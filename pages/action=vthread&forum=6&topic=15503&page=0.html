<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Идентификация &quot;своей&quot; DLL, и загрузка DLL из памяти. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Приветствую! У меня есть два странных вопроса: 1. Есль некий софт, который использует плагины в DLL. Нужно как-то отличать &quot;свои&quot; плагины от &quot;чужих&quot;. Если ли какие-нибудь варианты, но так, чтобы эту проверку">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=55802'>JustLife</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Идентификация &quot;своей&quot; DLL, и загрузка DLL из памяти.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=15503&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=15503&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 декабря 2009 23:12 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Приветствую!<br>У меня есть два странных вопроса:<br>1. Есль некий софт, который использует плагины в DLL. Нужно как-то отличать &quot;свои&quot; плагины от &quot;чужих&quot;. Если ли какие-нибудь варианты, но так, чтобы эту проверку нельзя было обойти?<br>Мне в голову приходит только один: шифровать библиотеку по алгоритму RSA и в проге расшифровывать и загружать из памяти. Тогда никто левый не сможет зашифровать DLL, потому что не будет знать ключ.<br>В связи с этим второй вопрос:<br>2. Киньте плиз в меня статьей или тутором как загрузить DLL из образа в памяти.<br><br>Пояснение (знаю что тут не любят такие темы:s5<img src="img/smilies/s1.gif" alt="">: <br>- Это НЕ троян, и НЕ малварь.<br>- Это НЕ прот или что-то подобное.<br>- Прога совершенно бесплатна для конечного пользователя.<br><br>Для чего вводится такое ограничение: Прога работает с личными данными пользователей, и мне очень не хочется чтобы пользователь скачал где-то в инете плагин хакера Васи, который уведет у него все пароли. Потому что в этом случае виноват окажется все равно разработчик))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247251&amp;user=8921&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=1" class="addthx" data-post="247251"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Kalmar[/b]','')">Kalmar</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.36'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=20084">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 декабря 2009 23:37 <br><script type="text/javascript">QU('Kalmar','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kalmar" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Подпишите &quot;свои&quot; плагины цифровой подписью и проверяйте её на валидность.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247253&amp;user=20084&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=2" class="addthx" data-post="247253"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]n0name[/b]','')">n0name</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 61.4 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.7'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 декабря 2009 23:58 <br><script type="text/javascript">QU('n0name','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n0name" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
а сохранить расшифрованную версию в temp нельзя?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247256&amp;user=7411&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=3" class="addthx" data-post="247256"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b][wl][/b]','')">[wl]</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/2760.jpg" alt=""><br><span class=txtSm>Ранг: 196.6 (ветеран), 11thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.76'>Активность: 0.07<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2760">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 00:01 <br><script type="text/javascript">QU('[wl]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[wl]" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
не совсем понятно, длл должна быть зашифрована или просто подписана? если достаточно подписи, то шифровать не придется
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247257&amp;user=2760&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=4" class="addthx" data-post="247257"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 00:51 &middot; Поправил: Azur1d <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Kalmar пишет:<br>Подпишите &quot;свои&quot; плагины цифровой подписью и проверяйте её на валидность. </I><br><I>[wl] пишет:<br>просто подписана? </I><br>Спасибо, я думал над этим, но в этом случае достоточно будет поправить один джамп в проге и она начнет хавать любые плагины.<br><br><br><I>[wl] пишет:<br>длл должна быть зашифрована </I><br>Это как вариант, просто мне в голову не пришли другие методы, отвечающие заданным требованиям.<br><br><I>n0name пишет:<br>а сохранить расшифрованную версию в temp нельзя? </I><br>Не вариант, потому что тогда можно будет подсунуть в темп любой плаг.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247263&amp;user=8921&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=5" class="addthx" data-post="247263"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:02 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>Azur1d пишет:<br>Спасибо, я думал над этим, но в этом случае достоточно будет поправить один джамп в проге и она начнет хавать любые плагины. </I><br>Если по условиям задачи требуется защита от вредоносного ПО работающего на одном уровне привилегий с тобой, то задача не имеет решения. <br>Как вам уже сказали, для гарантии аутентичности плугинов их нужно подписывать ЭЦП. А распаковывать перед загрузкой следует туда, куда атакующий не имеет доступа. Если таких мест нет, то увы, ничего нельзя сделать.<br><br>Чтобы знать что и как делать, сначала составьте модель угроз. Т.е. опишите формальным языком что и от кого вы хотите защищать, какими возможностями может обладать атакующий, и.т.п. Без этого вам врядли посоветуют что-то дельное.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247264&amp;user=12867&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=6" class="addthx" data-post="247264"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:10 &middot; Поправил: Azur1d <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>ntldr пишет:<br>Если по условиям задачи требуется защита от вредоносного ПО работающего на одном уровне привилегий с тобой, то задача не имеет решения. </I><br>Дык ежу понятно что идеальных защит не бывает, но можно ведь сделать так чтобы злоумышленник поимел максимальное количество гемора)))<br><br><I>ntldr пишет:<br>для гарантии аутентичности плугинов их нужно подписывать ЭЦП </I><br>То что я предлагаю, и есть своеобразная подпись, только шифруется не хэш, а весь плаг.<br>Если использовать &quot;классическую&quot; подпись, то где-то в теле программы все равно останется один джамп после проверки подписи, поправив который атакующий получит возмжность загрузить плаг с левой подписью.<br>Если использовать мой вариант, то даже после патча приложение просто рухнет при попытке выполнить мусор из покриптованной DLL.<br><br><I>ntldr пишет:<br>А распаковывать перед загрузкой следует туда, куда атакующий не имеет доступа. Если таких мест нет, то увы, ничего нельзя сделать. </I><br>Лично я в винде таких мест не знаю, а вы?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247265&amp;user=8921&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=7" class="addthx" data-post="247265"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:17 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Azur1d пишет:<br>Дык ежу понятно что идеальных защит не бывает, но можно ведь сделать так чтобы злоумышленник поимел максимальное количество гемора))) </I><br>Я считаю что программа должна делать то, что она должна делать. Если она не позиционируется как замена системы безопасности ОС, то гемор поимеете только вы и ваши пользователи. Кому надо - тот всёравно взломает.<br><br><I>Azur1d пишет:<br>То что я предлагаю, и есть своеобразная подпись, только шифруется не хэш, а весь плаг. </I><br>Весь плаг шифруется RSA? В таком случае поздравляю, вы допустили фатальную ошибку в применении этого алгоритма, и ваш секретный ключ легко вычисляется по публичному ключу и шифртексту.<br>Чтобы писать самому реализацию какой-либо криптографии, особенно асиммитричной, нужно идеально знать её матчасть. Не знаете матчасти - используйте распространенную библиотеку, или на худой конец CryptoAPI.<br><br><br><I>Azur1d пишет:<br>Если использовать &quot;классическую&quot; подпись, то где-то в теле программы все равно останется один джамп после проверки подписи, поправив который атакующий получит возмжность загрузить плаг с левой подписью. </I><br>Повторяю: если атакующий может модифицировать код вашей программы, то сливай воду и суши вёсла. Он может просто вырезать нахрен всю криптографию и загрузить обычную DLL.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247266&amp;user=12867&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=8" class="addthx" data-post="247266"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:19 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Azur1d пишет:<br>Лично я в винде таких мест не знаю, а вы? </I><br>Всё что в пределах %HOMEPATH% доступно только текущему пользователю, и ещё администраторам. Но если ваш враг администратор, то увы, вы заранее проиграли.<br><br>К тому-же я не услышал от чего именно вы хотите защититься. Если постановка задачи стоит как &quot;хочу чтобы никто, даже администратор, не мог прицепить к моему процессу свою DLL&quot;, то учтите что атакующему достаточно кинуть в папку с вашей программой DLL с именем одной из системных, и система её загрузит до исполнения вашего кода. С этим вы ничего не можете поделать.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247267&amp;user=12867&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=9" class="addthx" data-post="247267"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:23 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>ntldr</b>, спасибо за советы!<br><br><I>ntldr пишет:<br>Весь плаг шифруется RSA? В таком случае поздравляю, вы допустили фатальную ошибку в применении этого алгоритма, и ваш секретный ключ легко вычисляется по публичному ключу и шифртексту. </I><br>Тогда так: плагин не шифруется, прога его загружает, забирает из него некий хедер, расшифровывает его, из него извлекает симметричный ключ и им расшифровывает код. <br><br><I>ntldr пишет:<br>Он может просто вырезать нахрен всю криптографию и загрузить обычную DLL. </I><br>Может конечно, но тогда перестанут работать нормальные плаги и пользователь это заметит. <br><br><I>ntldr пишет:<br>если атакующий может модифицировать код вашей программы, то сливай воду и суши вёсла </I><br>Я это прекрасно понимаю, поэтому не стоит задача защитить на 100%. Стоит задача макимально усложнить взломщику задачу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247268&amp;user=8921&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=10" class="addthx" data-post="247268"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:25 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>ntldr</b>, возможно вы меня неправильно поняли - я не пытаюсь доказать крутость этой идеи, я просто высказал то что мне пришло на ум и спросил как можно сделать тоже самое другими средствами.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247269&amp;user=8921&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=11" class="addthx" data-post="247269"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:26 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
А нельзя проверять просто сигнатуру принадлежности к данной программе , сделать процедуруинициализации плагина с загрузкой конфигурации , сделать Длл Врапер определенных функций , и потом все это дело дружно накрыть вм протекцией как в проге , так и в дллке ?!<br><br>Добавлено - а там уже и крипто , но можно не сложное а подобие крипто под вм протекцию ...<br><br><b>ntldr</b> Весьма академичный подход =) по постановке задачи
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247270&amp;user=3520&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=12" class="addthx" data-post="247270"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:30 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Azur1d пишет:<br>Тогда так: плагин не шифруется, прога его загружает, забирает из него некий хедер, расшифровывает его, из него извлекает симметричный ключ и им расшифровывает код. </I><br>Прошу вас - не занимайтесь самодеятельностью. Шифровать симмитричный ключ - это правильный подход, но и это не так уж просто сделать правильно. Есть такие вещи как low exponent attack, схемы дополнения симметричного ключа, и прочее, что обязательно надо знать, иначе будет дыра. Используйте библиотеки, там уже всё сделали за вас.<br><br><I>Azur1d пишет:<br>Может конечно, но тогда перестанут работать нормальные плаги и пользователь это заметит. </I><br>Да ладно, что ему мешает пропатчить так, чтобы шифрованные плаги расшифровывались, а не шифрованные нет. Это всего на 5 минут дольше.<br><br><br><I>Azur1d пишет:<br>Я это прекрасно понимаю, поэтому не стоит задача защитить на 100%. Стоит задача макимально усложнить взломщику задачу. </I><br>Ещё раз повторяю (для танкистов): опишите взломщика и формализуйте задачу. И полностью читайте мой предыдущий пост, т.к. если я угадал с постановкой задачи, то вас сразу ждет жесточайший облом.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247271&amp;user=12867&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=13" class="addthx" data-post="247271"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:35 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Дам пример адекватной постановки задачи и её решения:<br><br>ТЗ: Гарантировать защиту от случайной установки пользователем неавторизованных плугинов. Гарантировать невозможность модификации программы со стороны других пользователей, за исключением администраторов.<br>Решение: Использовать ЭЦП на основе Authenticode, либо собственный формат подписи на основе CryptoAPI или OpenSSL. Устанавливаемые плугины и конфиги хранить в %homedir%, запрещать установку программы в общедоступные для записи папки.<br><br>Когда дело касается безопасности, то должен иметь место строгий системный подход, а защиты обоснование которых сводится к &quot;авось враг не догадается, а если догадается то забьёт&quot; - свидетельство дилетантизма автора, и доверия к нему и его ПО не добавляют.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247273&amp;user=12867&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=14" class="addthx" data-post="247273"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:41 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>ntldr пишет:<br>Используйте библиотеки, там уже всё сделали за вас. </I><br>Библиотеки криптоалгоритмов видел. Библиотеки, позволяющие опознать &quot;свой-чужой&quot; плагин не видел. Если ткнете носом, буду очень благодарен.<br><br><I>ntldr пишет:<br>Ещё раз повторяю (для танкистов): опишите взломщика и формализуйте задачу </I><br>Задача: Максимально затруднить взломщику увод паролей из памяти.<br>Взломщик не ограниченин в средствах реализации, но вычислительные мощности взломщика сильно ограничены (фактически три-четыре мощных компа).<br>Если не указал еще какие-то данные - скажите какие.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247274&amp;user=8921&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=15" class="addthx" data-post="247274"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:45 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Azur1d пишет:<br>Задача: Максимально затруднить взломщику увод паролей из памяти. </I><br>Для этого он может просто найти их в памяти и скопировать. Методов защиты от этого я не знаю.<br>Либо он может загрузить свой плаг, который получит доступ к паролям. От этого я и пытаюсь защититься.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247275&amp;user=8921&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=16" class="addthx" data-post="247275"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:55 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Azur1d пишет:<br>Библиотеки криптоалгоритмов видел. Библиотеки, позволяющие опознать &quot;свой-чужой&quot; плагин не видел. Если ткнете носом, буду очень благодарен. </I><br>В аттаче исходники опознающие оригинальные апдейты MS по Authenticode подписи. Для вашего случая достаточно заменить в них строку &quot;Microsoft Code Signing PCA&quot; на имя своего сертификата.<br><br><I>Azur1d пишет:<br>Если не указал еще какие-то данные - скажите какие. </I><br>Имеет ли злоумышленник возможность запускать на атакуемой системе свои программы с администраторскими привилегиями? Если да, то разработка защиты принесет больше вреда, чем пользы, ибо всеравно не поможет. Если же стоит задача защититься от левых плугинов которые пользователь САМ попытается установить путем копирования DLL в папку с плугинами вашей программы, то это возможно.<br><br><img src="img/attach.gif" alt=""> <a href="./files/44ec_20.12.2009_CRACKLAB.rU.tgz">44ec_20.12.2009_CRACKLAB.rU.tgz</a> - check.c
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247276&amp;user=12867&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=17" class="addthx" data-post="247276"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:57 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>ntldr пишет:<br>В аттаче исходники опознающие оригинальные апдейты MS по Authenticode подписи. </I><br>Большое спасибо!<br><br><I>ntldr пишет:<br>Если же стоит задача защититься от левых плугинов которые пользователь САМ попытается установить путем копирования DLL в папку с плугинами вашей программы, то это возможно. </I><br>Да! Да!!! Именно от этого и ТОЛЬКО от этого нужно защищаться. потому что я и сам понимаю, что<br><I>ntldr пишет:<br>Если да, то разработка защиты принесет больше вреда, чем пользы, ибо всеравно не поможет </I>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247277&amp;user=8921&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=18" class="addthx" data-post="247277"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 01:59 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>ntldr</b>, спасибо огромное, вы открыли мне глаза.<br>Если других методов нет, то вопрос можно считать решенным, если есть - буду рад выслушать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247278&amp;user=8921&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=19" class="addthx" data-post="247278"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]SLV[/b]','')">SLV</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 309.8 (мудрец), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.69'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=663">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 07:10 <br><script type="text/javascript">QU('SLV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SLV" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Всеми любимый антивирус касперского использует ЭЦП для своих модулей.
<br><br><font size="1"><i>-----<br>Shalom ebanats!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247289&amp;user=663&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=20" class="addthx" data-post="247289"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 09:20 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Стоит добавить, что если пользователю ОЧЕНЬ захочется установить себе левый плаг, то технически невозможно это запретить, поскольку тогда наша задача из области криптографии переходит в область DRM (которые, как известно, не могут быть надежны).
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247293&amp;user=12867&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=21" class="addthx" data-post="247293"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 09:53 <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>Azur1d пишет:<br>Киньте плиз в меня статьей или тутором как загрузить DLL из образа в памяти </I><br><br>hxxp://www.rsdn.ru/article/baseserv/peloader.xml
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247295&amp;user=6801&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=22" class="addthx" data-post="247295"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]DMD[/b]','')">DMD</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 11:24 <br><script type="text/javascript">QU('DMD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DMD" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>ntldr пишет:<br>Он может просто вырезать нахрен всю криптографию и загрузить обычную DLL.  </I><br>если приложение локальное, если длл не криптована и если хватит квалификации - да, сможет (ну или кто поможет <img src="img/smilies/s5.gif" alt=""> ), и что это ему даст?<br>Azur1d как девелопер не будет столь наивным что бы оставить процесс загрузки длл на самотек <img src="img/smilies/s1.gif" alt=""> добавит decrypt любым алго кода любой функции dll и все.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247297&amp;user=892&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=23" class="addthx" data-post="247297"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 11:36 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>DMD пишет:<br>и что это ему даст? </I><br>Даст возможность установить левый плуг наплевав на запреты автора. Если цель, с которой автор делает эту защиту не совпадает с желаниями пользователей, и программа хоть кому-то нужна, то её быстро взломают.<br><br><I>DMD пишет:<br>Azur1d как девелопер не будет столь наивным что бы оставить процесс загрузки длл на самотек  добавит decrypt любым алго кода любой функции dll и все. </I><br>Да ладно тебе. Я думаю тут все прекрасно знают, что ухищрения из серии &quot;безопасность через неизвестность&quot; ещё никому не помогли. Если подобную защиту на сломают, то это значит лишь одно - она никому нафиг не сдалась.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247298&amp;user=12867&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=24" class="addthx" data-post="247298"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]RSI[/b]','')">RSI</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 284.8 (наставник), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 11:44 <br><script type="text/javascript">QU('RSI','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RSI" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>Azur1d</b><br>возможно стоит завести white list плагинов которые прога будет загружать + проверка ЭЦП. и этого будет достаточно + содержимое списка будет закрипчено и проверка будет происходить не один раз, а в нескольких местах, но тогда еще придется контролировать соответсвие стандартных виндовых библиотек оригинальным.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247299&amp;user=6361&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=25" class="addthx" data-post="247299"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 11:56 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>RSI пишет:<br>но тогда еще придется контролировать соответсвие стандартных виндовых библиотек оригинальным. </I><br>А это лишнее. Повторяю в десятый раз: если злоумышленник может запускать программы с администраторскими привилегиями, модифицировать системные библиотеки или имеет физический доступ к системе на которой исполняется ваша программа, то сливай воду и суши вёсла. Все попытки защититься от такого атакующего идут не в плюс, а в минус к потребительским качествам софта, т.к. ничего кроме проблем не приносят.<br>Поэтому исходить надо из предположения, что атакующий это НЕ пользователь программы, а какое-то третье лицо, которое может лишь выкладывать левые плуги на левых сайтах или имеет ОГРАНИЧЕННЫЙ доступ к атакуемой системе. В таких рамках задача имеет решение.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247301&amp;user=12867&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=26" class="addthx" data-post="247301"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 12:02 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<I>ntldr пишет:<br>Стоит добавить, что если пользователю ОЧЕНЬ захочется установить себе левый плаг, то технически невозможно это запретить </I><br>Если юзер САМ захочет загрузить левый плуг, то это его личное горе. А если юзер скачает &quot;новый JIMM с золотыми смайликами&quot; который втихушку установит ему этот плаг - вот это уже моя проблема.<br><br><I>ntldr пишет:<br>Если цель, с которой автор делает эту защиту не совпадает с желаниями пользователей, и программа хоть кому-то нужна, то её быстро взломают </I><br>Программа бесплатная, плаги бесплатные - обычному юзеру ломать ничего не нужно.<br><br><I>RSI пишет:<br>возможно стоит завести white list плагинов </I><br>Плаги выходят чаще чем обновляется прога, каждый раз просить пользователя скачать новую версию?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247303&amp;user=8921&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=27" class="addthx" data-post="247303"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 12:03 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>ntldr пишет:<br>Поэтому исходить надо из предположения, что атакующий это НЕ пользователь программы, а какое-то третье лицо, которое может лишь выкладывать левые плуги на левых сайтах или имеет ОГРАНИЧЕННЫЙ доступ к атакуемой системе </I><br>Атакующий может либо выложить плуг, либо установить его с помощью трояна.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247305&amp;user=8921&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=28" class="addthx" data-post="247305"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 12:07 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>Azur1d пишет:<br>А если юзер скачает &quot;новый JIMM с золотыми смайликами&quot; который втихушку установит ему этот плаг - вот это уже моя проблема. </I><br>Есть ли у этой проблемы решение - зависит от того, в каком виде пользователь скачает этот самый &quot;новый JIMM&quot;. Если в виде DLL, которую он вручную скопирует в папку с плугами, то вы можете проверить и не загружать эту DLL. Если в виде EXE инсталлятора, то вы бессильны что-либо сделать, т.к. вы не контролируете запуск этого EXE, и он может патчить систему, вашу программу, и.т.д. Такой случай - это проблема пользователей и антивирусных компаний.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=247306&amp;user=12867&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=29" class="addthx" data-post="247306"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]DMD[/b]','')">DMD</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2009 12:26 &middot; Поправил: DMD <br><script type="text/javascript">QU('DMD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DMD" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15503&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>ntldr пишет:<br>Даст возможность установить левый плуг наплевав на запреты автора. </I><br>не думаю что все будет так просто, но спорить нет смысла <img src="img/smilies/s1.gif" alt=""> (см ниже)<br> <br><I>Azur1d пишет:<br>Программа бесплатная, плаги бесплатные - обычному юзеру ломать ничего не нужно. </I><br><I>Azur1d пишет:<br>Плаги выходят чаще чем обновляется прога, каждый раз просить пользователя скачать новую версию?  </I><br><br>из всего следует только один вывод: <b>нет ТЗ - нет предмета диспута.</b><br>каждый из присутствующих может &quot;в_слепую&quot; предложить по небольшой кучке вариантов ответов на поставленные ТС вопросы. + еще немного в зависимости от доп.условий или уточнений от ТС<br>пока же в кофейной гуще и то больше информативности<br><br>ps<br><I>ntldr пишет:<br>Если в виде DLL, которую он вручную скопирует в папку с плугами, то вы можете проверить и не загружать эту DLL </I><br>кажется мне, ТС не контролирует кол-во user&#039;ов и/или права на использование ими длл =&gt; проверить это невозможно в принципе<br>и опять же см. вывод выше
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=247307&amp;user=892&amp;forum_n=6&amp;topic=15503&amp;page=0&amp;anchor=30" class="addthx" data-post="247307"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=15503&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=15503&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Идентификация &quot;своей&quot; DLL, и загрузка DLL из памяти.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="15503">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15503" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
