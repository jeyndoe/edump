<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Методы внедрения DLL в процессы - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет. Интересует информация о возможностях внедрения DLL в процесс. Однако предлагаемые варианты должны удовлетворять определенным требования  1/ Исключительно юзермод. 2/ Ключ AppInit_Dlls, функция SetWindowsHookEx не">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=39467'>hgdagon</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Методы внедрения DLL в процессы</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=9581&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=9581&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]pushick[/b]','')">pushick</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 117.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 07:51 <br><script type="text/javascript">QU('pushick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pushick" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет.<br><br>Интересует информация о возможностях внедрения DLL в процесс. Однако предлагаемые варианты должны удовлетворять определенным требования <img src="img/smilies/s1.gif" alt=""><br><br>1/ <u>Исключительно</u> юзермод.<br>2/ Ключ AppInit_Dlls, функция SetWindowsHookEx не интересуют.<br>3/ Варианты, в той или иной мере требующие открытия процесса (в том числе через сервер процессов) также не интересны, так как невозможно получить нормальный хэндл процесса.<br>4/ Внедрение должен быть в максимально возможное количество процессов, winlogon отдельно не интересует.<br>5/ Модификация файлов на диске не рассматривается.<br>6/ Внедрение через перехват той или иной фазы создания процесса не интересует.<br>7/ Желательно, чтобы все начинало работать без перезагрузки, но не обязательно.<br><br>Есть ли что-то ещё или нет? <img src="img/smilies/s1.gif" alt=""><br>Если кто готов поделиться информацией буду очень благодарен.<br><br>TIA
<br><br><font size="1"><i>-----<br>Security through obscurity is just an illusion</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150643&amp;user=10667&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=1" class="addthx" data-post="150643"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]W[4Fh]LF[/b]','')">W[4Fh]LF</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 56.3 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.61'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8227">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 08:13 <br><script type="text/javascript">QU('W[4Fh]LF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=W[4Fh]LF" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
rootkit.com/newsread.php?newsid=715<br><br>Правда, я думаю ты о нём знаешь <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150645&amp;user=8227&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=2" class="addthx" data-post="150645"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]pushick[/b]','')">pushick</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 117.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 08:47 <br><script type="text/javascript">QU('pushick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pushick" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Спасибо. Однако это патч процесса при загрузке. А если оно уже загружено?
<br><br><font size="1"><i>-----<br>Security through obscurity is just an illusion</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150652&amp;user=10667&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=3" class="addthx" data-post="150652"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 09:31 <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
А в <i class=x>Advanced API Hook Libary (By Ms-Rem)</i> смотрел ?<br>Там есть три разных метода внедрения.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150662&amp;user=11974&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=4" class="addthx" data-post="150662"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]pushick[/b]','')">pushick</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 117.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 12:34 <br><script type="text/javascript">QU('pushick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pushick" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Смотрел.<br><br><b>InjectDll</b> стандартный прием с LoadLibraryA/CreateRemoteThread. Неприемлимо, поскольку CreateRemoteThread требует хэндл процесса, который получить для целевого процесса в моем случае из юзермод невозможно, мой пункт №3 в первом посте.<br><b>InjectDllEx</b> запись DLL в процесс и инжект трида с передачей управления. Неприемлимо, опять же никто не даст открыть и тем более писать в процесс, пункт №3.<br><b>InjectDllAlt</b> используется инжект, основанный на SetThreadContext. Совершенно неприменимо, поскольку к сожалению потоки целевого процесса закрыты от доступа хуками на уровне SSDT.<br><br>Для более полного понимая поясню, что задача проникнуть в АП уже запущенного процесса средствами юзермод, при этом процесс не дает просто так открыть себя в юзермод <img src="img/smilies/s1.gif" alt=""><br><br>Хм. Может существуют ещё какие-нибудь ключи в реестре (кроме AppInit), которые могут подгрузить dll в процесс (помимо winlogon)?
<br><br><font size="1"><i>-----<br>Security through obscurity is just an illusion</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150703&amp;user=10667&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=5" class="addthx" data-post="150703"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]sotona[/b]','')">sotona</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 51.0 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.02'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5495">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 12:40 &middot; Поправил: sotona <br><script type="text/javascript">QU('sotona','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sotona" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
[deleted]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150704&amp;user=5495&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=6" class="addthx" data-post="150704"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]asd[/b]','')">asd</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 162.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.58'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3241">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 13:33 <br><script type="text/javascript">QU('asd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=asd" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>pushick</b><br>Скажи а пользователь на чьей стороне? Твоей или той проги?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150717&amp;user=3241&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=7" class="addthx" data-post="150717"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]pushick[/b]','')">pushick</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 117.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 14:34 <br><script type="text/javascript">QU('pushick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pushick" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Оффтоп, но ладно. Это не троян (или любая другая вредоносная программа) и это не средство потрошения касперского антивируса <img src="img/smilies/s1.gif" alt=""><br><br>А теперь может все-таки что-то в тему?
<br><br><font size="1"><i>-----<br>Security through obscurity is just an illusion</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150733&amp;user=10667&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=8" class="addthx" data-post="150733"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]SLV[/b]','')">SLV</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 309.8 (мудрец), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.69'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=663">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 15:56 <br><script type="text/javascript">QU('SLV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SLV" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
в езиносах 29A писали про ключ реестра, чтобы поставить свою прогу &quot;отладчиком&quot; для другой... кто заинтересуется найдёт и пременит =)
<br><br><font size="1"><i>-----<br>Shalom ebanats!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150756&amp;user=663&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=9" class="addthx" data-post="150756"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Executioner[/b]','')">Executioner</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/7616.gif" alt=""><br><span class=txtSm>Ранг: 120.9 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.68'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7616">Участник</a><br><font color=blue>Programmer and reverser</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 16:00 <br><script type="text/javascript">QU('Executioner','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Executioner" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Что это у тебя за процесс, хэндл которого невозможно получить? Если уж так вышло, то все же, видимо, придется писать драйвер. И все же, почему ты не можешь получить &quot;нормальный&quot; хэндл процесса? И что ты вместо него получаешь?
<br><br><font size="1"><i>-----<br>Уважайте других и пишите грамотно.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150760&amp;user=7616&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=10" class="addthx" data-post="150760"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]SLV[/b]','')">SLV</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 309.8 (мудрец), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.69'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=663">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 16:15 <br><script type="text/javascript">QU('SLV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SLV" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
ага... восстанови sdt и получай хэндл, не боясь аверов =]
<br><br><font size="1"><i>-----<br>Shalom ebanats!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150770&amp;user=663&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=11" class="addthx" data-post="150770"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]pushick[/b]','')">pushick</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 117.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 17:22 <br><script type="text/javascript">QU('pushick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pushick" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>SLV</b><br><br>Это про Image File Execution Options?<br>Метод известный, спасибо.<br><br><I>Executioner пишет:<br>И все же, почему ты не можешь получить &quot;нормальный&quot; хэндл процесса? </I><br><br>Потому что перекрыто SSDT (десяток функций инлайном), пропатчена таблица хэндлов в ядре, а все что осталось от следов присутсвия процесса в системе было закрыто принудительно самой программой.<br><br>SSDT почти всегда восстанавливается легко и непринуждено в двух случаях<br>1/это хуки антивируса<br>2/тебе дали загрузить драйвер<br><br>в нашем случае<br>1/это не дребедень вроде кав, хуки стоят инлайном и это мониторит их, восстанавливая немедленно<br>2/если я загружу драйвер, мне уже ничего из темы этого топика будет не нужно <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Security through obscurity is just an illusion</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150780&amp;user=10667&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=12" class="addthx" data-post="150780"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]SLV[/b]','')">SLV</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 309.8 (мудрец), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.69'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=663">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 17:24 <br><script type="text/javascript">QU('SLV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SLV" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
ищи ошибки в этой защите сталобыть =]
<br><br><font size="1"><i>-----<br>Shalom ebanats!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150781&amp;user=663&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=13" class="addthx" data-post="150781"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]n0name[/b]','')">n0name</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 61.4 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.7'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 17:52 <br><script type="text/javascript">QU('n0name','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n0name" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
приложение оконное?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150788&amp;user=7411&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=14" class="addthx" data-post="150788"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]pushick[/b]','')">pushick</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 117.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 05:54 <br><script type="text/javascript">QU('pushick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pushick" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>SLV</b><br><br>Вот я и ищу <img src="img/smilies/s5.gif" alt=""><br><br><b>n0name</b><br><br>Приложение оконное. Однако, не стоит на это расчитывать, так как его окна тоже бронированные.<br>Хотя здесь могут быть варианты. хвнд окна стандартными средствами получить невозможно.<br>Вообще эту программу писали фанатики самозащиты <img src="img/smilies/s3.gif" alt=""> по аналогии с крякми и катчме это можно назвать факме <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>Security through obscurity is just an illusion</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150886&amp;user=10667&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=15" class="addthx" data-post="150886"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Sly Ass[/b]','')">Sly Ass</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.8 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.03'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12225">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 05:59 <br><script type="text/javascript">QU('Sly Ass','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sly Ass" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>pushick</b><br>Под твои условия подходит разве что добавление dll в загружаемые LSP, shell extention, и.т.д. <br>Для процессов запускающихся не из системной директории, можно кинуть dll враппер на используемую ими дллку в их папку. Ну в общем то и все, болше под эти условия ничего не подойдет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150888&amp;user=12225&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=16" class="addthx" data-post="150888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]pushick[/b]','')">pushick</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 117.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 08:53 <br><script type="text/javascript">QU('pushick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pushick" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Sly Ass</b><br>Спасибо большое. Если можно поподробнее про shell extensions. AFAIK они и называются потому так, что работают в оболочке и вызываются из оболочки? И как здесь поможет layered service provider?<br><br>Насчет врапера я тоже смотрел, однако оказалось, что таблица импорта у программы отсутствует, в силу чего она не работает под win2k. Анализ показал, что программа самостоятельно подгружает kernel32.dll и далее грузит все, что ей нужно. Что неужели все прикрыто? <img src="img/smilies/s13.gif" alt="">
<br><br><font size="1"><i>-----<br>Security through obscurity is just an illusion</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150901&amp;user=10667&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=17" class="addthx" data-post="150901"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]HoBleen[/b]','')">HoBleen</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5110.jpg" alt=""><br><span class=txtSm>Ранг: 240.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.09'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5110">Участник</a><br><font color=blue>Author of ACKiller </font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 09:02 <br><script type="text/javascript">QU('HoBleen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HoBleen" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>pushick</b><br>А если открыть csrss и получить хендл через DuplicateHandle?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150904&amp;user=5110&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=18" class="addthx" data-post="150904"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]W[4Fh]LF[/b]','')">W[4Fh]LF</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 56.3 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.61'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8227">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 09:03 &middot; Поправил: W[4Fh]LF <br><script type="text/javascript">QU('W[4Fh]LF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=W[4Fh]LF" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>pushick пишет:<br>Вот я и ищу  </I><br><br>Можно ещё попробовать заюзать локальные баги elevation of code privelege в ОС. Хотя это жёсткая привязка к ОС, но всё зависит от задачи.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150905&amp;user=8227&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=19" class="addthx" data-post="150905"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Sly Ass[/b]','')">Sly Ass</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.8 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.03'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12225">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 09:57 <br><script type="text/javascript">QU('Sly Ass','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sly Ass" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>HoBleen пишет:<br>А если открыть csrss и получить хендл через DuplicateHandle? </I><br>А почитать первый пост в топеге не судьба?<br><br><I>pushick пишет:<br>Если можно поподробнее про shell extensions. </I><br>Это DLL которые добавляют пункты в контекстное меню оболочки. (к примеру rarext.dll в WinRar). Могут быть загружены в любой процесс использующий file open dialig, либо другие функции оболочки.<br>Смотри HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers и потом HKEY_CLASSES_ROOT\CLSID<br><br><I>pushick пишет:<br>И как здесь поможет layered service provider? </I><br>Если процесс юзает winsock, то LSP в него загрузиться.<br><br><br><I>HoBleen пишет:<br>Насчет врапера я тоже смотрел, однако оказалось, что таблица импорта у программы отсутствует, в силу чего она не работает под win2k. Анализ показал, что программа самостоятельно подгружает kernel32.dll и далее грузит все, что ей нужно. Что неужели все прикрыто </I><br>А загрузиться ДО нее и после хукать создание процессов не судьба? К примеру это можно сделать из BootExecute<br><br>З.Ы. можно ссылку на прогу в личку?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150911&amp;user=12225&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=20" class="addthx" data-post="150911"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Unmoored[/b]','')">Unmoored</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9253">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 10:01 &middot; Поправил: Unmoored <br><script type="text/javascript">QU('Unmoored','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Unmoored" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
И вобще это странно. Прога может рушить хендлы только из режима ядра. Бороться с ядром из юзер-мода... А что мешает сделать простенький драйвер? Из режима ядра можно будет напрямую пообщаться с обьектом ядра процесс...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150913&amp;user=9253&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=21" class="addthx" data-post="150913"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]n0name[/b]','')">n0name</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 61.4 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.7'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 11:04 <br><script type="text/javascript">QU('n0name','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n0name" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>Sly Ass пишет:<br>З.Ы. можно ссылку на прогу в личку? </I><br>тож интересно.<br><I>pushick пишет:<br>Анализ показал, что программа самостоятельно подгружает kernel32.dll </I><br>проверяет что это реальный kernel32?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150926&amp;user=7411&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=22" class="addthx" data-post="150926"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 11:29 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
хех))) что же это такое то? по осписанию что-то знакомое, но говорить не буду <img src="img/smilies/s1.gif" alt=""><br>на счёт хендла окна, его можно получить многими способами <img src="img/smilies/s2.gif" alt=""> врядли они прикрыли все,<br>всё зависит от задачи, я так бегло пробежал топик, но вроде не заметил, а для чего это всё? <img src="img/smilies/s13.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150932&amp;user=72&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=23" class="addthx" data-post="150932"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]pushick[/b]','')">pushick</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 117.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 11:57 <br><script type="text/javascript">QU('pushick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pushick" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>HoBleen</b><br><br>Пункт №3 первого поста. Хэндл процесса отсутствует в csrss.exe<br><br><I>Sly Ass пишет:<br>Это DLL которые добавляют пункты в контекстное меню оболочки. (к примеру rarext.dll в WinRar). Могут быть загружены в любой процесс использующий file open dialig, либо другие функции оболочки.<br>Смотри HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers и потом HKEY_CLASSES_ROOT\CLSID  </I><br><br>Это понятно. К сожалению не применимо, программа не использует шел диалоги.<br><br><I>Sly Ass пишет:<br>Если процесс юзает winsock, то LSP в него загрузиться.  </I><br><br>Нет, ничего такого там нет.<br><br><I>Sly Ass пишет:<br>А загрузиться ДО нее и после хукать создание процессов не судьба? К примеру это можно сделать из BootExecute </I><br><br>Пункт №6 первого поста. На целевых компьютерах такой возможности просто не будет.<br><br><b>Sly Ass</b><br><b>n0name</b><br>Программа является частной и закрытой разработкой одной команды моего города. Мне отвинтят башку, если я выложу её в паблик. Если бы я имел такое право, я бы это сделал ещё в первом посте.
<br><br><font size="1"><i>-----<br>Security through obscurity is just an illusion</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150945&amp;user=10667&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=24" class="addthx" data-post="150945"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]pushick[/b]','')">pushick</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 117.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 12:06 <br><script type="text/javascript">QU('pushick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pushick" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>n0name пишет:<br>проверяет что это реальный kernel32? </I><br><br>Идет получение симболик линка на системную директорию, а потом типа strcatW(buf, &#039;\system32\kernel32.dll&#039;);<br><br><I>Hellspawn пишет:<br>хех))) что же это такое то? по осписанию что-то знакомое, но говорить не буду<br>на счёт хендла окна, его можно получить многими способами врядли они прикрыли все,<br>всё зависит от задачи, я так бегло пробежал топик, но вроде не заметил, а для чего это всё?<br> </I><br><br>Сомневаюсь, что ты знаешь, что это такое, поскольку ни одна из пяти версий никогда не выкладывалась в паблик. По описанию это похоже на антивирус или систему предотвращения, но это совсем не оно.<br>Перекрыты NtUserQueryWindow, NtUserFindWindowEx, NtUserBuildHwndList, NtUserWindowFromPoint, соответственно, все юзермод функции использующие их не дают результата. Если есть идеи, поделись <br><img src="img/smilies/s1.gif" alt=""><br><br><I>Unmoored пишет:<br>И вобще это странно. Прога может рушить хендлы только из режима ядра. Бороться с ядром из юзер-мода... А что мешает сделать простенький драйвер? Из режима ядра можно будет напрямую пообщаться с обьектом ядра процесс... </I><br><br>Рушить хэндлы в других процессах в юзермод можно через ZwDuplicateObject с флагом DUPLICATE_CLOSE_SOURCE, если я правильно тебя понял. Бороться с ядром вполне возможно, если авторы драйвера дураки. <br><br>При выходе в кернел мод не нужен и инжект длл. А тогда условия будут не выполнены и этот своеобразный &quot;факме&quot; будет не факнут.
<br><br><font size="1"><i>-----<br>Security through obscurity is just an illusion</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150947&amp;user=10667&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=25" class="addthx" data-post="150947"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]n0name[/b]','')">n0name</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 61.4 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.7'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 12:22 <br><script type="text/javascript">QU('n0name','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=n0name" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
а с потоками как? хендлы прикрыты?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150949&amp;user=7411&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=26" class="addthx" data-post="150949"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Sly Ass[/b]','')">Sly Ass</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.8 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.03'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12225">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 12:49 <br><script type="text/javascript">QU('Sly Ass','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sly Ass" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<I>pushick пишет:<br>Если есть идеи, поделись </I><br>Делаем скриншот через BitBlt, после чего ищем в нем координаты окна проги по сигнатуре и юзает keybd_event, mouse_event. Либо придется нарушить одно из правил условия задачи.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150955&amp;user=12225&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=27" class="addthx" data-post="150955"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 13:04 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
ну не все, например эта не прикрыта, как заюзать решай сам))) а заюзать можно <img src="img/smilies/s2.gif" alt=""><br><br>NtUserGetForegroundWindow<br><br>что-то мне всё странно это кажется, а не тестят ли очередной говнопродукт?<br>если это закрытая разарботка, нахера такая защита?
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150957&amp;user=72&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=28" class="addthx" data-post="150957"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]pushick[/b]','')">pushick</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 117.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10667">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 15:06 <br><script type="text/javascript">QU('pushick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pushick" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>n0name пишет:<br>а с потоками как? хендлы прикрыты? </I><br><br>Их тоже нет в csrss.<br><br><I>Hellspawn пишет:<br>что-то мне всё странно это кажется, а не тестят ли очередной говнопродукт?  </I><br><br>Вот насчет этого можешь быть абсолютно спокоен. На кавнокомпании я не работаю.<br><br><I>Hellspawn пишет:<br>если это закрытая разарботка, нахера такая защита? </I><br>Потому как эта программа всегда применяется только в жутко агрессивной среде =)<br><br>Кстати, спасибо за BitBlt, GetForegroundWindow, это конечно уже из области высоких извращений, но тоже можно попробовать в будущем.<br><br>Должен всех успокоить решение найдено - простое как полено, удивительно как я сам не догадался. Правда товарищ просил не говорить само решение <img src="img/smilies/s1.gif" alt=""> Пусть и не внедрение длл, но получив хэндл окна процесса с ним уже можно кое-что сотворить. Теперь задача тривиальна и не требует сторонней помощи.
<br><br><font size="1"><i>-----<br>Security through obscurity is just an illusion</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150990&amp;user=10667&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=29" class="addthx" data-post="150990"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]tnt17[/b]','')">tnt17</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/7417.jpg" alt=""><br><span class=txtSm>Ранг: 109.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.7'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7417">Участник</a><br><font color=blue>Cardinal</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 15:08 <br><script type="text/javascript">QU('tnt17','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tnt17" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=9581&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>pushick</b><br>Работа с файлами каким-то образом отслеживается/блокируется? Есть возможность получить доступ к закрытым на чтение файлам?
<br><br><font size="1"><i>-----<br>– Почему ты работаешь по ночам ?  – Так удобнее... В одну смену с чертями...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150991&amp;user=7417&amp;forum_n=6&amp;topic=9581&amp;page=0&amp;anchor=30" class="addthx" data-post="150991"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=9581&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=9581&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Методы внедрения DLL в процессы</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="9581">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=9581" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
