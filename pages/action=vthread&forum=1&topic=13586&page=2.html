<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Вопросы по написанию универсального распаковщика - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет всем! Форум читаю достаточно давно, узнал много нового, но сейчас возникли вопросы, на которые я не смог ответить самостоятельно, поэтому прошу помощи. Сначала краткая предыстория. Крякингом я занимаюсь меньше полугода,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопросы по написанию универсального распаковщика</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=1.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=1.html">2</a> . <b>3</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Wolfram[/b]','')">Wolfram</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2009 11:21 &middot; Поправил: Wolfram <br><script type="text/javascript">QU('Wolfram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wolfram" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#1');return false;">#1</a> </span><div align=left><br>
Привет всем! Форум читаю достаточно давно, узнал много нового, но сейчас возникли вопросы, на которые я не смог ответить самостоятельно, поэтому прошу помощи.<br><br>Сначала краткая предыстория. Крякингом я занимаюсь меньше полугода, научился за это время ломать сильно тупые защиты, где разработчик понадеялся на упаковщик/протектор. Автоматическим распаковщиком (или на &quot;полуавтомате&quot; - break&#039;n&#039;enter - EP - bpm esp-4 - OEP - dump - ImpRec) снимаем защиту, патчим пару байт - и готово. Но это, понятно, проходит далеко не всегда. Тупая защита + не самый простой пакер = приехали <img src="img/smilies/s9.gif" alt=""><br>И где-то месяца 2 назад я начал писать собственный универсальный распаковщик. Принцип действия у него задумывается такой:<br>- создаём замороженный поток.<br>- в EP втыкаем хук (jmp eip, чтобы не трассировать стандартным методом через TF, что обычно палится защитой) отпускаем программу до EP, замораживаем (SuspendThread), снимаем хук.<br>- далее эмулируем работу подопытной программы на виртуальных регистрах, но на её реальной памяти (Read/WriteProcessMemory).<br>- при этом ловим программу при возникновении исключений на входе в обработчик и на выходе из него; на возврате из системных вызовов (KiFastSystemCallRet); вообще, полностью отслеживаем передачу управления. Для этого предусмотрено втыкание хука в любое нужное место.<br>- на всём пути выполнения каким-либо образом запоминаем порядок передачи управления и адреса участков памяти, которые были изменены в адресном пространстве подопытной программы.<br>- когда доходим до OEP (определим, например, на основе статистики по нескольким файлам, покарёженных одним и тем же пакером), дампим всё, что было изменено.<br>- восстанавливаем импорт (пока с этим вопросом подробно не разбирался)<br>- делаем ещё какие-нибудь дополнительные приседания<br>- получаем рабочий дамп, который можно изучать в дизассемблере <img src="img/smilies/s1.gif" alt=""><br><br>Понятно, что, например, для Armadillo дополнительных приседаний будет очень много, но ASProtect вполне мог бы поддаться на такую провокацию.<br>С него я и решил начать. Запаковал виндовский блокнот с помощью ASProtect2.1, научился проходить на EP и стал &quot;обучать&quot; свой распаковщик ассемблерным инструкциям по одной. Проверка простая: если при встрече с незнакомой инструкцией актуализировать контекст и отпустить программу (ResumeThread), и она не грохнется, то с большой вероятностью все предыдущие инструкции выучены правильно.<br><br>&lt;отредактировано Wolfram&gt;<br>(Перенёс первый вопрос в свой второй пост, чтобы он не повторялся на каждой странице)<br><br>Заранее спасибо за ответы. Прошу модераторов не закрывать данную тему, когда они будут получены, потому что распаковщик пишется, и новые вопросы непременно будут возникать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=217964&amp;user=19474&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=1" class="addthx" data-post="217964"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Wolfram[/b]','')">Wolfram</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2009 12:03 &middot; Поправил: Wolfram <br><script type="text/javascript">QU('Wolfram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wolfram" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#2');return false;">#2</a> </span><div align=left><br>
2 Archer<br>Спасибо ещё раз (надеюсь, не последний <img src="img/smilies/s1.gif" alt=""> )<br><br>Раскурил мануал по FPU. Вставляет не по-детски! <img src="img/smilies/s15.gif" alt=""> Поэтому пока эмулировал все его команды через исполнение, вроде работает. В Аспре дошёл до OEP!!!!! Пора прикручивать дампер и поиск OEP (сейчас она у меня пока что в тексте анпакера вбита).<br><br>Идеи такие:<br>Трейсить прогу уже знакомым методом от EP и до обеда <img src="img/smilies/s1.gif" alt="">, попутно запоминая по каким адресам шло управление и модификация. Также фиксировать все вызовы VirtualAlloc и VirtualFree, чтобы иметь в руках список выделенных областей памяти. Когда мы решим, что OEP уже пройдена, мы остановим процесс. Анпакер может подсказать этот момент, но всё равно должна быть возможность трейсить дальше. Затем анпакер выдаст графики передачи управления и модификации памяти в осях [адрес в памяти - количество пройденных команд]. Чтобы размер трейс-файла был не слишком большим, можно запоминать адрес с точностью, например, до 4кб и сохранять трейс в формате [номер участка - количество пройденных в нём команд]. Переход на OEP, скорее всего, будет как-то визуально выделяться (по крайней мере, там обычно кончается самомодифицирующийся код). В итоге, положение OEP определяем мы, задаём его анпакеру, и снова запускаем трейсинг.<br>Дойдя до OEP, дампим все секции, которые были в исходном файле, плюс все области памяти, которые были выделены и не освобождены, засунув каждую в отдельную секцию. В итоге получаем для любого пакера/протектора рабочий дамп с офигенным количеством секций. Если это пакер или не очень хороший протектор, то с таким дампом уже можно работать - патчить и т.д. Если же прот качественный, то дамп нужно будет ещё каким-либо образом обработать - вернуть краденые байты с функций, убрать проверки CRC, обрезать лишние секции и т.д. Наиболее общие из таких дополнительных задач можно засунуть в основную программу, а узкоспециальные - сделать в виде плагинов.<br>Основная задача - даже при отсутствии соответствующего плагина в любом ring3 протекторе дойти до OEP и получить рабочий дамп. В нём, по крайней мере, можно будет изучить оставшуюся антиотладку, защиту от дизассемблирования, патча и др. и написать тот самый плагин.<br><br>Прошу высказаться всех, у кого есть конкретные предложения/замечания по описанной модели.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=220209&amp;user=19474&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=2" class="addthx" data-post="220209"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]SVIN95[/b]','')">SVIN95</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 39.0 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.72'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18599">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2009 17:24 <br><script type="text/javascript">QU('SVIN95','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVIN95" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#3');return false;">#3</a> </span><div align=left><br>
<b>Wolfram</b><br>Главная проблема не поиск OEP и не дампер. Как у тебя с восстановлением импорта?<br><br>з.ы. доходишь до OEP в аспре без антидебага? Если с ним, то как ты проходишь?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=220241&amp;user=18599&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=3" class="addthx" data-post="220241"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2009 18:13 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#4');return false;">#4</a> </span><div align=left><br>
<b>SVIN95</b> а четам антидебаг , я тоже дохожу. Команды то эмулируются, поэтому эта техника сильнее в разы, проблема в том что качественной реализации нет. А теорию я так и не нашел , хотя она должна быть хоть немного. В дальнейшем могут быть проблемы , шаг в лево в право и все труды насмарку , поэтому есть лучше реализации , где вообще пофиг что дампить когда дампить в плоть до эмуляции рдтс и кпуид и всяких других мелочей. В том то и смысл , надо сделать так , чтобы любой антидебаг шел лесом , а остальное доработать напильником , такое как размеры секций изменные скажем для антидампа или оеп краденный.
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=220246&amp;user=3520&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=4" class="addthx" data-post="220246"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2009 19:23 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#5');return false;">#5</a> </span><div align=left><br>
Можешь почитать статью Hump-and-dump: efficient generic unpacking using an ordered<br>address execution histogram. Там идея на твою похожая. Имеет много ограничений, типа стыренный оеп/несколько процессов и тд. Но идея похожа, возможно, попервой сгодится.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=220261&amp;user=1556&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=5" class="addthx" data-post="220261"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]user_[/b]','')">user_</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 49.3 (посетитель), 43thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.61'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18944">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2009 19:34 <br><script type="text/javascript">QU('user_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=user_" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#6');return false;">#6</a> </span><div align=left><br>
<i class=x><b>Wolfram</b><br>Основная задача - даже при отсутствии соответствующего плагина в любом ring3 протекторе дойти до OEP и получить рабочий дамп.</i><br>А какже это рабочий дамп без импорта, без ресурсов?<br><br>Конкретное пожелание по импорту: я в &quot;вопросах новичков&quot; поднимал тему про импорт <a href="http://www.exelab.ru/f/action=vthread&amp;forum=5&amp;topic=13653" target="_blank">--&gt; Link &lt;--</a> Суть в том, что все известные мне анпакеры при восстановление импорта берут только имя длл и не учитывают путь к ней. Это не сложно поправить руками в ImpRec, да и QuickUnpack вроде позволяет исправить имя длл (дописать перед именем путь). Но удобнее было бы это автоматизировать - получилась бы уникальная фича. Мелочь, но приятно.<br><br>Еще вопрос: когда планируешь выкладывать свой анпакер на всеобщее обозрение? СДК для плагинов начал делать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=220262&amp;user=18944&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=6" class="addthx" data-post="220262"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Wolfram[/b]','')">Wolfram</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2009 11:15 <br><script type="text/javascript">QU('Wolfram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wolfram" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#7');return false;">#7</a> </span><div align=left><br>
Прошу прощения за долгое молчание.<br><br><b>Archer</b><br>Спасибо, почитал. Статья отличная.<br>Стыренный OEP, думаю, можно будет научиться находить на гистограмме. А с многопоточностью возможны варианты. Когда с ней столкнусь - появятся новые вопросы.<br><br><b>user_</b><br>На всеобщее обозрение буду выкладывать, когда прикручу поиск OEP и добьюсь стабильного анпака на некотором количестве пакеров/протекторов. Возможность написания плагинов, конечно, будет, но, возможно, не с первой версии (чтобы труд их создателей не пропал даром после исправления мной очередного бага).<br><br><b>SVIN95</b><br>Из антидебага в той версии Аспра вроде только исключения, но они у меня отлично ловятся, поэтому и дохожу.<br>А с импортом - да, осознал, что эта проблема покруче будет <img src="img/smilies/s4.gif" alt=""> , когда начал ею вплотную заниматься. Пока делаю так: дохожу до OEP, делаю дамп (расширяя SizeOfRawData всех секций до VirtualSize) и прикручиваю к нему импорт с помощью ImpREC. Ограничения: иногда ImpREC находит не весь импорт (например в PEspin), а ещё проблема с протекторами, утягивающими часть кода в выделенные области памяти (тот же Аспр). Изначальная идея - сдампить на OEP все области, оставшиеся к этому моменту - потерпела крах. Путём долгих экспериментов в LordPE я выяснил, что файл запустится только если проекции всех его секций в память лежат одна за другой без всяких промежутков, причём в том же порядке, что и в таблице секций. В принципе, эту проблему можно решить, отсортировав области по базовому адресу и добавив между полученными секциями секции-заглушки с атрибутом Discardable и нулевым значением SizeOfRawData. Мне таким способом удавалось добавлять к экзешнику различное количество областей памяти, лежащих _ниже_ заголовка и не по-порядку. Но проблема в том, что куча, а значит, и все выделенные области лежат _выше_ заголовка.<br><br>Отсюда вопрос:<br>Можно ли как-то усовершенствовать такую технику дампа, чтобы обойти эту проблему, или же нужно что-то в ней радикально менять?  Ещё хочется узнать (сорри, если вопрос глупый), чем ограничены возможности протекторов по утягиванию кусков кода в виртуальную память?<br><br>Теперь вопросы по восстановлению импорта. Хочется попросить знающих людей порекомендовать статьи или ссылки по механизмам и методам импорта, о том, как его можно испортить, сохранив работоспособность файла, и как потом восстановить. В частности, хочу понять, как работает ImpREC, и как некоторые протекторы умудряются прятать от него импорт?<br><br>Теперь пару слов о наших успехах:<br>После исправления критического косяка в определении метода адресации распаковщик научился доходить до OEP ещё в PEspin, FSG, PECompact, WinUpack, MEW. При этом UPX, ASPack, ORiEN, NSPack, PECompact, WinUpack, MEW распаковываются полностью, т.е. после прикручивания импорта получается рабочий дамп!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=220897&amp;user=19474&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=7" class="addthx" data-post="220897"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2009 12:33 &middot; Поправил: progopis <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#8');return false;">#8</a> </span><div align=left><br>
В FSG импорт не сильно защищен. Так что дерзай. Добавь и его в список поддерживаемых пакеров.<br><br>P.S. WinUpack тоже вроде не злой.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=220904&amp;user=2449&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=8" class="addthx" data-post="220904"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2009 13:19 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#9');return false;">#9</a> </span><div align=left><br>
Собирать память не всегда удобно, ниже хедера в образ не впишутся полюбас, выше хедера, если их слишком много, задолбаешься собирать, ибо в хедер произвольное число секций не влезет. Поэтому в идеале надо восстанавливать код, ибо могут быть антидампы и тд, на которых свалишься при условии, что даже если ты и соберёшь всё в кучу. Это и будет основная проблема.<br>А импорт как раз не проблема, его всегда можно восстановить полностью автоматически при грамотном подходе (ну в крайнем случае кой-где ручками чуть подрихтовать). Импрек ищет границы импорта, что есть жопа, поэтому и сам импрек говно и часто лажает. Надо искать обращения к импорту и фиксить их, формат импорта бери из дока по пе формату. Ну и сложности будут с перенаправленным импортом, который указывает не прямо сразу на импортную либу, а на переходник, который ещё фейковые вызовы импорта может делать.<br>Возможности протов по вынесению кода в выделенную память теоритически не ограничены ничем. Практически релоками, которых обычно нет в оригинальном ехе, некоторые хандлеры сех опираются на хардкоденые адреса ещё, но это в работе с анпакером никак не поможет, 1 хрен.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=220911&amp;user=1556&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=9" class="addthx" data-post="220911"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]SVIN95[/b]','')">SVIN95</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 39.0 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.72'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18599">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2009 15:53 <br><script type="text/javascript">QU('SVIN95','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVIN95" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#10');return false;">#10</a> </span><div align=left><br>
Обращения к импорту - это call dword ptr[xxxxxxxx] и jmp dword ptr[xxxxxxxx]. Так?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=220925&amp;user=18599&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=10" class="addthx" data-post="220925"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 февраля 2009 16:05 &middot; Поправил: Archer <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#11');return false;">#11</a> </span><div align=left><br>
Я бы посоветовал автору и задавшему вопрос выше пополнить раздел практики. Сдаётся мне, он слабоват. Т.е. взять и самому руками пощупать разные проты, поглядеть на импорт, как он заполняется, как восстанавливается, в каких случаях его не находит импрек и тд.<br>Обращения к импорту далеко не только такие, в чистом виде бывает вызов ещё через регистры типа mov reg32, dword ptr[xxx] ... call reg32. А проты могут извратить, как хотят, включая call xxx, jmp xxx, push xxx, ret и тд.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=220927&amp;user=1556&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=11" class="addthx" data-post="220927"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Wolfram[/b]','')">Wolfram</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 февраля 2009 15:25 <br><script type="text/javascript">QU('Wolfram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wolfram" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#12');return false;">#12</a> </span><div align=left><br>
<b>progopis</b>, <b>Archer</b><br>Большое спасибо. То, что практики у меня мало - не отрицаю, буду восполнять пробелы.<br><br>Этот пост - не то чтобы очередной progress report, просто не удержался. Я уже говорил, что пока мой анпакер не умеет находить OEP сам, она в тексте прописана. Соответственно, если OEP спёрта, то мы проскочим мимо. Впервые такой проскок случился в Yoda Protector, блокнот запустился, и я в нём даже печатать смог! Конечно, жутко медленно, но зато под полным моим контролем!!!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=221086&amp;user=19474&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=12" class="addthx" data-post="221086"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Wolfram[/b]','')">Wolfram</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19474">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2009 09:18 <br><script type="text/javascript">QU('Wolfram','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Wolfram" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#13');return false;">#13</a> </span><div align=left><br>
Прикрутил к своему распаковщику какой-никакой GUI с модулем, рисующим граф передачи управления. Поигрался с разными пакерами и понял, что прав был <b>Hellspawn</b>, когда писал:<br><br><I>Hellspawn пишет:<br>полезнее было бы накодить эмулятор, засунуть его в длл, вывести основные функции в экспорт и снабдить подробным описанием, вот это было бы полезно  и более реально. </I><br><br>Сейчас у меня всё же не распаковщик, а эмулятор. И если сделать его не в виде проги, а в виде библиотеки, то потом можно будет использовать при написании действительно распаковщика. А там уже можно будет сосредоточиться на поиске OEP, восстановлении импорта, собирании кусков кода из памяти, деобфускации и т.д.<br><br>А пока на горизонте замаячила защита диплома, и пора сосредоточиться на ней. Когда появится свободное время, займусь перегоном того, что уже написано в библиотеку. Поэтому прошу модераторов не закрывать эту тему - она обязательно оживёт.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=222377&amp;user=19474&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=13" class="addthx" data-post="222377"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]dimaxmaster[/b]','')">dimaxmaster</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 53.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.71'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7375">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2009 11:00 <br><script type="text/javascript">QU('dimaxmaster','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dimaxmaster" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#14');return false;">#14</a> </span><div align=left><br>
<I>Wolfram пишет:<br>А пока на горизонте замаячила защита диплома, и пора сосредоточиться на ней. Когда появится свободное время, займусь перегоном того, что уже написано в библиотеку. Поэтому прошу модераторов не закрывать эту тему - она обязательно оживёт.  </I><br><br>сомневаюсь я, что бы когда-нибудь она (тема) ожила. Вот так бесславно окончилась эпопея с написанием еще одного универсального распаковщика, что, собственно говоря, и следовало ожидать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=222384&amp;user=7375&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=14" class="addthx" data-post="222384"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2009 13:28 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#15');return false;">#15</a> </span><div align=left><br>
<I>dimaxmaster пишет:<br>Вот так бесславно окончилась эпопея с написанием еще одного универсального распаковщика, что, собственно говоря, и следовало ожидать </I><br><br>потому-что изначально была поставлена не правильная задача.<br><br><I>Wolfram пишет:<br>Сейчас у меня всё же не распаковщик, а эмулятор. И если сделать его не в виде проги, а в виде библиотеки, то потом можно будет использовать при написании действительно распаковщика. </I><br><br>сразу надо было так делать, тогда щас уже был бы какой-никакой релиз. и можно было потестить.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=222391&amp;user=72&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=15" class="addthx" data-post="222391"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2009 19:30 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=13586&amp;page=2#16');return false;">#16</a> </span><div align=left><br>
Отстаньте от человека, делает и делает. Заканчивайте оффтопить, ибо топик не хочу закрывать, просто дайти топику уйти в темноту на время, пока автор не вернётся.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=222430&amp;user=1556&amp;forum_n=1&amp;topic=13586&amp;page=2&amp;anchor=16" class="addthx" data-post="222430"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=1.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=1&amp;topic=13586&amp;page=1.html">2</a> . <b>3</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопросы по написанию универсального распаковщика</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#17" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="13586">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=13586" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
