<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Армадила кусается. Помогите люди добрые. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Решил значит я изучить японский язык... Скачал замечательную программу: Read and Write Hiragana. Тут www.declan-software.com/japanese/japanese_hiragana.htm (2mb). Решил ее сразу вылечить, PEID говорит armadillo 3.71-4.xx.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=5602'>ut2004</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Армадила кусается. Помогите люди добрые.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]sliderZ[/b]','')">sliderZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.9'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6080">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 сентября 2006 03:01 <br><script type="text/javascript">QU('sliderZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sliderZ" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Решил значит я изучить японский язык... Скачал замечательную программу:<br>Read and Write Hiragana.<br>Тут www.declan-software.com/japanese/japanese_hiragana.htm  (2mb).<br><br>Решил ее сразу вылечить, PEID говорит armadillo 3.71-4.xx.<br>Прочитал пару статей по armadillo. Запустил в olly, поставил bp на секции .text, еще пробовал bp SetProcessWorkingSetSize.<br>Короче оба варианта после прохождения всех exceptions приводят к крашу, olly вылетает.<br><br>Попробовал еще штук 10 скриптов по распаковке армы, ни один не сработал, после одного из скриптов вобще какое-то странное окно вылезло:<br>&quot;Please dont use cracked version of this software! I have a children to feed!&quot;<br><br>Не знаю что делать, может кто чего посоветует?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=94200&amp;user=6080&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=1" class="addthx" data-post="94200"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]sliderZ[/b]','')">sliderZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.9'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6080">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 сентября 2006 04:55 <br><script type="text/javascript">QU('sliderZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sliderZ" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Ладно, с крашами разобрался, просто установил hide debugger plugin. Теперь не вылетает <img src="img/smilies/s16.gif" alt=""><br><br>Дальше все делал по статье &quot;Быстрая распаковка Armadillo 3.xx&quot;<br><br>Поставил bp на .text дальше пошел пока не выпал memory when executing, сделал olly dump без rebuild import.<br>Дамп вроде норм получился, peid говорит c++ 7.0. <br>Вроде осталось только импорт восстановить.<br>Загрузил Imprec-&gt; IAT auto search-&gt; get imports.<br>Появился один thunk valid:no<br>Внутри пара сотен функций из низ много вида rva:xxx ptr:xxx , Я так понимаю это не восстановленые функции? Что делать дальше ? Неужели с каждой функцией копаться вручную как в статье, может есть более приличный способ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=94218&amp;user=6080&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=2" class="addthx" data-post="94218"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 сентября 2006 07:20 <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>sliderZ пишет:<br>Внутри пара сотен функций из низ много вида rva:xxx ptr:xxx , Я так понимаю это не восстановленые функции? Что делать дальше ? Неужели с каждой функцией копаться вручную как в статье, может есть более приличный способ? </I><br>Это вполне нормально. Вот эти <b>rva:xxx ptr:xxx</b> надо опознавать, сначала можно <b>Show Invalid</b> и <b>AutoTrace </b>или <b>Trace Level 1 (Dasm)</b>, а всё что останется - вручную, отрезая мусор (<b>Cut thunks</b>).
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=94233&amp;user=175&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=3" class="addthx" data-post="94233"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2006 00:15 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>sliderZ пишет:<br>странное окно вылезло: <br>&quot;Please dont use cracked version of this software! I have a children to feed!&quot; </I><br>Ну дык заплати ему 10&#036;, пусть накормит ребенка<img src="img/smilies/s5.gif" alt=""><br>или используй утилиту dilloDIE 1.4 cip-re.6x.to/<br>Когда распакуешь, по адресу 0040576B поменяй 075h на 0EBh
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=94315&amp;user=423&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=4" class="addthx" data-post="94315"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]sliderZ[/b]','')">sliderZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.9'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6080">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2006 05:44 <br><script type="text/javascript">QU('sliderZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sliderZ" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Начал ручное восстановление импорта, появились вопросы.<br><br>В статье &quot;Быстрая распаковка Armadillo 3.xx&quot; написано:<br><br><code> 009C9071   8B15 E4289F00    MOV EDX,DWORD PTR DS:[9F28E4]        ; kernel32.77E79F2F <br> 009C9077   83C2 64          ADD EDX,64 <br> 009C907A   B9 05000000      MOV ECX,5 <br> 009C907F   803A CC          CMP BYTE PTR DS:[EDX],0CC <br> 009C9082   74 07            JE SHORT 009C908B <br> 009C9084  ^E2 F9            LOOPD SHORT 009C907F <br> 009C9086   FF75 08          PUSH DWORD PTR SS:[EBP+8] <br> 009C9089   FFD2             CALL EDX <br></code><br><br><code># Адрес, который заносится в EDX вводим в командную строку - D “адрес в EDX”. В окне дампа памяти нужно переключиться в режим Disassemble<br># Смотрим, что за адрес стоит первым в списке. Это и будет наша искомая оригинальная функция импорта.</code><br><br>Нафига переключаться в режим Disassemble? <br><br><br><br>Еще непонятки с несколькими функциями возникли:<br><br><code><br>...<br>00AB8F66   8B15 10A3AE00    MOV EDX,DWORD PTR [AEA310]    (DS:[00AEA310]=F0AA0000)<br>...<br>00AB8F8A   A7               CMPS DWORD PTR [ESI],DWORD PTR ES:[EDI]<br>00AB8F8B   6F               OUTS DX,DWORD PTR ES:[EDI]               ; I/O command<br>00AB8F8C   F1               INT1<br>00AB8F8D   18EE             SBB DH,CH<br>00AB8F8F   3808             CMP BYTE PTR [EAX],CL<br>00AB8F91   FFD2             CALL EDX<br>...<br></code><br><br>Чему тут EDX равен?<br><br><code><br>...<br>00ABB1EE   A1 E09FAE00      MOV EAX,DWORD PTR [AE9FE0]([00AE9FE0]=000004E3)<br>00ABB1F3   C3               RETN<br>...<br></code><br><br>А это что за чудо?<br><br><code><br>...<br>00AB7372   55               PUSH EBP<br>00AB7373   8BEC             MOV EBP,ESP<br>00AB7375   51               PUSH ECX<br>00AB7376   6A 00            PUSH 0<br>00AB7378   FF15 D462AD00    CALL DWORD PTR [AD62D4]                  ; msvcrt.time<br>00AB737E   59               POP ECX<br>00AB737F   8945 FC          MOV DWORD PTR [EBP-4],EAX<br>00AB7382   8D4D FC          LEA ECX,DWORD PTR [EBP-4]<br>00AB7385   E8 769CFEFF      CALL 00AA1000<br>00AB738A   25 FFFF0100      AND EAX,1FFFF<br>00AB738F   0305 2461AD00    ADD EAX,DWORD PTR [AD6124]               ; kernel32.ExitProcess<br>00AB7395   FFD0             CALL EAX<br>00AB7397   C9               LEAVE<br>00AB7398   C3               RETN<br>...<br></code><br><br>А такую как понять?<br><br><code><br>...<br>00AB72F7   55               PUSH EBP<br>00AB72F8   8BEC             MOV EBP,ESP<br>00AB72FA   83EC 14          SUB ESP,14<br>00AB72FD   53               PUSH EBX<br>00AB72FE   56               PUSH ESI<br>00AB72FF   57               PUSH EDI<br>00AB7300   6A 00            PUSH 0<br>00AB7302   FF15 D462AD00    CALL DWORD PTR [AD62D4]                  ; msvcrt.time<br>00AB7308   59               POP ECX<br>00AB7309   8945 FC          MOV DWORD PTR [EBP-4],EAX<br>00AB730C   6A 04            PUSH 4<br>00AB730E   8D75 EC          LEA ESI,DWORD PTR [EBP-14]<br>00AB7311   5F               POP EDI<br>00AB7312   8D4D FC          LEA ECX,DWORD PTR [EBP-4]<br>00AB7315   E8 E69CFEFF      CALL 00AA1000<br>00AB731A   8906             MOV DWORD PTR [ESI],EAX<br>00AB731C   83C6 04          ADD ESI,4<br>00AB731F   4F               DEC EDI<br>00AB7320  ^75 F0            JNZ SHORT 00AB7312<br>00AB7322   8B45 EC          MOV EAX,DWORD PTR [EBP-14]<br>00AB7325   8B5D ED          MOV EBX,DWORD PTR [EBP-13]<br>00AB7328   8B4D EE          MOV ECX,DWORD PTR [EBP-12]<br>00AB732B   8B55 EF          MOV EDX,DWORD PTR [EBP-11]<br>00AB732E   CD 2E            INT 2E<br>00AB7330   5F               POP EDI<br>00AB7331   5E               POP ESI<br>00AB7332   5B               POP EBX<br>00AB7333   C9               LEAVE<br>00AB7334   C3               RETN<br>...<br></code><br><br><br>Эту как msvcrt.dll:time восстанавливать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=94354&amp;user=6080&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=5" class="addthx" data-post="94354"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2006 06:45 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>sliderZ</b><br>Скорее всего, дело в том, что арма эта версии 4.хх, т.к. скажу тебе, как никому, что арму третьей версии сейчас мало где можно откопать. Попробуй просканить арму с помощью опции External Scan в PeID и убедишься в этом.<br>По поводу невосстановленных функций скажу так - метод в статье &quot;Быстрая распаковка Armadillo 3.xx&quot; древний, как вся моя жизнь, сделай лучше так:<br><b><br>Стоя на ОЕР, открой карту памяти и найди секцию, в которой импорт находиться (по мнению отладчика), она будет подписана как import,data или что-то наподобие. Далее найди там в куче всех API адресов валидных функций невалидный адрес и поставь на него аппаратный бряк на запись, перезапускай прогу и прервёшся на команде, которая будет этот адрес записывать, далее прокрути вверх в поисках такого кода:<br>pop ecx<br>pop ecx<br>test eax,eax<br>jnz &quot;адрес&quot;<br>как найдёшь, переправь прыг на безусловный, т.е. на jmp, теперь весь последующий импорт будет нормальным, но надо будет ещё эту исследуемую функцию подправить, поэтому ставь на этот переход бряк (аппаратный) на выполнение и перезапускай прогу. А потом опять смени переход на абсолютный и всё пучком. <br></b><br>Это, конечно, прокактит, если там IAT Elimination, тогда с импортом всё будет более жёстко, тогда я бы посоветовал читать тьюторы Нарваи, а на счёт dilloDIE 1.4 или даже 1.6 версии, то он мне не нравится тем, что потом приходится юзать ArmAccess.dll, а это не хорошо, как мне кажется.<br>Я бы посоветовал тебе скачать Armadillo find protected 1.3 и посмотреть, что у тебя там за опции защиты<img src="img/smilies/s8.gif" alt="">
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=94364&amp;user=6336&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=6" class="addthx" data-post="94364"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]sliderZ[/b]','')">sliderZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.9'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6080">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2006 11:02 <br><script type="text/javascript">QU('sliderZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sliderZ" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Попробовал так сделать, адреса функций правда нашел в .rdata , а не data/imports...<br>Попал в итоге в такое место:<br><code><br>...<br>00ACC4A1   EB 0F            JMP SHORT 00ACC4B2<br>00ACC4A3   8B85 58C2FFFF    MOV EAX,DWORD PTR [EBP-3DA8]<br>00ACC4A9   83C0 0C          ADD EAX,0C<br>00ACC4AC   8985 58C2FFFF    MOV DWORD PTR [EBP-3DA8],EAX<br>00ACC4B2   8B85 58C2FFFF    MOV EAX,DWORD PTR [EBP-3DA8]<br>00ACC4B8   8378 08 00       CMP DWORD PTR [EAX+8],0<br>00ACC4BC   74 49            JE SHORT 00ACC507<br>00ACC4BE   68 00010000      PUSH 100<br>00ACC4C3   8D85 58C1FFFF    LEA EAX,DWORD PTR [EBP-3EA8]<br>00ACC4C9   50               PUSH EAX<br>00ACC4CA   8B85 58C2FFFF    MOV EAX,DWORD PTR [EBP-3DA8]<br>00ACC4D0   FF30             PUSH DWORD PTR [EAX]<br>00ACC4D2   E8 0E61FDFF      CALL 00AA25E5<br>00ACC4D7   83C4 0C          ADD ESP,0C<br>00ACC4DA   8D85 58C1FFFF    LEA EAX,DWORD PTR [EBP-3EA8]<br>00ACC4E0   50               PUSH EAX<br>00ACC4E1   8D85 68C2FFFF    LEA EAX,DWORD PTR [EBP-3D98]<br>00ACC4E7   50               PUSH EAX<br>00ACC4E8   FF15 9863AD00    CALL DWORD PTR [AD6398]                  ; msvcrt._stricmp<br><b>00ACC4EE   59               POP ECX<br>00ACC4EF   59               POP ECX<br>00ACC4F0   85C0             TEST EAX,EAX<br>00ACC4F2   75 11            JNZ SHORT 00ACC505</b><br>00ACC4F4   8B85 58C2FFFF    MOV EAX,DWORD PTR [EBP-3DA8]<br>00ACC4FA   8B40 08          MOV EAX,DWORD PTR [EAX+8]<br>00ACC4FD   8985 68CAFFFF    MOV DWORD PTR [EBP-3598],EAX<br>00ACC503   EB 02            JMP SHORT 00ACC507<br>00ACC505  ^EB 9C            JMP SHORT 00ACC4A3<br>00ACC507   8B85 A8D4FFFF    MOV EAX,DWORD PTR [EBP-2B58]<br>00ACC50D   40               INC EAX<br>00ACC50E   8985 A8D4FFFF    MOV DWORD PTR [EBP-2B58],EAX<br>00ACC514   EB 37            JMP SHORT 00ACC54D<br>00ACC516   8D8D 38D9FFFF    LEA ECX,DWORD PTR [EBP-26C8]<br>...<br></code><br><br>Поменял на JMP,перезапустил, убрал hw bp, запустил, прога померла с сообщением &quot;debugged program was unable to process exception&quot;. Ну залез в IMPrec попробовал GET Import, все равно получилось<br>8 unresolved pointers (до этого 30 получалось). Это те же самые функции которые я сам распознать не смог(выше писал)...  Попробовал cut все 8 потом fix dump и тут еще беда какая-то вылезла &quot;Not enough space: cant add any section to this dump file!&quot;. Что-то мне не везет пока <img src="img/smilies/s14.gif" alt=""><br><br>Armadillo find protected пишет:<br><code>!- Protected Armadillo<br>Version 4.40a (Public Build)<br>Protection system (Basic)<br>!- &lt;Protection Options&gt;<br>Standard protection or Minimum protection<br>!- &lt;Backup Key Options&gt;<br>Fixed Backup Keys<br>!- &lt;Compression Options&gt;<br>Better/Slower Compression<br>!- &lt;Other Options&gt;<br></code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=94411&amp;user=6080&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=7" class="addthx" data-post="94411"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]NEOPEX[/b]','')">NEOPEX</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/2521.gif" alt=""><br><span class=txtSm>Ранг: 89.2 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.87'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2521">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2006 12:15 <br><script type="text/javascript">QU('NEOPEX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NEOPEX" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>sliderZ пишет:<br>Что-то мне не везет пока</I><br><br>Наоборот, ты уже почти до самого конца дошёл <img src="img/smilies/s1.gif" alt=""><br>Импорт ты восстановил вроде верно, те 8 неопознанных значений - мусор между кусками импорта из разных библиотек - их и надо было удалить...<br>А насчёт дампа - снимай его по-новой, и каким-нибудь нормальным дампером...
<br><br><font size="1"><i>-----<br>Люблю повеселиться, особенно пожрать</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=94419&amp;user=2521&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=8" class="addthx" data-post="94419"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]sliderZ[/b]','')">sliderZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.9'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6080">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2006 04:09 <br><script type="text/javascript">QU('sliderZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sliderZ" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Ладненько, все распаковал и зарегил, только один вопрос появился насчет Olly.<br><br>Допустим в проге у меня есть такая команда<br><br><code><br>0040576F   68 08994200      PUSH fixed2.00429908                     ; ASCII &quot;Crack!&quot;<br></code><br><br>Ну тык вот, почему если я делаю search for-&gt;all referenced text strings , то там этого стринга ( и всех  подобных) нету. В дампе тоже нету. Приходится лезть в секцию .rdata на которую ссылается и там искать.<br>Почему olly не ищет текст сразу во всех секциях и в дампе тоже не все секции сразу подгружены че-то я не пойму?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=94514&amp;user=6080&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=9" class="addthx" data-post="94514"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2006 09:48 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>sliderZ</b><br>А ты левые секции армы отрежь, и тогда у тебя такой вопрос возникнет:&quot;Почему оля в дампе не ищет?&quot;, это шутка, конечно<img src="img/smilies/s2.gif" alt="">, а если серьёзно, то эта такая фигня из-за злобной армы, поэтому юзай Иду и ищи с её помощью свои стринги<img src="img/smilies/s8.gif" alt="">
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=94557&amp;user=6336&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=10" class="addthx" data-post="94557"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2006 22:16 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>sliderZ пишет:<br>то там этого стринга ( и всех подобных) нету. </I><br> Скорее всего оля ищет там, где прошел анализ. Запусти его в этот момент - может что-то добавится.<br> Правда при повторной загрузке она заорет, что модуль изменился.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=94586&amp;user=4072&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=11" class="addthx" data-post="94586"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]sliderZ[/b]','')">sliderZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.9'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6080">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 сентября 2006 02:38 <br><script type="text/javascript">QU('sliderZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sliderZ" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6236.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>ARCHANGEL</b><br><br>Тык я не понял, чтобы search for-&gt;all referenced text strings нормально работал надо секции армы отрезать?<br><br><br><b>ALL</b><br><br>Ну тык почему в дампе памяти изначально всегда подгружена только секция data(во всех прогах), и по остальным вручную или ctrl+g путешествовать приходиться.<br><br><code><br>Memory map<br><br>00400000   00001000   fixed                 PE header     Imag   R         RWE<br>00401000   00028000   fixed      .text                    Imag   R         RWE<br>00429000   00005000   fixed      .rdata                   Imag   R         RWE<br>0042E000   00023000   fixed      .data                    Imag   R         RWE<br>00451000   00050000   fixed      .text1     code          Imag   R         RWE<br>004A1000   00010000   fixed      .adata                   Imag   R         RWE<br>004B1000   00020000   fixed      .data1     data          Imag   R         RWE  &lt;- только эта почему? Хочу все!<br>004D1000   00050000   fixed      .pdata                   Imag   R         RWE<br>00521000   0000B000   fixed      .rsrc      resources     Imag   R         RWE<br>0052C000   00002000   fixed      .mackt     imports       Imag   R         RWE<br></code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=94616&amp;user=6080&amp;forum_n=5&amp;topic=6236.html&amp;page=0&amp;anchor=12" class="addthx" data-post="94616"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Армадила кусается. Помогите люди добрые.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#13" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="6236">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=6236" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
