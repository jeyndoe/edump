<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Неизвестный алгоритм обмена. Помогите.. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть два девайса при коннекте между собой делают проверку свой-чужой по хитрому алгоритму. Ведуший девайс посылает 8 байт криптованный ключик ведомому..ведомый должен его декриптить и отправить правильный ответ.. сокращённо лог">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=242'>Alf</a>, <a target='_blank' href='?action=userinfo&amp;user=21426'>Dart Raiden</a>, <a target='_blank' href='?action=userinfo&amp;user=55930'>bedop66938</a>, <a target='_blank' href='?action=userinfo&amp;user=33192'>morgot</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/rt.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=17&sortBy=0&page=0.html"><b>Электроника</b></a> <b class=bulletHead>&#8212;&#8250;</b> Неизвестный алгоритм обмена. Помогите..</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=17&amp;topic=17776&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=17&amp;topic=17776&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2011 12:37 <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Есть два девайса при коннекте между собой делают проверку свой-чужой по хитрому алгоритму. Ведуший девайс посылает 8 байт криптованный ключик ведомому..ведомый должен его декриптить и отправить правильный ответ..<br>сокращённо лог общения выглядит так<br>5A 0B 8004 B7A80076B00587EC 19 <br>A5 12 06 8E759E521D19EEB0 47B29FE2342209F9 A9<br>где : 8004 команда запроса и далее ключ 8 байт на конце КС<br>1206 успешный ответ и далее 8 байт ответа  плюс 8 байт криптованный ключ уже для проверки на свой-чужой ведущего девайса.<br>Ведомый девайс собран на МК NEC....удалось взломать этот контроллер и вытащить с него дамп прошивки весом 4 к.<br>Начал поторшить дамп  в IDA на предмет взлома алгоритма...и застрял в сложности его..алго нечто отдалённо напоминающее SAFER <br>Что на данный момент поятно..Принятый ключик разбивается побайтно и мешается попарно с ключом шифрования 8 байт ..на выходе 16 байт вперемешку. Далее эти 16 байт опускаются в кучу &quot;мусора&quot; представляющуюю тупо набор разных значений байт объёмом около 430 байт и там начинают перемешиваться с использованием различных логических операций посредством приблизительно около 247 проходов по этой куче...на выходе получаем ключ 16 байт из него выбрасываем 8 байт и оставшиеся 8 байт есть ответ. В чём стоит задача? Ведомый девайс старой ревизии и понимает только запросы в диапазоне от 8000 до 8005, а новые работают в диапазоне от 8008 до 800D...вот и нужно старый научить работать по новому диапазону.<br>Тепрь про саму команду запроса 80хх ..второй байт в этой команде указывает каким ключом дешифровать посланный ключ и помимо этого указывает на точку входа в &quot;мусор&quot; <img src="img/smilies/s1.gif" alt=""> Реально этот &quot;мусор&quot; весит около 2 кило! И соответсвенно имеет разные точки входа/выхода для 16 байт ключа...Вопрос реально ли в этой всей каше просчитать новые ключи шифрования и точки входа/выхода для нового диапазона команд.  Если кому интересно помочь мне то могу предоставить все доки и дамп по этой задаче..Так же возможна оплата труда в разумных пределах.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277167&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=1" class="addthx" data-post="277167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2011 15:55 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Т.е. мусор у старой прошивки тот же, что и у новой? Задача только в том, чтобы пропатчить старую прошивку, чтобы она понимала и старые и новые диапазоны команд? Или только новые? Есть ли прошивка от новых версий железки?
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277180&amp;user=3232&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=2" class="addthx" data-post="277180"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2011 19:41 &middot; Поправил: Boryan <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Про мусор не знаю, возможно остался прежний...потому как ведущий девайс принимает и старый и новый ...задача заставить железяку работать по новым командам...старые можно остатвить а можно и выкинуть. Прошивы от нового девайса нет ...есно если бы была я сюда обращаться не стал...да и не суть. Дело в другом, в самом алгоритме... можно ли каким нибудь методом вычислить новые ключи шифрования и точки входа на основе снятых пар запрос\ответ от нового девайса. Количесто пар можно снять любое. Сам дамп прошивки старой есть, если сделать реверс и полностью разложить алгоритм..и в таком виде с ним работать. Есть ли варианты? Меня пугает сама матрица по которой идут ключи...есть возможность обратного хода по ней?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277200&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=3" class="addthx" data-post="277200"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Tyra[/b]','')">Tyra</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 78.7 (постоянный), 43thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.45'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3632">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2011 22:05 <br><script type="text/javascript">QU('Tyra','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tyra" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>Boryan пишет:<br>можно ли каким нибудь методом вычислить новые ключи шифрования и точки входа на основе снятых пар запрос\ответ от нового девайса.  </I><br>Думаю без Дампа с нового устройства, Вряди ! Аналогично, что Хэшит от MD5 Пристраивать в SHA1 !<br>ИМХО.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277205&amp;user=3632&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=4" class="addthx" data-post="277205"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Hugo Chaves[/b]','')">Hugo Chaves</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 128.8 (ветеран), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.64'>Активность: 0.06<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=7963">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 06:21 <br><script type="text/javascript">QU('Hugo Chaves','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hugo Chaves" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
А дамп прошивки нельзя показать ? Иначе это гадание на кофейной гуще получается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277209&amp;user=7963&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=5" class="addthx" data-post="277209"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 12:06 &middot; Поправил: Boryan <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Собсна дамп..контроллер NEC upd78f9202, ядро 78K0S.. ключи в нём пока затёр..на месте 0 ключа 00..на месте 1-11,2-22 и т.д. это не суть. Прошиву писал китаец кривыми руками..версия походу отладочная, но рабочая <img src="img/smilies/s1.gif" alt=""> Видно пытался реализовать мою идею, но не получилось..так и оставил в ней мусор. <br><b>Tyra</b> а нафига тогда пляски с бубном если бы была возможность снять дамп с нового девайса? ...с нового можно только логов наснимать ...<br><br><img src="img/attach.gif" alt=""> <a href="./files/db52_17.02.2011_CRACKLAB.rU.tgz">db52_17.02.2011_CRACKLAB.rU.tgz</a> - damp_no_key.bin
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277221&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=6" class="addthx" data-post="277221"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 16:13 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
доки RUS на 78K0S <noindex><a href="http://zalil.ru/30458252" rel="nofollow" target="_blank">http://zalil.ru/30458252</a></noindex><br>на англ тут <noindex><a href="http://zalil.ru/30523912" rel="nofollow" target="_blank">http://zalil.ru/30523912</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277228&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=7" class="addthx" data-post="277228"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Tyra[/b]','')">Tyra</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 78.7 (постоянный), 43thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.45'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3632">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 16:56 <br><script type="text/javascript">QU('Tyra','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tyra" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Boryan пишет:<br>а нафига тогда пляски с бубном если бы была возможность снять дамп с нового девайса? ...с нового можно только логов наснимать ... </I><br>Может я и Не Прав, но Встречал и Такое(не на Микроконтроллерах)<br>Была програмка в которой использовался MD5 для проверки Реги - ЗаКГнили<br>Обновилась прога (допустим внутрь залезть не удалось) Имеем Имя и Регу в неограниченом количестве.<br>Вопрос, как узнать как изменился Алгоритм ?<br>В Том случае Автор подменил константы при просчете MD5 и Всё !<br>Вывод: Не имея доступа, невозможно узнать эти Константы, а тем более вычислить.<br>Предположу, что в Вашем случае ТАК !<br>Старый Вариант:<br>Запрос -&gt; Алго (мусор) -&gt; Ответ (Мусор известен)<br>Новый Вариант:<br>Запрос -&gt; Алго (мусор) -&gt; Ответ (Мусор не известен)<br>1. Если Алго Однонаправленный, то только БРУТ , если Алго не поменялся. Съэмулировать кучу запросов на определенный кусок мусора и пытаться вычислить.<br>2. Мог добавиться Новый Алго, Для Обработки новых команд. Без дампа, Врядли выясниш !
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277233&amp;user=3632&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=8" class="addthx" data-post="277233"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 17:20 &middot; Поправил: Boryan <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Tyra</b> Тогда так ..возможно константы поменяли...но! Девайс оставил поддержку старых команд+добавил новые константы+ добавил ещё новее константы для самого последнего варианта ведомого девайса..И если учитывать, что только для старых команд мусор весит 2 кило...то для новых этот мусор должен вырасти в разы. Ведь ведущий девайс каким то образом шифрует передаваемые ключи...соответственно тоже должен иметь место под мусор и в своей памяти? А учитывая что в девайсе за свой чужой отвечает мелкая микруха BGA размером всего 6х6 мм (не суть)...и она ограниченна в своих возможностях..она попросту не может жрать много ресурсов...и сбестоимость её копеечная потому как и сам девайс стоит 5т руб.. Ну ладно не суть...оставим это. Тут вот есть новости про алго...возможно они и решат всё. Короче как я писал ранее принятый ключ 8 байт мешается с 8 байт ключом, из полученных 16 байт и &quot;мусора&quot; высчитываются адреса в &quot;мусоре&quot; откуда тупо набираются байты для ответа....иными словами, принятый ключ и ключ дешифрования хитрым алгоритмом вычисляют только адреса&quot;мусора&quot; откуда набирать ответ...  Походу проход только в одну сторону <img src="img/smilies/s9.gif" alt="">.. Интересно кто нибудь знаком с таким алгоритмом и с чем либо подобным? Скажу одно это всё замутила фирма SONY <img src="img/smilies/s1.gif" alt=""><br>И ещё, на одинаковый  запрос 8  байт от ведущего девайса, все три ревизии ведомых девайсов дают разные ответы и они устраивают полностью ведущий девайс...Иными словами на один  запрос может быть три разных ответа..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277235&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=9" class="addthx" data-post="277235"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Tyra[/b]','')">Tyra</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 78.7 (постоянный), 43thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.45'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3632">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 17:44 <br><script type="text/javascript">QU('Tyra','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tyra" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Boryan пишет:<br>Иными словами на один запрос может быть три разных ответа..  </I><br>Это может быть из=за того, что дивайсы разные и передают свой ID.<br><br>Всё упирается в алгоритм шифровки(дешифоровки)<br>Нарисуйте БлокСхему и наглядно увидите, что Конкретно нужно.<br>Иделальный Вариант это написать свою програмку, которая будет правильно обрабатывать Пакеты.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277236&amp;user=3632&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=10" class="addthx" data-post="277236"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 18:28 &middot; Поправил: Boryan <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>Tyra</b> ID девайсы не передают...100% Я привёл тут только часть лога...все логи общения достаточно изученны и там нет тёмных пятен.<br>А вот по ходу изучения дампа прошивки , а этот дамп снят с галимого китайского клона...создаётся впечатление от того наличия мусора и от кривости прошивки...что китайцы тупо создали свой &quot;новый&quot; и очень кривой метод ответов на запросы...иначе не было бы такого мусора в прошивке....если бы им был слив с оригинала .....не думаю что Sony способна на такой мусор в написании прог для контроллеров..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277237&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=11" class="addthx" data-post="277237"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 18:36 <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
вот полный лог инициализации девайсов <br>5A 02 01 A2-запрос напряжения девайса<br>A5 05 06 107905 C1-ответ о велечине напруги<br>5A 02 0C 97-запрос серийника<br>A5 06 06 34127856 3A-ответ и передача серийника<br>5A 0B 80 08B7EE78DD9E35089B A2- далее проверка свой-чужой<br>A5 12 06 CB5E5D56D1FD32C4BD13CCB16F24F8C8 02-тут ответ не верный (старый девайс не знает ответы на 8008)  <br>5A 02 01 A2-и снова повторяем всё заново<br>A5 05 06 107905 C1<br>5A 02 0C 97<br>A5 06 06 34127856 3A<br>5A 0B 80 024A1EFEA52887D730 57 -снижаем диапазон запроса на 8002 для старого девайса<br>A5 12 06 6564E3675EA9C4FAF400F9EB4C367B3C 59 - всё нормально..ответ принят<br>5A 0A 81 A53F0E3A85541BD2 28<br>A5 0A 06 C0BE63BBB31BAF56 DB<br>5A 02 01 A2<br>A5 05 06 007905 D1<br>5A 0B 80 027C802BB92461FF17 9D<br>A5 12 06 7C8B7FA6D99E3EC02C81D6CACC9F9F27 23<br>5A 0A 81 0BB506924FF89378 70<br>A5 0A 06 4EBADCE7C92573E2 3C<br>в итоге инициализация прошла
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277238&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=12" class="addthx" data-post="277238"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 18:51 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Нету там никакого мусора. С чего вы взяли что он там есть? Все разбито на таблицы красиво.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277240&amp;user=11966&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=13" class="addthx" data-post="277240"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 19:02 <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>r_e</b> ну вот и появились точки над и <img src="img/smilies/s1.gif" alt=""> Мусор это для моего уровня знаний <img src="img/smilies/s1.gif" alt=""> см личку.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277241&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=14" class="addthx" data-post="277241"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 19:13 <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>r_e пишет:<br>Нету там никакого мусора.  </I><br><br>Может там мусора и нет, но код очень кривой даже для меня - очень слабо разбирающегося в асме...<br>Вот пример кривости:<br><br>ROM_:0F24 loc_F24: ; CODE XREF: sub_EE3+3Dj<br>ROM_:0F24 mov E,A ; Move Byte Data Transfer<br>ROM_:0F26 mov A,[HL] ; Move Byte Data Transfer<br>ROM_:0F27 xor A,X ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F29 xor A,B ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F2B xor A,C ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F2D mov [HL],A ; Move Byte Data Transfer<br>ROM_:0F2E mov A,[HL+04h] ; Move Byte Data Transfer<br>ROM_:0F30 xor A,X ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F32 xor A,C ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F34 xor A,D ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F36 mov [HL+00h],A ; Move Byte Data Transfer<br>ROM_:0F38 mov A,[HL+08h] ; Move Byte Data Transfer<br>ROM_:0F3A xor A,X ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F3C xor A,D ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F3E xor A,E ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F40 mov [HL+00h],A ; Move Byte Data Transfer<br>ROM_:0F42 mov A,[HL+0Ch] ; Move Byte Data Transfer<br>ROM_:0F44 xor A,X ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F46 xor A,E ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F48 xor A,B ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F4A mov [HL+00h],A ; Move Byte Data Transfer<br>ROM_:0F4C pop DE ; Pop<br>ROM_:0F4D ret ; Return from Subroutine <br><br>куча манипуляций в итоге сводится к четырехкратному перезатиранию ячейки RAM [HL] и  в итоге из строчек кода играют роль лишь эти:<br><br>ROM_:0F42 mov A,[HL+0Ch] ; Move Byte Data Transfer<br>ROM_:0F44 xor A,X ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F46 xor A,E ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F48 xor A,B ; Exclusive Or Exclusive Logical Sum of Byte Data<br>ROM_:0F4A mov [HL+00h],A ; Move Byte Data Transfer <br><br>Для чего такая реализация кода ? чтобы реализовать софтово какие то тайминги ? Примеров последовательной перезаписи одного регистра или ячейки памяти в этом коде хватает...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277242&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=15" class="addthx" data-post="277242"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 19:56 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>Androand</b><br>Да, по поводу этого у меня есть некоторые сомнения. Тут или ида косячит или реально баги в коде.<br>Потому как, например, такой кусок в базе:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">0767</span>&nbsp;Mov_AX_dwHL<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: CryptDisp0+21Ap</span></li><li class="hl_l1">ROM<span class="hl_char">:</span><span class="hl_number">0767</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CryptDisp0+234p</span></li><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">0767</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; DATA XREF: ...</span></li><li class="hl_l1">ROM<span class="hl_char">:</span><span class="hl_number">0767</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A<span class="hl_char">,</span><span class="hl_char">[</span>HL<span class="hl_char">]</span></li><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">0768</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A</span><span class="hl_char">,</span>X</li><li class="hl_l1">ROM<span class="hl_char">:</span><span class="hl_number">0769</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A<span class="hl_char">,</span><span class="hl_char">[</span>HL<span class="hl_char">+</span><span class="hl_number">01h</span><span class="hl_char">]</span></li><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">076B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">ret</span></li><li class="hl_l1">ROM<span class="hl_char">:</span><span class="hl_number">076B</span>&nbsp;<span class="hl_comment">; End of function Mov_AX_dwHL</span></li><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">076C</span>&nbsp;<span class="hl_comment">; =============== S U B R O U T I N E =======================================</span></li><li class="hl_l1">ROM<span class="hl_char">:</span><span class="hl_number">076C</span>&nbsp;Mov_dbHL_X<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: CryptDisp0+211p</span></li><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">076C</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; DATA XREF: ROM:0076o</span></li><li class="hl_l1">ROM<span class="hl_char">:</span><span class="hl_number">076C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>HL<span class="hl_char">+</span><span class="hl_number">00h</span><span class="hl_char">]</span><span class="hl_char">,</span>A</li><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">076E</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A</span><span class="hl_char">,</span>X</li><li class="hl_l1">ROM<span class="hl_char">:</span><span class="hl_number">076F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>HL<span class="hl_char">]</span><span class="hl_char">,</span>A</li><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">0770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">ret</span></li><li class="hl_l1">ROM<span class="hl_char">:</span><span class="hl_number">0770</span>&nbsp;<span class="hl_comment">; End of function Mov_dbHL_X</span></li>        </ol>
    </div>
</div></div>
<br>идет в блоке стандартных функций<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">075B</span>&nbsp;<span class="hl_comment">; [00000006 BYTES: COLLAPSED FUNCTION Mov_AX_dwDE. PRESS KEYPAD &quot;+&quot; TO EXPAND]</span></li><li class="hl_l1">ROM<span class="hl_char">:</span><span class="hl_number">0761</span>&nbsp;<span class="hl_comment">; [00000006 BYTES: COLLAPSED FUNCTION Mov_dwDE_AX. PRESS KEYPAD &quot;+&quot; TO EXPAND]</span></li><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">0767</span>&nbsp;<span class="hl_comment">; [00000005 BYTES: COLLAPSED FUNCTION Mov_AX_dwHL. PRESS KEYPAD &quot;+&quot; TO EXPAND]</span></li><li class="hl_l1">ROM<span class="hl_char">:</span><span class="hl_number">076C</span>&nbsp;<span class="hl_comment">; [00000005 BYTES: COLLAPSED FUNCTION Mov_dbHL_X. PRESS KEYPAD &quot;+&quot; TO EXPAND]</span></li><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">0771</span>&nbsp;<span class="hl_comment">; [0000000B BYTES: COLLAPSED FUNCTION Inc_dwHL. PRESS KEYPAD &quot;+&quot; TO EXPAND]</span></li><li class="hl_l1">ROM<span class="hl_char">:</span><span class="hl_number">077C</span>&nbsp;<span class="hl_comment">; [0000000B BYTES: COLLAPSED FUNCTION Dec_dwHL. PRESS KEYPAD &quot;+&quot; TO EXPAND]</span></li>        </ol>
    </div>
</div></div>
<br><br>Как вывод, код разобрать можно. Не такая там страшная крипта как ее малюют.<br>А уже после восстановления кода можно смотреть можно ли восстановить ключи.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277247&amp;user=11966&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=16" class="addthx" data-post="277247"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 20:04 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Дополнение:</b><br>Это ИДА косячит. Страница 34/97 мануала на русском говорит.<br>MOV [HL+byte], A ::: [ED] [byte]<br>Смотрим базу<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ROM<span class="hl_char">:</span><span class="hl_number">076C</span>&nbsp;ED&nbsp;<span class="hl_number">01</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>HL<span class="hl_char">+</span><span class="hl_number">00h</span><span class="hl_char">]</span><span class="hl_char">,</span>A</li>        </ol>
    </div>
</div></div>
<br>Налицо косяк.<br><br>Аналогично и с твоим кодом.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277248&amp;user=11966&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=17" class="addthx" data-post="277248"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Tyra[/b]','')">Tyra</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 78.7 (постоянный), 43thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.45'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3632">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 22:37 <br><script type="text/javascript">QU('Tyra','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tyra" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>r_e пишет:<br>Налицо косяк. </I><br>Аналогичные косяки встречал при написании программ, например для PIC, на трансляьлрах высокого уровня, которые севершают кучу ненужных(мусорных) команд. Нужно полностью разбирать Алго и Отлаживать !
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277257&amp;user=3632&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=18" class="addthx" data-post="277257"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Mercyful[/b]','')">Mercyful</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.6 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=896">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 00:25 <br><script type="text/javascript">QU('Mercyful','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mercyful" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>PE_Kill</b><br>ку ;) почему-то так и думал, что твой комментарий будет одним из первых )) помню твою любовь к &quot;железному&quot; софту )<br><b>Boryan</b> проделал грандиозную работу и аналогов ей нет и не предвидется. Перспективы очень вкуснявые для обладателей девайса. Не обойди вниманием вопрос, если найдётся свободное время. Заходи на канал.. там смогу рассказать подробнее.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277260&amp;user=896&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=19" class="addthx" data-post="277260"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 00:55 &middot; Поправил: Boryan <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>Mercyful</b> пасиб за добрые слова <img src="img/smilies/s1.gif" alt=""> Ну сейчас перспективы уже не такие вкуснявые как до выхода хенов..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277262&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=20" class="addthx" data-post="277262"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Yokel[/b]','')">Yokel</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 92.4 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.35'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10326">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 04:32 <br><script type="text/javascript">QU('Yokel','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Yokel" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
О <b>Boryan</b>, ты про батарею от PSP?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277264&amp;user=10326&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=21" class="addthx" data-post="277264"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 09:21 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>Mercyful</b> привет, бро. Да, до сих пор почти каждый день с железками пересекаюсь, судьба что ли такая <img src="img/smilies/s1.gif" alt=""><br><b>Boryan</b> такое ощущение, что китайская поделка оптимизированный табличный эмулятор.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277273&amp;user=3232&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=22" class="addthx" data-post="277273"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Yokel[/b]','')">Yokel</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 92.4 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.35'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10326">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 09:41 <br><script type="text/javascript">QU('Yokel','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Yokel" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
блочное шифрование похожее на keeloq!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277274&amp;user=10326&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=23" class="addthx" data-post="277274"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 11:45 <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>Yokel</b> зачем ругаешся?;) ты оттуда? Здесь то чего делаешь?<br> <I>PE_Kill пишет:<br>Boryan такое ощущение, что китайская поделка оптимизированный табличный эмулятор. </I><br>Это ломаемо?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277286&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=24" class="addthx" data-post="277286"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Androand[/b]','')">Androand</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=26496">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 13:09 &middot; Поправил: Androand <br><script type="text/javascript">QU('Androand','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Androand" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>r_e пишет:<br>Дополнение:<br>Это ИДА косячит. Страница 34/97 мануала на русском говорит.<br>MOV [HL+byte], A ::: [ED] [byte]<br>Смотрим базу<br>Code:<br><br>   1. ROM:076C ED 01                                   mov     [HL+00h],A<br><br><br>Налицо косяк.<br><br>Аналогично и с твоим кодом.  </I><br><br><br>Ого ... Спасибо большое за подсказку, а то две недели бьемся - не можем повторить и проверить запрос-ответ - вроде перетащили в асм процедуры по обработке 80XX запросов, таблицы байт тоже а результата нет и нет - генерится другой код и все...<br><br>А есть какой нить способ поправить автоматически эти косяки в IDA - прогонкой скрипта какого нить или каждый оператор сверять с мануалом ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277292&amp;user=26496&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=25" class="addthx" data-post="277292"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Yokel[/b]','')">Yokel</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 92.4 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.35'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10326">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 13:36 <br><script type="text/javascript">QU('Yokel','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Yokel" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>Boryan</b> всмысле откуда, на дату регистрации посмотри!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277294&amp;user=10326&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=26" class="addthx" data-post="277294"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2011 00:52 <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
И что? Больше ни кто ни чего не может подсказать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277654&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=27" class="addthx" data-post="277654"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2011 10:01 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Собсно, с учетом изложенного выше - в читабельный код свою БД перевели? Тесты скомпилировали? Работает как аппарат?
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277674&amp;user=11966&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=28" class="addthx" data-post="277674"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Boryan[/b]','')">Boryan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.4'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28000">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2011 11:45 <br><script type="text/javascript">QU('Boryan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boryan" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
пока ещё в процессе..чот не очень у нас это получается..опыта маловато <img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277688&amp;user=28000&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=29" class="addthx" data-post="277688"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2011 11:58 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=17&amp;topic=17776&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
О сколько нам открытий чудных<br>Готовят просвещенья дух<br>И опыт, сын ошибок трудных,<br>И гений, парадоксов друг...<br><br>Как закончите - пишите в топик. Посмотрим что там за крипта.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277689&amp;user=11966&amp;forum_n=17&amp;topic=17776&amp;page=0&amp;anchor=30" class="addthx" data-post="277689"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=17&amp;topic=17776&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=17&amp;topic=17776&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/rt.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=17&sortBy=0&page=0.html"><b>Электроника</b></a> <b class=bulletHead>&#8212;&#8250;</b> Неизвестный алгоритм обмена. Помогите..</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="17">
<input type="hidden" name="topic" value="17776">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=17776" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
