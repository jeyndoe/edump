<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Asprotect 1.2: нужна помощь со stolen байтами - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Программа (1120 kb): www.criline.com/produkt/csrepl.exe Запакована: Asprotect 1.23RC4-1.3.08.24[1] Перечитал много туторов, вроде все понял. Пробую распаковать, все вроде получается, кроме stolen bytes. Не могу понять, как их">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Asprotect 1.2: нужна помощь со stolen байтами</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2007 16:05 <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Программа (1120 kb):<br>www.criline.com/produkt/csrepl.exe<br>Запакована: Asprotect 1.23RC4-1.3.08.24[1]<br><br>Перечитал много туторов, вроде все понял.<br>Пробую распаковать, все вроде получается, кроме stolen bytes<img src="img/smilies/s9.gif" alt="">. Не могу понять, как их найти, либо я не там ищу, либо они очень сильно перемешаны с мусором...<br>Итак:<br><br>TempOEP: RVA=53f7b1<br>OEP:          RVA=53f7a3<br><br>Байты украдены с 53f7a3 по 53a7b1.<br><br>IAT:RVA=5461b8<br>      Size=8b0<br><br>Программа написана на Dephi.<br><br><br>У меня мусорный код плучился таким(но этот код наполовину эмпирический, получил, сравнивая код программы запакованной, и моей, распакованной, а также мусорный код, где должны быть stolen bytes.Cкорее всего этот код не верный...):<br>0053F7A3 &gt; &#036; 55             PUSH EBP<br>0053F7A4   . 8BEC           MOV EBP,ESP<br>0053F7A6     53               PUSH EBX<br>0053F7A7     B8 3CF25300    MOV EAX,CSReplac.0053F23C<br>0053F7AC     90             NOP<br>0053F7AD     83EC 18        SUB ESP,18<br><br>С такими stolen bytes программа как-то пытается запустся, но виснет. По размеру, в stolen bytes еще должно быть что-то,но я не могу найти, что именно<img src="img/smilies/s9.gif" alt=""><br><br>Если есть возможность, подскажите, как порешать проблему со stolen bytes.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=153219&amp;user=7008&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=1" class="addthx" data-post="153219"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2007 17:26 <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>tempread</b>, один из ключей к успеху - это восстановление в распакованой программе значений регистров (и стека соотв.), соответственно запакованой программе на данной инструкции. Т.е. тебе надо пройти спертые байты и подумать, что нужно добавить чтобы в дампе к этой инструкции всё выглядело так же.
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=153236&amp;user=175&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=2" class="addthx" data-post="153236"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2007 19:18 <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Совпадения значений регистров я добился. А вот со стеком проблемы, он очень разный в запакованой программе, и распакованной. Стек должен один в один совпадать в запакованой и распакованной програме?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=153247&amp;user=7008&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=3" class="addthx" data-post="153247"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2007 20:47 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>tempread</b><br>Я особо не проверял,но попробуй вот этот код:<br><br><code><br>push ebp<br>mov ebp, esp<br>add esp, -10h<br>push ebx<br>push esi<br>push edi<br>mov eax, 0040713Ch ; &lt;-- тут надо проверить</code><br><br><I>AlexZ пишет:<br>это восстановление в распакованой программе значений регистров (и стека соотв.), соответственно запакованой программе на данной инструкции </I><br>...не надо пудрить человеку мозги.Гораздо проще просто просмотреть стартовый код в незащищённых файлах Delphi 6-7, чтобы сложилось некоторое представление,что там должно быть,а что -- нет.<br><br>Спёртые байты в данном случае попадались все в начале мусорного кода.Первые три команды стоят вместе,и их можно отчётливо разглядеть в определённый момент.Только команда ADD заменена на SUB.<br>Последнюю команду MOV надо проверить -- я мог ошибиться с адресом,который кладётся в EAX.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=153259&amp;user=1613&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=4" class="addthx" data-post="153259"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2007 20:49 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
не качав прогу могу сказать тчо байты какие-то странные???<br><br><I>tempread пишет:<br>0053F7A7 B8 3CF25300 MOV EAX,CSReplac.0053F23C <br>0053F7AC 90 NOP </I><br><br>ноп? откуда он тут? посмотри внимательнее...
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=153261&amp;user=72&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=5" class="addthx" data-post="153261"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2007 21:05 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>Hellspawn пишет:<br>байты какие-то странные??? </I><br>...я ж привёл нормальные байты.<br><br><b>tempread</b><br>Возможно,что твой адрес 0053F23C -- правильный.В любом случае проверяй.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=153263&amp;user=1613&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=6" class="addthx" data-post="153263"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2007 21:25 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Hellspawn</b><br>Я нолики нопами забил ,чтобы удобнее было. А команды ручками вбивал. Я понимаю, что там все украденные байты должны быть восстановлены, ноя не мог понять, где мусор, а где краденные байты.<br><br><b>DillerInc</b><br>Проверил, тот eax=0040713Ch не подходит, а вот если ставлю eax=0053F23C - программа ведет себя, как и раньше - немножко запускается и вылетает. Причем,мне кажется программа не совсем проста - после того, как asprotect ее распаковывает, запускается окошко, где есь три кнопки - зарегистрировать,купить, продолжить. Если нажимаешь &quot;продолжить&quot; - возникает два ексепшена, и после второго запускается программа.<br><br>В моей распакованной версии,подправив один cmp,я могу тоже окошко получить с кнопочкми купить,продолжить, зарегить. Но когда нажимаю &quot;продолжить&quot; после второго ексепшена возникает третий... А дальше прога вылетает. И я не знаю, виноваты хитрые програмисты. или мои кривые ручки <img src="img/smilies/s9.gif" alt=""><br><br>P.S. Где лежат краденные байты, приведенные DillerInc&#039;ком нашел,хотя для меня загадка, почему именно эти байты нужны, а похожие команды выше по коду,или ниже - нет <img src="img/smilies/s1.gif" alt=""><br><br>P.P.S. После вставки украденных байт, остался один свободный байтик....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=153271&amp;user=7008&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=7" class="addthx" data-post="153271"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2007 21:52 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>DillerInc пишет:<br>...я ж привёл нормальные байты. </I><br><br>не тебе...<br><br><I>tempread пишет:<br>P.P.S. После вставки украденных байт, остался один свободный байтик.... </I><br><br>насколько я помню, свободных байт быть не должно <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=153278&amp;user=72&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=8" class="addthx" data-post="153278"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Sturgeon[/b]','')">Sturgeon</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2007 23:49 <br><script type="text/javascript">QU('Sturgeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sturgeon" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Вот, почитай. Может поможет.<br><a href="http://www.exelab.ru/f/action=vthread&amp;topic=9048&amp;forum=5&amp;page=-1" target="_new">http://www.exelab.ru/f/action=vthread&amp;topic=9048&amp;forum=5&amp;p age=-1</a><br>Мне помогло <img src="img/smilies/s1.gif" alt=""><br>Твою прогу пока не смотрел. Просто информация по снятию Asprotect 1.23RC4.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=153297&amp;user=3305&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=9" class="addthx" data-post="153297"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2007 10:49 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>tempread</b> stripper_v211rc2 отлично распаковывает эту прогу ;)
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=153336&amp;user=2775&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=10" class="addthx" data-post="153336"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2007 13:11 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Итаг задача, сломать сей замечательный продухт:<br><br>1. Распаковка: дабы очередной раз позлить паффку распаковываем прогу с помощью stripper_v211rc2<br><br>2. Вписываем свое имя на веки: Смотрим лог стрипера и видим<br>Difference at RVA: 00141564 (.data), unpacked - 00 00 00 <br>Difference at RVA: 00141564 (.data), presented - 61 38 b6 <br><br>То есть по этому адресу надо вбить имя. Прога смотрит, если по этому адресу (b66138) = 0 то прога не зарегана, иначе с регой все ок. Вбиваем туда ссыль на tempread и все, теперь прога перешла в рег. режим.<br><br>3. Убираем проверки на распакованность. Ну тут все просто, после наг.скрина идет 4 call:<br>0053F04A     E8 D927F5FF    CALL _CSRepla.00491828<br>0053F04F   . E8 5428F5FF    CALL _CSRepla.004918A8<br>0053F054   . E8 7728F5FF    CALL _CSRepla.004918D0<br>0053F059   . E8 BA28F5FF    CALL _CSRepla.00491918<br><br>Просто ставим RET по указанным адресам, и наслаждаемся отломанной прогой...
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=153357&amp;user=2775&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=11" class="addthx" data-post="153357"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2007 13:15 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Итого имеем: Время слома 10 мин.<br>Результат: rapidshare.com/files/50113822/_CSReplacer1.rar.html
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=153360&amp;user=2775&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=12" class="addthx" data-post="153360"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2007 15:16 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Попробовал в своем дампе отключить проверку на распакованность, как указал Maximus - программа запускается в Оле, но при закрытии вылетает ошибка.  Хочу все таки добить ручную распаковку...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=153378&amp;user=7008&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=13" class="addthx" data-post="153378"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2007 17:37 <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Не могу разобраться, вроде как украденный код верный, создается тред,программа работает. Потом закрываю программу, тред завершается с кодом 0. А потом программа виснет <img src="img/smilies/s9.gif" alt=""> - читается в eax адрес, потом длается переход по указателю в eax - а там пустота. А в запакованной программе вообще такой адрес в том месте программы не пробегает.<br><br><b>Maximus</b> А как нашел проверки на распакованость? По какой-то методике,или методом научного тыка?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=153401&amp;user=7008&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=14" class="addthx" data-post="153401"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2007 18:17 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Нет, метод научного тыка не рулит.<br>Нашел где прога вылетает. И посомтрел код. Я уже много порубил аспровых прог, по этому проверки на запакованность узнаю в лицо))... Тем более они всегда рядом в коде находятся.
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=153403&amp;user=2775&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=15" class="addthx" data-post="153403"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2007 19:23 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
А где можно прочитать про типовые проверки на запакованность? Ведь програмисты же где-то этого набираются...<br><br> В общем,как я понял, все проблемы у меня из-за шалостей програмистов.<br><br> Если не сложно, укажите пожалуйста, что за методы детекта распаковки применяются в этих 4 -х calls.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=153414&amp;user=7008&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=16" class="addthx" data-post="153414"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2007 20:00 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>tempread</b> берешь прот, и ставишь все проверки на дельфи прогу (или берешь готовый вариант в примерах).<br>Потом в отладчике смотришь что куда.<br><br>По проверкам:<br>Одна пытается прописать в секцию импорта, если не пишется прога распакована.<br>Вторая смотрит что бы ОЕП был кратен 1000, не кратен, прога распакована.<br>Ну и первые две проверяют окружение, если нет определенных значений в ячейках, прога распакована.<br><br>Стрипер находит проверки по сигнатурам, я не смотрел но может быть сигнатуры есть в чудо-китайском скрипте.<br>Ну и точно сигнатурки есть в инструменте что юзается тут:<br><a href="http://www.exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6315" target="_new">http://www.exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6315</a>
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=153428&amp;user=2775&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=17" class="addthx" data-post="153428"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2007 20:02 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Да, еще, это не проделки программистов, проверки на распакованность это проделки самого аспра.
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=153430&amp;user=2775&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=18" class="addthx" data-post="153430"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2007 23:31 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9702.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Порешал свою проблему с вылетом программы(после ее закрытия). Проблема была вот тут:<br><code><br>00404806   MOV EDI,Dumped_.00544634<br>0040480B   MOV EAX,DWORD PTR DS:[EDI+8]<br>0040480E   TEST EAX,EAX<br>00404810   JE SHORT Dumped_.0040485A<br>00404812   MOV EBX,DWORD PTR DS:[EDI+C]<br>00404815   MOV ESI,DWORD PTR DS:[EAX+4]<br>00404818   XOR EDX,EDX<br>0040481A   PUSH EBP<br>0040481B   PUSH Dumped_.00404846<br>00404820   PUSH DWORD PTR FS:[EDX]<br>00404823   MOV DWORD PTR FS:[EDX],ESP<br>00404826   TEST EBX,EBX<br>00404828   JLE SHORT Dumped_.0040483C<br>0040482A   DEC EBX<br>0040482B   MOV DWORD PTR DS:[EDI+C],EBX<br>0040482E   MOV EAX,DWORD PTR DS:[ESI+EBX*8+4]<br>00404832   TEST EAX,EAX<br>00404834   JE SHORT Dumped_.00404838<br>00404836   CALL EAX   ======================&gt;Проблема!<br>00404838   TEST EBX,EBX<br></code><br><br>В eax у меня какой-то заоблачный адрес, я этот call занопил - и порядок,мой дамп нормально запускается, и нормально завершается!<br>Всем кто помогал огромное спасибо!<br><br>Чуток позже,если не появятся новые вопросы(стучу по дереву три раза), тему закрою.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=153463&amp;user=7008&amp;forum_n=5&amp;topic=9702.html&amp;page=0&amp;anchor=19" class="addthx" data-post="153463"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Asprotect 1.2: нужна помощь со stolen байтами</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=9702" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
