<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>FADE DRM, обнаружение и механизм работы - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет всем! Очень удивлен был тем, что про FADE нет ни статей об анализе, ни рабочих детекторов, учитывая то, что, судя по зарубежным изданиям, в данное время эта защита - всё еще конкретная заноза в заднице. Вначале хочу">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55550'>testrev1337</a>, <a target='_blank' href='?action=userinfo&amp;user=19256'>johnniewalker</a>, <a target='_blank' href='?action=userinfo&amp;user=55914'>Kybyx</a>, <a target='_blank' href='?action=userinfo&amp;user=55930'>bedop66938</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> FADE DRM, обнаружение и механизм работы</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ogurets_agressive[/b]','')">ogurets_agressive</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.74'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=22731">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2009 01:25 &middot; Поправил: ogurets_agressive <br><script type="text/javascript">QU('ogurets_agressive','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ogurets_agressive" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15143.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет всем! Очень удивлен был тем, что про FADE нет ни статей об анализе, ни рабочих детекторов, учитывая то, что, судя по зарубежным изданиям, в данное время эта защита - всё еще конкретная заноза в заднице.<br>Вначале хочу поделиться некоторыми наблюдениями, основанными на анализе ArmA и ArmA2 (securom + fade):<br>1. Детекция<br>Оба образца имеют узнаваемую сигнатуру:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_WinMain@16</li>        </ol>
    </div>
</div></div>
<br>В IDA определяется как перекрестная ссылка на WinMain (она в обоих образцах всего одна).<br><br>2. Триггеры<br>Рядом с сигнатурой сидит FADE_flag1 (mov [xxx], 1), который ставится в 1 каждый раз когда срабатывает FADE-триггер. Использование флага через перекрестные ссылки не ловится, видимо адрес рассчитывается процедурно или вся область памяти с этим флагом участвует в расчетах. Но это неважно, раз уж мы можем отловить все установочные триггеры через xref&#039;ы. Тем более что в патченной версии (самих игр у меня нет, есть только пара fixed exe из инета) некоторые из найденных мной триггеров уже пропатчены (хоть и не все).<br>Видел также другую разновидность триггера, но и она завязана на четырех флагах, которые находятся недалеко от FADE_flag1 и вся эта красота удобно и стабильно наследуется от версии к версии, а установочные функции-триггеры также находятся по сигнатуре (и к тому же идут подряд, друг за дружкой).<br><br>Насколько я понимаю, защита эта несложная. Даже если я что-то упустил, и её снятие гораздо сложнее, начало уже обнадеживает. Более того - за годы между выходами двух частей ArmA она почти не изменилась и вполне возможно написать если не универсальный кряк, то по крайней мере детектор. Интересно другое (для меня лично, тема не об этом) - почему за столько времени ею никто не занялся всерьез?<br><br>Напишите плз кто что знает по теме и нужна ли народу статья с анализом этой защиты? Я мог бы написать, когда (и если) разберусь в ней полностью. Любая помощь - только приветствуется.<br><br>Oops. Забыл про благодарности - группе Hatred за securom-дамп 1-й Армы и особенно Itachi за его апдейт к кряку от Hatred, который указал мне места, где прячутся триггеры FADE. Заслуги за их работу я себе присваивать не собирался.<br><br>Updated:<br>Обнаруженные мной проверки (триггирующие основной флаг):<br>1. Self integrity.<br>Какой-то собственный несложный хеш по собственному коду в памяти плюс CRC32 по WinMain. Находится по push offset WinMain@16.<br>2. CDKEY Blacklist Check<br>В winmain первые 4 байта CD-Key xor-ятся с некоторым DWORD (для каждой игры видимо свой) и проверяются по списку на равенство нескольким другим константам. Если не равно ни одной из них - проверка пройдена. WinMain защищен профайлером или каким-то другим контролем целостности (видимо чтобы не ковыряли блеклист, остроумно!). Трассировка отладчиком приведет к падению на динамических call-таблицах.<br>3. CDKEY Hash Check №1<br>CDKEY (первые 4 байта) хешируется базовым Windows Crypt API, алгоритм SHA. Если первый байт хеша равен некоторому hardcoded-числу, проверка пройдена. В этой проверке также вычисляется язык лицензии (он заложен в CD-Key). Здесь уже начинаются динамические таблицы указателей на функции. Без отладчика всё еще можно, но уже некомфортно.<br>4. CDKey Hash Check №2<br>Дублирует проверку №1 для FADE, но вместо определения языка делает itoa первых 4 байт CD-KEY в десятичном представлении. В отладчике я в неё ни разу не попадал, поэтому отложу её пока.<br><br>Больше манипуляций с CD-KEY видно не было, что наводит на интересные мысли - можно написать Fast-SHA для генерации хеша только по DWORD, подобрать все валидные для игры начальные номера из всего лишь 4 млрд. вариантов, учесть блеклист, выбрать язык и прилепить остальные 11 байт от фонаря. Вуаля! У нас валидный CD-KEY и всё заработает без exe-patching&#039;а (плюс игра в онлайне ;) ). Буду проверять эту догадку.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=241839&amp;user=22731&amp;forum_n=2&amp;topic=15143.html&amp;page=0&amp;anchor=1" class="addthx" data-post="241839"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2009 01:39 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15143.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>ogurets_agressive</b><br>Подкинь хоть какую нибудь игру с этой защитой, а то ни разу не слышал и не встречал
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=241840&amp;user=2777&amp;forum_n=2&amp;topic=15143.html&amp;page=0&amp;anchor=2" class="addthx" data-post="241840"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ogurets_agressive[/b]','')">ogurets_agressive</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.74'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=22731">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2009 01:53 &middot; Поправил: ogurets_agressive <br><script type="text/javascript">QU('ogurets_agressive','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ogurets_agressive" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15143.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>daFix пишет:<br>Подкинь хоть какую нибудь игру с этой защитой, а то ни разу не слышал и не встречал  </I><br>Я ж написал - ArmA и ArmA 2 <img src="img/smilies/s1.gif" alt=""> Интересная кстати защита - отслеживает изменения своих файлов и вводит искусственные глюки в игру, например такие:<br>hxxp://img13.imageshack.us/img13/6797/kabanator.jpg (скрин не мой)<br><br>P.S. Обычно она идет в паре с SecuROM или SafeDisc.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=241841&amp;user=22731&amp;forum_n=2&amp;topic=15143.html&amp;page=0&amp;anchor=3" class="addthx" data-post="241841"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]huckfuck[/b]','')">huckfuck</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 49.6 (посетитель), 9thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6947">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2009 02:00 <br><script type="text/javascript">QU('huckfuck','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=huckfuck" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15143.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
кое-какая инфа о защите:<br><br>www.gameburnworld.com/protections_fade.shtml
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=241842&amp;user=6947&amp;forum_n=2&amp;topic=15143.html&amp;page=0&amp;anchor=4" class="addthx" data-post="241842"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2009 02:04 &middot; Поправил: MasterSoft <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15143.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<img src="img/smilies/s6.gif" alt=""> Кабанатор???!!! <img src="img/smilies/s6.gif" alt=""><br><br>Лично я про такую защиту ниразу не слышал, да про неё собственно нигде и не упоминается <img src="img/smilies/s11.gif" alt=""> А с чего ты взял, что эт FADE? Ну в смысле как? По сигнам, кто-то сказал или ещё что-то?<img src="img/smilies/s1.gif" alt=""> И где мона почитать базовую инфу по ней (имею ввиду сайт разработчика)<br><br><b>huckfuck</b><br>Thank&#039;s
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=241843&amp;user=16624&amp;forum_n=2&amp;topic=15143.html&amp;page=0&amp;anchor=5" class="addthx" data-post="241843"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ogurets_agressive[/b]','')">ogurets_agressive</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.74'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=22731">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2009 02:17 &middot; Поправил: ogurets_agressive <br><script type="text/javascript">QU('ogurets_agressive','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ogurets_agressive" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15143.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>huckfuck пишет:<br>кое-какая инфа о защите: </I><br>Да да. Это я и имел в виду под &quot;зарубежными изданиями&quot; <img src="img/smilies/s1.gif" alt=""> Есть еще статья на gamecopyworld и в английской википедии. Вот это особенно интересно:<br>&quot;Detection of this protection is unknown at this stage, if anyone has a known method of detecting this protection please let us know here&quot;.<br><br><I>MasterSoft пишет:<br>А с чего ты взял, что эт FADE? Ну в смысле как? </I><br>Во 2-й Арме с nocd-кряком от Reloaded невозможно даже прицельно и в упор из пистолета в бочку попасть. В лицензии всё норм. Народ говорит еще о других глюках - например превращении в птицу (летающую) или курицу, отключение AI (солдаты в сингле просто стоят столбом). Кабанчик вот например - тоже из 2-й Армы.<br>Представляю как прикольно работать в их группе разработки багов <img src="img/smilies/s1.gif" alt=""><br><br>Вообще мне не очень нравится подход по отлову отдельных триггеров. Их можно плодить сотнями, насовать во все дырки, но основных условий включения будет мало. Например, на один флаг может быть куча триггеров - time-bombs, script-bombs, активируемые по нажатию клавиши или чтению особого ресурса. Пока выделил CD-KEY-флаг. Видимо он тащится из первых версий, простенькая проверка. Знаю что есть еще как минимум exe-integrity и анти-отладочный флаги (ставится если работает отладчик, читается память процесса и еще фиг знает при каких условиях). Может еще быть проверка меток диска (scratches).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=241844&amp;user=22731&amp;forum_n=2&amp;topic=15143.html&amp;page=0&amp;anchor=6" class="addthx" data-post="241844"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2009 11:07 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15143.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Нужно искать свинью по сигнатуре... <img src="img/smilies/s1.gif" alt=""> Свинская сигнатура должна присутствовать <img src="img/smilies/s1.gif" alt=""><br>В смысле например объект этого кабана в ресурсах присутствует, но в нормальной версии врядле вообще используется. На примере этого скриншота понятно, что из ресурсов на сцену должен был джип подгрузиться, а подгрузилась и используется свинья. Может по запросам к ресурсу выловить флажок? Где то же принимается решение, что загружать кабана вместо джипа, ну или номер ресурса джипа подменяется на номер ресурса кабана....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=241858&amp;user=702&amp;forum_n=2&amp;topic=15143.html&amp;page=0&amp;anchor=7" class="addthx" data-post="241858"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2009 15:43 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15143.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
А в GTA4 не эта-же защита присутствует?
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=241876&amp;user=2777&amp;forum_n=2&amp;topic=15143.html&amp;page=0&amp;anchor=8" class="addthx" data-post="241876"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ogurets_agressive[/b]','')">ogurets_agressive</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.74'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=22731">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2009 19:36 <br><script type="text/javascript">QU('ogurets_agressive','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ogurets_agressive" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15143.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>ToBad пишет:<br>Нужно искать свинью по сигнатуре... </I><br>В том-то и проблема что таких &quot;приколов&quot; может быть сколько угодно, все не выловишь. Обрисую вкратце механизм FADE, как я его вижу сейчас:<br>1. Есть несколько проверок - CD-KEY, целостность exe + возможно других файлов, отсутствие отладчика, blacklisted apps и на топологию диска (поскольку этим занимается SecuROM, это маловероятно, но упускать из виду все равно не стоит). Эти проверки в случае провала включают несколько флагов. Проверок может быть несколько и в разное время, но их обнаружение довольно простое, потому что сопряжено со специфичными действиями (открытием .exe-файла например). Проверки - слабое место. В пользу этой идеи говорит то что они защищены jumpgate&#039;ами и анти-отладочным кодом (слава яйцам хоть полиморфного пока не видно).<br><br>2. При включенном флаге в случайное время активируются логические бомбы (триггеры). Они могут срабатывать сразу (косоглазие например), а некоторые - по таймеру или какому-то игровому событию (в определенной миссии, при выполнении скрипта или игрового действия). Нейтрализация одного триггера не мешает работе остальных, они разнотипны, трудно поддаются обнаружению, зато легко локализуются и патчатся, что в общем-то, особо не обнадеживает. По xref-ам на флаги не отыскиваются. Как я написал выше, даже простейший CD-KEY-флаг спрятан и простым дизассемблированием нельзя понять, где он проверяется и какие триггеры запускает.<br><br><I>daFix пишет:<br>А в GTA4 не эта-же защита присутствует?  </I><br>Может быть. Защита особо не афишируется, на коробочке мелким шрифтом должно быть написано.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=241907&amp;user=22731&amp;forum_n=2&amp;topic=15143.html&amp;page=0&amp;anchor=9" class="addthx" data-post="241907"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> FADE DRM, обнаружение и механизм работы</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#10" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="15143">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15143" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
