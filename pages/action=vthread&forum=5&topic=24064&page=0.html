<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Исходник: по шаблону искать в файле - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго дня господа. Ищется исходник (или его часть), который позволял бы по шаблону искать в файле определенный набор команд (байт). НО ... При положительном результате поиска, надо чтобы искомая строка сохранялась в некий">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=6859'>cppasm</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Исходник: по шаблону искать в файле</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]maddmaks[/b]','')">maddmaks</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.9 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.38'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=28112">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2016 18:05 <br><script type="text/javascript">QU('maddmaks','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=maddmaks" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24064.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго дня господа.<br><br>Ищется исходник (или его часть), который позволял бы по шаблону искать в файле определенный набор команд (байт).<br>НО ...<br>При положительном результате поиска, надо чтобы искомая строка сохранялась в некий буфер, для того чтобы ее оттуда извлечь, модифицировать и записать в измененном виде на место. <br><br>маленький пример набора команд для ясности<br><br>add edx, dword ptr [0x00570b84]<br>mov eax, 1<br>imul eax, edx, 2<br><br>bytes - 03 15 84 0B 57 00 B8 01 00 00 00 6B C2 02<br><br>Заменить надо на<br><br>mov eax, 3<br>mov dword ptr [0x00570b84], eax<br>nop<br><br>bytes - B8 03 00 00 00 89 15 84 0B 57 00 90 90 90<br><br><br>А вот другой ...<br><br>add ecx, dword ptr [0x00570d40]<br>mov edx, 1<br>imul edx, ecx, 3<br><br>А этот заменить надо на<br><br>mov ecx, 3<br>mov dword ptr [0x00570d40], ecx<br>nop<br><br><br>Таких кусков в файле много и в искомых наборах команд, как регистры, так и явные адреса (первая команда - add, xxx [0x00xxxxxx]) всегда будут разные. По этим причинам и нужно наличие временного буфера.<br><br>Ни один авто-патчер подобного не умеет.<br><br>Кто чем поможет, кто что подскажет?<br>Меня устроил бы даже скрипт для инно-сетап, если там подобное возможно.<br><br>Надеюсь разрисовал все толково ...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=363591&amp;user=28112&amp;forum_n=5&amp;topic=24064.html&amp;page=0&amp;anchor=1" class="addthx" data-post="363591"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2016 18:51 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24064.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
)) Однако..<br>Там ещё и асм/дизасм должен быть встроенный?<br><br>Евть распространяемый с  исходниками biew. Там всё это должно быть.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=363592&amp;user=35473&amp;forum_n=5&amp;topic=24064.html&amp;page=0&amp;anchor=2" class="addthx" data-post="363592"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2016 19:05 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24064.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
поиск по маске? иначе слишком сложно получается и в этом нет смысла.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=363593&amp;user=72&amp;forum_n=5&amp;topic=24064.html&amp;page=0&amp;anchor=3" class="addthx" data-post="363593"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]maddmaks[/b]','')">maddmaks</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.9 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.38'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=28112">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2016 19:16 <br><script type="text/javascript">QU('maddmaks','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=maddmaks" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24064.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
ну да, по маске, а как еще ...<br><b>dosprog</b><br><br>асм-дизасм ... ?<br><br>ищем по маске bytes - 03 ?? ?? ?? ?? 00 ?? 01 00 00 00 6B ?? 02<br>нашли              bytes - 03 15 <b>84 0B 57 00</b> B8 01 00 00 00 6B C2 02<br><br>здесь важная часть фактический адрес - <b>84 0B 57 00</b><br><br>пишем bytes - B8 03 00 00 00 89 15 <b>84 0B 57 00</b> 90 90 90<br><br>и все ...<br>зачем асм-дизасм ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=363594&amp;user=28112&amp;forum_n=5&amp;topic=24064.html&amp;page=0&amp;anchor=4" class="addthx" data-post="363594"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2016 19:37 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24064.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<noindex><a href="http://www.programmersforum.ru/showthread.php?t=105301" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>..проще самому написать, чем в чужом ковыряться..<br><br>Задача состоит из двух частей - сперва по строке поиска строится двоичная строка и двоичниая маска ,<br>а потом с помощью этих двух строк выполняется занудный поиск.<br>Можно выполнять тупо последовательный strcmp, накладывая на текст двоичную маску, а можно помудрить с оптимизацией. Зависит от старательности.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=363595&amp;user=35473&amp;forum_n=5&amp;topic=24064.html&amp;page=0&amp;anchor=5" class="addthx" data-post="363595"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]maddmaks[/b]','')">maddmaks</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.9 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.38'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=28112">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2016 20:06 &middot; Поправил: maddmaks <br><script type="text/javascript">QU('maddmaks','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=maddmaks" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24064.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>dosprog</b><br>АБСОЛЮТНО с вами согласен. Но ...<br>Если бы для меня это было как два пальца ..., я бы и тему здесь не поднимал.<br><br>P.S.<br>там по вашей ссылке файлик во вложении. мне не достать. Вы не могли бы помочь, если есть такая возможность?<br>Спасибо
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=363596&amp;user=28112&amp;forum_n=5&amp;topic=24064.html&amp;page=0&amp;anchor=6" class="addthx" data-post="363596"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2016 20:10 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24064.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>maddmaks пишет:<br>Если бы для меня это было как два пальца </I><br><br>Сравнить две строки байтов сможете? - Думаю, да.<br>А перед этим сделать им AND c двоичной маской? - Тоже не сложно.<br>А дальше цикл для каждого байта исходного массива байтов  - собственно поиск начала искомой строки.<br>Работать будет.<br><br>Хотя.. На словах-то оно всё просто<br><br><I>maddmaks пишет:<br>там по вашей ссылке файлик во вложении. мне не достать. </I><br><br>Тоже там не зарегистрирован, сорри.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=363597&amp;user=35473&amp;forum_n=5&amp;topic=24064.html&amp;page=0&amp;anchor=7" class="addthx" data-post="363597"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]maddmaks[/b]','')">maddmaks</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.9 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.38'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=28112">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2016 20:19 <br><script type="text/javascript">QU('maddmaks','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=maddmaks" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24064.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>dosprog</b><br>Конечно буду пробывать, либо пока не сделаю, либо не помру от мучений.<br>Тему поднял лишь для того, что если кто-то уже подобное делал, то возможно, что со мной поделятся готовой работой ....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=363598&amp;user=28112&amp;forum_n=5&amp;topic=24064.html&amp;page=0&amp;anchor=8" class="addthx" data-post="363598"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2016 21:34 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24064.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
На коленке пишется<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">BYTE</span><span class="hl_char">*</span>&nbsp;searchByMask<span class="hl_char">(</span><span class="hl_function">BYTE</span><span class="hl_char">*</span>&nbsp;buf<span class="hl_char">,</span>&nbsp;<span class="hl_function">BYTE</span><span class="hl_char">*</span>&nbsp;search<span class="hl_char">,</span>&nbsp;<span class="hl_function">BYTE</span><span class="hl_char">*</span>&nbsp;mask<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;buflen<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;len<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function">BYTE</span><span class="hl_char">*</span>&nbsp;found&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;for<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; i &lt;= buflen - len; i++)</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;j&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;for<span class="hl_char">(</span><span class="hl_comment">; j &lt; len; j++)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_char">(</span>buf<span class="hl_char">[</span>i&nbsp;<span class="hl_char">+</span>&nbsp;j<span class="hl_char">]</span>&nbsp;^&nbsp;search<span class="hl_char">[</span>j<span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span>&nbsp;mask<span class="hl_char">[</span>j<span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>break</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>j&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;len<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">&amp;</span>buf<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>break</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;return&nbsp;found<span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>Конечно, можно оптимизировать... и возможны ошибки... но идея, надеюсь, понятна <img src="img/smilies/s1.gif" alt=""><br><br>Вот скучно, видимо, всем - такие топики на 9 постов растягивать <img src="img/smilies/s5.gif" alt="">
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=363600&amp;user=24257&amp;forum_n=5&amp;topic=24064.html&amp;page=0&amp;anchor=9" class="addthx" data-post="363600"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2016 21:37 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24064.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
1. используйте генераторы патчей, там есть такая функция.<br>2. гугл по запросу &quot;поиск последовательности байт по маске&quot; и нужный язык программирования.<br>3. закрыто
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=363601&amp;user=72&amp;forum_n=5&amp;topic=24064.html&amp;page=0&amp;anchor=10" class="addthx" data-post="363601"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Исходник: по шаблону искать в файле</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24064" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
