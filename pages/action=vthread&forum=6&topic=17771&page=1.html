<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Запись в адресное пространство приложения - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть приложение, которое ставит драйвер хукающий NtOpenProcess и NtQuerySystemInformation, дабы спрятать своё присутствие в списке процессов и не дать открыть свой процесс через OpenProcess. Задача: писать в память этого">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Запись в адресное пространство приложения</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=17771&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=17771&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=6&amp;topic=17771&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=17771&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]noph[/b]','')">noph</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.5 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.34'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24616">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 февраля 2011 15:53 <br><script type="text/javascript">QU('noph','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=noph" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Есть приложение, которое ставит драйвер хукающий NtOpenProcess и NtQuerySystemInformation, дабы спрятать своё присутствие в списке процессов и не дать открыть свой процесс через OpenProcess.<br>Задача: писать в память этого процесса.<br><br>При восстановлении SDT и снятии хуков приложение начинает работать некорректно, поэтому этот способ отпадает. Я инжекчу свою длл в этот процесс, поэтому в принципе все данные по нему и так есть. И даже из этой длл в его адресное пространство можно писать что угодно. Вопрос вот в чём: как в данной ситуации сделать так, чтобы в память этого процесса могло писать <b>любое другое</b> приложение? Тот же самый ArtMoney?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277107&amp;user=24616&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=1" class="addthx" data-post="277107"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2011 20:27 &middot; Поправил: Nightshade <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
Драйвер фроста<br>Код там простой. Думаю так будет проще говорить.<br><br><img src="img/attach.gif" alt=""> <a href="./files/da5d_17.02.2011_CRACKLAB.rU.tgz">da5d_17.02.2011_CRACKLAB.rU.tgz</a> - frost_32.rar<br>и вот еще веселый кусок на закусь<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004118F0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">004118F2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">8A584500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0045588A</span></li><li class="hl_l0"><span class="hl_number">004118F7</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">64</span><span class="hl_char">:</span>A1&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">FS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">004118FD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004118FE</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">81EC</span>&nbsp;<span class="hl_number">34010000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">134</span></li><li class="hl_l1"><span class="hl_number">00411904</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EBP</span></li><li class="hl_l0"><span class="hl_number">00411905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">00411906</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">57</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l0"><span class="hl_number">00411907</span>&nbsp;&nbsp;&nbsp;&nbsp;A1&nbsp;B0ED4600&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">46EDB0</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">0041190C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">33C4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>XOR</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">ESP</span></li><li class="hl_l0"><span class="hl_number">0041190E</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">0041190F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D8424</span>&nbsp;<span class="hl_number">44010000</span>&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">144</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00411916</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">64</span><span class="hl_char">:</span>A3&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">FS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">0041191C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BE9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">0041191E</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">44</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">44</span></li><li class="hl_l1"><span class="hl_number">00411920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D4424</span>&nbsp;<span class="hl_number">1C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">1C</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00411924</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">00411926</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00411927</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">046D0200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00438630</span></li><li class="hl_l1"><span class="hl_number">0041192C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">83C4</span>&nbsp;<span class="hl_number">0C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">0C</span></li><li class="hl_l0"><span class="hl_number">0041192F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">7CA04500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0045A07C</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; ASCII &quot;ntdll.dll&quot;</span></li><li class="hl_l1"><span class="hl_number">00411934</span>&nbsp;&nbsp;&nbsp;&nbsp;FF15&nbsp;<span class="hl_number">68834500</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>KERNEL32<span class="hl_char">.</span>GetModuleH<span class="hl_char">&gt;</span><span class="hl_comment">; kernel32.GetModuleHandleA</span></li><li class="hl_l0"><span class="hl_number">0041193A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B8C24</span>&nbsp;<span class="hl_number">54010000</span>&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">154</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00411941</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B3D</span>&nbsp;<span class="hl_number">9C834500</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>KERNEL32<span class="hl_char">.</span>GetProc<span class="hl_char">&gt;</span><span class="hl_comment">; kernel32.GetProcAddress</span></li><li class="hl_l0"><span class="hl_number">00411947</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8BF0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ESI</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00411949</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">88A04500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0045A088</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; ASCII &quot;ZwOpenProcess&quot;</span></li><li class="hl_l0"><span class="hl_number">0041194E</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">0041194F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">894C24</span>&nbsp;<span class="hl_number">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">20</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l0"><span class="hl_number">00411953</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l1"><span class="hl_number">00411955</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">85C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00411957</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">03</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">0041195C</span></li><li class="hl_l1"><span class="hl_number">00411959</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B40</span>&nbsp;<span class="hl_number">01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">0041195C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">98A04500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0045A098</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; ASCII &quot;ZwQuerySystemInformation&quot;</span></li><li class="hl_l1"><span class="hl_number">00411961</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l0"><span class="hl_number">00411962</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">894424</span>&nbsp;<span class="hl_number">34</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">34</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00411966</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l0"><span class="hl_number">00411968</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">85C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">0041196A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">03</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">0041196F</span></li><li class="hl_l0"><span class="hl_number">0041196C</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B40</span>&nbsp;<span class="hl_number">01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">0041196F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;B4A04500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0045A0B4</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; ASCII &quot;ZwQueryVirtualMemory&quot;</span></li><li class="hl_l0"><span class="hl_number">00411974</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">00411975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">894424</span>&nbsp;<span class="hl_number">3C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">3C</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">00411979</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l1"><span class="hl_number">0041197B</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">85C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">0041197D</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">03</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">00411982</span></li><li class="hl_l1"><span class="hl_number">0041197F</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B40</span>&nbsp;<span class="hl_number">01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00411982</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;CCA04500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0045A0CC</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; ASCII &quot;ZwReadVirtualMemory&quot;</span></li><li class="hl_l1"><span class="hl_number">00411987</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l0"><span class="hl_number">00411988</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">894424</span>&nbsp;<span class="hl_number">54</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">54</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">0041198C</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l0"><span class="hl_number">0041198E</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">85C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">00411990</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">03</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">00411995</span></li><li class="hl_l0"><span class="hl_number">00411992</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B40</span>&nbsp;<span class="hl_number">01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00411995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;E0A04500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0045A0E0</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; ASCII &quot;ZwWriteVirtualMemory&quot;</span></li><li class="hl_l0"><span class="hl_number">0041199A</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">0041199B</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">894424</span>&nbsp;<span class="hl_number">44</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">44</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">0041199F</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l1"><span class="hl_number">004119A1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">85C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004119A3</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">03</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">004119A8</span></li><li class="hl_l1"><span class="hl_number">004119A5</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B40</span>&nbsp;<span class="hl_number">01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">004119A8</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;F8A04500&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0045A0F8</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; ASCII &quot;NtDuplicateObject&quot;</span></li><li class="hl_l1"><span class="hl_number">004119AD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l0"><span class="hl_number">004119AE</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">894424</span>&nbsp;<span class="hl_number">4C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">4C</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">004119B2</span>&nbsp;&nbsp;&nbsp;&nbsp;FFD7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_registr">EDI</span></li><li class="hl_l0"><span class="hl_number">004119B4</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">85C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l1"><span class="hl_number">004119B6</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">74</span>&nbsp;<span class="hl_number">03</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JE</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">004119BB</span></li><li class="hl_l0"><span class="hl_number">004119B8</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B40</span>&nbsp;<span class="hl_number">01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">004119BB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D5424</span>&nbsp;<span class="hl_number">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">18</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">004119BF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EDX</span></li><li class="hl_l1"><span class="hl_number">004119C0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">894424</span>&nbsp;<span class="hl_number">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">58</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004119C4</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;E7EBFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">004105B0</span></li><li class="hl_l1"><span class="hl_number">004119C9</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">83C4</span>&nbsp;<span class="hl_number">04</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">4</span></li><li class="hl_l0"><span class="hl_number">004119CC</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D4424</span>&nbsp;<span class="hl_number">5C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">5C</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">004119D0</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004119D1</span>&nbsp;&nbsp;&nbsp;&nbsp;FF15&nbsp;<span class="hl_number">64834500</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>KERNEL32<span class="hl_char">.</span>GetSystemI<span class="hl_char">&gt;</span><span class="hl_comment">; kernel32.GetSystemInfo</span></li><li class="hl_l1"><span class="hl_number">004119D7</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B4C24</span>&nbsp;<span class="hl_number">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">60</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">004119DB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">894C24</span>&nbsp;<span class="hl_number">28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">28</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">004119DF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D4C24</span>&nbsp;<span class="hl_number">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">18</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">004119E3</span>&nbsp;&nbsp;&nbsp;&nbsp;E8&nbsp;<span class="hl_number">78E4FFFF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">0040FE60</span></li><li class="hl_l1"><span class="hl_number">004119E8</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_number">004119EA</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D5424</span>&nbsp;<span class="hl_number">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">18</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">004119EE</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EDX</span></li><li class="hl_l0"><span class="hl_number">004119EF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8B55</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">004119F2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">04</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">4</span></li><li class="hl_l0"><span class="hl_number">004119F4</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D4424</span>&nbsp;<span class="hl_number">1C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">1C</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">004119F8</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004119F9</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">6A</span>&nbsp;<span class="hl_number">44</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">44</span></li><li class="hl_l1"><span class="hl_number">004119FB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D4C24</span>&nbsp;<span class="hl_number">2C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">2C</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">004119FF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">51</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ECX</span></li><li class="hl_l1"><span class="hl_number">00411A00</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">0824409C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">9C402408</span></li><li class="hl_l0"><span class="hl_number">00411A05</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EDX</span></li><li class="hl_l1"><span class="hl_number">00411A06</span>&nbsp;&nbsp;&nbsp;&nbsp;C74424&nbsp;<span class="hl_number">30</span>&nbsp;<span class="hl_number">00000</span><span class="hl_char">&gt;</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">30</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_number">00411A0E</span>&nbsp;&nbsp;&nbsp;&nbsp;C74424&nbsp;<span class="hl_number">34</span>&nbsp;<span class="hl_number">00000</span><span class="hl_char">&gt;</span><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span><span class="hl_number">34</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">00411A16</span>&nbsp;&nbsp;&nbsp;&nbsp;FF15&nbsp;<span class="hl_number">84834500</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_char">&lt;</span><span class="hl_char">&amp;</span>KERNEL32<span class="hl_char">.</span>DeviceIoCo<span class="hl_char">&gt;</span><span class="hl_comment">; kernel32.DeviceIoControl</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277251&amp;user=4618&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=2" class="addthx" data-post="277251"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 09:43 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
Дело было вечером, делать было нечего. Родился такой немного безумный алгоритм. Идея основана на том, что существует некоторое приложение, защищённое фростом (причём, возможно, его модификация отличается от вышеописанной, и заранее мы не знаем, сколько функций он перехватил в _KiServiceTable), а также есть чит, который либо полностью выполнен в виде исполняемого файла (экзешника), либо существует загрузчик, который посредством каких-то манипуляций в третьем кольце подгружает свои компоненты в приложение, защищённое фростом (целевое). Задача – скрыть чит от фроста, и выполнять все функции чита так, как если бы фроста не существовало. Т.е. если нужно открыть целевой процесс, то чит вызывает OpenProcess с идентификатором целевого процесса, и в ответ получает дескриптор.<br>Метод реализации такой. Сам экзешник чита запускаем с флагом CREATE_SUSPENDED, далее подгружаем свой дров, который по технологии DKOM скроет процесс чита. Вызываем ResumeThread. Теперь нам нужно в ядре выделить NonPagedPool память для размещения адресов из _KiServiceTable. Логично, что для начала нам нужно эти самые адреса найти. Сделать это можно так – известно, что неэкспортируемая KiInitSystem() в ntoskrnl.exe (или аналогичном) выполняет инициализацию экспортируемой KeServiceDescriptorTable вот так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>_KeServiceDescriptorTable<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiServiceTable</li>        </ol>
    </div>
</div></div>
<br>Собственно, именно offset _KiServiceTable  указывает на те значения адресов функций, которые патчатся фростом. НО! На диске в файле ntoskrnl.exe эти значения хранятся в своём первородном виде, поэтому скопировав их оттуда (предварительно пересчитав в соответствии с базой образа ядра), мы получим неперхваченную KiServiceTable. Однако, как же найти этот адрес _KiServiceTable в файле на диске? <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">005EF2F4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>_KeServiceDescriptorTable<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiServiceTable</li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">005EF2FE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_48B524<span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">005EF304</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_48B52C<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiArgumentTable</li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">005EF30E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">005EF310</span></li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">005EF310</span>&nbsp;loc_5EF310<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CODE XREF: KiInitSystem()+13Dj</span></li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">005EF310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_48B528<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">005EF316</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">005EF318</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">40h</span></li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">005EF31B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_5EF310</li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">005EF31D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KeServiceDescriptorTable</li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">005EF322</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KeServiceDescriptorTableShadow</li>        </ol>
    </div>
</div></div>
<br><br>KeServiceDescriptorTable – экспортируемое значение, KeServiceDescriptorTableShadow – можно найти. На основе двух этих значений можно организовать сигнатурный плавающий поиск, т.е. на случай, если между ними (этими значениями) код может варьироваться от версии к версии Windows, то можно найти одно значение, например, первое вхождение KeServiceDescriptorTable, потом предположить, что второе вхождение этого значения может быть в промежутке от +24h до +2Еh и т.д. Ясно, что вхождения следует искать внутри модуля ntoskrnl.exe, ImageBase и ImageSize которого можно найти даже с помощью перехваченной NtQuerySystemInformation и даже в юзермоде. (можно юзать значение KiServiceTable, полученное разыменовываением KeServiceDescriptorTable в памяти, если не боитесь, что оно будет перехвачено новыми версиями фроста).<br><br>Далее, вот мы получили оригинальную KiServiceTable в нашем выделенном участке ядерной неподкачиваемой памяти. Теперь следующее. В ntdll.dll загруженного в память чита ищем вот это:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">7C90CE40</span>&nbsp;Z<span class="hl_char">&gt;</span>&nbsp;&nbsp;B8&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">7C90CE45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BA&nbsp;<span class="hl_number">0003FE7F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_number">7FFE0300</span></li><li class="hl_l0"><span class="hl_number">7C90CE4A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FF12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>NEAR</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDX</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">7C90CE4C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C2&nbsp;<span class="hl_number">1800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RETN</b></span>&nbsp;<span class="hl_number">18</span></li>        </ol>
    </div>
</div></div>
<br><br>7FFE0300 – может варьироваться от системы к системе. Так начинается сервис ZwAcceptConnectPort (но не факт), я не знаю утилит или руткитов, которые бы его хукали сплайсингом, поэтому на оригинальность кода можно положиться (или не положиться, и читать код с диска). Короче, найдя этот код по сигнатуре, мы будем знать начало перехводников, которые обращаются к ядру, и, в конечном итоге, к KiServiceTable. Фишка в том, что заполняя нашу ядерную выделенную память нехученными значениями сервисов, мы можем узнать их количество (конец – начало / 4). Так мы будем знать, сколько всего переходников нам нужно поправить. Но на что поправить? <br><br>Давайте вспомним, как происходит вызов ядерных функций в KiServiceTable. Номер из юзермода умножается на 4, прибавляется к offset _KiServiceTable, и полученный указатель разыменовывается. Но до этого, чтоб получить offset _KiServiceTable, разыменовывается offset _KeServiceDescriptorTable:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00406983</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00406985</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_registr">eax</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>Значения KeServiceDescriptorTable и KiServiceTable патчить нельзя, тогда остаётся так выбрать номер сервиса, чтоб получить нужный нам адрес, на который потом передастся управление. Т.е. например, (глядя на вышеприведенный ассемблерный код) после первой инструкции edi = 00890540h (адреса взяты из головы для примера). После второй инструкции ebx должен быть равен 00956000 h, что соответствует адресу неперехваченной функции. Как этого добиться? Предположим, что значение 00956000h расположено по адресу 00905030h. Тогда edi+eax*4 должно равняться 00905030h. Отсюда еах = (00905030h – edi) / 4 -&gt; еах = (00905030h – 00890540h) / 4 = 1D2BCh. <br><br>Даже если результат будет отрицательный, это – не проблема, поскольку номера имеют размер ULONG. Единственное, что следует упомянуть, так это то, что память должна быть выделена так, чтобы разность делилась на 4, но в описании ExAllocatePoolWithTag не говориться, как это сделать (возможно, никак с её помощью), поэтому придётся выделить на 1 DWORD памяти больше, чем нужно, и с помощью вычислений добиться расположения первого значения так, чтоб (00905030h – edi) подобная разность делилась на 4 нацело.<br><br>Теперь, когда всё готово, на финальном этапе с помощью VirtualProtectEx + WriteProcessMemory в адресном пространстве чита мы можем перенастроить переходники – переписать номера сервисов.<br><br>При завершении чита драйвер должен освобождать память, ранее выделяемую под неперехваченную таблицу. Это достигается установкой нотификатора через PsSetCreateProcessNotifyRoutine. <br><br>Так можно положить болт на всякие модификации этого грёбаного фроста, или нельзя, если я что-то упустил. Жду комментариев.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277275&amp;user=6336&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=3" class="addthx" data-post="277275"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 11:00 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
Так можно и в ring3 сделать, как посоветовал арчи, и будет надежнее чем эмпирическое вычисление значений по сигнатурам. ИМХО конечно.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277281&amp;user=3232&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=4" class="addthx" data-post="277281"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 14:49 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<b>PE_Kill</b><br>Можно, но если фрост перехватит новые функции, то придётся заново сидеть и думать, как в каждом конкретном случае эмулировать тот или иной сервис. Да, в общем случае поддерживать всю линейку Windows будет не самой простой задачей, но добиться работоспособности на конкретной оси (например, ХР SP3, даже на всём семействе ХР) я думаю, вполне реально.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277306&amp;user=6336&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=5" class="addthx" data-post="277306"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 15:02 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<b>Nightshade</b> а что если просто подменить адреса функций в этом месте)))) на что-нить ненужное.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277307&amp;user=72&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=6" class="addthx" data-post="277307"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 15:04 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>Hellspawn</b><br><br>Была такая мысль, но понятное дело, она не годится, т.к. вдруг это ненужное вызовется какой-то программой, и будет бсод.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277308&amp;user=6336&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=7" class="addthx" data-post="277308"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 15:05 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<b>ARCHANGEL</b> а если подумать? <img src="img/smilies/s1.gif" alt=""> не адрес другого сервиса ей дать, а ... и тут много вариантов
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277309&amp;user=72&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=8" class="addthx" data-post="277309"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 15:11 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<b>Hellspawn</b><br><br>Ну, если подумать, то можно так: сторонняя библиотека подгружается в АП приложения, защищённого фростом, хукается ЕР, чтоб либа отработала до начала исполнения кода, далее либа перехватывает GetProcAddress и вместо адреса того же ZwOpenProcess подсовывает какую-нибудь оччччень редко используемую функу (причём на все функции, которые нужно оставить неперехваченными, подсовывается один и тот же адрес). Тогда есть шанс, но опять же, при малейшем апдейте всё придётся переделывать.<br><br><b>Добавлено</b><br>типа, чтоб она перехватила что-то левое в ядре, которое никогда не выполнится? Да, но если нельзя патчить ничего из файлов фроста (даже в памяти нельзя менять), то это не получится сделать.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277310&amp;user=6336&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=9" class="addthx" data-post="277310"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 15:13 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
хукнуть DeviceIoControl, и редактировать буфер <img src="img/smilies/s1.gif" alt=""> ловить нужную отправку. <br><br>создаём процесс суспенд, хукаем  в ntdll что надо, отпускаем. на крайняк, чтобы хукнуть, в памяти можно ничего не менять <img src="img/smilies/s1.gif" alt=""> главное свою длл подсунуть.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277311&amp;user=72&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=10" class="addthx" data-post="277311"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 15:21 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<b>Hellspawn</b><br><br>А что вы собираетесь ловить? И на что менять?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277313&amp;user=6336&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=11" class="addthx" data-post="277313"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 15:24 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
я ничего не собираюсь, мне это не интересно, т.к. читами не пользуюсь. <br>ловить нужно dwIoControlCode <img src="img/smilies/s1.gif" alt=""> <br>а менять, найти в ядре что либо подходящее, не составит труда.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277314&amp;user=72&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=12" class="addthx" data-post="277314"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 15:35 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<i class=x>я ничего не собираюсь, мне это не интересно, т.к. читами не пользуюсь.</i><br><br><img src="img/smilies/s5.gif" alt=""> <img src="img/smilies/s5.gif" alt=""> Понял.<br><br>Ну вот если б товарищи геймеры скинулись по чуть-чуть (я не жадный), я б им что-то накодил бы, что б читилось хорошо, а так - нет времени.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277316&amp;user=6336&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=13" class="addthx" data-post="277316"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 17:12 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
Я говорил не про эмуляцию сервиса, а про создание интерфейса внутри игры и подгрузку своей библиотеки-провайдера в адресное пространство чита. Перехватываем в чите апи работы с процессами, генерим инвалидный специфичный хендл при NtOpenProcess (DEADC0DE например), а все остальные апи фильтруют хендлы, если попадается наш хендл, то через ту же шаред мемори эмулируем апи, редиректя запросы на длл внутри игры. За вечер вполне можно сделать ну и вечер на отладку и при этом не трогаем дров и всё красиво и универсально. С другой стороны под силу ли это ТС.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277325&amp;user=3232&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=14" class="addthx" data-post="277325"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 18:00 &middot; Поправил: ajax <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<b>PE_Kill</b><br>Было бы под силу, топик бы не возник <img src="img/smilies/s1.gif" alt=""><br>А в дрова нет смысла лезть без ну очень крайней необходимости. Даже в pace это особо не требовалось.
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277332&amp;user=8830&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=15" class="addthx" data-post="277332"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 21:17 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>&gt; как же найти этот адрес _KiServiceTable<br><br>1. Менеджер сискалов берёт линк на SDT из описателя текущего потока, это ETHREAD.ServiceTable. Это значение не может быть изменено до конвертации потока в гуи.<br>2. Обычно SST не перемещают в памяти, хотя этому ничто не мешает.<br><br>Можно переместить всю сст в нужное место. Можно вобще погрузить ядро и загрузить в сст ссылку на содержащуюся в нём таблицу(да и вобще перенаправить вызовы сервисов на оригинальные в новой проекции).<br><br>&gt; значениями сервисов, мы можем узнать их количество (конец – начало / 4). Так мы будем знать, сколько всего переходников нам нужно поправить.<br>Число их описано в SST.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277344&amp;user=17964&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=16" class="addthx" data-post="277344"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]HiEndsoft[/b]','')">HiEndsoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 237.0 (наставник), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.74'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13651">Участник</a><br><font color=blue>sysenter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2011 21:39 &middot; Поправил: HiEndsoft <br><script type="text/javascript">QU('HiEndsoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HiEndsoft" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
Для XP фрост ломается из юзермода патчем драйвера (чтобы выкинуть нотификаторы и не лезть в ядро), исправлением SDT через гейт physicalmemory, перенаправлением загрузки драйвера (хук CreateServiceW - там именно так загружается дров) и убийством &quot;теневого&quot; контрольного потока в защищаемом процессе (там на самом деле их несколько, какой из них прибить - дело другое))
<br><br><font size="1"><i>-----<br>продавец резиновых утёнков</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277346&amp;user=13651&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=17" class="addthx" data-post="277346"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2011 13:25 &middot; Поправил: Clerk <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Не поленился собрать пруфкод. Всё завязано на графы. Для поиска IDT используем также анализ графа. Находим KiSystemService(), далее kssdoit и интегрируем на это место наш код. И этот код может быть загружен в дескрипторы для сервисного прерывания. Для фастколов необходимо поправить линк в #DB. Вот исходный менеджер:<br><noindex><a href="http://img607.imageshack.us/i/30253296.png/" rel="nofollow" target="_blank">http://img607.imageshack.us/i/30253296.png/</a></noindex><br>Вот конечный:<br><noindex><a href="http://img810.imageshack.us/i/outm.png/" rel="nofollow" target="_blank">http://img810.imageshack.us/i/outm.png/</a></noindex><br>Разумеется это не полноценный код, а только пример показывающий на сколько просто такие манипуляции выполнять.<br><br><img src="img/attach.gif" alt=""> <a href="./files/218f_19.02.2011_CRACKLAB.rU.tgz">218f_19.02.2011_CRACKLAB.rU.tgz</a> - Service.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277377&amp;user=17964&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=18" class="addthx" data-post="277377"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 февраля 2011 09:54 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
Уфф, начну по порядку.<br><br>Мой вышеприведенный алгоритм требует переработки. Дело в том, что нельзя (без патчинга ядра) вызывать сервисы по произвольным номерам (стандартно). Т.е., для примера, такой код:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">7C90CE40</span>&nbsp;Z<span class="hl_char">&gt;</span>&nbsp;&nbsp;B8&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">7C90CE45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BA&nbsp;<span class="hl_number">0003FE7F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_number">7FFE0300</span></li><li class="hl_l0"><span class="hl_number">7C90CE4A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FF12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>NEAR</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDX</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">7C90CE4C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C2&nbsp;<span class="hl_number">1800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RETN</b></span>&nbsp;<span class="hl_number">18</span></li>        </ol>
    </div>
</div></div>
<br><br>Прекрасно отработает, а вот такой:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">7C90CE40</span>&nbsp;Z<span class="hl_char">&gt;</span>&nbsp;&nbsp;B8&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_number">888895</span></li><li class="hl_l1"><span class="hl_number">7C90CE45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BA&nbsp;<span class="hl_number">0003FE7F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_number">7FFE0300</span></li><li class="hl_l0"><span class="hl_number">7C90CE4A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FF12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>NEAR</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDX</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">7C90CE4C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C2&nbsp;<span class="hl_number">1800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RETN</b></span>&nbsp;<span class="hl_number">18</span></li>        </ol>
    </div>
</div></div>
<br><br>Вернёт ошибку о неверной функции. Дело в том, что номера сервисов в ядре проходят проверку на валидность, а именно внутри _KiSystemService выполняется такой код:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00406944</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFFh</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00406949</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">0040694C</span>&nbsp;<span class="hl_function"><b>jnb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_KiBBTUnexpectedRange</li>        </ol>
    </div>
</div></div>
<br><br>(кстати, видно на рисунке <b>Clerk&#039;a</b> )Не трудно догадаться, что в еах – номер сервиса. Во второй строчке он сравнивается с общим числом сервисов, что происходит дальше – очевидно из имени метки. Но самым интересным является то, что число сервисов берётся не из SYSTEM_SERVICE_TABLE, на которую указывает KeServiceDescriptorTable. Оно берётся из её копии, на которую указывает ETHREAD.ServiceTable потока. Изменив эту копию (подсунув туда адрес непадченной KiServiceTable) можно добиться работы в обход перехватов. Как писал <b>Great</b>, это поле очень интересно (<b>Clerk</b>, сэнкс, что обратили на него моё внимание), но  <b>Great</b> (в своей статье &quot;Планировщик, потоки и процессы&quot;) писал неверно, что оно содержит содержимое (простите за повторы) либо KeServiceDescriptorTable, либо KeServiceDescriptorTableShadow. Оно содержит либо KeServiceDescriptorTable, либо обе, если поток стал Gui. Я тож собрал пруфкод, но пока ещё не до конца отладил - не разобрался, как принудительно конвертить поток в ГУИ, если я не могу исполнять код в его адресном пространстве. Думаю, через пару дней выложу.<br><br>Далее, дизасм драйвера, выложенного <b>Nightshade</b>, дал результаты. Во-первых, сокрытие по DKOM не даст результата, поскольку дров фроста ставит нотификаторы на создание процесса и загрузку модулей – он всё равно всё сдетектит. Поэтому мы пойдём другим путём. Давайте подумаем, что он конкретно может сдетектить. Имя и контрольную сумму части образа. Поэтому переименовываем чит и упаковываем его любым упаковщиком на выбор. Но, если фрост в будущем (в текущей версии я не видел таких проверок) будет юзать поиск по объектам ядра (мьютексам, событиям, именованым каналам и т.д.), опираясь на конкретные имена, то от этого, в общем случае, не защититься.<br><br>Второе, ничего не дадут перехваты с подменой номеров сервисов в юзермоде, т.к. дров фроста вычисляет значения Nt-функций, опираясь на ядро.<br><br>Ну, в общем, пока всё, будут отлаживать свой код, чтоб было, что показать. В связи с отладкой вот таккой вот вопрос, прямо не касающийся фроста, но, может, кто знает. Скачал я с офсайта отладочные символы для ХР, стал их юзать, и понял, что нифига-то символы не загружаются, то ли не подходят, то ли хз ещё что. Тогда подгрузил символы из WinDbg (скачанные через него), и всё запахало. Но для Семёрки я не могу подгрузить символы из WinDbg, где бы достать нормальные?<br><br><b>HiEndsoft</b><br>Как вы используете PhysicalMemory на XP SP3?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277508&amp;user=6336&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=19" class="addthx" data-post="277508"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 февраля 2011 21:48 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>&gt; Я тож собрал пруфкод, но пока ещё не до конца отладил - не разобрался, как принудительно конвертить поток в ГУИ, если я не могу исполнять код в его адресном пространстве.<br>Поток в гуи конвертирует функа PsConvertToGuiThread(), она загружает теневую сст и расширяет ядерный стек. Можно дёрнуть для этого любой теневой сервис, но при этом понадобится както обойти вызов пользовательского apfn-колбека. Ну с этим проблем вобщем не должно быть.<br>Шадов не доступен из процесса System не потому, что поток не гуи, а потомучто шадов находится в адресном пространстве сессии и для отображения туда его нужно выполнить аттач, тоже и для иных сессий. Для этого нужно дёрнуть MmAttachSession(), напрямую никак, но можно через колбек ExpWin32SessionCallout, вызываемый из ObjectType-процедур для обьекта &quot;Desktop&quot;. Дето был пруфкод мой в инетах..<br>Обычно это в пределах текущей сессии не делают, а просто выполняют аттач к гуи-процессу(например csrss по имени порта и тп.).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277574&amp;user=17964&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=20" class="addthx" data-post="277574"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]HiEndsoft[/b]','')">HiEndsoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 237.0 (наставник), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.74'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13651">Участник</a><br><font color=blue>sysenter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 01:31 <br><script type="text/javascript">QU('HiEndsoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HiEndsoft" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Как вы используете PhysicalMemory на XP SP3? </I><br>ошибся server2003sp2 была тогда. а вообще достаточно драйвер пропатчить, в другое место его переместить и на него через хук CreateServiceW (или LdrLoadDriver) перенапралять.
<br><br><font size="1"><i>-----<br>продавец резиновых утёнков</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277591&amp;user=13651&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=21" class="addthx" data-post="277591"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 10:34 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
<b>Clerk пишет:</b><br><i class=x>Можно дёрнуть для этого любой теневой сервис</i><br><br>Да, я так и делаю. Про PsConvertToGuiThread прочитал у <b>Great&#039;a</b>, да и после перехода на _KiBBTUnexpectedRange там через несколько инструкций её вызов идёт, а выполнять код в АП требуемого процесса решил через APC. Пока вот прикладываю PoC. На картинках запусщенный HideTools с установленым драйвером, RKU показывает наличие перехватов HideTools, чтоб не подумали, будто их кто-то снял. А Pe Tools перенастроен так, что все его потоки обращаются к чистой KiServiceTable. Соответственно, Pe Tools палит HideTools. <br><br><i class=x>Шадов не доступен из процесса System</i><br>Не вижу необходимости делать его там доступным.<br><br><b>Clerk</b><br>Скачал ваш код, посмотрел, хотелось бы задать вам несколько вопросов, но, думаю, что они не будут прямо относиться к теме топика, поэтому позже (1-2 дня на продумывание, может, сам догадаюсь) стукну в личку. Странно, что больше тут никто ничего по этому поводу не написал, наверное, всем остальным и так всё ясно.<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/7c61_21.02.2011_CRACKLAB.rU.tgz">7c61_21.02.2011_CRACKLAB.rU.tgz</a> - Archive.rar
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277606&amp;user=6336&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=22" class="addthx" data-post="277606"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 18:23 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>&gt; а выполнять код в АП требуемого процесса решил через APC.<br>Для этого есть Ke[Stack]AttachProcess().<br><br>&gt; Скачал ваш код, посмотрел, хотелось бы задать вам несколько вопросов<br>Спрашивайте.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277624&amp;user=17964&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=23" class="addthx" data-post="277624"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 18:38 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Странно, что больше тут никто ничего по этому поводу не написал, наверное, всем остальным и так всё ясно. </I><br>Остальные либо шарят, либо &quot;курят&quot; в сторонке (в т.ч. я <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277629&amp;user=8830&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=24" class="addthx" data-post="277629"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2011 10:51 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
<b>Clerk пишет:</b><br><i class=x>Для этого есть Ke[Stack]AttachProcess().</i><br><img src="img/smilies/s1.gif" alt=""><br><br>Наконец-то собрал всё воедино, и выкладываю рабочий загрузчик процессов. В архиве батник, в котором описан пример запуска блокнота через загрузчик. Просьба потетсить на фросте (у кого есть такая возможность), т.е. посмотреть, заработали ли читы (тот же артмани). Загрузчик совместим пока только с ХР, но если кому-то очень надо - пишите, будем что-то решать с более новыми ядрами. <br><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/54fe_22.02.2011_CRACKLAB.rU.tgz">54fe_22.02.2011_CRACKLAB.rU.tgz</a> - Release.rar
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277682&amp;user=6336&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=25" class="addthx" data-post="277682"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2011 17:34 &middot; Поправил: Clerk <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Стрёмно запускать, впрочем как и вам мои кодесы =))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277734&amp;user=17964&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=26" class="addthx" data-post="277734"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]HiEndsoft[/b]','')">HiEndsoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 237.0 (наставник), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.74'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13651">Участник</a><br><font color=blue>sysenter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2011 20:33 <br><script type="text/javascript">QU('HiEndsoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HiEndsoft" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Unable to create Process N<br>WinXP x32 SP3
<br><br><font size="1"><i>-----<br>продавец резиновых утёнков</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277742&amp;user=13651&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=27" class="addthx" data-post="277742"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2011 09:43 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
<b>HiEndsoft</b><br>Хм, а в отладчике не смотрели, почему процесс не создаётся? Мало ли, мож имя не то, или нет такого процесса, попробуйте полный адрес задать, или если через батник пользуйетесь, то кириллицу из полного адреса убрать.<br><br><b>Clerk</b><br>Ну, так вы под варей попробуйте, хотя б просто запускается ли, работает ли и т.д.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277772&amp;user=6336&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=28" class="addthx" data-post="277772"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]HiEndsoft[/b]','')">HiEndsoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 237.0 (наставник), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.74'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13651">Участник</a><br><font color=blue>sysenter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2011 13:03 &middot; Поправил: HiEndsoft <br><script type="text/javascript">QU('HiEndsoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HiEndsoft" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Хм, а в отладчике не смотрели, почему процесс не создаётся?</I><br>--если честно времени нет;<br> <I>Мало ли, мож имя не то, или нет такого процесса, попробуйте полный адрес задать, или если через батник пользуйетесь, то кириллицу из полного адреса убрать. </I><br>-- получилось заинжектится только если файл notepad&#039;a лежит в одной папке с вашей прогой (раньше в system32 был). Функционал посмотрю позже
<br><br><font size="1"><i>-----<br>продавец резиновых утёнков</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277783&amp;user=13651&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=29" class="addthx" data-post="277783"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]kannabis[/b]','')">kannabis</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.41'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=27949">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2011 08:32 <br><script type="text/javascript">QU('kannabis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kannabis" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#30');return false;">#30</a> </span><div align=left><br>
ARCHANGEL этот код вообще работает?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=278450&amp;user=27949&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=30" class="addthx" data-post="278450"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 марта 2011 17:53 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17771&amp;page=1#31');return false;">#31</a> </span><div align=left><br>
<b>kannabis</b><br>работает
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=278546&amp;user=6336&amp;forum_n=6&amp;topic=17771&amp;page=1&amp;anchor=31" class="addthx" data-post="278546"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=17771&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=17771&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=6&amp;topic=17771&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=17771&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Запись в адресное пространство приложения</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="17771">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=17771" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
