<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>unpack securom - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="я создал тему в разделе для новичков http://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9277 пакер SecuROM 4.x.x.x - 5.x.x.x -&gt; Sony DADC посмотрел секции: CWFR FWFR .asrc .ojff .apypwk .idata Говорят что это">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> unpack securom</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=9282&amp;page=1.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=9282&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=9282&amp;page=1.html">2</a> . <b>3</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Mavlyudov[/b]','')">Mavlyudov</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3355.jpg" alt=""><br><span class=txtSm>Ранг: 156.2 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3355">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2007 23:39 <br><script type="text/javascript">QU('Mavlyudov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mavlyudov" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#1');return false;">#1</a> </span><div align=left><br>
я создал тему в разделе для новичков<br><a href="http://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9277" target="_new">http://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9277</a><br><br>пакер SecuROM 4.x.x.x - 5.x.x.x -&gt; Sony DADC<br>посмотрел секции:<br>CWFR<br>FWFR<br>.asrc<br>.ojff<br>.apypwk<br>.idata<br><br>Говорят что это пакер по сложности не уступает Themida<br>Знаю, на сайте есть две статьи про распаковк securom, но чт-то мне не очень понятно.<br>Буду благодарен, если кто посмотрит exe-ник.<br><a href="http://ifolder.ru/2578939" target="_new">http://ifolder.ru/2578939</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=144935&amp;user=3355&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=1" class="addthx" data-post="144935"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 июля 2007 23:30 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#2');return false;">#2</a> </span><div align=left><br>
<I>Mavlyudov пишет:<br>0040EECB 8946 10 MOV DWORD PTR DS:[ESI+10],EAX </I><br>...так ты уже проскочил настоящее OEP...между прочим.<br><br>Ты вообще программу инсталлировал на жёсткий диск??И что значит запускал &quot;с одним exe-шником&quot;??<br>Нормально запускай защищённый файл из той директории,куда установлена программа.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=148885&amp;user=1613&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=2" class="addthx" data-post="148885"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Mavlyudov[/b]','')">Mavlyudov</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3355.jpg" alt=""><br><span class=txtSm>Ранг: 156.2 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3355">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июля 2007 13:13 <br><script type="text/javascript">QU('Mavlyudov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mavlyudov" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#3');return false;">#3</a> </span><div align=left><br>
<I>DillerInc пишет:<br>И что значит запускал &quot;с одним exe-шником&quot;?? </I><br>Значит, что в отдельную папку кинул exe и его дебаггил
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148927&amp;user=3355&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=3" class="addthx" data-post="148927"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Mavlyudov[/b]','')">Mavlyudov</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3355.jpg" alt=""><br><span class=txtSm>Ранг: 156.2 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3355">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июля 2007 13:27 <br><script type="text/javascript">QU('Mavlyudov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mavlyudov" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#4');return false;">#4</a> </span><div align=left><br>
<I>DillerInc пишет:<br>Ты вообще программу инсталлировал на жёсткий диск?? </I><br>Проинсталировал, открыл и т.д.. ВСЁ тоже самое, что и в моем последнем посте, где я код приводил.<br>с точностью до адресов!!!!! НИЧЕГО не понимаю!!!!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148928&amp;user=3355&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=4" class="addthx" data-post="148928"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Mavlyudov[/b]','')">Mavlyudov</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3355.jpg" alt=""><br><span class=txtSm>Ранг: 156.2 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3355">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 июля 2007 14:15 &middot; Поправил: Mavlyudov <br><script type="text/javascript">QU('Mavlyudov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mavlyudov" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#5');return false;">#5</a> </span><div align=left><br>
Я так посмотрел, только 6% из посетивших отвечают в эту тему...<br>Наверняка же можно имея только один файл EGU.exe, распаковать этот файл: убрать проверку cd, выйти на UPX и распаковать...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=148934&amp;user=3355&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=5" class="addthx" data-post="148934"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 июля 2007 10:50 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#6');return false;">#6</a> </span><div align=left><br>
<b>Mavlyudov</b><br>И всё-таки я думаю,что у тебя палится отладчик,потому как иначе трудно объяснить,почему у тебя так происходит.<br>Вот,попробуй поставить этот плагин для ольки.Попробуй с ним,так сказать,поиграться,когда загрузишь программу в отладчик и будешь стоять на EP.<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/c33e_29.07.2007_CRACKLAB.rU.tgz">c33e_29.07.2007_CRACKLAB.rU.tgz</a> - hidedbg_by_xDREAM.rar
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=149024&amp;user=1613&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=6" class="addthx" data-post="149024"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Mavlyudov[/b]','')">Mavlyudov</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3355.jpg" alt=""><br><span class=txtSm>Ранг: 156.2 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3355">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 01:42 &middot; Поправил: Mavlyudov <br><script type="text/javascript">QU('Mavlyudov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mavlyudov" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#7');return false;">#7</a> </span><div align=left><br>
Начну с хороших новостей: я нашел ОЕР.<br>Но импорт еще не восстановил. Мои попытки это сделать не увенчались успехом,<br>Поэтому расскажу, как я это делал, чтобы была возможность меня поправить.<br>Заодно покритикую(в хорошем смысле) статьи Ra&#036;cal’а и Cigan’а.<br><br>Итак, я стою на ОЕР.<br>00553258   55               PUSH EBP<br>Сразу снимаю 2 дампа: один с галочкой Rebuild Import, другой без.<br>Cigan пишет, что чуть ниже ОЕР &quot;видим первый CALL ведущий в не куда&quot; <br>Вот как он выглядит у меня:<br>А вот куда он ведет (сомневаюсь, что это то самое &quot;не куда&quot;, хотя кто знает):<br>00407093   90               NOP<br>00407094   53               PUSH EBX<br>Продолжим.<br>Трассирую F7 со входом в call:<br>Попадаю в секцию библиотек<br>7C573DFC &gt; 55               PUSH EBP<br>Жму Alt+F9 и попадаю опять в код проги:<br>004070A5   A3 18F75500      MOV DWORD PTR DS:[55F718],EAX            ; EGU.00400000<br>Поднимаюсь на команду выше<br>004070A0   E8 2BFFFFFF      CALL EGU.00406FD0                        ; JMP to kernel32.GetModuleHandleA<br>Жму Enter на нее:<br>00406FD0  -FF25 18435600    JMP DWORD PTR DS:[564318]                ; kernel32.GetModuleHandleA<br><br>В окне дампа смотрю на адрес 564318 и пытаюсь найти примерное начало импорта<br>00564318  FC 3D 57 7C 00 00 00 00 24 30 2D 7C 1A 90 2D 7C  ь=W|....&#036;0-| ђ-|<br>Поднимаюсь чуть выше, вижу нули.<br>00564208  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>Нули заканчиваются по адресу<br>0055E698  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>Т.е с адреса 0055E688 опять начинается код.<br>0055E688  EC 9F 41 00 0C 32 47 00 00 00 00 00 00 00 00 00  мџA..2G.........<br>Ладно, иду в ImpRec:<br>OEP=00153258 (без ImageBase)<br>RVA=&lt;начало где нули&gt;=00564208 - 400000=00164208<br>SIZE=&lt;начало кода, после того как нули закончились&gt;=0055E688<br>Галочка &quot;Add new section&quot; стоит<br>Нажимаю Get Imports и ничего не импортируется, значит я накосячил где-то…<br>Вот только где…<br>Хм…попробовал еще кое-что. Перечитал топик еще раз..<br>Ввел параметры, какие говорил <b>DillerInc</b><br>OEP=00153258<br>RVA=0016421C <br>SIZE= 00000A88.<br>RVA(от галочки Add new section) =001F7000<br>Get Import и Fix Dump. Зафиксировал те два дампа, что снял из Олли..<br>Оба работают. <br>Так, интересно. Теперь правлю мои параметры. Решил заменить размер.<br>Был SIZE=0055E688<br>Заменил на размер <b>DillerInc</b>&#039;а 00000A88. Все получилось!!!!<br><br>Еще попробовал. Теперь ставлю размер 00010000<br>Появилось кое-что лишнее<br>? Fthunk: 00169000 Nbfunc:4 (decimal:4) valid:NO<br> rva: 00169000 ptr 00568000<br> rva: 00169004 ptr 00568010<br> rva: 00169008 ptr 0055F710<br> rva: 0016900C ptr 00569010<br><br>Удаляю ее, фиксирую оба дампа. Все работает.<br>Файл в среднем занимает 3,63 МБ (±0,01)<br>Значит все дело в IAT Size (хотя у меня RVA=00164208, у DillerInc RVA=0016421C, у меня к тому же Windows 2000  )<br><br><b>DillerInc</b>, расскажи почему IAT Size = 0A88h ??<br>Щас пойду почитаю про PE-формат и &quot;Директории импорта&quot;. Расскажешь тогда еще как урезать файл?? А то он весит 3,63 МБ. <br>Как там вырезать секции и т.п. Ты вроде говорит что-то про .idata.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=149385&amp;user=3355&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=7" class="addthx" data-post="149385"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Mavlyudov[/b]','')">Mavlyudov</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3355.jpg" alt=""><br><span class=txtSm>Ранг: 156.2 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3355">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 02:39 <br><script type="text/javascript">QU('Mavlyudov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mavlyudov" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#8');return false;">#8</a> </span><div align=left><br>
<b>DillerInc</b><br>Решил попробовать, как ты посоветовал (интересно, получится ли?).<br>Дошел до ОЕР. <br>Ставлю бряк. bp GetModuleHandleA <br>Остановка на<br>7C573DFC &gt; 55               PUSH EBP<br>Смотрю откуда эта функция была вызвана и куда вернется после завершения работы<br>0012F87C   00553272  RETURN to EGU.00553272 from EGU.00407094<br>From:<br>00407093   90               NOP<br>00407094   53               PUSH EBX<br>Как видно, это тот самый «CALL ведущий в не куда»<br>To:<br>0055326D   E8 223EEBFF      CALL EGU.00407094<br>00553272   33C0             XOR EAX,EAX<br><br>Что с этим делать??<br>Возможно, какую-то информацию уже можно вбивать в ImpRec?<br><br>Еще заметил: дамп, снятый в WinXp, в Win2000 не запутился:<br>Ошибка с заголовком: <br>&quot;Entry Point Not Found&quot; сообщает, что:<br>&quot;The procedure entry point RestoreLastError could not be located in the dynamic link library kernel32.dll&quot;<br><br>Посмотрел параметры функции GetModuleHandleA.<br>HMODULE GetModuleHandleA<br> {<br>  LPCSTR module <br>}<br>Возвращает<br>Success: A handle to the loaded dll. <br>Failure: A NULL handle. Use <u>GetLastError</u> to determine the cause.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=149396&amp;user=3355&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=8" class="addthx" data-post="149396"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 11:36 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#9');return false;">#9</a> </span><div align=left><br>
<I>Mavlyudov пишет:<br>расскажи почему IAT Size = 0A88h ?? </I><br>...ну,это же элементарно,Ватсон <img src="img/smilies/s1.gif" alt=""><br><br>00564CA4h - 0056421Ch = 0A88h<br><br>От тебя же просят размер,а не смещение,где таблица заканчивается.<br>Начало IAT -- это смещение,где начинаются первые адреса IAT, а не какие-то нули.<br>Конец IAT -- это смещение,по которому находится последний импортируемый адрес, + 8 байт.<br><br>И здесь нет &quot;CALL ведущий в не куда&quot;, потому что это UPX.<br>Securom тут по-видимому используется для привязки к оригинальному диску.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=149481&amp;user=1613&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=9" class="addthx" data-post="149481"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Mavlyudov[/b]','')">Mavlyudov</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3355.jpg" alt=""><br><span class=txtSm>Ранг: 156.2 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3355">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 11:56 <br><script type="text/javascript">QU('Mavlyudov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mavlyudov" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#10');return false;">#10</a> </span><div align=left><br>
<I>DillerInc пишет:<br>Начало IAT -- это смещение,где начинаются первые адреса IAT, а не какие-то нули. <br>Конец IAT -- это смещение,по которому находится последний импортируемый адрес, + 8 байт. </I><br>Как понять где начинается IAT, а где заканчивается?<br>Это столбики цифр 77 или 7С ?<br>У меня по адресу 00564318 таких нет.<br>Где ты взял арес 00564CA4 ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=149495&amp;user=3355&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=10" class="addthx" data-post="149495"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 14:46 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#11');return false;">#11</a> </span><div align=left><br>
<b>Mavlyudov</b><br>По-моему,тема начинает проситься в раздел для новичков,ей богу.<br>Это элементарные вещи,я не знаю,как их объяснить проще.Поэтому учи матчасть.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=149554&amp;user=1613&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=11" class="addthx" data-post="149554"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]SniperOK[/b]','')">SniperOK</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.7 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.13'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4895">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 19:10 <br><script type="text/javascript">QU('SniperOK','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SniperOK" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#12');return false;">#12</a> </span><div align=left><br>
Может быть, мне тут помогут =)<br>В общем начал изучать сей прот. Для опытов взял старую версию на WarCraft&#039;e - 4.84<br>Восстанавливать импорт методом Cigan&#039;a не стал, а просто пофиксил все переходы скриптом. Но вот проблемка. Все переходы верные, но импорт imprec&#039;ом восстанавливается не полностью. Для сравнения брал nocd с gamecopyworld.com. Если точнее, то не восставливается импорт системных библиотек - т.е. kernel, user32, ntdll и т.д. Хотя в дампе все они есть:<br>nop<br>call .. <br>заменено на:<br>004011D0   |. FF15 ECB34400      CALL DWORD PTR DS:[44B3EC]                ; \MessageBoxA<br>Возможно, я что-то конкретно не понимаю в импорте, но все же прошу помочь <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=149637&amp;user=4895&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=12" class="addthx" data-post="149637"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Cigan[/b]','')">Cigan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=208">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2007 19:53 <br><script type="text/javascript">QU('Cigan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Cigan" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#13');return false;">#13</a> </span><div align=left><br>
А там импорт и не надо востанавливать, там единственное что нужно это коректно его прописать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=149651&amp;user=208&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=13" class="addthx" data-post="149651"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Smon[/b]','')">Smon</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 500.5 (<b>!</b>), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.33'>Активность: 0.23<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 августа 2007 01:07 &middot; Поправил: Smon <br><script type="text/javascript">QU('Smon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Smon" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#14');return false;">#14</a> </span><div align=left><br>
Кто нить реально смотрел 7-ку ? Начал ковырять Hitman Blood Money, распакованная гама падает на одном из инт3 (неужели в секуроме есть наномиты?! <img src="img/smilies/s11.gif" alt=""> ), которых в секции кода примерно несколько тысяч, блоками от 1-го до 4 интов подряд, лежат в основном сразу за jcc (может это всё  же такая проверка на распакованность\антидамп?)<br><br>Примеры:<br>00401030    6A FF                      PUSH -1<br>00401032    68 54897200                PUSH 555_.00728954<br>00401037    64:A1 00000000             MOV EAX,DWORD PTR FS:[0]<br>0040103D    50                         PUSH EAX<br>0040103E    64:8925 00000000           MOV DWORD PTR FS:[0],ESP<br>00401045    51                         PUSH ECX<br>00401046    A1 3CF88100                MOV EAX,DWORD PTR DS:[81F83C]<br>0040104B    85C0                       TEST EAX,EAX<br>0040104D    74 01                      JE SHORT 555_.00401050<br>0040104F    CC                         INT3<br>00401050    6A 21                      PUSH 21<br>00401052    68 C4147500                PUSH 555_.007514C4                       ; ASCII &quot;hitman3\hitman3\hitman3.cpp&quot;<br>00401057    68 886A0000                PUSH 6A88<br>0040105C    E8 FF560400                CALL 555_.00446760<br><br><br>00402E1C    57                         PUSH EDI<br>00402E1D    897424 0C                  MOV DWORD PTR SS:[ESP+C],ESI<br>00402E21    C706 4C167500              MOV DWORD PTR DS:[ESI],555_.0075164C<br>00402E27    8B46 14                    MOV EAX,DWORD PTR DS:[ESI+14]<br>00402E2A    33DB                       XOR EBX,EBX<br>00402E2C    3BC3                       CMP EAX,EBX<br>00402E2E    895C24 1C                  MOV DWORD PTR SS:[ESP+1C],EBX<br>00402E32    74 01                      JE SHORT 555_.00402E35<br>00402E34    CC                         INT3<br>00402E35    891D 84F68100              MOV DWORD PTR DS:[81F684],EBX<br>00402E3B    8B7E 04                    MOV EDI,DWORD PTR DS:[ESI+4]<br>00402E3E    3BFB                       CMP EDI,EBX<br>00402E40    895E 18                    MOV DWORD PTR DS:[ESI+18],EBX<br>00402E43    895E 14                    MOV DWORD PTR DS:[ESI+14],EBX<br><br><br>00405310    8B81 041B0000              MOV EAX,DWORD PTR DS:[ECX+1B04]<br>00405316    85C0                       TEST EAX,EAX<br>00405318    74 04                      JE SHORT 555_.0040531E<br>0040531A    CC                         INT3<br>0040531B    32C0                       XOR AL,AL<br>0040531D    C3                         RETN<br>0040531E    C781 041B0000 02000000     MOV DWORD PTR DS:[ECX+1B04],2<br>00405328    B0 01                      MOV AL,1<br>0040532A    C3                         RETN<br><br><br>00452BE7    FF15 A8107500              CALL DWORD PTR DS:[&lt;&amp;kernel32.GetCurrent&gt;; kernel32.GetCurrentProcess<br>00452BED    50                         PUSH EAX<br>00452BEE    FF15 A4107500              CALL DWORD PTR DS:[&lt;&amp;kernel32.GetProcess&gt;; kernel32.GetProcessAffinityMask<br>00452BF4    85C0                       TEST EAX,EAX<br>00452BF6    0F84 B5000000              JE 555_.00452CB1<br>00452BFC    8B0C24                     MOV ECX,DWORD PTR SS:[ESP]<br>00452BFF    85C9                       TEST ECX,ECX<br>00452C01    75 04                      JNZ SHORT 555_.00452C07<br>00452C03    CC                         INT3<br>00452C04    8B0C24                     MOV ECX,DWORD PTR SS:[ESP]<br>00452C07    8B4424 04                  MOV EAX,DWORD PTR SS:[ESP+4]<br>00452C0B    85C0                       TEST EAX,EAX<br>00452C0D    75 04                      JNZ SHORT 555_.00452C13<br>00452C0F    CC                         INT3<br>00452C10    8B0C24                     MOV ECX,DWORD PTR SS:[ESP]<br>00452C13    83F9 01                    CMP ECX,1<br>00452C16    0F84 95000000              JE 555_.00452CB1<br><br>Особенно забавно выглядят третий и четвертый пример, складывается такое впечатление, что прот просто сам обрабатывает инты, не позволяя проге упасть <img src="img/smilies/s15.gif" alt=""><br>PS: ни вм, ни прыжков в секцию прота не нашёл, прога падает на интах, попытка занопить их по шаблонам не удалась, всё равно падает, только уже непонятно где (OpenGL движок игры не дает ольке нормально работать <img src="img/smilies/s14.gif" alt=""> )
<br><br><font size="1"><i>-----<br>&quotПусть видят, что мы не шутим. Стволы для понта, ножи для дела&quot Lock, Stock &amp Two Smoking Barrels</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150474&amp;user=1449&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=14" class="addthx" data-post="150474"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 22:00 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#15');return false;">#15</a> </span><div align=left><br>
<b>Smon</b><br>Странно,не встречал подобного.Хотя я в принципе не особо разбирал седьмую версию.<br>А можно посмотреть,что происходит в защищённой программе при выполнении команды INT3, т.е. как её обрабатывает протектор??Может в защищённой программе они(команды прерывания) вообще не получают управления??<br><br>Может <b>Cigan</b> сможет больше сказать...он ведь у нас любит Securom <img src="img/smilies/s2.gif" alt="">
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150841&amp;user=1613&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=15" class="addthx" data-post="150841"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Smon[/b]','')">Smon</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 500.5 (<b>!</b>), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.33'>Активность: 0.23<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 22:07 <br><script type="text/javascript">QU('Smon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Smon" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#16');return false;">#16</a> </span><div align=left><br>
<I>DillerInc пишет:<br>А можно посмотреть,что происходит в защищённой программе при выполнении команды INT3, т.е. как её обрабатывает протектор </I><br>Я уже думал над этим, но сайс не юзаю, а олька тут не помощник, т.к. гама падает уже после запуска и входа в граф. режим, а олька с ним к сожалению не дружит (
<br><br><font size="1"><i>-----<br>&quotПусть видят, что мы не шутим. Стволы для понта, ножи для дела&quot Lock, Stock &amp Two Smoking Barrels</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150844&amp;user=1449&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=16" class="addthx" data-post="150844"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Mavlyudov[/b]','')">Mavlyudov</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3355.jpg" alt=""><br><span class=txtSm>Ранг: 156.2 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.53'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3355">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 августа 2007 15:23 <br><script type="text/javascript">QU('Mavlyudov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mavlyudov" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#17');return false;">#17</a> </span><div align=left><br>
<b>DillerInc</b><br>Еще пришла такая мысль: а зачем распаковывать UPX, ведь если импорт не кривой, то все работать будет!!!<br>Дошел до адреса<br>005ED180   60               PUSHAD <br>Снял дамп: с галочкой Rebuild Import и без.<br>Работает файл с отключенной галочкой.<br><br>тоже самое сделал на строчке ОЕР<br>00553258   55               PUSH EBP<br>Опять же: дамп, который снять с отключенной галочкой Rebuild Import работает.<br>(другой дамп выдает ошибку: The procedure entry point could not be located in the dynamic link library WS2_32.DLL)<br><br>Мне кажется, что такие дампы все же не будут работать на других компах, так что подправить импорт одним из указанных выше способой в ImpRec, ст0ит...<br>Да, кстати, проверил еше раз скрипты: один из них доходит до 005ED180, т.е лошел бы ло ОЕР, если бы не было UPX. Другой скрипт ставить бряки на все CALL&#039;ы. Пока что я не понял для чего. <br><br><b>DillerInc</b><br>Расскажи пожалуйста еще две такие вещи:<br>1) как дойти до ОЕР, если ставить бряк на WriteProcessMemory, а не на CreateEventA....<br>2) как сократить размер файла с 3,62МБ до 1,98МБ
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=151223&amp;user=3355&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=17" class="addthx" data-post="151223"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]SniperOK[/b]','')">SniperOK</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 38.7 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.13'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4895">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2007 14:07 <br><script type="text/javascript">QU('SniperOK','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SniperOK" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#18');return false;">#18</a> </span><div align=left><br>
Вопрос. Начал разбирать седьмую версию сабжа, встал на первом же шаге - ОЕР и антиотладка. Последний тутор от ARTeam немного освещает антиотладку, но этого оказалось недостаточно. Я не смог даже найти использование описанного там трика. Даже ничего похожего. Как я понимаю, с помощью плагинов, удается обойти ZwQueryInformationProcess, ZwQuerySystemInformation, CheckRemoteDebuggerPresent, IsDebuggerPresent, NtGlobalFlag\HeapFlag и несколько проверок класса\имени окна. На форуме ARTeam haggar отмечал след. зависимость кодов ошибки со срабатыванием антиотладки:<br>1. ERROR_NUMBER = 10000<br>ZwQueryInformationProcess<br>InfoClass = 0<br>2. ERROR_NUMBER = 2000<br>ZwQueryInformationProcess <br>InfoClass = 7<br>3. ERROR_NUMBER = 5002<br>FindWindowA<br>FindWindowExA<br>FindWindowW<br>FindWindowExW<br>4. ERROR_NUMBER = 5001<br>CreateFileA - drivers<br>5. ERROR_NUMBER = 5017<br>ZwQuerySystemInformation<br>6. ERROR_NUMBER = 8002<br>CheckRemoteDebuggerPresent <br>7. ERROR_NUMBER = 8008<br>HeapFlag<br>8. ERROR_NUMBER = 8009<br>NtGlobalFlag<br>9. ERROR_NUMBER = 8010 <br>IsDebuggerPresent ???? maybe some more checks<br>10 ERROR_NUMBER = 8007<br>ZwQueryObject ????<br><br>... почти уверен, что 8010 вызывается не только из-за IsDebuggerPresent<br>Вот собственно и все, что смог узнать. Версия 7.29.0008 (Protection_ID 5.2с) с отладчиком выплевывает ошибку 8010. Уверен, кто-то справлялся с этим делом, может подскажите куда рыть? =)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=155197&amp;user=4895&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=18" class="addthx" data-post="155197"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2007 19:47 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#19');return false;">#19</a> </span><div align=left><br>
<I>SniperOK пишет:<br>Уверен, кто-то справлялся с этим делом, может подскажите куда рыть? </I><br>...на самом деле всё можно сделать гораздо проще,не заморачиваясь со всевозможными антиотладочными трюками.Надо только немного попрограммировать.<br>Главной наводкой здесь является то,что почти любая программа вызывает одной из первых функцию GetModuleHandleA.Подумайте,как это можно использовать,а потом напишите что-то вроде loader&#039;а.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=155264&amp;user=1613&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=19" class="addthx" data-post="155264"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Dream[/b]','')">Dream</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.91'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=6073">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2007 18:40 <br><script type="text/javascript">QU('Dream','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dream" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=9282&amp;page=2#20');return false;">#20</a> </span><div align=left><br>
<I>Mavlyudov пишет:<br>The linear sector density of Securom discs is very different to the density of normal cdr(w)s. This can be measured by timing reads on the cd. The following image shows the density of a Securom disc (red) compared to a normal disc (green). </I><br><br>Кто смотрел, в 7-ой версии все тоже самое? Новых фишек проверки диска нет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=159874&amp;user=6073&amp;forum_n=13&amp;topic=9282&amp;page=2&amp;anchor=20" class="addthx" data-post="159874"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=9282&amp;page=1.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=9282&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=9282&amp;page=1.html">2</a> . <b>3</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> unpack securom</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#21" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="9282">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=9282" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
