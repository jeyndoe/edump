<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите разобраться - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Эта прога &quot;ОГНИ&quot; используется мной по прямому назначению. Это бухгалтерская программа, куда как легде и проще 1с. И это находка для того, кто не имеет бухгалтерии, а сам выступает во всех качествах. Но надоело, что не">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+4 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите разобраться</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 мая 2006 20:49 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Эта прога &quot;ОГНИ&quot; используется мной по прямому назначению. Это бухгалтерская программа, куда как легде и проще 1с. И это находка для того, кто не имеет бухгалтерии, а сам выступает во всех качествах. Но надоело, что не выходит так как она не зарегистрирована сохранять деклорации на магнитных носителях. Исполняемыз файл был упакован UPX.
<br>Я его распаковал, правда не стал выкидывать мусор. Он теперь открывается на всех машинах. В Дасме отлично видно место, где прога проверяет рег.данные:
<br>:004EA228 33D2                    xor edx, edx
<br>:004EA22A 8B4050                  mov eax, dword ptr [eax+50]
<br>:004EA22D E87630F7FF              cal1 0045D2A8 - процедура сравнения
<br>:004EA232 6AOO                    push 00000000
<br>:004EA234 668BOD48A24EOO          mov cx, word ptr [004EA248]
<br>:004EA23B B201                    mov d1, 01
<br>* Possible StringData Ref from Data 0bj -&gt;&quot;Bвeдитe пapoль&quot; (при неудачной регистрации)
<br>I
<br>:004EA23D B854A24EOO              mov eax, 004EA254
<br>:004EA242 E88D67F7FF              cal1 004609D4
<br>:004EA247 C3                      ret
<br>
<br>Если войти в процедуру проверки 004EA22D CALL 0045D2A8, то мы имеем вот это:
<br>* Referenced by a CALL at Addresses:
<br>|:00487A97   , :00488096   , :00488A87   , :004893B3   , :004893CA
<br>|:0048941A   , :004BED3F   , :004BEE1F   , :004BF247   , :004BF65E
<br>|:004EA22D   , :005566BC   , :005568AB   , :005E4FFD   , :005E54EO
<br>|:005E57AF   , :005E5894   , :005E59B6   , :005E5ADA   , :005E5BFE
<br>|:005E5D3A   , :005E5E79   , :005E5FE5   , :005E6148   , :005E630E
<br>|:005E6376   , :005FA96E   , :005FAD69   , :005FAF36   , :005FAF70
<br>|:00607ADB   , :00607CCE   , :0060D5A2   , :0062C5FB
<br>I
<br>:0045D2A8 3A5038                  cmp d1, byte ptr [eax+38]
<br>:0045D2AB 7408                    je 0045D2B5 - на выход если ничего не ввел
<br>:0045D2AD 885038                  mov byte ptr [eax+38], dl
<br>:0045D2BO E867FFFFFF              cal1 0045D21C -  перед выполнением этой процедуры &quot;d edx&quot; (виден введенный мной но видоизмененный рег.код, а под ним, после прочей рег.информации сгенерированный код.
<br>* Referenced by a (U)nconditional or (C)onditiona1 Jump at Address:
<br>|:0045D2AB(C)
<br>I
<br>:0045D2B5 C3                      ret
<br>
<br>Код всякий раз генерится новый и не понял я где он именно генерится. А если не видеть алгоритма генерации. то он всякий раз генерится не верно. Я не прошу взломать за меня прогу, но подскажите, где механизм генерации (с какого адреса) ну и разъяснить по возможности. почему так - где я прошляпил.
<br>Саму прогу можно взять здесь:www.bonusMe.ru&#92;DEMO_GEN.HTM
<br>То. что я распаковал здесь:http://www.lombuh.narod.ru
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68619&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=1" class="addthx" data-post="68619"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 10:40 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
ace32.dll   забыл.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68795&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=2" class="addthx" data-post="68795"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 15:27 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Понял. Сейчас добавлю к архиву на народе
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68891&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=3" class="addthx" data-post="68891"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 15:46 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Ну вот, я добавил в архив неа народе все ДЛЛ и справку проги. Все должно запускаться. Нет только всяких образцов документов, конфигураций - короче всего того. что для взлома не нужно, а только добавляет вес.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68897&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=4" class="addthx" data-post="68897"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 17:10 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Pafic пишет:
<br>Все должно запускаться </I>
<br> Фиг. Нужен наверное реестр. Качаю дистр - завтра продолжу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68925&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=5" class="addthx" data-post="68925"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 19:31 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Может я конечно что проглядел или защита сработала, но никаких кодов кроме адреса 16BC10  я  не вижу. Точнее видел по другим адресам, если точки останова ставить. Т.к. в проге есть еще thread и вызов KillTimer, то ясно что поймать программу анализа будет не просто.
<br>  Пока ясно ,что введенный код хранится по адресу 16BC10, пока не нажмем кнопку регистрации.
<br> После нажатия кнопки он видимо переносится  по адресу 16BC80 и скорее всего анализируется еще до останова по 45D2A8 ( она вызывается из 0060D5A2, а не там где пароль), т.к. на стеке лежат все данные регистрации. На сегодня все!  Да - прога написана на Дельфи, но DeDe мало что выдает - жаль.
<br>  Надо бы ее дизассемблировать, чем-то, где сигнатуры  Дельфи  - завтра IDA попробую.
<br> К сожалению я краклабом слишком сильно увлекся - придется тормозить и основной деятельностью заняться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=68974&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=6" class="addthx" data-post="68974"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 мая 2006 23:59 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Мне до этого попадались проги, где все регистрационные данные и коды (вводимые и генерируемые) оказывались в одном регистре перед концом процедуры сравнения. Но. обычно это не вызывало проблем - считывается сгенеренный код и вносится куда следует. Здесь же что то не то.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69064&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=7" class="addthx" data-post="69064"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2006 13:28 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>Pafic пишет:
<br>Здесь же что то не то. </I>
<br>  Посмотрел я откуда идет на адрес 0060D5A2:
<br>
<br>0060D482   E8 0560EDFF      CALL lombuh.004E348C
<br>0060D487   84C0             TEST AL,AL
<br>0060D489   0F84 04010000    JE lombuh.0060D593
<br>
<br>  Как видишь результат в регистре ( коды на стеке) и если занопить JE, то идет сообщение про дополнительный пароль, т.е. &quot;тепло&quot;. Проверка явно не только в 004E348C идет, т.к. 10 символьный ключ регистрации и более длинный кладут в разные адреса. Короче бомби проги которые выше адреса 
<br>0060D487 - олли  там нормально все трассирует. У меня с временем напряг сильный.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69193&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=8" class="addthx" data-post="69193"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2006 13:58 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Понял. Вечером посмотрю. Спасибо
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69198&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=9" class="addthx" data-post="69198"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2006 18:08 &middot; Поправил: tundra37 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Немного посмотрел - именно это программа анализа. Все остальные вытягивают данные для анализа
<br> В анализе какую-то роль играет число 2244050784 из него еще какое-то получается. Если занопить оба входа, долго думает, но все равно ругается. Либо там пауза, либо идет расшифровка. Анализ на крипто ничего не показал - будем надеятся, что легко сломается &quot;самопальный алгоритм&quot;. Два пароля тоже радуют - по теории один нормальный тяжело ломается, а два &quot;самопальных&quot; - без проблем.
<br> число 2244050784 для ИНН=1234512345, и потом еще одно число появляется.
<br> Второй JMP должен отработать  - это доп-пароль. Так и не научился EIP править - в command-bar ошибка, а двойной клик - ноль эмоций  <img src="img/smilies/s4.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69267&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=10" class="addthx" data-post="69267"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2006 19:04 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Я менял джампы. Правда не в этих местах. Я это делал в редакторе - тоже не умею в Ольке. А трассирую в айсе. Но. кстати какоето странное число я видел в edx и в том участке кода, о котором первоначально писал. Мне кажется здесь вряд ли чтото даст занопливание так. как если защиту таким образом выключить и при этом не получить ничего в реестре, то запертые функции не активизируются. Если только и их потом &quot;доводить&quot;. А ведь они - эти самые запертые функции проверяются именно через ту процедуру, какую я давал выше - там где вызов идет из 34 мест.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69289&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=11" class="addthx" data-post="69289"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 мая 2006 19:35 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Да и еще. В проге есть место, где при попытке воспользоваться запертой функцией, выдается сообщение &quot;В бесплатной версии ограничение&quot;. Может оттуда зайти и глядишь гдето удастся пропатчить? Там хорошо видны сравнения и переходы. кроме того. там можно попробовать заменить push 00 а 01.
<br>: 005D1587 E890AEEFFF              cal1 004CC41C
<br>: 005D158C 85CO                    test eax, eax
<br>: 005D158E 7E75                    jle 005D1605
<br>: 005D1590 8B83EO020000            mov eax, dword ptr [ebx+000002E0]
<br>: 005D1596 E881AEEFFF              cal1 004CC41C
<br>: 005D159B 3B83EC020000            cmp eax, dword ptr [ebx+000002EC]
<br>: 005D15A1 7E62                    jle 005D1605
<br>: 005D15A3 A1647A6300              mov eax, dword ptr [00637A64]
<br>: 005D15A8 8BOO                    mov eax, dword ptr [eax]
<br>: 005D15AA 83B8DCOOOOOOOO          cmp dword ptr [eax+000000DC], 00000000
<br>: 005D15B1 7552                    jne 005D1605
<br>: 005D15B3 A1647A6300              mov eax, dword ptr [00637A64]
<br>: 005D15B8 8BOO                    mov eax, dword ptr [eax]
<br>: 005D15BA 80B8FD02000000          cmp byte ptr [eax+000002FD], 00
<br>: 005D15C1 7542                    jne 005D1605
<br>: 005D15C3 6AOO                    push 00000000
<br>: 005D15C5 8D55F8                  lea edx, dword ptr [ebp-08]
<br>: 005D15C8 8B83EC020000            mov eax, dword ptr [ebx+000002EC]
<br>: 005D15CE E8A18BE3FF              cal1 0040A174
<br>: 005D15D3 8B4DF8                  mov ecx, dword ptr [ebp-08]
<br>: 005D15D6 8D45FC                  lea eax, dword ptr [ebp-04]
<br>Possible StringData Ref from Data 0bj -&gt;&quot;B бecплaтнoй вepcии oгpaничeниe &quot;
<br>I
<br>: 005D15D9 BA34165DOO              mov edx, 005D1634
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69298&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=12" class="addthx" data-post="69298"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 мая 2006 00:35 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Я сейчас смотрел - правда без отладчика. только в Дасме. Отладчик на работе не держу. Второй пароль - это расширение лицензии. я правда ничего не читал о том, что там ее еще и расширить можно. А еще одно число после сгенеренных десяти символов ИНН (мне кажется) - это видимо &quot;реакция&quot; проги на постоянно введенный номер лицензии. Но. ведь где то они должны &quot;объединиться&quot;.  Иначе эти 10 символов и были бы рег.кодом.  У меня тоже на работе аврал. Сильно долго сидеть за креком не выходит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69376&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=13" class="addthx" data-post="69376"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 мая 2006 09:04 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Останов:
<br>
<br>0060D482   E8 0560EDFF      CALL lombuh.004E348C
<br>
<br>  На  стеке  ( рабочие ячейки программы )
<br>
<br>0012F2C0   0113D43C  ASCII &quot;200206001&quot;     Зашитый номер лицензии
<br>0012F2C4   011425D4  ASCII &quot;200206001&quot;     Зашитый номер лицензии
<br>0012F2C8   0113A814  ASCII &quot;1234512345&quot;   ИНН
<br>0012F2CC   011425EC  ASCII &quot;1234512345200206001&quot;  ИНН+Зашитый номер лицензии
<br>0012F2D0   0114258C  ASCII &quot;gggg34rtaaaa222fffff&quot;   рег-код
<br>0012F2D4   011425B0  ASCII &quot;gggg34rtaaaa222fffff&quot;   рег-код
<br>=============================================
<br>
<br><I>Pafic пишет:
<br>&quot;В бесплатной версии ограничение&quot;. Может оттуда зайти и глядишь гдето удастся пропатчи </I>
<br> Во-первых, я не знаю как туда попасть( напиши какую-нибудь функцию попроще - небольшой опыт работы с бух-программами есть), во-вторых, я все больше склоняюсь к мысли, что без анализа не обойтись -
<br>программа после выдачи сообщения про &quot;В бесплатной версии ограничение&quot; идет туда же, куда и без этого сообщения. Значит закрываются функции, скорее всего, через ячейки и как их открыть - угадывать надо <img src="img/smilies/s4.gif" alt="">    Пока твою задачку вынужден отложить
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69457&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=14" class="addthx" data-post="69457"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 мая 2006 17:27 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
То есть мне ставить бряк на 0012F2C0 и оттуда все смотреть в edx? То есть ты попал в жто место из 0060D482 E8 0560EDFF CALL lombuh.004E348C. Сегодня посмотрю. Заранее благодарен. Если что пиши в личку. А, тему закроем наверно - все равно здесь только наш диалог.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69523&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=15" class="addthx" data-post="69523"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 мая 2006 10:46 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Pafic пишет:
<br>и оттуда все смотреть в edx </I>
<br> Почему обязательно в EDX. Результат проверки вообще в AL  посылается. Первые 10 символов рег-кода долго лопатятся и получается другая комбинация, причем при перелопачивании используется еще один 10-ти символьный код ( он ниже по стеку появится). Потом это все еще долго мурыжится - пока никаких идей нет, а ковырятся нет сил и времени. Тему вроде смотрят - если перестанут, тогда в личку уйдем.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69681&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=16" class="addthx" data-post="69681"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 мая 2006 11:00 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Посмотрел. Да, видно. что из этих ячеек, которые ты написал, что то берется и из этого - чегото образуются вторичные пароли. Но в айсе я не рассмотрел это чтото в виде ASCII. Пробовал командой &quot;?&quot;.
<br>Потом перешел в ольку. Может я делаю в ней что не так, но видел в виде ASCII только ИНН и номер лицензии - тоесть:
<br>0012F2C0 0113D43C ASCII &quot;200206001&quot; Зашитый номер лицензии 
<br>0012F2C4 011425D4 ASCII &quot;200206001&quot; Зашитый номер лицензии 
<br>0012F2C8 0113A814 ASCII &quot;1234512345&quot; ИНН 
<br>0012F2CC 011425EC ASCII &quot;1234512345200206001&quot; ИНН+Зашитый номер лицензии 
<br>А все что ниже - рег.код не виден. Ставил бряк на адрес 0060D482 E8 0560EDFF CALL lombuh.004E348C 
<br>Пользовался для этого плагином &quot;Apibreak&quot;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69918&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=17" class="addthx" data-post="69918"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 мая 2006 15:15 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>Pafic пишет:
<br>А все что ниже - рег.код не виден </I>
<br> Специально проверил - поставил бряк по F2 - все видно.
<br> Вообще эти строки заводятся в динамической памяти, с 16 символов уже другой адрес, больше 32 - еще один. Поэтому может в твоей ОС( у меня ВИН2000) механизм выделения работает по другому и их нет на стеке. Я попытался найти, где это, но бряк по памяти бесполезен.
<br>
<br>  На всякий случай еще одно место, где  рег-код на стеке.
<br>004E345F   33C0             XOR EAX,EAX
<br>
<br>И  чуть ниже  вызов        call   004E3398
<br>
<br>004E3573   E8 20FEFFFF      CALL lombuh.004E3398
<br>
<br>   А  в  EAX - рег-код.  Если не получится, тогда совет
<br>трассируй   подпрограмму по   004E348C.
<br>  Подпрограммы  с адресом  0040хххх - пропускай - это мелкие системные.
<br> Заходи только   в  42хххх  43хххх, в какой-то из них или по ходу  в  004E348C
<br>  увидишь рег-код и его обработку. Алгоритмы вроде несложные - до выходных попробую разобрать.
<br>
<br>
<br>
<br>   решил поковырять. Вот кусок, который превращает  ИНН+Зашитый номер лицензии 
<br>  в десятизначное число. Чего там суммирует, делит на десять и по циферке собирает.
<br>004E34F9   8B45 FC          MOV EAX,DWORD PTR SS:[EBP-4]
<br>...................................................................... .................
<br>004E3535  ^7D C2            JGE SHORT lombuh.004E34F9
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69989&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=18" class="addthx" data-post="69989"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 мая 2006 20:20 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Да, у меня XP. Может и не видит что то из-за этого. Вечером поковыряю. 
<br>004E34F9 8B45 FC MOV EAX,DWORD PTR SS:[EBP-4] - посмотрю сегодня.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=70050&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=19" class="addthx" data-post="70050"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 мая 2006 12:48 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Pafic пишет:
<br>Да, у меня XP </I>
<br> При случае дома прогоню.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=70213&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=20" class="addthx" data-post="70213"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 мая 2006 13:12 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Проверил. Тот код, что начинает вычисляться циклом с адреса 004E34F9 8B45 FC MOV EAX,DWORD PTR SS:[EBP-4] - это не рег. код. Из него дальше начинаются вычисления. Всего в рег коде будет (в моем случае) 21 символ - 12 символов ИНН (физическое лицо) и 9 символов из лицензии. Причем на ИНН сначало генерится 11 символов, а 12 символ уходит к той части кода, которая на лицензию. Все кладется в EDX/ По адресу 4E3582 d edx - видны все цифры но не видно, как они должны быть расположены при вводе в прогу. Если их просто сложить (а на стеке они порознь), то выдается ошибка. Защита задумана так, чтобы в edx генерилось &quot;на дурака&quot; - в зависимости от того, как ты ввел в в прогу. Но я пока не могу отследить как именно должны быть введены эти цифры.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=70218&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=21" class="addthx" data-post="70218"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 мая 2006 13:13 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
А ты пробовал регистрировать? Получалось?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=70219&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=22" class="addthx" data-post="70219"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 мая 2006 15:09 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>Pafic пишет:
<br>это не рег. код </I>
<br> Я просто не написал. Я это все пробовал. Если бы все так просто было. Надо полностью алгоритм смотреть и наверняка рег-код явно нигде не появится. Скорее всего будут сравнивать две величины : одну сгенерированную из ИНН+лицензия и вторую из рег-кода. В этом и сложность, а иначе я бы до кода добрался уже. Время - увы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=70245&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=23" class="addthx" data-post="70245"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 мая 2006 15:22 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>Pafic пишет:
<br>это не рег. код </I>
<br> Я просто не написал. Я это все пробовал. Если бы все так просто было. Надо полностью алгоритм смотреть и наверняка рег-код явно нигде не появится. Скорее всего будут сравнивать две величины : одну сгенерированную из ИНН+лицензия и вторую из рег-кода. В этом и сложность, а иначе я бы до кода добрался уже. Время - увы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=70250&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=24" class="addthx" data-post="70250"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 мая 2006 15:51 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Да, со временем действительно туго. Я на работе имею безграничный инет. но не могу этим заниматься. Дизасемблер держу, но отладчик не могу. А может другим путем пойти - попробовать найти место, где прога считывает из реестра рег.данные и сделать так. чтобы функция всегда возвращала &quot;1&quot;. Я этим пока не занимался никогда. Кстати, как называется эта функция в винде? Правда плохо. что (или задумано так. или это я так грязно распаковал) в дизассемблере функций не видно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=70257&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=25" class="addthx" data-post="70257"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 мая 2006 16:36 &middot; Поправил: tundra37 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>Pafic пишет:
<br>) в дизассемблере функций не видно. </I>
<br> В  IDA  все  видно  :  RegOpenKeyExA, RegQueryValueExA, RegSetValueExA
<br>  regmon  показывает из интересного, только это
<br>	HKLM&#92;SOFTWARE&#92;Microsoft&#92;Cryptography&#92;RNG&#92;Seed	
<br> Программа какую-то величину генерит и пишет в реестр. Скорее всего в реестре рег-код она будет искать, когда что-то в ini будет прописано. Грамотно сделано - открытым текстом есть только Борланд, свои ключи они так не хранят. Пока рег-код не подберешь - ключи не узнаешь. Тут тема пробежала про скрипты в олли - хотел попробовать, но прога под олли перестала работать - блин <img src="img/smilies/s13.gif" alt="">
<br>++++++++++++++++++++++++++++++++++++++++++++++++++++++++
<br>  Наставил вчера бряков по Alloc - вот и сломал. Скрипт не смог, да и не нужны - там condition есть.
<br> Поставил бряки по памяти еще раз - именно по ссылкам со стека проверяют рег-код.
<br> Выяснил только,что вторая цифровая строка зависит от введенного рег-кода, т.ч. точно надо дальше ковырять. Пока плюну на трассировку и попробую все-таки DeDe нормально применить - все-таки при наличии имен  Дельфи-функции легче смотреть, что есть что.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=70276&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=26" class="addthx" data-post="70276"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 мая 2006 12:15 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>Pafic</b>
<br> В бой пошла тяжелая артиллерия, т.к. коница без толку бьется.
<br>1) Я распаковал по второму разу : вызвал  PeTools 1ю5 и увидел в нем плаг  UPXFIX. Сделал и применил распаковку UPX - получился рабочий модуль и DeDe его скушал. К сожалению сама программа проверки не воспринялась, как паскалевская(или я что-то упустил в DeDe), но вот имена всех функций теперь есть. Почему-то они в файле  events.txt, ну вроде логично. Попытаюсь либо получить паскаль, либо в IDA загнать имена - так верил в DeDe, что не стал сразу делать.<br><br><img src="img/attach.gif" alt=""> <a href="./files/9ef6_17.05.2006_CRACKLAB.rU.tgz">9ef6_17.05.2006_CRACKLAB.rU.tgz</a> - events-ogni.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=70468&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=27" class="addthx" data-post="70468"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 мая 2006 13:18 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
1) Проверки такая : читают  ИНН+лиц
<br>004E34AC  |. E8 0F0FF2FF    CALL &lt;OGNI.System.@LStrAddRef&gt;
<br>  и говорят, что все хорошо
<br>004E34BF  |. C645 F7 01     MOV BYTE PTR SS:[EBP-9],1
<br>  Потом долго, долго проверяют и находят, что что-то плохо   пишут 0 в [EBP-9]
<br>
<br>2) Наша цель, чтобы прошли поверки и дойти до основной проверки :
<br>
<br>004E35C9  |. E8 4E0DF2FF    CALL &lt;OGNI.System.@LStrCmp&gt;
<br>   Сюда она со случайными кодами не попадает.
<br>
<br>  Прикладываю прогу проверки с именами программ в  CALL. Осталось 3 подпрограммы рядышком неразобранных. Короче, потихоньку приближаемся к развязке. Теперь думаю в личку перейти можно, чтобы авторы программы не привлекли за распространение кряков <img src="img/smilies/s6.gif" alt="">
<br>
<br> 
<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/1a50_17.05.2006_CRACKLAB.rU.tgz">1a50_17.05.2006_CRACKLAB.rU.tgz</a> - Analiz.asm
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=70484&amp;user=4072&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=28" class="addthx" data-post="70484"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Pafic[/b]','')">Pafic</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3689">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 мая 2006 16:38 <br><script type="text/javascript">QU('Pafic','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Pafic" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4837.html&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
Да, это ты прав - сделано с умом. Не думал. что так станут защищать демку. Давай в личку. Хотя кряк в чистом виде мы и не распространяем, но &quot;береженого бог бережет, не береженого........&quot;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=70518&amp;user=3689&amp;forum_n=5&amp;topic=4837.html&amp;page=0&amp;anchor=29" class="addthx" data-post="70518"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите разобраться</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=4837" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
