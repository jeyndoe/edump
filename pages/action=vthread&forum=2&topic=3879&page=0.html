<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Вызов функции по ординалу - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Собственно смотрел одну прогу и на глаза попался такой код во первых интересно узнать что за функция.. и во вторых как мне допустим вызвать такую функцию в своей программе  MOV EDI,DWORD PTR DS:[403023] SHR EDI,0C PUSH 20060000">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55991'>kris_sexy</a>, <a target='_blank' href='?action=userinfo&amp;user=52433'>Wenzel</a>, <a target='_blank' href='?action=userinfo&amp;user=42610'>r0lka</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вызов функции по ординалу</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=2&amp;topic=3879&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=2&amp;topic=3879&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2006 17:11 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Собственно смотрел одну прогу и на глаза попался такой код <img src="img/smilies/s13.gif" alt="">
<br>во первых интересно узнать что за функция.. и во вторых
<br>как мне допустим вызвать такую функцию в своей программе <img src="img/smilies/s13.gif" alt="">
<br><code> 
<br>MOV EDI,DWORD PTR DS:[403023]
<br>SHR EDI,0C 
<br>PUSH 20060000
<br>PUSH 0
<br>PUSH 1
<br>PUSH EDI
<br>PUSH 1000D
<br>CALL &lt;JMP.&amp;KERNEL32.#5&gt;
<br></code>
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52477&amp;user=72&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=1" class="addthx" data-post="52477"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Bit-hack[/b]','')">Bit-hack</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/198.jpg" alt=""><br><span class=txtSm>Ранг: 303.7 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=198">Участник</a><br><font color=blue>tPORt Manager</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2006 17:19 <br><script type="text/javascript">QU('Bit-hack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bit-hack" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>Hellspawn пишет:
<br>что за йункция.. </I>
<br>А ты посмтори в kernel32.dll
<br>
<br><I>Hellspawn пишет:
<br>как мне допустим вызвать такую функцию в своей программе  </I>
<br>Посмтори в библе имя и импортируй.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52480&amp;user=198&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=2" class="addthx" data-post="52480"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2006 17:25 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Bit-hack пишет:
<br>Посмтори в библе имя и импортируй. </I>
<br>ну нету тама =&#92; там дофига функций в кернеле, которые без имени...
<br>млин знаю тока 1 извратный способ чтобы вызвать из проги...
<br>но хотелось бы нормальный <img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52482&amp;user=72&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=3" class="addthx" data-post="52482"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]infern0[/b]','')">infern0</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2006 17:39 <br><script type="text/javascript">QU('infern0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=infern0" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>Hellspawn пишет:
<br>как мне допустим вызвать такую функцию в своей программе  </I>
<br>GetProcAddress((char *)ordinal);
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52485&amp;user=36&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=4" class="addthx" data-post="52485"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ValdiS[/b]','')">ValdiS</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1263.gif" alt=""><br><span class=txtSm>Ранг: 420.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.42'>Активность: 0.24<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1263">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2006 18:59 <br><script type="text/javascript">QU('ValdiS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ValdiS" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
А как реализовать поиск ординала по имени функции (я просто не сталкивался)? Можно примерчик кода?
<br><br><font size="1"><i>-----<br>Сколько ни наталкивали на мысль – все равно сумел увернуться</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52496&amp;user=1263&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=5" class="addthx" data-post="52496"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2006 22:14 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
см. IMAGE_IMPORT_DESCRIPTOR
<br>берёшь FirstThunk (или, в зависимости от ситуации, OriginalFirstThunk) и  если присутствует IMAGE_ORDINAL_FLAG32 - значит импорт по ординалу
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52520&amp;user=1379&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=6" class="addthx" data-post="52520"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]DrGolova[/b]','')">DrGolova</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/301.jpg" alt=""><br><span class=txtSm>Ранг: 199.6 (ветеран), 12thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=301">Участник</a><br><font color=blue>www.uinc.ru</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 02:44 &middot; Поправил: DrGolova <br><script type="text/javascript">QU('DrGolova','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrGolova" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
&gt;  как реализовать поиск ординала по имени функции (я просто не сталкивался)? Можно примерчик кода?
<br>
<br>static INT GetOrdinalByName(VOID* hModule, CHAR* Name)
<br>{
<br>  IMAGE_EXPORT_DIRECTORY* ExpDir;
<br>  IMAGE_DOS_HEADER* DOS;
<br>  IMAGE_NT_HEADERS* PE;
<br>  ULONG   ExpTableRVA, I;
<br>  USHORT* OrdinalTable;
<br>  ULONG*  NameTable;
<br>  
<br>  DOS = (IMAGE_DOS_HEADER*)(hModule);
<br>  PE  = (IMAGE_NT_HEADERS*)((BYTE*)hModule + DOS-&gt;e_lfanew);
<br>  if ( 0 == (ExpTableRVA = PE-&gt;OptionalHeader.
<br>    DataDirectory[IMAGE_DIRECTORY_ENTRY_EXPORT].VirtualAddress) )
<br>  {
<br>    return(-1); /* no export table in image */
<br>  }
<br>
<br>  ExpDir = (IMAGE_EXPORT_DIRECTORY*)((BYTE*)hModule + ExpTableRVA);
<br>  OrdinalTable = (USHORT*)((BYTE*)hModule + ExpDir-&gt;AddressOfNameOrdinals);
<br>  NameTable    =  (ULONG*)((BYTE*)hModule + ExpDir-&gt;AddressOfNames);
<br>
<br>  for ( I = 0; I &lt; ExpDir-&gt;NumberOfNames; I++ )
<br>  {
<br>    if ( strcmp(Name, (CHAR*)hModule + NameTable[I]) )
<br>      continue;
<br>
<br>    return (INT)(OrdinalTable[I] + ExpDir-&gt;Base);
<br>  }
<br>
<br>  return(-1); /* not founded */
<br>}
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52537&amp;user=301&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=7" class="addthx" data-post="52537"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ValdiS[/b]','')">ValdiS</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1263.gif" alt=""><br><span class=txtSm>Ранг: 420.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.42'>Активность: 0.24<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1263">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 09:11 <br><script type="text/javascript">QU('ValdiS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ValdiS" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>DrGolova</b>
<br>Спасибо за пример, хотя лучше бы на делфях. <img src="img/smilies/s3.gif" alt=""> Хотя, ничего страшного, разберусь. <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Сколько ни наталкивали на мысль – все равно сумел увернуться</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52554&amp;user=1263&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=8" class="addthx" data-post="52554"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 12:02 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<code>
<br>CALL &lt;JMP.&amp;KERNEL32.#5&gt;</code>
<br><code>
<br>var
<br>  d1:dword;
<br>  pp:pointer;
<br>begin
<br>  d1:=GetModuleHandle(&#039;KERNEL32.dll&#039;);
<br>  pp:=GetProcAddress(d1,&#039;0005&#039;);
<br>  edit5.Text:=IntToHex(dword(pp),8);
<br></code>
<br>че я тока не передавал в GetProcAddress в качестве второго параметра...
<br>возвращает всё равно 0 <img src="img/smilies/s13.gif" alt=""> млин... может кто-нить попробует.... <img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52577&amp;user=72&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=9" class="addthx" data-post="52577"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ssx[/b]','')">ssx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 352.4 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33">Участник</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 12:56 <br><script type="text/javascript">QU('ssx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ssx" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Hellspawn пишет:
<br>pp:=GetProcAddress(d1,&#039;0005&#039;); </I>
<br>надо не &#039;0005&#039; а просто 5
<br>
<br>см. выше:
<br>GetProcAddress((char *)ordinal);
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52584&amp;user=33&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=10" class="addthx" data-post="52584"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 13:03 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>ssx пишет:
<br>надо не &#039;0005&#039; а просто 5  </I>
<br>млин =&#92;
<br><code>
<br>pp:=GetProcAddress(d1,char(5));
<br>pp:=GetProcAddress(d1,&#039;5&#039;);
<br></code>
<br>всё равно 0 возвращается... %( да чтож такое...
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52585&amp;user=72&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=11" class="addthx" data-post="52585"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]infern0[/b]','')">infern0</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 13:12 <br><script type="text/javascript">QU('infern0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=infern0" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Hellspawn пишет:
<br>pp:=GetProcAddress(d1,&#039;5&#039;); </I>
<br>
<br>ты че издеваешься ?
<br>pp:=GetProcAddress(d1,<b>5</b>);
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52587&amp;user=36&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=12" class="addthx" data-post="52587"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 13:17 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>infern0 пишет:
<br>ты че издеваешься ? 
<br>pp:=GetProcAddress(d1,5) </I>
<br>ну если бы всё так просто было +)
<br>--&gt; [Error] Unit1.pas(179): Incompatible types: &#039;Integer&#039; and &#039;PAnsiChar&#039;
<br>хм к чему бы это =&#92; ах ну да:
<br>function GetProcAddress(hModule: HMODULE; lpProcName: LPCSTR): FARPROC
<br>--&gt; lpProcName: LPCSTR ну теперь всё понятно =&#92;
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52588&amp;user=72&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=13" class="addthx" data-post="52588"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]infern0[/b]','')">infern0</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 13:44 <br><script type="text/javascript">QU('infern0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=infern0" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Hellspawn</b>
<br>бля, ну дык написал же английским по белому <b>GetProcAddress((char *)ordinal);</b>
<br>передаешь число, но надо привести тип к строке. И вообще - читай доки - они рулят !!
<br>
<br>lpProcName 
<br>[in] Pointer to a null-terminated string that specifies the function or variable name, or the function&#039;s ordinal value. If this parameter is an ordinal value, it must be in the low-order word; the high-order word must be zero.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52593&amp;user=36&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=14" class="addthx" data-post="52593"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 14:36 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
на асме всё гораздо проще ;) никаких те приведений типов ;)
<br>DWORD и усё ;)
<br>например:
<br>invoke GetProcAddress,hLib,61
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52595&amp;user=1379&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=15" class="addthx" data-post="52595"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]infern0[/b]','')">infern0</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 15:10 <br><script type="text/javascript">QU('infern0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=infern0" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>Jupiter</b>
<br>asm - Advanced Sado-Mazo
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52601&amp;user=36&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=16" class="addthx" data-post="52601"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]ssx[/b]','')">ssx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 352.4 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33">Участник</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 15:52 <br><script type="text/javascript">QU('ssx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ssx" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
баян с bash.org.ru/quote.php?num=9929  <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52613&amp;user=33&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=17" class="addthx" data-post="52613"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 16:36 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
короче я в шоке... как я тока не делал.. ну 0 и хоть ты тресни =&#92;
<br>d1:=GetModuleHandle(&#039;KERNEL32.dll&#039;);
<br><code>
<br>asm
<br>    PUSH 5h
<br>    PUSH d1
<br>    call GetProcAddress
<br>    mov pp,eax
<br>end;
<br></code>
<br>даже так.. и всё равно 0 %(
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52618&amp;user=72&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=18" class="addthx" data-post="52618"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 17:24 &middot; Поправил: Ara <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<code>
<br>procedure TForm1.Button1Click(Sender: TObject);
<br>var
<br>d1:dword;
<br>pp:pointer;
<br>begin
<br>   d1:=GetModuleHandle(&#039;KERNEL32.dll&#039;);
<br>   pp:=GetProcAddress(d1,PChar(5));
<br>   Edit1.Text:=IntToHex(DWORD(pp),8);
<br>end;
<br></code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52626&amp;user=24&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=19" class="addthx" data-post="52626"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 17:32 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
я понял =&#92; мне не везёт... да пробовал я так =(
<br>может в винде проблема... %( у меня 98...
<br>ну 0 и вот хоть тресни.... кто-нить хоть пробовал??
<br>возвращается что-нить кроме 0 ??
<br>
<br>пойду выпью йада...
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52629&amp;user=72&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=20" class="addthx" data-post="52629"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 17:35 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>Hellspawn</b>
<br>выложи сюда, чо те надо - у кого время есть исправит
<br>винда тут ни при чём
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52632&amp;user=1379&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=21" class="addthx" data-post="52632"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 17:37 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>Hellspawn пишет:
<br>я понял =&#92; мне не везёт... да пробовал я так =( 
<br>может в винде проблема... %( у меня 98... 
<br>ну 0 и вот хоть тресни.... кто-нить хоть пробовал?? 
<br>возвращается что-нить кроме 0 ?? </I>
<br>Я привел код, который возвращает не ноль.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52633&amp;user=24&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=22" class="addthx" data-post="52633"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 17:40 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
--&gt; Ара не поверишь... 0 ёпт %(
<br>
<br>мне нужно вызвать в программе функцию:
<br><code> CALL &lt;JMP.&amp;KERNEL32.#5&gt; </code>
<br>
<br>ну не возвращает GetProcAddress её адресс...
<br>если у функции есть имя.. то всё ок.. а есть передаёшь орд... то 0 возвращает...
<br>и вот хоть ты тресни...
<br><code>
<br>  d1:=GetModuleHandle(&#039;KERNEL32.dll&#039;);
<br>  pp:=GetProcAddress(d1,Pchar(5));
<br>  edit5.Text:=IntToHex(dword(pp),8);
<br>  asm
<br>    PUSH 5h
<br>    PUSH d1
<br>    call GetProcAddress
<br>    mov pp,eax
<br>  end;
<br>  edit4.Text:=IntToHex(dword(pp),8); 
<br></code>
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52635&amp;user=72&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=23" class="addthx" data-post="52635"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]DrGolova[/b]','')">DrGolova</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/301.jpg" alt=""><br><span class=txtSm>Ранг: 199.6 (ветеран), 12thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=301">Участник</a><br><font color=blue>www.uinc.ru</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 18:14 &middot; Поправил: DrGolova <br><script type="text/javascript">QU('DrGolova','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrGolova" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Ах это d1 а не dl <img src="img/smilies/s1.gif" alt="">
<br>Значит в твоем kernel32 нет функции с ординалом #5
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52640&amp;user=301&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=24" class="addthx" data-post="52640"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 18:26 &middot; Поправил: Jupiter <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
проверь на ф-ции #61 из Shell32.dll - диалог &quot;Запуск программы&quot;
<br>
<br>hShell32:=LoadLibrary(&#039;Shell32.dll&#039;);
<br>pRun:=GetProcAddress(hShell32,Pchar(61)); 
<br>
<br>P.S. используй <b>LoadLibrary</b>!
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52646&amp;user=1379&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=25" class="addthx" data-post="52646"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 18:34 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>Jupiter пишет:
<br>проверь на ф-ции #61 из Shell32.dll - диалог &quot;Запуск программы&quot; 
<br>
<br>hShell32:=LoadLibrary(&#039;Shell32.dll&#039;); 
<br>pRun:=GetProcAddress(hShell32,Pchar(5)); </I>
<br>
<br>да вернуло значение... 7FC959B0
<br>а вот с кернелом нет =( это же ппц...
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52648&amp;user=72&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=26" class="addthx" data-post="52648"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Klajnor[/b]','')">Klajnor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2708">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 18:35 <br><script type="text/javascript">QU('Klajnor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Klajnor" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
Хм... У меня работают все здесь приведённые примеры на дельфях
<br>Везде выдается вполне приличный адрес 7ххххххх
<br>
<br><I>Jupiter пишет:
<br>pRun:=GetProcAddress(hShell32,Pchar(5)); </I>
<br>А говоришь #61 =)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52649&amp;user=2708&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=27" class="addthx" data-post="52649"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Klajnor[/b]','')">Klajnor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2708">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 18:44 <br><script type="text/javascript">QU('Klajnor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Klajnor" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>DrGolova пишет:
<br>Значит в твоем kernel32 нет функции с ординалом #5 </I>
<br>Но ведь в проге, которую исследовал <b>Hellspawn</b> эта функция вызывается
<br><I>Hellspawn пишет:
<br>CALL &lt;JMP.&amp;KERNEL32.#5&gt; </I>
<br>И прога наверняка работает =)
<br>
<br><b>Hellspawn</b>, попробуй запустить такой код и скажи, что получится
<br>
<br> d1:=GetModuleHandle(&#039;KERNEL32.dll&#039;);
<br> Edit1.text:=inttostr(d1);
<br>
<br> d1:=LoadLibrary(&#039;KERNEL32.dll&#039;);
<br> Edit2.text:=inttostr(d1);
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52652&amp;user=2708&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=28" class="addthx" data-post="52652"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 18:47 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
и там и там BFF60000 =&#92;
<br>да для других то функции возвращаются адресса...
<br>блин бред какой-то =(
<br><I>Klajnor пишет:
<br>И прога наверняка работает =) </I>
<br>удивительно но прога работает...
<br>кстати в кернеле есть эта функция... посмотрите экспорт...
<br>а вот как в проге:
<br><code>
<br>0040123F   |.  68 00000620              PUSH 20060000
<br>00401244   |.  6A 00                    PUSH 0
<br>00401246   |.  6A 01                    PUSH 1
<br>00401248   |.  57                       PUSH EDI
<br>00401249   |.  68 0D000100              PUSH 1000D
<br>0040124E   |.  E8 13020000              CALL &lt;JMP.&amp;KERNEL32.#5&gt;
<br>
<br>call ведём на jmp а после
<br>
<br>846ED1D0    68 D413F6BF     PUSH KERNEL32.#8
<br>846ED1D5  - E9 E78A893B     JMP KERNEL32.BFF85CC1
<br>
<br>хм... у олли то #5 то #8 =&#92;
<br></code>
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=52654&amp;user=72&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=29" class="addthx" data-post="52654"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Klajnor[/b]','')">Klajnor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.78'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2708">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2006 19:15 &middot; Поправил: Klajnor <br><script type="text/javascript">QU('Klajnor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Klajnor" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3879&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
У меня, кернел грузится 7С800000-7С900000
<br>У этой функции даже имя есть <b>AddConsoleAliasW</b>
<br>Тока у меня по адресу <b>7C870931</b>(это мне выдала моя прога) находится совершенно другой код
<br>
<br>7C870931 &gt;   8BFF           MOV EDI,EDI                              ;  LOADDLL.00460024
<br>7C870933  /. 55             PUSH EBP
<br>7C870934  |. 8BEC           MOV EBP,ESP
<br>7C870936  |. 33C0           XOR EAX,EAX
<br>7C870938  |. 3945 0C        CMP [ARG.2],EAX
<br>7C87093B  |. 74 0A          JE SHORT kernel32.7C870947
<br>7C87093D  |. FF75 0C        PUSH [ARG.2]                             ; /String = &quot;&quot;
<br>7C870940  |. E8 F490F9FF    CALL kernel32.lstrlenW                   ; &#92;lstrlenW
<br>7C870945  |. D1E0           SHL EAX,1
<br>7C870947  |&gt; 6A 01          PUSH 1                                   ; /Arg6 = 00000001
<br>7C870949  |. FF75 10        PUSH [ARG.3]                             ; |Arg5 = 80874038
<br>7C87094C  |. 0FB7C0         MOVZX EAX,AX                             ; |
<br>7C87094F  |. 50             PUSH EAX                                 ; |Arg4 = 00000010
<br>7C870950  |. FF75 0C        PUSH [ARG.2]                             ; |Arg3 = 7FFDF000
<br>7C870953  |. FF75 08        PUSH [ARG.1]                             ; |/String = FFFFFFFF ???
<br>7C870956  |. E8 DE90F9FF    CALL kernel32.lstrlenW                   ; |&#92;lstrlenW
<br>7C87095B  |. D1E0           SHL EAX,1                                ; |
<br>7C87095D  |. 50             PUSH EAX                                 ; |Arg2 = 00000010
<br>7C87095E  |. FF75 08        PUSH [ARG.1]                             ; |Arg1 = FFFFFFFF
<br>7C870961  |. E8 ABFEFFFF    CALL kernel32.7C870811                   ; &#92;kernel32.7C870811
<br>7C870966  |. 5D             POP EBP                                  ;  kernel32.7C816D4F
<br>7C870967  &#92;. C2 0C00        RETN 0C
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=52656&amp;user=2708&amp;forum_n=2&amp;topic=3879&amp;page=0&amp;anchor=30" class="addthx" data-post="52656"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=2&amp;topic=3879&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=2&amp;topic=3879&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вызов функции по ординалу</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=3879" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
