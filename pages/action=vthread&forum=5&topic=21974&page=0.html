<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Подскажите, каким генератором лоадера такое можно сделать. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Проблема в следущем. В каждой очередной версии одной программы, приходится подменять несколько байт. Адрес подмены ищу всегда одеим и тем-же способом. Поэтому и хочется создать один &quot;универсальный для всех версий&quot;">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Подскажите, каким генератором лоадера такое можно сделать.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=21974&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=21974&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 16:20 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Проблема в следущем. В каждой очередной версии одной программы, приходится подменять несколько байт. Адрес подмены ищу всегда одеим и тем-же способом. Поэтому и хочется создать один &quot;универсальный для всех версий&quot; лоадер.<br>Способ поиска адреса и байт для патча:<br>Есть определенная текстовая сигнатура. Ищу по ней адрес. Выше этого адреса в определенном интервале ищу вторую текстовую сигнатуру. Перевожу текст этой сигнатуры в НЕХ-значение. Подставляю это хекс значение в третью, но уже нех-сигнатуру. Ищу адрес этой третьей сигнатуры . И чуть выше адреса этой третьей сигнатуры нахожу адрес места куда буду вносить нужные изменения.<br>Может сумбурно написал, но если понадобится, могу написать пример.<br>Вопрос, каким генератором лоадеров можно это осуществить, так сказать сделать &quot;умный лоадер&quot;. Тоесть какой генератор лоадеров позволит ввести такой алгоритм поиска, а не просто поиск по сигнатуре?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327883&amp;user=29098&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=1" class="addthx" data-post="327883"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 16:41 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Не проще ли взять и самому написать? Благо, лоадер пишется за 10 минут.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327888&amp;user=1556&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=2" class="addthx" data-post="327888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 16:53 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
WinHex поддерживает скрипты, можно заложить скрипт поиска. Но если не подойдёт по каким-либо причинам (не хватит функционала, неудобства, ...), то действительно проще свой написать, поскольку искать под конкретные нужды замучаешься.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327889&amp;user=24257&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=3" class="addthx" data-post="327889"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 16:55 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Archer</b><br>Насчет &quot;проще&quot;, не уверен. Для меня большая проблема, как аттачиться лоадером к проге, обойдя защиты. Потом как открыть дамп процесса, как обходить проверку црц (или хотя-бы задержку сделать). Я такое точно на асме не напишу. <br>А можно готовые лоадеры (исходники) посмотреть? Дайте ссылочки, пожалуйста. <br>Лучше если язык лоадеров будет делфи, даже пусть с &quot;асм-вставками&quot;. <br>Меня именно интересует, как запустить программу, и открыть ее виртуальную память. Ну и потом завершить лоадер не навредив процессу.<br><b>DenCoder</b><br>Да видел я в ВИН-ХЕКСе скрипты. Но никак не могу найти команду открывания RAM, запущенного процесса.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327892&amp;user=29098&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=4" class="addthx" data-post="327892"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]void[/b]','')">void</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 221.3 (наставник), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.79'>Активность: 0.19<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=2687">Участник</a><br><font color=blue></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 17:01 <br><script type="text/javascript">QU('void','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=void" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Разберешься?<br><br>делфи<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;program&nbsp;loader<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function">uses</span></li><li class="hl_l1">&nbsp;&nbsp;Windows<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">var</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_registr"><b>si</b></span>&nbsp;<span class="hl_char">:</span>&nbsp;Startupinfo<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;pi&nbsp;<span class="hl_char">:</span>&nbsp;Process_Information<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">procedure&nbsp;Patch<span class="hl_char">(</span>Address<span class="hl_char">:</span>&nbsp;Cardinal<span class="hl_comment">; PatchedBytes: Array Of Byte; OrigBytes: Array Of Byte);</span></li><li class="hl_l0">var</li><li class="hl_l1">&nbsp;&nbsp;NBW<span class="hl_char">:</span>&nbsp;Cardinal<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;Old<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>byte</b></span><span class="hl_comment">;</span></li><li class="hl_l1">begin</li><li class="hl_l0">&nbsp;&nbsp;ReadProcessMemory<span class="hl_char">(</span>pi<span class="hl_char">.</span>hProcess<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span>Address<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@Old<span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;NBW<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;OrigBytes<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;Old&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;WriteProcessMemory<span class="hl_char">(</span>pi<span class="hl_char">.</span>hProcess<span class="hl_char">,</span>&nbsp;Pointer<span class="hl_char">(</span>Address<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;@PatchedBytes<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Length<span class="hl_char">(</span>PatchedBytes<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;NBW<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;ResumeThread<span class="hl_char">(</span>pi<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>pi<span class="hl_char">.</span>hProcess<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>pi<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Messagebox<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span>pchar<span class="hl_char">(</span><span class="hl_quote">'Bytes not found...'</span><span class="hl_char">)</span><span class="hl_char">,</span>pchar<span class="hl_char">(</span><span class="hl_quote">'Error'</span><span class="hl_char">)</span><span class="hl_char">,</span>mb_iconinformation<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;TerminateProcess<span class="hl_char">(</span>pi<span class="hl_char">.</span>hProcess<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>pi<span class="hl_char">.</span>hProcess<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>pi<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">begin</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;CreateProcess<span class="hl_char">(</span>nil<span class="hl_char">,</span><span class="hl_quote">'target.exe'</span><span class="hl_char">,</span>nil<span class="hl_char">,</span>nil<span class="hl_char">,</span><span class="hl_function">FALSE</span><span class="hl_char">,</span>&nbsp;Create_Suspended<span class="hl_char">,</span>nil<span class="hl_char">,</span>nil<span class="hl_char">,</span><span class="hl_registr">si</span><span class="hl_char">,</span>pi<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>true</b></span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Patch<span class="hl_char">(</span><span class="hl_char">$</span><span class="hl_number">00000001</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_char">$</span>FF<span class="hl_char">,</span>&nbsp;<span class="hl_char">$</span>FF<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function">end</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br>масм:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_number">586</span></li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_function"><b>model</b></span>&nbsp;<span class="hl_function">flat</span><span class="hl_char">,</span><span class="hl_function">stdcall</span></li><li class="hl_l1"><span class="hl_function"><b>option</b></span>&nbsp;casemap<span class="hl_char">:</span><span class="hl_function">none</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_char">\</span>masm32<span class="hl_char">\</span>include<span class="hl_char">\</span>windows<span class="hl_char">.</span><span class="hl_function">inc</span></li><li class="hl_l0"><span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_char">\</span>masm32<span class="hl_char">\</span>include<span class="hl_char">\</span>user32<span class="hl_char">.</span><span class="hl_function">inc</span></li><li class="hl_l1"><span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_char">\</span>masm32<span class="hl_char">\</span>include<span class="hl_char">\</span>kernel32<span class="hl_char">.</span><span class="hl_function">inc</span></li><li class="hl_l0"><span class="hl_function"><b>includelib</b></span>&nbsp;<span class="hl_char">\</span>masm32<span class="hl_char">\</span>lib<span class="hl_char">\</span>user32<span class="hl_char">.</span>lib</li><li class="hl_l1"><span class="hl_function"><b>includelib</b></span>&nbsp;<span class="hl_char">\</span>masm32<span class="hl_char">\</span>lib<span class="hl_char">\</span>kernel32<span class="hl_char">.</span>lib</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_function">data</span></li><li class="hl_l0">FileName&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">&quot;crackme.exe&quot;</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1">Error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">&quot;Process could not started!&quot;</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">Startup&nbsp;STARTUPINFO&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span></li><li class="hl_l0">processinfo&nbsp;PROCESS_INFORMATION&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_function">data</span><span class="hl_char">?</span></li><li class="hl_l1">hInstance&nbsp;HINSTANCE&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">ByteBuf&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_function">code</span></li><li class="hl_l0">start<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;GetModuleHandleA<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;hInstance<span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;CreateProcess<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;FileName<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;CREATE_SUSPENDED<span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;Startup<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;processinfo</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;MessageBox<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;Error<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;MB_ICONEXCLAMATION</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;patch</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function">endif</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;ExitProcess<span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">patch&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;hWnd<span class="hl_char">:</span>&nbsp;<span class="hl_function">DWORD</span></li><li class="hl_l0"><span class="hl_function"><b>LOCAL</b></span>&nbsp;tmp<span class="hl_char">:</span>&nbsp;<span class="hl_function">byte</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_patch&nbsp;<span class="hl_function"><b>macro</b></span>&nbsp;_pos<span class="hl_char">,</span>&nbsp;_byte</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>mov</b></span>&nbsp;tmp<span class="hl_char">,</span>&nbsp;_byte</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;WriteProcessMemory<span class="hl_char">,</span>&nbsp;processinfo<span class="hl_char">.</span>hProcess<span class="hl_char">,</span>&nbsp;_pos<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;tmp<span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;ByteBuf</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;ResumeThread<span class="hl_char">,</span>&nbsp;processinfo<span class="hl_char">.</span>hThread</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">endm</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">_patch&nbsp;<span class="hl_number">00000001h</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFh</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">ret</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">patch&nbsp;<span class="hl_function">endp</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>end</b></span>&nbsp;start</li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>xchg dword [eax], eax</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327895&amp;user=2687&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=5" class="addthx" data-post="327895"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29098" title="18-07-2013 14:36, ранг:15.2" target="_blank">Kuzya69</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 17:07 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>void</b><br>Спасибо. Попробую понять.<br><br>Так получается, что лоадер, который на Делфи, не запускает прогу, а атачится уже к запущенной? А как бы посмотреть на лоадер, который еще и запускает прогу, атачится к ней, исправляет байты в памяти процесса, и отключается от проги?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327896&amp;user=29098&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=6" class="addthx" data-post="327896"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 17:32 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Kuzya69 пишет:<br>Так получается, что лоадер, который на Делфи, не запускает прогу, а атачится уже к запущенной?  </I><br>С чего такие умозаключения? а CreateProcess там на что?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327898&amp;user=5291&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=7" class="addthx" data-post="327898"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 18:06 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>Vovan666</b><br>Извиняюсь, бегло посмотрел. Привык, что основной код вверху, а процедуры внизу.<br><br>Извиняюсь, а как поисковики по сигнатуре пишутся в готовых лоадерах?<br>Они всю память процесса копируют в массив, а потом в массиве ищут? Или побайтно делают ReadProcessMemory? Или еще есть какие приемы в плане, размер-быстродействие?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327902&amp;user=29098&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=8" class="addthx" data-post="327902"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]void[/b]','')">void</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 221.3 (наставник), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.79'>Активность: 0.19<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=2687">Участник</a><br><font color=blue></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 19:27 &middot; Поправил: void <br><script type="text/javascript">QU('void','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=void" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Kuzya69 пишет:<br>Они всю память процесса копируют в массив, а потом в массиве ищут? Или побайтно делают ReadProcessMemory? Или еще есть какие приемы в плане, размер-быстродействие?  </I><br>Ненадо ничто никуда копировать, работаешь напрямую с памятью.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">function&nbsp;dwFindPattern<span class="hl_char">(</span>dwAddress<span class="hl_char">,</span>&nbsp;dwLen<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>DWORD</b></span><span class="hl_comment">; bMask: PByte; szMask: Pointer): DWORD;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span></li><li class="hl_l0">&nbsp;&nbsp;function&nbsp;bDataCompare<span class="hl_char">(</span>pData<span class="hl_char">,</span>&nbsp;bMask<span class="hl_char">:</span>&nbsp;PByte<span class="hl_comment">; szMask: Pointer): Boolean; </span></li><li class="hl_l1">&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>While</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_function">Byte</span><span class="hl_char">(</span>szMask^<span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">)</span>&nbsp;Do</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>If</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_function">Byte</span><span class="hl_char">(</span>szMask^<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">Byte</span><span class="hl_char">(</span><span class="hl_quote">'x'</span><span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_char">(</span>pData^&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span>&nbsp;bMask^<span class="hl_char">)</span>&nbsp;Then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>false</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pData&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;PByte<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">(</span>pData<span class="hl_char">)</span><span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bMask&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;PByte<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">(</span>bMask<span class="hl_char">)</span><span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;szMask&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;Pointer<span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">(</span>szMask<span class="hl_char">)</span><span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">Byte</span><span class="hl_char">(</span>szMask^<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span></li><li class="hl_l0">var</li><li class="hl_l1">&nbsp;&nbsp;i<span class="hl_char">:</span>&nbsp;Integer<span class="hl_comment">;</span></li><li class="hl_l0">begin</li><li class="hl_l1">&nbsp;&nbsp;result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;For&nbsp;i&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;To&nbsp;dwLen<span class="hl_char">-</span><span class="hl_number">1</span>&nbsp;Do</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>If</b></span>&nbsp;bDataCompare<span class="hl_char">(</span>PByte<span class="hl_char">(</span>dwAddress<span class="hl_char">+</span>i<span class="hl_char">)</span><span class="hl_char">,</span>bMask<span class="hl_char">,</span>szMask<span class="hl_char">)</span>&nbsp;Then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;dwAddress<span class="hl_char">+</span>i<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Ищем:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">var</li><li class="hl_l1">&nbsp;&nbsp;cAddress<span class="hl_char">:</span>&nbsp;Cardinal<span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function">const</span></li><li class="hl_l1">&nbsp;&nbsp;baVtablePattern<span class="hl_char">:</span>&nbsp;array<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_number">13</span><span class="hl_char">]</span>&nbsp;of&nbsp;<span class="hl_function"><b>Byte</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">$</span>C7<span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">06</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">89</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">86</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">00</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">89</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">86</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;sigVTableMask<span class="hl_char">:</span>&nbsp;PChar&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">'xx????xx????xx'</span><span class="hl_comment">;</span></li><li class="hl_l1">begin</li><li class="hl_l0">&nbsp;&nbsp;cAddress<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;dwFindPattern<span class="hl_char">(</span>GetModuleHandleA<span class="hl_char">(</span><span class="hl_quote">'d3d9.dll'</span><span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_number">828000</span><span class="hl_char">,</span>@baVtablePattern<span class="hl_char">,</span>sigVTableMask<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>PS: надеюсь следующим твоим вопросом не будет &quot;ребят, я чет туплю, напишите за меня&quot;
<br><br><font size="1"><i>-----<br>xchg dword [eax], eax</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327905&amp;user=2687&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=9" class="addthx" data-post="327905"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 19:39 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Напрямую с памятью, видимо, имеется в виду, что уже в адресном пространстве нужного процесса код. В общем случае проще считать в буфер и искать там.<br>А вообще все эти вопросы ни о чём уже томили, топик-кандидат на закрытие. Лень открыть гугл и поглядеть описание 2-3 функций в мсдн?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327906&amp;user=1556&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=10" class="addthx" data-post="327906"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 19:48 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>void</b> , <b>Archer</b><br>Ну не пинайте, я понимаю, надоел. Но это мой первый лоадер. Раньше с готовыми &quot;делалками лоадеров&quot; <br>занимался. Поэтому и вопрос был про готовый генератор. Но тут тема резко сменила свое направление. И стала еще более интересной.<br>Спасибо вам, что помогаете.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327908&amp;user=29098&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=11" class="addthx" data-post="327908"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]void[/b]','')">void</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 221.3 (наставник), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.79'>Активность: 0.19<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=2687">Участник</a><br><font color=blue></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 20:00 <br><script type="text/javascript">QU('void','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=void" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Archer пишет:<br>Напрямую с памятью, видимо, имеется в виду, что уже в адресном пространстве нужного процесса код. В общем случае проще считать в буфер и искать там. </I><br>Спорно, зачем делать ненужную работу, когда можно <br><i class=x>уже в адресном пространстве нужного процесса</i><br><br><I>Kuzya69 пишет:<br>Ну не пинайте, я понимаю, надоел. Но это мой первый лоадер. Раньше с готовыми &quot;делалками лоадеров&quot; <br>занимался. Поэтому и вопрос был про готовый генератор. Но тут тема резко сменила свое направление. И стала еще более интересной. </I><br>Сейчас у тебя есть почти все готовое. Осталось это соеденить воедино и тестировать.
<br><br><font size="1"><i>-----<br>xchg dword [eax], eax</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327912&amp;user=2687&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=12" class="addthx" data-post="327912"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 21:25 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>void</b>, а как твоя функция dwFindPattern окажется в адресном пространстве нужного процесса, чтобы можно было, как ты выражаешься:<br><I>void пишет:<br>работаешь напрямую с памятью. </I><br>...а?
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327918&amp;user=1613&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=13" class="addthx" data-post="327918"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=6336" title="18-07-2013 18:59, ранг:522.1" target="_blank">ARCHANGEL</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июля 2013 21:46 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
самый функциональный патч-мэйкер, умеет делать и лоадеры<br>http://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=8207&amp;page=0
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327923&amp;user=5291&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=14" class="addthx" data-post="327923"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]void[/b]','')">void</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 221.3 (наставник), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.79'>Активность: 0.19<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=2687">Участник</a><br><font color=blue></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2013 16:12 <br><script type="text/javascript">QU('void','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=void" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>DillerInc пишет:<br>...а?  </I><br>ring0, лол
<br><br><font size="1"><i>-----<br>xchg dword [eax], eax</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327961&amp;user=2687&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=15" class="addthx" data-post="327961"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2013 16:32 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>DillerInc пишет:<br>void, а как твоя функция dwFindPattern окажется в адресном пространстве нужного процесса, чтобы можно было, как ты выражаешься: </I><br>Одним из способов<br>1) перевести в базонезависимый асм-код на асме и внедрить в процесс<br>2) перевести в асм-код, подсчитать необходимые смещения и внедрить в процесс<br>3) перенести функцию в shared-секцию и подгрузить shared-секцию в процесс (Recommended)
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327963&amp;user=24257&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=16" class="addthx" data-post="327963"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2013 16:50 &middot; Поправил: DillerInc <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Похоже, что влияние клерка не проходит бесследно...
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327966&amp;user=1613&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=17" class="addthx" data-post="327966"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2013 16:55 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>Kuzya69 пишет:<br>Они всю память процесса копируют в массив, а потом в массиве ищут? </I><br>самый простой способ. еще файл с диска возможно считать/отмапить, если ReadProcessMemory напрягает <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327967&amp;user=8830&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=18" class="addthx" data-post="327967"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2013 17:06 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
если делается generic loader, то:<br>сначала читаем файл -&gt; ищем искомое место (по сигнатуре или как нибудь еще) -&gt; RVA to VA минус imagebase -&gt; CreateProcess SUSPENDED -&gt; [Ebx+8] получаем imagebase процесса, добавляем найденное ранее место для патча -&gt; патчим -&gt; ResumeThread -&gt; ExitProcess
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327968&amp;user=5291&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=19" class="addthx" data-post="327968"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2013 17:16 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>DillerInc</b><br><br>О чём тут вообще речь, не понимаю <img src="img/smilies/s13.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327969&amp;user=33727&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=20" class="addthx" data-post="327969"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=8830" title="19-07-2013 14:32, ранг:158.0" target="_blank">ajax</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2013 18:14 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<i class=x><b>ajax пишет:</b></i><br><i class=x><b>файл с диска возможно считать/отмапить</b></i><br>А можно ссылочку на аналогичный код?<br><i class=x><b>Vovan666 пишет:</b></i><br><i class=x><b>...сначала читаем файл -&gt; ищем искомое место (по сигнатуре или как нибудь еще) -&gt; RVA to VA минус imagebase -&gt; CreateProcess SUSPENDED -&gt; ...</b></i><br>Сам файл упакован и распаковывается в памяти. Искать сигнатуры и вычислять место патча приходится именно в памяти. Или я вас неправильно понял?<br><b>void</b><br>Спасибо за примеры кода. пробую разобраться, почему я не могу считать определенную область из памяти в буфер. Вернее ReadProcessMemory в последнем параметре выдает, что считал например 10 байт, но при попытке перезаписать эти байты из буфера в файл или вывести на печать, срабатывают эксепшоны:<br>1) Application Error<br>    Exception EExternalException in module ntdll.dll at 0000e4ff. External exception C0000008.<br>2) Application Error<br>    Exception EAccessViolation in module Loader1.exe at 00005924. Access violation at address 00405924 in module &#039;Loader1.exe&#039;. Write of address 63206D59.<br>Видимо я или с адресацией напутал, или с типами переменных. Не думайте, я не прошу написать за меня код. Попробую сам разобраться, как правильно пользоваться этими АПИ, и как работать с памятью процесса, спасибо и за то, что вы уже выложили.<br>Я просто поясняю почему &quot;затих&quot;.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327970&amp;user=29098&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=21" class="addthx" data-post="327970"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2013 18:28 &middot; Поправил: ajax <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>Kuzya69 пишет:<br>Сам файл упакован и распаковывается в памяти </I><br>только из памяти тогда. валится - что-то из параметров не так пользуешь.<br>стоп. а как ты узнаешь, что он уже в памяти типа распаковался?<br><br>добавил: тогда все уже рассказали, кодь
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327971&amp;user=8830&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=22" class="addthx" data-post="327971"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Kuzya69[/b]','')">Kuzya69</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.16'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29098">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2013 18:39 &middot; Поправил: Kuzya69 <br><script type="text/javascript">QU('Kuzya69','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kuzya69" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<i class=x><b>ajax пишет:</b></i><br><i class=x><b>а как ты узнаешь, что он уже в памяти типа распаковался?</b></i><br>Ставлю паузу. Когда использую готовый лоадер, то и 3-х секунд для паузы хватает, чтоб потом правильно пропатчить.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;CreateProcess<span class="hl_char">(</span>nil<span class="hl_char">,</span><span class="hl_quote">'exper.exe'</span><span class="hl_char">,</span>nil<span class="hl_char">,</span>nil<span class="hl_char">,</span><span class="hl_function">FALSE</span><span class="hl_char">,</span>Create_Suspended<span class="hl_char">,</span>nil<span class="hl_char">,</span>nil<span class="hl_char">,</span><span class="hl_registr">si</span><span class="hl_char">,</span>pi<span class="hl_char">)</span><span class="hl_char">=</span><span class="hl_function"><b>true</b></span>&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ResumeThread<span class="hl_char">(</span>pi<span class="hl_char">.</span>hThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleep<span class="hl_char">(</span><span class="hl_number">4000</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadProcessMemory<span class="hl_char">(</span>pi<span class="hl_char">.</span>hProcess<span class="hl_char">,</span>Pointer<span class="hl_char">(</span>Address<span class="hl_char">)</span><span class="hl_char">,</span>@Old<span class="hl_char">,</span><span class="hl_number">10</span><span class="hl_char">,</span>NBW<span class="hl_char">)</span><span class="hl_comment">;  </span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327973&amp;user=29098&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=23" class="addthx" data-post="327973"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 июля 2013 22:49 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>DillerInc пишет:<br>Похоже, что влияние клерка не проходит бесследно... </I><br>Ой, и меня посчитали <img src="img/smilies/s5.gif" alt=""><br><br><I>Kuzya69 пишет:<br>Ставлю паузу. Когда использую готовый лоадер, то и 3-х секунд для паузы хватает </I><br>В зависимости от языка, на котором писалась прога, в начале обязательно вызываются специфические ф-ции. Даже после распаковки. VirtualAlloc, например, но не факт. Перехватывая её, мы знаем что уже всё распаковалось.<br><br>Ну в этом духе более точнее )
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327982&amp;user=24257&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=24" class="addthx" data-post="327982"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]ADMIN-CRACK[/b]','')">ADMIN-CRACK</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 27.8 (посетитель), 51thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.88'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17877">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2013 05:20 &middot; Поправил: ADMIN-CRACK <br><script type="text/javascript">QU('ADMIN-CRACK','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ADMIN-CRACK" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
В тему вопрос.<br>Вот если я нахожу имя файла<br><br>MSIMG32 proc hInstDLL:DWORD<br><br>    fn GetModuleFileName,0,OFFSET fName,128h<br>    fn CreateFile,[OFFSET fName],GENERIC_READ,0,0,OPEN_EXISTING,0,0<br>    MOV[FileHandle],EAX<br>    fn GetFileSize,[FileHandle],0<br>    CMP EAX,1E6F30h<br>    JNZ @EXIT<br>    fn CloseHandle,[FileHandle]<br>    fn GetModuleFileName,0,OFFSET fName,256h<br>    fn LoadLibrary,OFFSET fName<br>    ADD EAX,2BFCD0h<br>    MOV EBX,EAX<br>    fn VirtualProtect,EBX,4h,PAGE_EXECUTE_READWRITE,ADDR old_addr<br>    MOV BYTE PTR DS:[EBX],033h<br>    MOV BYTE PTR DS:[EBX+1],0C0h<br>    MOV BYTE PTR DS:[EBX+2],040h<br>    MOV BYTE PTR DS:[EBX+3],0C3h<br>   @EXIT:<br>    MOV EAX,1<br>    LEAVE<br>    RETN 2Ch<br><br>MSIMG32 Endp<br><br>Это заголовок библы.<br>как там пропатчить по сигнатуре?<br>С лодырем понятно все.<br>А с загружаемой библы не совсем.<br>Буду благодарен за советы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327987&amp;user=17877&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=25" class="addthx" data-post="327987"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]NikolayD[/b]','')">NikolayD</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 189.9 (ветеран), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.36'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24529">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2013 07:08 <br><script type="text/javascript">QU('NikolayD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NikolayD" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>ADMIN-CRACK</b>, на форуме уже кто-то давно выкладывал исходник, поищи.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327989&amp;user=24529&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=26" class="addthx" data-post="327989"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2013 10:20 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>ADMIN-CRACK</b><br>у автора dup2 было что-то фришное на масме для поиска паттернов<br><br>PS: так не красивее? <img src="img/smilies/s1.gif" alt=""><br><br>ADD EAX,2BFCD0h<br>push eax<br>fn VirtualProtect,EAX,4h,PAGE_EXECUTE_READWRITE,ADDR old_addr<br>pop  eax<br>MOV DWORD PTR [EAX],0C340C033h<br>fn VirtualProtect,EAX,4h,old_addr,ADDR tmp_addr ; не забывай возвращать аттрибуты<br><br>@EXIT:<br>xor eax,eax<br>inc eax<br>LEAVE<br>RETN 2Ch
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=327993&amp;user=8830&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=27" class="addthx" data-post="327993"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2013 10:29 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>ajax пишет:<br>у автора dup2 было что-то фришное на масме для поиска паттернов </I><br>в аттаче<br><br><img src="img/attach.gif" alt=""> <a href="./files/afd4_20.07.2013_EXELAB.rU.tgz">afd4_20.07.2013_EXELAB.rU.tgz</a> - d2k_patchengine.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327994&amp;user=5291&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=28" class="addthx" data-post="327994"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]ADMIN-CRACK[/b]','')">ADMIN-CRACK</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 27.8 (посетитель), 51thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.88'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17877">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2013 20:27 &middot; Поправил: ADMIN-CRACK <br><script type="text/javascript">QU('ADMIN-CRACK','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ADMIN-CRACK" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>ajax</b><br>Благодарю. <img src="img/smilies/s1.gif" alt=""><br>Это уже есть в принципе давно.<br>Это я так со старого исходника на скорую руку вставил.<br><br><b>Vovan666</b><br>Этим  давно пользуюсь для патча екзешки.<br>Дьявол сам не сделал такой штуки без помощи отдельного файла с шаблоном.<br>Мне интересно немного другое.<br>Поиск сигнатур в памяти.<br>У меня подгружаемая длл, и из неё при старте проги нужно найти косяк и устранить его.<br>Собственно вопрос как, найти в памяти этого проца эти данные.<br>А как исправить это не вопрос.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=328184&amp;user=17877&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=29" class="addthx" data-post="328184"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 июля 2013 21:45 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21974&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>ADMIN-CRACK</b><br><br>я под это когда-то адаптировал этот исходник<br>http://www.manhunter.ru/assembler/261_postroenie_karti_pamyati_processa.html<br><br>грубо говоря после<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">@@<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span>mbi<span class="hl_char">.</span>Protect<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">40h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; PAGE_EXECUTE_READWRITE</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@f</li>        </ol>
    </div>
</div></div>
<br><br>добавил readprocessmemory и там уже искал
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=328188&amp;user=5291&amp;forum_n=5&amp;topic=21974&amp;page=0&amp;anchor=30" class="addthx" data-post="328188"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=21974&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=21974&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Подскажите, каким генератором лоадера такое можно сделать.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="21974">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=21974" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
