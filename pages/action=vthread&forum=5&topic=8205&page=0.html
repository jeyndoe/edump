<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Нужна помощь в создании кейгена! - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Имеется программа, ключ в которой генерится в зависимости от железа и программного обеспечения, поэтому при изменении конфигурации компа прога слетает. А автор проги - человек довольно жадный - для приобретенной у него проги">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=5602'>ut2004</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Нужна помощь в создании кейгена!</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2007 13:01 <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Имеется программа, ключ в которой генерится в зависимости от железа и программного обеспечения, поэтому при изменении конфигурации компа прога слетает. А автор проги - человек довольно жадный - для приобретенной у него проги бесплатно высылает только 3 ключа, а за каждый последующий хочет 400 рублей. Но я немного увлекся, короче место в программе где генерится ключ активации, я нашел, прогу зарегистрировал. Но не хочется каждый раз в отладчике искать этот номер. Подскажите пожалуйста, как создать кейген или подправить прогу чтобы она сама выводила в окно или в файл этот номер. Вот это место:<br><br>00512D2A   |.  E8 5568FEFF          CALL 004F9584<br>00512D2F       8B45 EC                 MOV EAX,DWORD PTR SS:[EBP-14]  ;здесь в EAX загружается адрес по которому находится правильный ключ <br>00512D32       8D55 F0                 LEA EDX,DWORD PTR SS:[EBP-10]<br>00512D35       E8 8264EFFF          CALL 004091BC<br><br>Это место прогамма проходит несколько раз, в результате после появления первого окна ключа в памяти уже не найти. Заранее благодарен за ответы, желательно поподробнее!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127922&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=1" class="addthx" data-post="127922"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Dr3d[/b]','')">Dr3d</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/7074.jpg" alt=""><br><span class=txtSm>Ранг: 68.0 (постоянный), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7074">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2007 13:22 <br><script type="text/javascript">QU('Dr3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr3d" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
&quot;Прогу в студию&quot; (ц)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127926&amp;user=7074&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=2" class="addthx" data-post="127926"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2007 15:01 <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Прога тяжеловатая 700 Мб. Сам ехе - 1.9 Мб могу выслать на мыло или выложить куда-нибудь, если подскажете куда.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127937&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=3" class="addthx" data-post="127937"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Dr3d[/b]','')">Dr3d</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/7074.jpg" alt=""><br><span class=txtSm>Ранг: 68.0 (постоянный), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7074">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2007 15:21 &middot; Поправил: Dr3d <br><script type="text/javascript">QU('Dr3d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr3d" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Там можно свой код вписать, если сам не можешь,  давай exe`шник, попробую сделоть
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127938&amp;user=7074&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=4" class="addthx" data-post="127938"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2007 16:43 <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Выложил exe&#039;шник на webfile.ru<br>Упакован RAR, размер 663 кб. Ссылка:<br>webfile.ru/1352840
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127948&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=5" class="addthx" data-post="127948"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]1nn0cent[/b]','')">1nn0cent</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 123.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.45'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1161">Участник</a><br><font color=blue>1nn0$/100</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 марта 2007 20:40 <br><script type="text/javascript">QU('1nn0cent','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=1nn0cent" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>wasmkv пишет:<br>00512D2F </I><br>После этого адреса делай JMP на свой код, который выведет серийник в файл или куда там тебе надо. После кода делай JMP обратно, только не забудь то что затрешь восстановить.
<br><br><font size="1"><i>-----<br>Blame the victim!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=127985&amp;user=1161&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=6" class="addthx" data-post="127985"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2007 12:40 <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Если можно то поподробнее, а то я так и пытался сделать но Windows XP не позволяет восстановить затертые байты во время работы программы. Возможно я что-то не так делаю, посколько ассемблер знаю плохо. Если не трудно, пожалуйста, напишите код, который копирует серийник в буфер и восстанавливает затертые байты <br><br><b>00512D2F       E9 205D0000            JMP 00518A54 </b><br>00512D34       90                             NOP<br>00512D35       E8 8264EFFF             CALL 004091BC<br><br>00518A44       0000                    ADD BYTE PTR DS:[EAX],AL ; пустое место (буфер) в програме для серийника<br>00518A46       0000                    ADD BYTE PTR DS:[EAX],AL<br>----- ----<br>00518A52       0000                    ADD BYTE PTR DS:[EAX],AL<br><b>00518A54       60                       PUSHAD</b>                     ;   место для кода<br><br>Огромнейшее человеческое спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=128067&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=7" class="addthx" data-post="128067"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]1nn0cent[/b]','')">1nn0cent</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 123.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.45'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1161">Участник</a><br><font color=blue>1nn0$/100</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 марта 2007 17:46 <br><script type="text/javascript">QU('1nn0cent','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=1nn0cent" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>wasmkv</b>, короче на скорую руку сделал. Смотри. Правь как надо.<br>revenge.crackdb.com/_users/1nn0cent/VAGScan4P2.rar
<br><br><font size="1"><i>-----<br>Blame the victim!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=128097&amp;user=1161&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=8" class="addthx" data-post="128097"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 марта 2007 12:09 &middot; Поправил: wasmkv <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Большое спасибо за код. Извиняюсь за назойливость, но хотелось немножко коментариев.<br><br>00518A44    60                              PUSHAD<br>00518A45    6A 00                         PUSH 0                               ; Arg4 = 00000000<br>00518A47    6A 00                         PUSH 0                               ; Arg3 = 00000000<br>00518A49    50                              PUSH EAX                           ; Arg2<br>00518A4A    6A 00                         PUSH 0                               ; Arg1 = 00000000<br>00518A4C    E8 BA7A8577            CALL user32.77D7050B                 ; user32.77D7050B<br>00518A51    61                             POPAD<br>00518A52    8D55 F0                    LEA EDX,DWORD PTR SS:[EBP-10]<br>00518A55    E8 6207EFFF             CALL 004091BC<br>00518A5A    E9 D8A2FFFF             JMP 00512D37<br><br>Если я правилно понял то копирование происходит с помощью команды CALL user32.77D7050B. Если можно поподробнее о том какие параметры передаются этой функции (что такое Arg1, Arg2, Arg3, Arg4).<br>Буду очень благодарен, если подскажете, где можно почитать об этой (и не только) библиотеках, желательно на русском языке. Спасибо еще раз.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=128190&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=9" class="addthx" data-post="128190"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]1nn0cent[/b]','')">1nn0cent</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 123.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.45'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1161">Участник</a><br><font color=blue>1nn0$/100</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 марта 2007 14:50 <br><script type="text/javascript">QU('1nn0cent','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=1nn0cent" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Это MessageBoxA. Я просто показал как вывести на экран серийник. Дальше сам. Например, вместо вызова MessageBoxA сделай копирование в буффер. Как это делать рассказывать не буду, ибо не знаю, а МСДН рулит, но мне читать лень ибо незачем.
<br><br><font size="1"><i>-----<br>Blame the victim!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=128212&amp;user=1161&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=10" class="addthx" data-post="128212"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2007 12:08 &middot; Поправил: wasmkv <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
C MessageBoxA разобрался, спасибо. В Windows XP без SP работает,  MessageBox появляется 8 раз. В Windows XP SP2, возникли некоторые проблемы, но это не важно. Получается то, с чего начал, а именно, остался открытым вопрос - <b>можно ли Windows XP SP2 восстановить затертые переходом оригинальные  байты  по тому же самому адресу.</b> В качестве примера:<br><br>Оригинальные<br><br>00512D32     8D55 F0                 LEA EDX,DWORD PTR SS:[EBP-10]<br>00512D35     E8 8264EFFF             CALL 004091BC<br><br>Измененные<br><br>00512D32    E9 0D5D0000             JMP 00518A44   ;переход на мой код на свободное место<br>00512D37    90                      NOP<br>00512D38    90                      NOP<br>00512D39    90                      NOP<br><br>А после выполнения кода возможно ли в Windows XP SP2, чтобы по адресу 00512D32 был не JMP 00518A44, а как в оригинале,  <br><br>00512D32     8D55 F0                 LEA EDX,DWORD PTR SS:[EBP-10]<br>00512D35     E8 8264EFFF             CALL 004091BC<br><br>чтобы программа больше не попадала на мой код.<br>Если возможность такая есть, то пожалуйста подскажите как это сделать. Спасибо за ответ.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=128328&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=11" class="addthx" data-post="128328"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2007 12:36 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>wasmkv пишет:<br>00512D32 E9 0D5D0000 JMP 00518A44 ;переход на мой код на свободное место </I><br><br>ну а по адресу 00518A44 пишешь<br>mov dword [00512D32],0E8F0558D<br>mov dword [00512D36],0FFEF6482<br>------| замуты с серийником |------<br>  ************************<br>-------------------------------------------<br>jmp 00512D32
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=128330&amp;user=3232&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=12" class="addthx" data-post="128330"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]1nn0cent[/b]','')">1nn0cent</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 123.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.45'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1161">Участник</a><br><font color=blue>1nn0$/100</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2007 13:57 <br><script type="text/javascript">QU('1nn0cent','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=1nn0cent" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Можно. Смотри пост <b>PE_Kill</b>&#039;а<br>Но опять-таки не понимаю зачем... Посмотри как сделал я: то что хатерто джампом написал после своего кода. И все. И никаких проблем.
<br><br><font size="1"><i>-----<br>Blame the victim!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=128346&amp;user=1161&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=13" class="addthx" data-post="128346"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2007 14:10 <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Я делал уже так, только что попробовал еще раз без замутов с серийником:<br><br>00518A44    60                        PUSHAD<br>00518A45    C705 322D5100 8D55F0E8    MOV DWORD PTR DS:[512D32],E8F0558D<br>00518A4F    C705 362D5100 8264EFFF    MOV DWORD PTR DS:[512D36],FFEF6482<br>00518A59    61                        POPAD<br>00518A5A    E9 D8A2FFFF               JMP 00512D37<br><br>В результате Windows XP SP2 матерится:<br><b>Access violation at address 00518A45 in module &#039;VAGScan4.exe&#039;. Write of address 00512D32.</b><br><br>И Олька тоже <br><b>Access violation when writing to [00512d32]- Use Shift+F7/F8/F9 to pass exeption to program.</b><br><br>Короче тупик полный.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=128349&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=14" class="addthx" data-post="128349"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2007 14:29 &middot; Поправил: wasmkv <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>1nn0cent пишет:<br>... не понимаю зачем... Посмотри как сделал я: то что хатерто джампом написал после своего кода.</b><br>Во первых:<br>получается 8 MessageBox_ов, которые надо закрывать.<br>Во вторых:<br>чтобы не разбираться и рипать процедуру генерации серийника, хочу прочитать его по конкретному адресу с помощью к примеру SignOfMisery, поскольку кроме железа и програмного обеспечения серийник зависит и от рег номера поставляемого на CD.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=128353&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=15" class="addthx" data-post="128353"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]MilitaryMan[/b]','')">MilitaryMan</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 14.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.46'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9415">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2007 17:19 &middot; Поправил: MilitaryMan <br><script type="text/javascript">QU('MilitaryMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MilitaryMan" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>wasmkv</b><br><br>00512D2A |. E8 5568FEFF CALL 004F9584 <br>00512D2F 8B45 EC MOV EAX,DWORD PTR SS:[EBP-14] ;здесь в EAX загружается адрес по которому находится правильный ключ <br>00512D32 8D55 F0 LEA EDX,DWORD PTR SS:[EBP-10] <br>00512D35 E8 8264EFFF CALL 004091BC<br><I>1nn0cent пишет:<br>wasmkv пишет: <br>00512D2F <br>После этого адреса делай JMP на свой код, который выведет серийник в файл или куда там тебе надо. После кода делай JMP обратно, только не забудь то что затрешь восстановить. </I><br><I>PE_Kill пишет:<br>wasmkv пишет: <br>00512D32 E9 0D5D0000 JMP 00518A44 ;переход на мой код на свободное место <br><br>ну а по адресу 00518A44 пишешь <br>mov dword [00512D32],0E8F0558D <br>mov dword [00512D36],0FFEF6482 <br>------| замуты с серийником |------ <br>************************ <br>------------------------------------------- <br>jmp 00512D32 </I><br><br>Всё правильно, за исключекнием того, что: НАДО ДОБАВИТЬ (чисто алгоритм):<br>1. Перед прыжком В НЕИСПОЛЬЗУЕМОЕ/ПУСТОЕ место записываешь 0 или 1 (или чё хошь)<br>2. Собственно сам прыжок<br>3. Проверка на то, что прыжок первый (это та переменная из п.1)<br>4.1. Если да - замуты с серийником + INC переменной, определенной ранее (п.1) + прыжок на п.5<br>4.2. Нет - прыжок на п.5<br>5. Тот код, что затер<br>6. Возврат (прыжок) на продолжение<br><br>Примерно такую конструкцию заюзал, когда делал регистратор для игр с новой защитой от мэйла (ведь опыта в написании кейгена тоже ёк). Правда замутов с ошибкой не было, поэтому проверку на первый это прыжок или нет - не делал
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=128585&amp;user=9415&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=16" class="addthx" data-post="128585"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]1nn0cent[/b]','')">1nn0cent</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 123.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.45'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1161">Участник</a><br><font color=blue>1nn0$/100</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 марта 2007 03:58 <br><script type="text/javascript">QU('1nn0cent','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=1nn0cent" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>wasmkv пишет:<br>получается 8 MessageBox_ов, которые надо закрывать. </I><br>Это скорее всего от того, что код проврки используется в туевой хуче мест.  Посмотри внимательней пост <b>PE_Kill</b>&#039;a. И запиши в моем коде на место старый код. Тогда все будет ок, и МессагеБокс вылезет один раз.
<br><br><font size="1"><i>-----<br>Blame the victim!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=128681&amp;user=1161&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=17" class="addthx" data-post="128681"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 марта 2007 09:52 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>wasmkv пишет:<br>Access violation at address 00518A45 in module &#039;VAGScan4.exe&#039;. Write of address 00512D32. </I><br><br>попробуй поставить на эту секцию флаг записи <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=128705&amp;user=72&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=18" class="addthx" data-post="128705"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2007 10:12 &middot; Поправил: wasmkv <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>1nn0cent пишет:<br>Посмотри внимательней пост PE_Kill&#039;a. И запиши в моем коде на место старый код. Тогда все будет ок, и МессагеБокс вылезет один раз. </I><br>Да я так и хотел, после первой проверки вернуть код на свое прежнее место. Но возникают проблемы с записью в память.<br><I>Hellspawn пишет:<br>попробуй поставить на эту секцию флаг записи  </I><br>Подскажите пожалуйста, как это сделать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=128954&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=19" class="addthx" data-post="128954"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2007 11:28 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>wasmkv</b> По-моему ты перемудрил. Для того чтобы узнать серийник нужна правленная программа.<br> После того как узнал серийник - берешь оригинальную прогу и вперед. Какие еще права на запись в секцию ?!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=128967&amp;user=4072&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=20" class="addthx" data-post="128967"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 марта 2007 17:07 <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>tundra37 пишет:<br>wasmkv По-моему ты перемудрил. Для того чтобы узнать серийник нужна правленная программа.  </I><br>Приходится мудрить, потому что не получается. Сегодня столкнулся с новой проблемой, нормально работающая правленная программа хотя и с 8 MessageBox&#039;ами на одной машине, отказывается работать на другой. Прога выдает сообщение:<br><b> Access violation at address 00000000. Read of address 00000000.</b><br><br>00513F5F    8B45 EC                MOV EAX,DWORD PTR SS:[EBP-14]<br><b>00513F62    E9 B95F0000     JMP 00519F20       ; внесенные изменения в прогу выделены<br>00513F67    90                        NOP<br>00513F68    90                        NOP<br>00513F69    90                        NOP</b><br>00513F6A    8B55 F0               MOV EDX,DWORD PTR SS:[EBP-10]<br><br><br><b>Мой код</b><br><br>00519F20    60                          PUSHAD<br>00519F21    6A 00                     PUSH 0                                            ; /Style = MB_OK|MB_APPLMODAL<br>00519F23    68 409F5100         PUSH 00519F40                               ; |Title = &quot;Key&quot;<br>00519F28    50                          PUSH EAX                                        ; |Text<br>00519F29    6A 00                     PUSH 0                                            ; |hOwner = NULL<br>00519F2B    E8 C2658577         CALL user32.MessageBoxA             ; \MessageBoxA<br>00519F30    61                          POPAD<br>00519F31    8D55 F0                 LEA EDX,DWORD PTR SS:[EBP-10]  ;это затертые JMP&#039;ом команды в проге<br>00519F34    E8 3BF2EEFF          CALL 00409174                              ;это затертые JMP&#039;ом команды в проге<br>00519F39    E9 29A0FFFF          JMP 00513F6A<br>00519F3E    00                          DB 00<br>00519F3F    00                          DB 00<br>00519F40    4B 65 79 00           ASCII &quot;Key&quot;,0<br><br>Может я ошибаюсь, но мне кажется, что это может происходить из-за того MessageBoxA на разных машинах грузится по различным адресам.  Как это можно обойти и заставить работать на других компах ???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=129028&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=21" class="addthx" data-post="129028"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2007 12:44 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>wasmkv пишет:<br>Как это можно обойти и заставить работать на других компах  </I><br> На других машинах не работает, т.к. тебе дали &quot;черновой&quot; вариант.<br> У тебя вбит вызов 00519F2B E8 C2658577 CALL user32.MessageBoxA ; \MessageBoxA <br> в котором зашит конкретный адрес. На другом сервис-паке и другой ОС, адрес другой.<br> По хорошему надо искать в таблице импорта и ставить обращение туда.<br> С твоим уровнем тебе в запросы на взлом надо или жди добрую душу <img src="img/smilies/s6.gif" alt=""><br> Либо изготавливай кейген &quot;по черному&quot; на каждой из машин.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=129162&amp;user=4072&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=22" class="addthx" data-post="129162"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2007 15:59 &middot; Поправил: wasmkv <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>tundra37 пишет:<br>С твоим уровнем тебе в запросы на взлом надо или жди добрую душу  </I><br><br>Спасибо за ответ, но вместо отправлять в запросы на взлом, лучше дали бы ссылочку где об этом можно почитать. Это все таки одна из нескольких взломаных мной программ. И запрос я запостил в раздел Вопросы новичков ибо в запросах на взлом я свой уровень повысить не смогу, а хочется все-таки самому    научиться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=129188&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=23" class="addthx" data-post="129188"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2007 16:26 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Как вариант (внимательно не читал, сорри) можно &quot;затертые&quot; байты выполнить на стеке - вряд ли они скора запретят там выполнение кода...
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=129194&amp;user=8962&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=24" class="addthx" data-post="129194"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 марта 2007 19:13 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>wasmkv пишет:<br>дали бы ссылочку где об этом можно почитать </I><br> Вся информация в разделе &quot;Новичку&quot;. Какую ссылку ? Про импорт, про патчи ? Число программ вовсе не говорит про уровень - ты азбуки не знаешь. Тупо делаешь что-то, не понимая смысл.<br>  В конце концов взял бы просто и посмотрел на отладчике, как &quot;заплатка&quot; отрабатывает на другой машине - сразу все увидел бы.  А у тебя сплошные вопросы и бездействие. Так долго учится будешь.<br>&quot;Глубже копайте - там золото&quot;.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=129223&amp;user=4072&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=25" class="addthx" data-post="129223"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2007 10:47 &middot; Поправил: wasmkv <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>tundra37 пишет:<br>На других машинах не работает, т.к. тебе дали &quot;черновой&quot; вариант </I><br>Этот черновой вариант я правил сам  в Ольке и код CALL user32.MessageBoxA мне выдал отладчик. А ошибку свою я понял. Ошибся в том, что понадеялся что Windows XP SP2 устанавливался на обе машины с одного диска, а на другой машине не было  отладчика. Когда разобрался, то исправил. Все оказалось очень даже просто и оригинально, без всяких JMP  и восстановления затертых команд. Ниже привожу код, правда из более новой версии программы:<br><br>00513F5A    .  E8 5568FEFF           CALL 004FA7B4                               ; оригинал<br>00513F5F    .  8B45 EC                  MOV EAX,DWORD PTR SS:[EBP-14]  ; оригинал<br><br>00513F62    .  8B15 38325200     MOV EDX,DWORD PTR DS:[&lt;&amp;user32.MessageBoxA&gt;]; адрес из таблицы импорта<br>00513F68    .  6A 00                     PUSH 0                               ; /Style = MB_OK|MB_APPLMODAL<br>00513F6A    .  68 803F5100         PUSH 00513F80                  ; |Title = &quot;Key&quot;<br>00513F6F    .  50                          PUSH EAX                           ; |Text<br>00513F70    .  6A 00                     PUSH 0                               ; |hOwner = NULL<br>00513F72    .  FFD2                      CALL EDX                             ; \MessageBoxA<br>00513F74    .  8B15 EC315200     MOV EDX,DWORD PTR DS:[&lt;&amp;kernel32.Exi&gt;;  адрес kernel32.ExitProcess из таблицы импорта<br>00513F7A    .  6A 00                     PUSH 0                               ; /ExitCode = 0<br>00513F7C    .  FFD2                      CALL EDX                             ; \ExitProcess<br>00513F7E    .  90                          NOP<br>00513F7F    .  90                          NOP<br>00513F80    .  4B                          DEC EBX                               ; заголовок окна<br>00513F81    .  65790000              DD 00007965                       ; &#039;Key&#039;<br><br> Осталось только сделать лоадер с помощью diablo2oo2&#039;s Universal Patcher [dUP], который проделает эту работу в памяти, дабы уменьшить размер кейгена.<br><br><b>Огромное СПАСИБО</b> всем, кто хоть как-то пытался помочь. Особая благодарность <b>1nn0cent</b>,<b>PE_Kill</b> и также <b>tundra37</b>.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=129329&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=26" class="addthx" data-post="129329"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]wasmkv[/b]','')">wasmkv</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.2 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9138">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 марта 2007 08:57 <br><script type="text/javascript">QU('wasmkv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wasmkv" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8205.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
Cделал лоадер, кейген получился размером всего 9216 байт. Работает естественно с установленной программой. Программа называется VAG-ScanXP v4.2. Если кому надо обращайтесь в личку. Тему закрываю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=129505&amp;user=9138&amp;forum_n=5&amp;topic=8205.html&amp;page=0&amp;anchor=27" class="addthx" data-post="129505"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Нужна помощь в создании кейгена!</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=8205" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
