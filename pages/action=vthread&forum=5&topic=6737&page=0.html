<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как узнать функцию-обработчик таймера по HWND окна? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Помогите советом: иследую программу CollMate, которая по истечении некоторого одинакого времени самозакрывается.  Значит виноваты таймеры  Ставлю бряки на SetTimer и получаю такое 0012FD4C  001701F8 |hWnd = 001701F8">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=5602'>ut2004</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как узнать функцию-обработчик таймера по HWND окна?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]amely[/b]','')">amely</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.35'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2006 10:52 <br><script type="text/javascript">QU('amely','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=amely" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Помогите советом: иследую программу CollMate, которая по истечении некоторого одинакого времени самозакрывается. <img src="img/smilies/s4.gif" alt=""> <br>Значит виноваты таймеры <img src="img/smilies/s1.gif" alt=""><br><br>Ставлю бряки на SetTimer и получаю такое<br><br>0012FD4C   001701F8  |<b>hWnd = 001701F8</b> (class=&#039;TPUtilWindow&#039;)<br>0012FD50   00000001  |TimerID = 1<br>0012FD54   00027100  |Timeout = 160000. ms<br>0012FD58   00000000  <b>Timerproc = NULL</b><br><br>Как найти процедуру обработки таймера?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=102921&amp;user=4001&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=1" class="addthx" data-post="102921"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]hell[/b]','')">hell</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 27.7 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.22'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4523">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2006 11:05 <br><script type="text/javascript">QU('hell','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hell" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
На чём прога написана?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=102926&amp;user=4523&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=2" class="addthx" data-post="102926"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]asd[/b]','')">asd</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 162.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.58'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3241">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2006 11:06 <br><script type="text/javascript">QU('asd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=asd" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Ожидание таймера осуществляется с помощью Wait функций (WaitForSingle(/Multiple)object). Если вызываются Wait функций попробуй у них поставить параметр dwMilliseconds 	в -1.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=102927&amp;user=3241&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=3" class="addthx" data-post="102927"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]amely[/b]','')">amely</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.35'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2006 12:47 <br><script type="text/javascript">QU('amely','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=amely" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>hell пишет:<br>На чём прога написана? </I><br>на Delphi<br><br>При схеме, когда Timerproc = NULL и есть hWnd, класс окна должен наследовать функцию OnTimer(TimerID). Я так понимаю, что система каждые Timeout  миллисекунд <br>1. Посилает меседж окну с определенными параметрами - я думаю это и есть наш случай<br>2. Вызывает callback функцию, это когда Timerproc != NULL<br><br>Возможно ли в олли поставить фильтр на SendMessage/PostMessage окну c указаным hWnd и узнать их обработчика?<br><br><br><I>asd пишет:<br>Ожидание таймера осуществляется с помощью Wait функций (WaitForSingle(/Multiple)object) </I><br>Спасибо за идею. Но как я узнаю функция ожидает таймер, а не скажем семафор? И как узнать по HANDLE узнать TimerID?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=102950&amp;user=4001&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=4" class="addthx" data-post="102950"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]asd[/b]','')">asd</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 162.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.58'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3241">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2006 13:21 <br><script type="text/javascript">QU('asd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=asd" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>amely</b><br>Сори я что-то вообще не отех таймерах подумал. А на счёт твоего случая я никогда не пользовался сам и не сталкивался. Но если верить MSDN то:<br> &quot;If lpTimerFunc is NULL, the system posts a WM_TIMER message to the application queue. The hwnd member of the message&#039;s MSG structure contains the value of the hWnd parameter. &quot;<br>из чего следует(если мне мой жуткий английский не изменяет<img src="img/smilies/s14.gif" alt=""> ), что тебе надо искать обработку сообщения WM_TIMER в оконной процедуре.<br>P.S.<br>А ты пробовал в Timeout при SetTimer загнать -1, или вместо Timerproc = NULL поставить адрес своего обработчика таймера.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=102954&amp;user=3241&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=5" class="addthx" data-post="102954"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]amely[/b]','')">amely</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.35'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2006 13:41 <br><script type="text/javascript">QU('amely','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=amely" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>asd пишет:<br>что тебе надо искать обработку сообщения WM_TIMER в оконной процедуре. </I><br>клас у меня есть  - class=&#039;TPUtilWindow&#039;, теперь попробую <b>RegisterClassEx</b> чтобы выяснить адрес оконной процедуры и там уже буду искать обработку сообщения WM_TIMER<br><br><br><I>asd пишет:<br>А ты пробовал в Timeout при SetTimer загнать -1, или вместо Timerproc = NULL поставить адрес своего обработчика таймера. </I><br>Нет не пробовал. Хотя попробовать надо <img src="img/smilies/s1.gif" alt=""> НО, возможно эти таймера еще чего полезного делают, кроме очередной проверки на подлинность копии <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=102958&amp;user=4001&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=6" class="addthx" data-post="102958"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]hell[/b]','')">hell</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 27.7 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.22'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4523">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2006 22:27 &middot; Поправил: hell <br><script type="text/javascript">QU('hell','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hell" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>amely</b><br>Возьми DeDe или SourceResourcer и посмотри адрес функции таймера потом в Olly ставь бряк на этот адрес.<br><br>Кинь ссылку на прогу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=102997&amp;user=4523&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=7" class="addthx" data-post="102997"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]amely[/b]','')">amely</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.35'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2006 06:21 <br><script type="text/javascript">QU('amely','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=amely" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>hell пишет:<br>Возьми DeDe или SourceResourcer и посмотри адрес функции таймера </I><br>пока что не знаю как <img src="img/smilies/s4.gif" alt=""><br><br><I>hell пишет:<br>Кинь ссылку на прогу. </I><br><br><b>Collmate 1.34.2.73 unpacked and partly cracked</b> <img src="img/smilies/s1.gif" alt=""> - вылетает через приблизительно 3 минути, даже ничего не надо делать, запустить, подождать и бац - проги нет <img src="img/smilies/s6.gif" alt=""><br><br>rapidshare.com/files/1831815/collmate.rar.html  - только exe<br><br>инсталл здесь _http://www.sidency.com/download/collmate-en.exe (1,1 Mb)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=103043&amp;user=4001&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=8" class="addthx" data-post="103043"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]hell[/b]','')">hell</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 27.7 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.22'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4523">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2006 03:34 <br><script type="text/javascript">QU('hell','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hell" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>amely</b><br>Ставишь бряк на адрес 5cd818 и ждешь. при закрытии прога прервется по этому адресу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=103133&amp;user=4523&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=9" class="addthx" data-post="103133"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]amely[/b]','')">amely</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.35'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 ноября 2006 13:29 <br><script type="text/javascript">QU('amely','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=amely" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>hell пишет:<br>Ставишь бряк на адрес 5cd818 и ждешь. при закрытии прога прервется по этому адресу. </I><br>Спасибо, но так и не вышел с этого адреса на оконную процедуру потому что уже выполнялась  процедура закрытия приложения. Поскольку приложение закрывалось корректно (через ExitProcess), то поставил бряки на PostQuitMessages - и сработало <img src="img/smilies/s1.gif" alt="">. Далее по Call Stack&#039;у добрался до нужного je <img src="img/smilies/s3.gif" alt="">. <br><br>На оконной процедуре вытянутой с RegisterClassEx - бряк не срабатывал <img src="img/smilies/s4.gif" alt=""> - возможно дочерние окна переопределяли свою процедуру. Но все-таки вопрос открыт: <b>Возможно ли в общем случае зная hWnd окна, класс окна, и TimerID определить обработчик события WM_TIMER в данном окне и как?</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=103257&amp;user=4001&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=10" class="addthx" data-post="103257"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2006 08:10 <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>amely пишет:<br>0012FD4C 001701F8 |hWnd = 001701F8 (class=&#039;TPUtilWindow&#039;)<br>0012FD50 00000001 |TimerID = 1<br>0012FD54 00027100 |Timeout = 160000. ms<br>0012FD58 00000000 Timerproc = NULL  </I><br>Как уже было сказано, событие таймера обрабатывает оконная проца. Судя по нестандартному классу окна ловить надо на RegisterClassEx/RegisterClass<br><br><code>ATOM RegisterClassEx(<br>    CONST WNDCLASSEX *lpwcx	// address of structure with class data<br>   );<br><br>typedef struct _WNDCLASSEX {    // wc  <br>    UINT    cbSize; <br>    UINT    style; <br>    WNDPROC lpfnWndProc; <br>    int     cbClsExtra; <br>    int     cbWndExtra; <br>    HANDLE  hInstance; <br>    HICON   hIcon; <br>    HCURSOR hCursor; <br>    HBRUSH  hbrBackground; <br>    LPCTSTR lpszMenuName; <br>    LPCTSTR lpszClassName; <br>    HICON   hIconSm; <br>} WNDCLASSEX; <br><br></code><br><br><code>ATOM RegisterClass(<br>    CONST WNDCLASS *lpWndClass 	// address of structure with class data<br>   );<br><br>typedef struct _WNDCLASS {    // wc  <br>    UINT    style; <br>    WNDPROC lpfnWndProc; <br>    int     cbClsExtra; <br>    int     cbWndExtra; <br>    HANDLE  hInstance; <br>    HICON   hIcon; <br>    HCURSOR hCursor; <br>    HBRUSH  hbrBackground; <br>    LPCTSTR lpszMenuName; <br>    LPCTSTR lpszClassName; <br>} WNDCLASS; <br><br><br></code>
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=103749&amp;user=175&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=11" class="addthx" data-post="103749"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2006 08:12 <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>amely пишет:<br>Возможно ли в общем случае зная hWnd окна, класс окна, и TimerID определить обработчик события WM_TIMER в данном окне и как? </I><br>Если не ошибаюсь, то в оконную процу придет сообщение WM_TIMER (или что-то типа того), значение константы ищи в делфи или С (или асме). Только не завидую если оконная проца скомпилена как case.
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=103750&amp;user=175&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=12" class="addthx" data-post="103750"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2006 08:53 <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Т.к. эти методы не работают (или плохо искали или что-то ещё<img src="img/smilies/s1.gif" alt=""> ), то можно спросить оконную процу с помощью след. АПИ (придется написать небольшую программку):<br><code>LONG GetWindowLong(<br>    HWND hWnd,	// handle of window<br>    int nIndex 	// offset of value to retrieve<br>   );<br></code> За подробностями - в SDK или любой доступный хэлп по WinAPI. Ещё можно поюзать готовую прогу &quot;inqsoft window scanner&quot;. Главное найти именно нужное окно, а там найдётся и Timer, если это действительно он, а не Thread <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=103759&amp;user=175&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=13" class="addthx" data-post="103759"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]amely[/b]','')">amely</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.35'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2006 04:37 <br><script type="text/javascript">QU('amely','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=amely" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>AlexZ пишет:<br>Судя по нестандартному классу окна ловить надо на RegisterClassEx/RegisterClass </I><br>Так и делал, вытягивал WNDPROC lpfnWndProc, ставил бряк - но он не срабатывал. <br><br><I>AlexZ пишет:<br>Если не ошибаюсь, то в оконную процу придет сообщение WM_TIMER </I><br>В общем это так, если быть более точным, то функция DispatchMessage вызывает оконную процедуру для конкретного сообщения и для конкретного окна (hWnd). это справедливо и для WM_TIMER, если hWnd != NULL, иначе DispatchMessage вызывает callback функцию зарегестрированную при создании таймера.<br><br><I>AlexZ пишет:<br>Т.к. эти методы не работают (или плохо искали или что-то ещё ), то можно спросить оконную процу с помощью след. АПИ (придется написать небольшую программку): <br>LONG GetWindowLong </I><br>Вот в этом наверное и соль <img src="img/smilies/s2.gif" alt="">. Каждое отдельное окно может переопределить оконную процедуру  класса на свою с помощью <b>SetWindowLong</b> или <b>SetWindowLongPtr</b> - так называемый сабклассинг. Так что буду курить <b>SetWindowLong</b> или <b>SetWindowLongPtr</b> <img src="img/smilies/s5.gif" alt=""><br><br><br><I>AlexZ пишет:<br>Ещё можно поюзать готовую прогу &quot;inqsoft window scanner&quot; </I><br>Спасибо!<br><br><br><I>AlexZ пишет:<br>Главное найти именно нужное окно, а там найдётся и Timer, если это действительно он, а не Thread  </I><br>Можно здесь поподробней об Thread. Или умеется ввиду Thread queue?<br>Если таймеры отключить (например Timeout = 16000000 ms) - то программа будет работать 16000 секунд, после чего будет вызвана OnTimer, которая и сделает нехорошее дело <img src="img/smilies/s5.gif" alt="">.  Я не совсем понимаю, как это будет проделывать поток, тоесть как Thread через указанный период времени чтото сделает. Я думаю без таймеров здесь не обойтись.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=103901&amp;user=4001&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=14" class="addthx" data-post="103901"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2006 09:45 &middot; Поправил: AlexZ <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>amely пишет:<br>Я не совсем понимаю, как это будет проделывать поток, тоесть как Thread через указанный период времени чтото сделает. Я думаю без таймеров здесь не обойтись. </I><br>Создать поток и заставить его поспать N милисекунд с помощью Sleep(N). Не исключено, что создается трэд, и в нем выполняются действия, которые по каким-то причинам нельзя побрякать.<br><code><br>// Выполняется в потоке:<br>while True do begin<br>  Sleep(N);<br>  ...<br>end;</code>
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=103953&amp;user=175&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=15" class="addthx" data-post="103953"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]amely[/b]','')">amely</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.35'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4001">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 ноября 2006 13:20 <br><script type="text/javascript">QU('amely','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=amely" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6737.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
ОК, однозначного метода как узнать функцию-обработчик таймера по HWND окна НЕТ. Можна пробовать следующие варианты:<br><br>1. Ставить бряки на RegisterClassEx/RegisterClass и вытягивать WNDPROC lpfnWndProc для класса окна. Потом в этой функции по switch(WM_XXX) искать case WM_TIMER;<br><br>2. Возможно что окно переопределит свою оконную функцию методами SetWindowLong или SetWindowLongPtr  - тогда надо ставить условные бряки на них<br><br>3. Программами &quot;inqsoft window scanner&quot; или Spy++ или подобными искать оконную процедуру конкретного окна, или использовать АПИ GetWindowLong / GetWindowLongPtr<br><br>4. Возможно событие WM_TIMER обрабатывается в message loop, тогда надо смотреть для потока в котором работает таймер код иежду GetMessage и DispatchMessage.<br><br>5. Возможно таймер только для отвода глаз, а &quot;работу&quot; выполняет некоторый поток по Sleep.<br><br>Наверное есть еще варианты, но они пока-что неизвестны мне<img src="img/smilies/s13.gif" alt="">.<br><br>Спасибо за ответы. Тему закрываю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=104901&amp;user=4001&amp;forum_n=5&amp;topic=6737.html&amp;page=0&amp;anchor=16" class="addthx" data-post="104901"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как узнать функцию-обработчик таймера по HWND окна?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=6737" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
