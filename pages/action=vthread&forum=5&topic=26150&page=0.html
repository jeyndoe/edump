<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Защищенный раб. стол - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте, ув. Профессионалы! В общем провожу исследование одной интересной программы. ------------------------------------------------------------------------------------------------------------ Описание программы: -">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=53803'>localhost1</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Защищенный раб. стол</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=26150&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=26150&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2019 14:17 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте, ув. Профессионалы! В общем провожу исследование одной интересной программы.<br>------------------------------------------------------------------------------------------------------------<br><b>Описание программы:</b><br>- программа написана на Delphi, ничем не запакована, из антиотладки вроде бы только IsDebuggerPresent<br>- назначение программы в том, чтобы воспроизводить защищенные видео-файлы.<br>------------------------------------------------------------------------------------------------------------<br><b>Описание защиты:</b><br>1-й слой:<br>- программа создает виртуальный раб. стол и уже в него помещает свой видео-проигрыватель<br>- на защищенном раб. столе скрыты все ярлыки, панель инструментов, системный трей... в общем все, кроме самого проигрывателя видео-файлов<br><br>2-й слой:<br>- программа мониторит список всех запущенных процессов и если в этом списке присутствует др. процесс, способный сделать запись видео с экрана (например, TeamViewer), то предложит закрыть его<br><br>3-й слой:<br>- на основе ID-компьютера и валидного ключа производит активацию курса через интернет<br><br>4-й слой:<br>- при воспроизведении видео с определенным интервалом времени вставляет уникальные метки, по которым можно идентифицировать пользователя<br><br>5-й слой:<br>- зашифрованные файлы - расшифровывает и воспроизводит в видео-проигрывателе<br>------------------------------------------------------------------------------------------------------------<br><b>Цель создания Темы:</b><br>- прокачать необходимые навыки исследователя, связанные с обходом 1-го слоя защиты<br>------------------------------------------------------------------------------------------------------------<br><br><b>Что уже сделано/исследовано:</b><br><br>Последовательность работы exe-файлов:<br>1. Пользователь запускает start.exe<br>2. start.exe запускает player.exe<br>3. player.exe запускает:<br>----restore.exe<br>----pctl.exe<br><br>Win API, которые используются для создания защищенного раб. стола:<br>см. в скрине:<br><noindex><a href="https://ibb.co/T2chNR9" rel="nofollow" target="_blank"> <img src="https://i.ibb.co/02qJzZH/Win-API.jpg" border="0" align="" alt=""></a></noindex><br><br>Идея по обходу защиты:<br>- идея проста - подменить имя защищенного раб. стола, которым манипулируют api на &quot;Default&quot;. То есть, после патча проигрыватель будет выводиться на текущий раб. стол, вместо защищенного<br><br>Сказано -&gt; сделано:<br>- пропатчил все exe-файлы, в которых используется уникальное имя защищенного раб. стола на &#039;Default&#039;<br><br>Тест работоспособности модифицированной программы:<br>- программа запускается -&gt; выполняется -&gt; действительно выводит окно плеера на текущий раб. стол и после этого завершается<br>- при выполнении не запускается процесс &#039;pctl.exe&#039; (а должен запускаться)<br><br>В чем возникла сложность:<br>- не знаю как дальше найти причину сбоя модифицированной программы<br><br>Архив с файлами здесь <noindex><a href="https://dropmefiles.com/qtQQI" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br>- чтобы протестировать пропатченные файлы следует распаковать архив с заменой в тот же каталог, где он находится:<br>а) start_patch.rar<br>б) \player\player_patch.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399477&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=1" class="addthx" data-post="399477"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2019 17:30 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Смотри в сторону проверки контрольной суммы, если перестало запускаться то, что должно запускаться.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399478&amp;user=1379&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=2" class="addthx" data-post="399478"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=25117" title="31-10-2019 17:55, ранг:13.0" target="_blank">rukop84</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2019 18:31 <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Без введенного ключа ничего не закрывается и &#039;pctl.exe&#039; висит. Проверь .00423A94 (ксоры-сдвиги каких-то данных в поле 16 бит) и .00431920 (напоминает црц, но это не црц, какая-то поделка, хеширующая в 32бит поле).
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399480&amp;user=8075&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=3" class="addthx" data-post="399480"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=25117" title="31-10-2019 17:55, ранг:13.0" target="_blank">rukop84</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2019 21:08 &middot; Поправил: rukop84 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>f13nd пишет:<br>Без введенного ключа ничего не закрывается и &#039;pctl.exe&#039; висит </I><br>это значит, что Вы тестируете оригинал, а не мои пропатченные файлы.<br><br>чтобы протестировать пропатченные файлы следует распаковать:<br>1) архив start_patch.rar в папку, где находится start.exe<br>2) архив player_patch.rar в папку player (где находятся файлы player.exe, restorer.exe, pctl.exe)<br><br><I>f13nd пишет:<br>и &#039;pctl.exe&#039; висит </I><br>при выполнении моих пропатченных файлов процесс &#039;pctl.exe&#039; даже не запускается (для него почему-то не вызывается CreateProcessA)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399489&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=4" class="addthx" data-post="399489"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2019 21:21 <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>rukop84 пишет:<br>это значит, что Вы тестируете оригинал, а не мои пропатченные файлы </I><br><noindex><a href="https://ibb.co/zmYMqcF" rel="nofollow" target="_blank"> <img src="https://i.ibb.co/zmYMqcF/image.png" border="0" align="" alt=""></a></noindex><br>А плеер на дефолтном рабочем столе случайно оказался?
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399490&amp;user=8075&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=5" class="addthx" data-post="399490"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 октября 2019 21:37 &middot; Поправил: rukop84 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>f13nd пишет:<br>А плеер на дефолтном рабочем столе случайно оказался? </I><br>очень интересно, а у меня все это дело закрывается (ОС Windows 7 32bit)<br><br>p.s.: если бы у меня был такой результат, то я бы считал, что первый слой защиты успешно снят<br><br><b>Добавлено спустя 1 час 14 минут</b><br>Буду выдвигать гипотезы, почему у Вас работает, а у меня закрывается. Первое наблюдение:<br>- у Вас плеер запускается на весь текущий рабочий стол, а у меня примерно на 1/4 (и после этого закрывается);<br>- когда проводил исследование приложения на использование api функций в нем была задействована WindowFromPoint (по указанной в координатах точке получает дескриптор окна). И получается, у Вас (так как окно плеера развернуто полностью) будет возвращен дескриптор окна плеера и программа корректно работает. А у меня (так как окно плеера уменьшено) будет возвращен дескриптор раб. стола, после чего произойдет исключение и программа благополучно сделает выход...<br><br>Но как проверить свою гипотезу?!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399491&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=6" class="addthx" data-post="399491"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2019 00:14 &middot; Поправил: f13nd <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Да я поигрался и с теми же симптомами стало закрывать <img src="img/smilies/s5.gif" alt=""><br>Вот здесь ему приходит WM_QUIT, поэтому форма сразу закрывается.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004818FE</span>&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EDI</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">12</span></li>        </ol>
    </div>
</div></div>
<br>Мне до этого оно в одном из тредов слалось PostMessageA&#039;м из самого player.exe (он сразу знал, что самовыпилится, но зачем-то Sleep&#039;ом ждал), теперь приходит видимо из другого процесса.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399492&amp;user=8075&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=7" class="addthx" data-post="399492"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]bartolomeo[/b]','')">bartolomeo</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.8 (посетитель), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.87'>Активность: 0.02<span style='color:green'>&nearr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=26261">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2019 02:47 &middot; Поправил: bartolomeo <br><script type="text/javascript">QU('bartolomeo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bartolomeo" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
в этом протекторе можно и без активации получить исходный файл<br><br><noindex><a href="https://dropmefiles.com/fpeSX" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399494&amp;user=26261&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=8" class="addthx" data-post="399494"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=25117" title="01-11-2019 14:43, ранг:13.4" target="_blank">rukop84</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2019 17:41 &middot; Поправил: rukop84 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>bartolomeo пишет:<br>в этом протекторе можно и без активации получить исходный файл </I><br>- поистине круто, что такое возможно и что есть люди способные это сделать<br><br>Тем не менее цель на эту Тему выставлена следующая:<br>- решить одну маленькую задачку - сделать обход защиты раб. стола<br>- и прокачать один единственный навык - умение находить и исправлять баги в программе<br>И я буду счастлив, если смогу это сделать!!!<br><br>Учитель <b>f13nd</b> что-то я застрял с поиском и исправлением багов в программе. Можете подкинуть какие-нибудь идеи в этом направлении (как и с помощью чего это делать) из своего богатого опыта?<br><br><I>f13nd пишет:<br>004818FE  CMP DWORD PTR DS:[EDI+4],12 </I><br>- данный адрес не относится к решению текущей задачи, правильно я понял? (бряк на ней не срабатывает)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399504&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=9" class="addthx" data-post="399504"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2019 18:35 &middot; Поправил: f13nd <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>rukop84 пишет:<br>данный адрес не относится к решению текущей задачи, правильно я понял? (бряк на ней не срабатывает) </I><br>У меня сейчас на WM_QUIT главное окно плеера закрывается сразу после запуска, именно после этой инструкции. Возможно пока с ключем баловался, он его куда-то сохранил и сейчас отсекается на другом чем-то.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399508&amp;user=8075&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=10" class="addthx" data-post="399508"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2019 18:45 &middot; Поправил: rukop84 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
А conditional log на какую api следует ставить, чтобы получить сообщение WM_QUIT?<br><br>Ну и вообще может есть в природе какие-то специализированные инструменты для отлова багов, генерации отчетов?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399511&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=11" class="addthx" data-post="399511"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2019 00:11 &middot; Поправил: f13nd <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>rukop84 пишет:<br>А conditional log на какую api следует ставить, чтобы получить сообщение WM_QUIT? </I><br>Отправляется обычно SendMessageA(/W), PostMessageA(/W); принимается GetMessageA(/W), PeekMessageA(/W).<br><br><I>rukop84 пишет:<br>какие-то специализированные инструменты для отлова багов, генерации отчетов? </I><br>Не представляю даже о чем речь. Сам отладчик это инструмент для отлова багов. Можно трассу снять, сравнить с трассой оригинала, наверное ты про это. Но там очень вряд ли что-то можно будет выщемить. Под любой чих прога запускает новый поток, даже если от него надо только 1 оконное сообщение отправить. А еще перед инициализацией главного окна в player.exe передается управление в огромную ноповую дорожку (подразумевается, что туда должен быть помещен какой-то код). Плохая примета.<br><br>ЗЫ: я б на твоем месте просто лодырь сделал, который бы SwitchDesktop перехватывал и возвращал TRUE. Дёшево-сердито.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399523&amp;user=8075&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=12" class="addthx" data-post="399523"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=25117" title="02-11-2019 07:05, ранг:13.4" target="_blank">rukop84</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2019 10:11 &middot; Поправил: rukop84 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>f13nd пишет:<br>ЗЫ: я б на твоем месте просто лодырь сделал, который бы SwitchDesktop перехватывал и возвращал TRUE </I><br>такое не прокатит. SwitchDesktop - эта функция только переключает управление на др. раб. стол. Др. словами, она ничего не даст: плеер все равно будет выведен на защищенный раб. стол, а управление - на текущем раб. столе.<br><br>ладно, думаю я справлюсь с задачей:<br>- как всегда проведу свою тысячу экспериментов и из них какие-то 2 или 3 сработают
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399528&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=13" class="addthx" data-post="399528"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]user99[/b]','')">user99</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 43.1 (посетитель), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 2.06'>Активность: 0.16<span style='color:green'>&nearr;</span>0.29</span><br>Статус: <a href="action=userinfo&amp;user=44014">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2019 14:24 <br><script type="text/javascript">QU('user99','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=user99" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>rukop84</b>, тогда перехват CreateDesktop и возвращать хендл от OpenDesktop(&quot;Default&quot;).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399533&amp;user=44014&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=14" class="addthx" data-post="399533"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2019 17:51 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>user99 пишет:<br>тогда перехват CreateDesktop и возвращать хендл от OpenDesktop(&quot;Default&quot;).  </I><br>особого смысла в этом нет, к тому же подобный эксперимент уже был проведен (самый первый).<br><br>На текущий момент, чтобы все заработало следует каким-то образом сделать, чтобы окно плеера на дефолтном раб. столе запускалось бы в полностью развернутом виде... или наоборот что-то изменить в коде, чтобы достаточно было и окна плеера развернутого на 1/4
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=399540&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=15" class="addthx" data-post="399540"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 ноября 2019 23:31 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Хукайте функции в рантайме. Уже полно движков, которые это могут. Вот, например, <noindex><a href="https://github.com/microsoft/Detours" rel="nofollow" target="_blank">--&gt; Detours &lt;--</a></noindex>. И патчить ничего не надо.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=399556&amp;user=6336&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=16" class="addthx" data-post="399556"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=25117" title="03-11-2019 08:30, ранг:13.8" target="_blank">rukop84</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 марта 2020 23:56 &middot; Поправил: rukop84 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
В общем провел море тестов и экспериментов, два из которых явно и однозначно указывали на это:<br><I>Jupiter пишет:<br>Смотри в сторону проверки контрольной суммы </I><br><br>После такой обратной связи все тесты с патчами прекращаются и полностью меняется подход и тактика. Теперь все изменения в программе делаются только с помощью манипуляций значениями регистров, стека и последовательностью выполнения программы (опция в дебаггере &#039;New origin here&#039;). Короче все свои действия выстраивал так, чтобы ни в памяти, ни на диске не изменялось ни одного байта программы, но при этом программа бы сделала то, что мне нужно.<br><br>Когда чувствовал, что не хватает знаний, навыков и умений - останавливался в тестах с программой, добирал необходимые знания. Сложные навыки разбивал на составляющие элементы и каждый элемент навыка осваивал на  каких-то простых понятных моделях. В общем интенсивно учился одним словом.<br><br>Просто выводить программу на дефолтный рабочий стол научился довольно быстро. Но так, чтобы еще корректно бы воспроизводилось бы видео - это у меня не шло очень длительное время. Кроме того, программа еще и многопоточная и просто с ума можно сойти каждый раз перебирая варианты и внося достаточно изменений в ход ее выполнения.<br><br>Помню даже как мне уже выть и плакать хотелось от того, что я провел несколько изнурительных месяцев работая над целью, а какого-то даже минимального результата не достиг. Ну и в общем примерно за неделю до Нового 2020 Года я так устал, что решил все бросить и хотя бы пару недель отдохнуть. Но уже за 3 дня до Н.Г. снова возвратился к программе. И, О-о-о, чудо!!! 31.12.2019 мне наконец-то удалось вывести программу на дефолтный раб. стол, так чтобы она еще и корректно воспроизводила бы видео. Помню, что особой радости не было так, как был измучен затяжной и изнурительной работой. Но результат достиг, дело сделано, поэтому отмечал Н.Г. с удовольствием.<br><br>Дальше я познакомился со скриптами и влюбился в них. Они были просты, понятны, давали возможность автоматизировать рутинные действия, позволяли преодолевать различные антиотладочные трюки и могли повелевать программой как только хочется. За счет использования скриптов я смог в разы увеличить количество проводимых тестов и экспериментов в единицу времени. А следовательно и моя скорость движения к цели теперь возросла.<br><br>Ладно, это все была лирика, теперь по делу. Проверка целостности в программе реализована примерно так:<br>- происходит чтение с диска блоками по 4096 байт. На основе этих байт считаются md5 хеши. И дальше эти значения участвуют в вычислении адресов по которым будет выполняться программа. Таких проверок несколько для нескольких процессов многопоточной программы;<br>- есть еще несколько других проверок целостности, также завязанных на чтении файла с диска;<br>- есть и проверка ключевых процедур в памяти (например, чтобы ничего не могли сделать с процедурой, которая делает чтение проверки целостности с диска);<br>- есть и проверка путей файлов, которые читает программа и, наверное, многое чего еще;<br>- в общем, как говорится, сделано на совесть<br><br>Ну, да ладно. Немного программирования на ассемблере, инлайн патч и это все решаемо. Что и было сделано.<br><br>Сейчас столкнулся с довольно интересным явлением:<br>- пропатченная программа корректно выполняется в отладчике;<br>- корректно выполняется, если ее запустить с отладчика, а затем на EP сделать Detach and exit;<br>- корректно выполняется, если ее запустить с помощью API Monitor&#039;а и в нем установить бряк на какую-нибудь api функцию (например, на IsDebuggerPresent);<br>- корректно выполняется, если инструкцию на точке входа зациклить и затем с помощью утилиты &#039;pupe&#039; вернуть на место измененные байты<br><br>!!!Но вот если просто запустить пропатченную программу (без танцев с бубуном) - то она закрывается!!!<br>Ув. Профессионалы высказывайте, пожалуйста, свои гипотезы и свое мнение на это загадачное явление. Также хорошо, если у Вас есть идеи как провести доп. тесты и эксперименты в отношении описанной особенности.<br><br>По поводу, дать посмотреть программу:<br>- ничего не выйдет. У программы есть ключи, которые привязаны к конкретному ПК. Др. словами, протестировать программу в действии у Вас не получится. Да и выкладывать пропатченную программу с такой защитой, думаю не очень корректно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403827&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=17" class="addthx" data-post="403827"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]friend[/b]','')">friend</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.2 (новичок), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.43'>Активность: 0.28=0.28</span><br>Статус: <a href="action=userinfo&amp;user=52993">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 марта 2020 01:13 <br><script type="text/javascript">QU('friend','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=friend" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Поставь int3 на call ExitProcess, законфи дебагер JIT, crash, смотри на callstack как ты туда попал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403828&amp;user=52993&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=18" class="addthx" data-post="403828"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=25117" title="10-03-2020 09:23, ранг:15.4" target="_blank">rukop84</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]_MBK_[/b]','')">_MBK_</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 63.5 (постоянный), 35thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.61'>Активность: 0.29<span style='color:green'>&nearr;</span>0.96</span><br>Статус: <a href="action=userinfo&amp;user=41701">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 марта 2020 05:32 <br><script type="text/javascript">QU('_MBK_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=_MBK_" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Это часом не vMix? А то по описанию сильно похоже <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403830&amp;user=41701&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=19" class="addthx" data-post="403830"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 марта 2020 12:21 &middot; Поправил: rukop84 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>friend пишет:<br>Поставь int3 на call ExitProcess, законфи дебагер JIT, crash, смотри на callstack как ты туда попал.  </I><br>проблема в том, что крэша никакого нет. Программа просто благополучно закрывается, не забыв еще и сбросить мои активационные данные в файле (за мои проделки с ней).<br><br>Я сейчас больше склоняюсь к мнению в том, что в программе есть еще какой-то доп. модуль защиты на целостность, который не завязан на проверке файла на диске и в памяти. Возможно, это что-то связано с потоками или с чем-то еще<br><br>Еще у меня есть предположение, что завершение программы происходит из-за какой-то нестыковки в синхронизации процессов (программа ведь многопоточная). Кроме обезвреживания проверок на целостность файла я еще отключал др. механизмы ее защиты. И отключение этих защитных процедур могло как раз таки и повлиять на работу этой программы в режиме многопоточности.<br><br><b>Добавлено спустя 2 часа 14 минут</b><br>Кстати, может кто знает какой-нибудь хороший туториал по работе со thread&#039;ами, которые создает программа. Интересует как их исследовать, изучать. Нарваха в своих руководствах говорит, что работа со средами это, мол, отдельная тема, но дальше, чем просто их замораживание он не идет.<br><br>Может в природе есть какие-то специализированные иструменты по мониторингу thread&#039;ов?!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403839&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=20" class="addthx" data-post="403839"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]friend[/b]','')">friend</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.2 (новичок), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.43'>Активность: 0.28=0.28</span><br>Статус: <a href="action=userinfo&amp;user=52993">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 марта 2020 17:11 <br><script type="text/javascript">QU('friend','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=friend" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
крэш будет когда ты инт вставишь
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403850&amp;user=52993&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=21" class="addthx" data-post="403850"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 марта 2020 18:32 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>friend пишет:<br>крэш будет когда ты инт вставишь </I><br>Можно вот в этом месте по подробней?<br>Как это делается? Надо пропатчивать файл kernel32, который у меня в системе? Сама система Windows после таких вмешательств не полетит ли?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403857&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=22" class="addthx" data-post="403857"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]_MBK_[/b]','')">_MBK_</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 63.5 (постоянный), 35thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.61'>Активность: 0.29<span style='color:green'>&nearr;</span>0.96</span><br>Статус: <a href="action=userinfo&amp;user=41701">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2020 06:59 <br><script type="text/javascript">QU('_MBK_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=_MBK_" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Не надо, полетит
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403878&amp;user=41701&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=23" class="addthx" data-post="403878"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]friend[/b]','')">friend</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.2 (новичок), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.43'>Активность: 0.28=0.28</span><br>Статус: <a href="action=userinfo&amp;user=52993">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 марта 2020 00:58 <br><script type="text/javascript">QU('friend','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=friend" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>rukop84 пишет:<br>Сама система Windows после таких вмешательств не полетит ли?  </I><br>Полетит. Надо патчить вызов в твоём модуле, на то и писал &quot;call Exitprocess&quot;, смотри не патчь импорт.<br>Увидел через какие процедуры апп выходит, поставь инты на них, смотри что делают. Нудно просто.<br><br>Вопрос странный, но у меня дежавю. Только не могу понять, кажется или было... что апп под дебагом идёт, а чисто нет. Или оно с виртуалками у меня было... хз <br><br>В конце концов вопрос ведь чем отличается среда аппа под дебагом от чистого старта.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403905&amp;user=52993&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=24" class="addthx" data-post="403905"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=25117" title="12-03-2020 09:45, ранг:15.6" target="_blank">rukop84</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 марта 2020 13:54 &middot; Поправил: rukop84 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Ага, теперь кажется уяснил суть метода. Осталось потестить на практике.<br><br><b>friend</b>, если интересно, то пока ожидал Вашего разъяснения методики придумал свой аналог тестирования. Суть его в том, что вместо патча на int3 я использовал патч eb fe, а затем просто аттачился дебаггером к зацикленному процессу и смотрел call stack.<br><br>По результатам пока следующее:<br>1. api функция ExitProccess - не сработала, также как и др. (TerminateProcess, ExitThread, TerminateThread...). А вот функция DestroyWindow уже начала давать какие-то ответы<br><br><b>Добавлено спустя 1 час 23 минуты</b><br><b>friend</b>, а есть ли у Вас идеи как можно доработать Вашу методику, чтобы крэш происходил не после 1-го вызова целевой api функции? Др. словами, чтобы 1-й раз функция выполнялась как надо,  а далее срабатывал бы крэш?<br><br><b>Добавлено спустя 1 час 47 минут</b><br><I>rukop84 пишет:<br>Осталось потестить на практике </I><br>протестировал я метод:<br>- после крэша и открытия программы в отладчике остановка происходит вовсе не на int 3 и даже не в этой процедуре, и даже в стеке нет ни одной процедуры в которой был установлен int 3!!!<br><br>Думаю, таким образом реализована одна из концепций защиты программы от ее исследования. Слишком много моментов указывают, что защита сделана здесь на очень профессиональном уровне.<br><br>Ну, да ладно. Думаю, я справлюсь. Как говорят: дорогу осилит идущий
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403921&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=25" class="addthx" data-post="403921"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]friend[/b]','')">friend</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.2 (новичок), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 0.43'>Активность: 0.28=0.28</span><br>Статус: <a href="action=userinfo&amp;user=52993">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 марта 2020 22:04 <br><script type="text/javascript">QU('friend','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=friend" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Нда я не подумал что их кастомный СЕХ хэндлер инты ловить то будет, наверно по этому не там где надо и тормозит. <br>DestroyWindow разве процессы закрывает?<br><br><I>rukop84 пишет:<br>чтобы крэш происходил не после 1-го вызова </I><br>Хуки ставить надо. Тыж инлайнит научился? Найди место в коде с нулями и напиши поверх вызова что хочешь хукать, что то вроде этого:<br>jmp CHECK<br>RET:<br>...<br>CHECK:<br>pushad<br>mov eax, [mesto]<br>cmp eax, 1<br>je VTOROJVYZOV<br>mov [mesto], 1<br>popad<br>call OriginalProcedure<br>jmp RET<br>VTOROJVYZOV:<br>eb fe
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403951&amp;user=52993&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=26" class="addthx" data-post="403951"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=25117" title="13-03-2020 09:45, ранг:16.0" target="_blank">rukop84</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 марта 2020 22:22 &middot; Поправил: rukop84 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
В общем на основе своих многочисленных тестов и экспериментов я кажется разобрался В чем дело и Что нужно сделать, но еще не до конца понимаю как это реализовать технически.<br><br>Мне требуется в определенные участки кода (в те места, где я отключал нежелательные процедуры) вставить программные задержки. Тесты с программой говорят следующее:<br>1. если в том месте, где должна быть программная задержка сделать прерывание с помощью HBP, а потом дальше продолжить выполнение, то программа корректно работает<br>2. если же в этом месте вместо hbp реализовать инлайн патч и сделать программную задержку с помощью функции Sleep, то программа благополучно закроется<br><br>Прошу участников высказывать свои идеи как реализовать программную задержку в описанном случае и почему не работает задержка с методом Sleep?!!!<br><br>Доп. информация для участников, которая возможно могла бы помочь в решении задачи:<br>- синхронизация по таймингу реализована в программе с помощью функций GetTickCount, и двух процессорных функций QueryPerformanceCounter и QueryPerformanceFrequency
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403954&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=27" class="addthx" data-post="403954"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 марта 2020 22:32 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>rukop84</b><br><br>А где семпл, ссылки битые.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=403955&amp;user=40990&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=28" class="addthx" data-post="403955"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]rukop84[/b]','')">rukop84</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 16.6 (новичок), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.22'>Активность: 0.03<span style='color:green'>&nearr;</span>0.16</span><br>Статус: <a href="action=userinfo&amp;user=25117">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 марта 2020 22:43 &middot; Поправил: rukop84 <br><script type="text/javascript">QU('rukop84','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rukop84" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>difexacaw пишет:<br>А где семпл, ссылки битые.  </I><br>Профессор ядра <b>difexacaw</b>, семпл Вы не сможете потестить:<br>- там ключи и привязка к конкретному ПК<br><br>----------------------------------------------------------------------------------------------------------------------------------<br><b>Добавлено спустя 2 часа 22 минуты</b><br><I>rukop84 пишет:<br>и почему не работает задержка с методом Sleep?!!! </I><br>в общем кажется до меня начало доходить что требуется.<br><br>Немного повторюсь с исходными данными для др. участников:<br>1. Пользователь запускает ПРОЦЕСС_01;<br>2. ПРОЦЕСС_01 запускает дочерний <b>ПРОЦЕСС_02</b>:<br>----это основной процесс;<br>----в нем сосредоточено все ДОБРО и вся АНТИОТЛАДКА, в общем почти вся защита;<br>----а еще этот процесс постепенно создает около 20 thread&#039;ов;<br>3. ПРОЦЕСС_02 запускает еще два др. процесса: ПРОЦЕСС_03 и ПРОЦЕСС_04<br><br>Мне требуется сделать программную задержку для всего ПРОЦЕССА_02, включая и те 20 tread&#039;ов, которые он создает. То есть, когда я делаю задержку для всего ПРОЦЕССА_02, я даю свободно выполниться трем др. процессам (ПРОЦЕССУ_01, ПРОЦЕССУ_03 и ПРОЦЕССУ_04).<br><br>А получается, что функцией Sleep я ввожу в спячку не весь ПРОЦЕСС_02, а только thread №1 с именем Main!!!<br><br><b>Добавлено спустя 14 часов 15 минут</b><br>----------------------------------------------------------------------------------------------------------------------------------<br><b>Немного более конкретизирую задачу:</b><br>- мне нужно сделать, чтобы <b>ПРОЦЕСС_02</b> до своей точки входа загружался как можно дольше, чтобы дать возможность ПРОЦЕССУ_01 (который его запустил) свободно выполниться.<br>Предлагайте, пожалуйста, свои идеи как это можно реализовать!!!<br>----------------------------------------------------------------------------------------------------------------------------------<br><br>Одно интересное наблюдение за выполнением программы:<br>1. зациклил я инструкцией ebfe начало одной из защитных процедур и запустил программу на выполнение. По логике ожидал, что получу ее полностью зацикленной в этой точке.<br>2. ан нет: программа оказалось зацикленной в точке и все равно корректно выполнилась (за счет реализации своих алгоритмов многопоточности)!!!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=403956&amp;user=25117&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=29" class="addthx" data-post="403956"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 марта 2020 10:11 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=26150&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>rudbkop84</b><br><br>&gt; А получается, что функцией Sleep я ввожу в спячку не весь ПРОЦЕСС_02, а только thread №1 с именем Main!!!<br><br>Ожидание может быть двух типов, либо асинхронное на основе системного времени, либо синхронное между потоками. В первом случае можно тормознуть все потоки NtSuspendProcess. Но для этого нужен второй процесс что бы разморозить. Иначе нужно локально для процесса изменить сис время. А это сложно сделать из за ядерного счётчика(USD, GetTickCount()).<br><br>&gt; Предлагайте, пожалуйста, свои идеи как это можно реализовать!!!<br><br>Ты глубоко закопался, особенно эта серия процессов и IPC.. так не делается, это занимает слишком много времени. Если апп 86(x32), то я могу собрать дий билд он вытянет из всех апп всю нужную инфу. Но для этого нужно чётко описать задачу, что конкретно нужно узнать. Копание отладчиком в приложении и удивление от увиденного не является задачей <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=404009&amp;user=40990&amp;forum_n=5&amp;topic=26150&amp;page=0&amp;anchor=30" class="addthx" data-post="404009"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=25117" title="14-03-2020 19:30, ранг:16.2" target="_blank">rukop84</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=26150&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=26150&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Защищенный раб. стол</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="26150">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=26150" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
