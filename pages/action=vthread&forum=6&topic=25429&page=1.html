<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Критерий EP. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здрасте. Меня некоторое время небыло, за это время я немного&quot; покопался в протекторах. Задача: Определение критерия EP после криптования. Задача весьма сложна, даже очень сложна. Доработан мотор для обката всяких">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40382'>jinoweb</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Критерий EP.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=25429&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=25429&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 ноября 2018 19:37 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Здрасте.<br><br>Меня некоторое время небыло, за это время я немного&quot; покопался в протекторах.<br><br>Задача:<br>Определение критерия EP после криптования.<br><br>Задача весьма сложна, даже очень сложна.<br><br>Доработан мотор для обката всяких пакеров/крипторов и прочих поделок. Смысл задачи - протектор бывает двух типов, это использующий кастомную загрузку, либо её не использующий. Это значит что до запуска оригинального образа выполняется иной образ, в пределах проекции. Изначально критерий, который определяет стартап адрес(EP) - абсолютная адресация. Первое событие абсолютной(AI) индирект выборки данных есть событие стартап образа. Но проблема в том, что для части протекторов есть аналогичное событие(релоцируемый образ).<br><br>Так например themida, privexeprot etc используют загрузчик - первый образ, он не является исходным.<br><br>Решение искалось из абстрагированной идеи что происходит загрузка двух идентичных модулей, это далее позволит возможно найти решение. События загрузки таких копий могут быть обнаружены лишь по адресным лимитам, те образ как единое целое не релоцируем, данные от кода не отличимы, а значит невозможно внедриться в промежуток между ними - декриптор может быть дописан лишь в конец образа, за пределы секций code/data. И таким образом может быть как то можно по последовательности выборок в память определить передачу управления на второй модуль(EP). Но это всё не точно.<br><br>Нужен свежий взгляд.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388663&amp;user=40990&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=1" class="addthx" data-post="388663"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2018 11:16 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<I>reversecode пишет:<br>на EP изменение энтропии<br>вычисляется динамически на большой выборке  </I><br><br>Отчетливо тянет каким-то бредом.<br>Изменение энтропии по сравнению с чем?
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388780&amp;user=31056&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=2" class="addthx" data-post="388780"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40990" title="05-11-2018 13:02, ранг:262.2" target="_blank">difexacaw</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2018 15:12 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<b>ClockMan</b><br><br>&gt; потом опять в тело прота<br><br>Не соотвествует реальности, вот лог:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;#AV&nbsp;at&nbsp;0x3AA0ACB&nbsp;to&nbsp;<span class="hl_char">[</span>0x0<span class="hl_char">]</span>&nbsp;as&nbsp;W</li><li class="hl_l0"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;NtContinue<span class="hl_char">(</span>IP': 0x3AA0AD2, EFL: 0x10246)</li><li class="hl_l1"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;#AV&nbsp;at&nbsp;0x3AA0BF5&nbsp;to&nbsp;<span class="hl_char">[</span>0x0<span class="hl_char">]</span>&nbsp;as&nbsp;W</li><li class="hl_l0"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;NtContinue<span class="hl_char">(</span>IP': 0x3AA0BFF, EFL: 0x10246)</li><li class="hl_l1"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;fault&nbsp;STATUS_BREAKPOINT&nbsp;at&nbsp;0x3A9BCDA</li><li class="hl_l0"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;NtContinue<span class="hl_char">(</span>IP': 0x3A9BCEB, EFL: 0x246)</li><li class="hl_l1"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PEB<span class="hl_char">.</span>Debugged&nbsp;at&nbsp;0x3A9BD8E</li><li class="hl_l0"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PEB<span class="hl_char">.</span>Debugged&nbsp;at&nbsp;0x3A9BDBA</li><li class="hl_l1"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;#AV&nbsp;at&nbsp;0x3A9DA0A&nbsp;to&nbsp;<span class="hl_char">[</span>0x0<span class="hl_char">]</span>&nbsp;as&nbsp;W</li><li class="hl_l0"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;NtContinue<span class="hl_char">(</span>IP': 0x3A9DA16, EFL: 0x10206)</li><li class="hl_l1"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;#AV&nbsp;at&nbsp;0x3A9F569&nbsp;to&nbsp;<span class="hl_char">[</span>0x0<span class="hl_char">]</span>&nbsp;as&nbsp;W</li><li class="hl_l0"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;NtContinue<span class="hl_char">(</span>IP': 0x3A9F573, EFL: 0x10246)</li><li class="hl_l1"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;AI<span class="hl_char">-</span>DF&nbsp;at&nbsp;0x421828&nbsp;to&nbsp;<span class="hl_char">[</span>0x43D68C<span class="hl_char">]</span>&nbsp;as&nbsp;R&nbsp;&nbsp;<span class="hl_char">,</span>&nbsp;<span class="hl_registr">dS</span><span class="hl_char">:</span>&nbsp;0x7C</li><li class="hl_l0"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x415757&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x421820</li><li class="hl_l1"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALR&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l0"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x3CC015C&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x415757</li><li class="hl_l1"><span class="hl_number">7C9466AF</span>&nbsp;&nbsp;&nbsp;&nbsp;Debug&nbsp;string<span class="hl_char">:</span>&nbsp;DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JMPI&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li>        </ol>
    </div>
</div></div>
<br><br>Даный прот своего образа не имеет, а крутит на загрузочной фазе какие то исключения и прямо из буфера передаёт управление на EP.<br><br><b>Добавлено спустя 39 минут</b><br>Я поразмыслил немного, аналитически ничего по задаче не вытянуть. Ясно только следующее:<br><br>- В пределах секции может быть релатив адресация, за пределы секций её не может быть, так как смещение изменяет загрузчик.<br><br>- В пределах образа есть абсолютная адресация, её не может быть за пределы образа.<br><br>- Пусть образа два идентичных, тогда реальна EP есть передача управления на второй образ, он всегда расположен ниже образа протектора, так как из абсолютной адресации секции должны быть восстановлены в памяти.<br><br>Тогда получается следующее. Сама AI выборка может дать пределы образа. Запуск нового модуля определиться по передаче управления за пределы первого образа. Но на основе выборки их видимо никак не различить(первый образ может настраивать второй). Есчо возможна ситуация, когда сам протектор выполняется по исходным адресам пе, затем выходит в буфер и формирует и запускает оригинальный образ.<br><br>Олли весьма кривой инструмент, как минимум при отображении образа он не использует построение областей памяти на основе их реальных значение, так в большинстве случаев либо сливает все регионы в единую область, либо вообще не может открыть образ в дампе.<br><br>У Руссиновича есть простая добрая тулза, это монитор рабочих наборов(vmmap). Через этот инструмент можно посмотреть деление на области, которые не показывает отладчик.<br><br>Видимо на этом и нужно строить реализацию. Если мы имеем таблицу областей, то можно разделить два модуля.<br><br>Изначально я подобное пытался реализовать, но закинул. Получилось что ядро нт не имеет интерфейса для быстрого дампа выделенной памяти. Можно запросить только рабочий набор. Тоесть сервис вернёт список страниц к которым произошла выборка и эти страницы добавлены в WS. Но не дёргать же это на каждой инструкции, если это вызывать после каждого сервиса, то если страница будет выделена, но небыло выборки - такое событие не будет в логе WS, память будет утеряна.<br><br>В данном случае думаю поступить просто - строим таблицу областей на основе аллокаций, мониторим сервисы. На основе таблицы областей определяем выходы за пределы проекций. Так два модуля можно различить.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388789&amp;user=40990&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=3" class="addthx" data-post="388789"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2018 20:44 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
Копался в протекторах, просто наблюдая а различной активностью. Заметил интересную закономерность, чисто случайно.<br><br>Первый образ выполняется в тех же пределах регионов, что и второй, если так помечать память то все события скипаются почти всегда. Если помечать страницы, уже выполненные, это уменьшает число событий, но их всё равно очень много. Случайно из за не доработки лог уменьшился - отсеялись почти все события.<br>Получилось следующим образом. Реализовал простеший монитор памяти, он строит массив областей, атрибуты(nt-protect) которых отличаются, просто листая память. Из фильтров Alloc/Protect массив сбрасывается, без какой либо обработки. Оказалось это почти всегда чистит лог от не нужных событий. Причина этому - депротект памяти образа перед его вызовом. Лог по накоторым имеющимся(имеющим свой образ).<br><br>ENIGMA:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;AI<span class="hl_char">-</span>DF&nbsp;at&nbsp;0x60F6C1&nbsp;to&nbsp;<span class="hl_char">[</span>0x610340<span class="hl_char">]</span>&nbsp;as&nbsp;R&nbsp;&nbsp;<span class="hl_char">,</span>&nbsp;dSTK<span class="hl_char">:</span>&nbsp;0xA4</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x703CAB&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x60F6A4</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALR&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x808120&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x703C9E</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JMPI&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;at&nbsp;0x7C801A81&nbsp;as&nbsp;0x400000<span class="hl_char">:</span>&nbsp;0x1000</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;AI<span class="hl_char">-</span>DF&nbsp;at&nbsp;0x60B4D0&nbsp;to&nbsp;<span class="hl_char">[</span>0x6117C0<span class="hl_char">]</span>&nbsp;as&nbsp;R&nbsp;&nbsp;<span class="hl_char">,</span>&nbsp;dSTK<span class="hl_char">:</span>&nbsp;0x779D0</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x60F480&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x60B4C4</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALR&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x60A3BE&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x60F473</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RET</b></span>&nbsp;&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;at&nbsp;0x7C801A81&nbsp;as&nbsp;0x400000<span class="hl_char">:</span>&nbsp;0x1000</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;AI<span class="hl_char">-</span>DF&nbsp;at&nbsp;0x60B4D0&nbsp;to&nbsp;<span class="hl_char">[</span>0x6117C0<span class="hl_char">]</span>&nbsp;as&nbsp;R&nbsp;&nbsp;<span class="hl_char">,</span>&nbsp;dSTK<span class="hl_char">:</span>&nbsp;0x779D0</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x60F480&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x60B4C4</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALR&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x60A3BE&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x60F473</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RET</b></span>&nbsp;&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;AI<span class="hl_char">-</span>DF&nbsp;at&nbsp;0x421828&nbsp;to&nbsp;<span class="hl_char">[</span>0x43D68C<span class="hl_char">]</span>&nbsp;as&nbsp;R&nbsp;&nbsp;<span class="hl_char">,</span>&nbsp;dSTK<span class="hl_char">:</span>&nbsp;0xC8</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x415757&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x421820</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALR&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x60F4ED&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x415757</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RET</b></span>&nbsp;&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li>        </ol>
    </div>
</div></div>
<br><br>OBSIDIUM<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;AI<span class="hl_char">-</span>DF&nbsp;at&nbsp;0x4CA279&nbsp;to&nbsp;<span class="hl_char">[</span>0x4CA26A<span class="hl_char">]</span>&nbsp;as&nbsp;RW&nbsp;<span class="hl_char">,</span>&nbsp;dSTK<span class="hl_char">:</span>&nbsp;0x8C</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x4CA0DF&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x4CA274</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RET</b></span>&nbsp;&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;at&nbsp;0x7C801A81&nbsp;as&nbsp;0x400000<span class="hl_char">:</span>&nbsp;0x1000</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;AI<span class="hl_char">-</span>DF&nbsp;at&nbsp;0x4CA279&nbsp;to&nbsp;<span class="hl_char">[</span>0x4CA26A<span class="hl_char">]</span>&nbsp;as&nbsp;RW&nbsp;<span class="hl_char">,</span>&nbsp;dSTK<span class="hl_char">:</span>&nbsp;0x78</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x4CA0DF&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x4CA274</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RET</b></span>&nbsp;&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;at&nbsp;0x7C801A81&nbsp;as&nbsp;0x489000<span class="hl_char">:</span>&nbsp;0x1000</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;AI<span class="hl_char">-</span>DF&nbsp;at&nbsp;0x4C9B80&nbsp;to&nbsp;<span class="hl_char">[</span>0x4C9A50<span class="hl_char">]</span>&nbsp;as&nbsp;RW&nbsp;<span class="hl_char">,</span>&nbsp;dSTK<span class="hl_char">:</span>&nbsp;0x74</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x4C98E5&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x4C9B7F</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RET</b></span>&nbsp;&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;AI<span class="hl_char">-</span>DF&nbsp;at&nbsp;0x421828&nbsp;to&nbsp;<span class="hl_char">[</span>0x43D68C<span class="hl_char">]</span>&nbsp;as&nbsp;R&nbsp;&nbsp;<span class="hl_char">,</span>&nbsp;dSTK<span class="hl_char">:</span>&nbsp;0x54</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x415757&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x421820</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALR&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x3A0A1E5&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x415757</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JMPR&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x3A0A1E0&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x3A0A1E5</li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br>THEMIDA:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;at&nbsp;0x3DF0E81&nbsp;as&nbsp;0x401000<span class="hl_char">:</span>&nbsp;0x1D000</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;at&nbsp;0x3DF0E81&nbsp;as&nbsp;0x400000<span class="hl_char">:</span>&nbsp;0x1000</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;at&nbsp;0x3DF0E81&nbsp;as&nbsp;0x400000<span class="hl_char">:</span>&nbsp;0x1000</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;at&nbsp;0x3DF0E81&nbsp;as&nbsp;0x400000<span class="hl_char">:</span>&nbsp;0x1000</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;at&nbsp;0x3DF0E81&nbsp;as&nbsp;0x400000<span class="hl_char">:</span>&nbsp;0x1000</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;at&nbsp;0x3DF0E81&nbsp;as&nbsp;0x400000<span class="hl_char">:</span>&nbsp;0x1000</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;at&nbsp;0x3DF0E81&nbsp;as&nbsp;0x400000<span class="hl_char">:</span>&nbsp;0x1000</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;AI<span class="hl_char">-</span>DF&nbsp;at&nbsp;0x421828&nbsp;to&nbsp;<span class="hl_char">[</span>0x43D68C<span class="hl_char">]</span>&nbsp;as&nbsp;R&nbsp;&nbsp;<span class="hl_char">,</span>&nbsp;dSTK<span class="hl_char">:</span>&nbsp;0xE4</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x415757&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x421820</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALR&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_function">BTR</span><span class="hl_char">:</span>&nbsp;0x54294C&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x415757</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>RET</b></span>&nbsp;&nbsp;AI<span class="hl_char">:</span>&nbsp;0x0</li>        </ol>
    </div>
</div></div>
<br><br>- своего образа не имеет.<br><br>SAFEENGINE генерит тьму событий.<br><br>ARMA не заводится, что то пошло не так после дня тестов, видимо нужно загружаться во второй процесс, толи истёк какой то тестовый срок, толи это хитрые трюки прота <img src="img/smilies/s1.gif" alt=""><br><br>Далее появилась идея посмотреть на доступ к заголовку исходного модуля.<br><br>ENIGMA:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;0x400000&nbsp;x&nbsp;0x1000<span class="hl_char">:</span>&nbsp;&nbsp;RW</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x60AD2F&nbsp;to&nbsp;0x40003C&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x60AD2F&nbsp;to&nbsp;0x4001FC&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x60AED6&nbsp;to&nbsp;0x4001FC&nbsp;as&nbsp;W&nbsp;&nbsp;</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x60AD2F&nbsp;to&nbsp;0x400224&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x60AED6&nbsp;to&nbsp;0x400224&nbsp;as&nbsp;W&nbsp;&nbsp;</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x60AD2F&nbsp;to&nbsp;0x40024C&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x60AED6&nbsp;to&nbsp;0x40024C&nbsp;as&nbsp;W&nbsp;&nbsp;</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x60AD2F&nbsp;to&nbsp;0x400274&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x60AED6&nbsp;to&nbsp;0x400274&nbsp;as&nbsp;W&nbsp;&nbsp;</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;PE<span class="hl_char">-</span>PROT&nbsp;0x400000&nbsp;x&nbsp;0x1000<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;R</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x7C9102D6&nbsp;to&nbsp;0x400000&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x7C9102DD&nbsp;to&nbsp;0x40003C&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x7C9102EE&nbsp;to&nbsp;0x4000E0&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x7C8102EE&nbsp;to&nbsp;0x400144&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x7C8102F3&nbsp;to&nbsp;0x400140&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x7C9102D6&nbsp;to&nbsp;0x400000&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x7C9102DD&nbsp;to&nbsp;0x40003C&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x7C9102EE&nbsp;to&nbsp;0x4000E0&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x7C80B7C8&nbsp;to&nbsp;0x40013C&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l0">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x41560D&nbsp;to&nbsp;0x4000E0&nbsp;as&nbsp;R&nbsp;&nbsp;</li><li class="hl_l1">DYE<span class="hl_char">:</span>&nbsp;DF&nbsp;to&nbsp;PE&nbsp;header&nbsp;at&nbsp;0x41561E&nbsp;to&nbsp;0x4000F8&nbsp;as&nbsp;R</li>        </ol>
    </div>
</div></div>
<br><br>Последние события походу после старта 2-го образа. Настраивает в памяти хидер.<br><br>OBSID. туда перед стартом второго модуля не пишет, а дёргает системные апи для работы с пе. Видимо можно этими событиями исключить первый образ, хотя это лишь допущение.<br><br>Наверно нужно снять лог с имеющихся протов на доступ к пе шапке и вывести поля. Они там все копаются. Обычное апп(не прот) в хидер не пишет, это не нужно.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388858&amp;user=40990&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=4" class="addthx" data-post="388858"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 465thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2018 11:15 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
ARMA не заводится, что то пошло не так после дня тестов, видимо нужно загружаться во второй процесс<br><b>(DebugActiveProcess</b> <b>CopyMem2</b>
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388864&amp;user=17432&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=5" class="addthx" data-post="388864"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2018 19:05 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<b>ClockMan</b><br><br>Очевидно что процесса два, спец инструмент для этого не нужен. Первый процесс видимо как то образ обрабатывает, раз он был в логах. Но это минутное дело впрыснуть мотор в потомок, сервисы мониторятся, DebugActiveProcess() не нужен, я не использую отладчик.)<br><br>Увидел свет в теме. Так как два образа не отличимы по активности от одного, то есть лишь один способ их различить - по родителю, так как образы разные, то и их загрузка будет разделена временем(активностью). Это видимо и есть решение задачи, только пока абстрактное.<br><br>Задавать тут вопросы походу совершенно бессмысленно.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388870&amp;user=40990&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=6" class="addthx" data-post="388870"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2018 19:12 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Первый процесс видимо как то образ обрабатывает, раз он был в логах. Но это минутное дело впрыснуть мотор в потомок, сервисы мониторятся, DebugActiveProcess() не нужен, я не использую отладчик.) </I><br>Ну это ты не используешь, а арма использует. Первый процесс это отладчик для второго процесса, почитай уже статьи для новичков, а.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=388871&amp;user=18316&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=7" class="addthx" data-post="388871"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17432" title="08-11-2018 21:07, ранг:507.7" target="_blank">ClockMan</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2018 19:33 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<b>SReg</b><br><br>Я не обращал на это внимание, так как тут куча тестовых протов, которые общим образом обрабатывются и выводится соответственно общий лог. И почему вас это так заинтересовало внезапно, были проблемы с данным протом ?<br><br>&gt; Первый процесс это отладчик для второго процесса<br><br>Ну и что. Есть крипторы, которые десятки/сотни процессов стартуют. Что бы обламать отладку. Я использую не отладчик, пойми а иного типа инструмент - как только он получает управление, то берёт апп под полный контроль, это нэйтив. Не имеет никакого значения, под отладчиком оно запущено, в самом отладчике(взят он под монитор) или вообще без отладки. В таком случае и единственно нормальный вариант загрузки - как верифер, до запуска нэйтива(точнее юзер его оболочки). Я после того как вы это обосрали не использовал, но это элементарный системный путь загрузки монитора в копии и никакие запуски процессов и отладки трогать не нужно - зарегал в реестре и вуаля, ты во всех копиях до загрузки кернел либы <img src="img/smilies/s15.gif" alt=""><br><br>Походу вы только и можите срабатывать на знакомый триггер - кидать говном при встрече знакомых событий, прямо как сабж события лол.<br><br>Без обид, это лишь рациональный ответ.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388873&amp;user=40990&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=8" class="addthx" data-post="388873"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 465thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2018 00:07 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Очевидно что процесса два, спец инструмент для этого не нужен. Первый процесс видимо как то образ обрабатывает, раз он был в логах. Но это минутное дело впрыснуть мотор в потомок, сервисы мониторятся, DebugActiveProcess() не нужен, я не использую отладчик.) </I><br><b>DebugActiveProcess</b><br>Запускаются 2 процесаа один из них под отладчиком<br><b>CopyMem2</b><br>в отлаживаемом приложении кода как такового нет при исключении заполняется часть кода<br>В арме есть ещё Nanomit и Codesplice<br><b>Nanomit</b><br>за место условных и безусловных прыжков используются in3 исключения<br><b>Codesplice</b><br>часть кода украдена и вынесена за пределы модуля
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388878&amp;user=17432&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=9" class="addthx" data-post="388878"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2018 19:53 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<b>ClockMan</b><br><br>Единственная проблема с процессами - нужно править дебаг вывод, что бы он не сливался воедино. Тоесть нужно пофиксить дебаг вывод, добавив PID в макро, те изменить несколько строк.<br><br>На счёт остального - у меня нет мнения и мне нечего сказать. У вас древний подход к задаче, вы думаете что обычные помехи для отладчика имеют значение. Это не верно. Потому что отладчик не используется, для вас не привычно.<br><br> &gt;  арме есть ещё Nanomit и Codesplice<br><br>Апп что угодно делает в памяти; цель - выделить EP. Так как сложные проты используют свой образ, то задача сводится к выделению нескольких образов, по их активности(изначальный и тупиковый подход, см выше). Активность это не значит что вызов апи, это значит что снимается выборка в память. Но и это тупиковый путь.<br><br>Может каким то образом наномиты и какие то патчи мешают отладке, наверно это так. Учитывая что завести отладчик большая проблема всегда. Но опять же не в данном случае, я не юзаю отладчик, а визор, который может анализить и сам ваш отладчик.<br><br>&gt; за место условных и безусловных прыжков используются in3 исключения<br><br>Срабатывает ловушка, ядро передаёт управление на Ki*Entry. С этого места происходит вход в визор и с этого места апп выполняется в контролируемой среде. Таких событий четыре(обратный ядерный вызов, за исключением сервисного) - исключение, гуй_калбэк, апк и инвалид_хэндл.  Входа(Ki*) патчит визор. Заложен механизм подмены выборки, тоесть попытка чтения вернёт исходные данные. Я это использовал лишь для поля антидебага(PEB[2]). Никакой проблемы нет скрыть мод кода нэйтив по адресам ki этим же способом.<br><br>Но видимо я тех деталями увлёкся. Про саму задачу очевидно нет смысла говорить.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388894&amp;user=40990&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=10" class="addthx" data-post="388894"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2018 20:03 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<I>difexacaw пишет:<br>проты используют свой образ, то задача сводится к выделению нескольких образов </I><br><br>По каким критериям разделяешь, есть образ или нет ?!
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388895&amp;user=3520&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=11" class="addthx" data-post="388895"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 338.5 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2018 20:19 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=25429&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<b>mak</b><br><br>2.6 + AI-df.<br><br><b>Добавлено спустя 1 час 50 минут</b><br>Тема закрыта, в связи с ожидаемым баном. Вернусь но не сюда, когда я найду решение.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388896&amp;user=40990&amp;forum_n=6&amp;topic=25429&amp;page=1&amp;anchor=12" class="addthx" data-post="388896"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=6&amp;topic=25429&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=6&amp;topic=25429&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Критерий EP.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=25429" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
