<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Дамп драйвера - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет, Изучаю защиту, которая использует драйвер для скрытия процессов/доступа к ним Драйвер называется zwave1.sys и запускается по требованию шилда этой защиты Мне нужно получить этот драйвер как бинарник, чтобы изучить По">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Дамп драйвера</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 15:43 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем привет,<br>Изучаю защиту, которая использует драйвер для скрытия процессов/доступа к ним<br>Драйвер называется zwave1.sys и запускается по требованию шилда этой защиты<br>Мне нужно получить этот драйвер как бинарник, чтобы изучить<br>По информации из ProcessHacker2 драйвер лежит &quot;\??\C:\Windows\zwave1.sys&quot;, но в папке, конечно, ничего нет - причем даже во время работы драйвера<br>Известно, что он хукает SSDT, и ,по-видимому, как-то скрывает себя<br>Под рукой 7x64 и XPx32 на виртуалке, работает везде, скрывается тоже и там и там<br>Собственно, возможно ли как-то сдампить его, и может кто-нибудь объяснить механизм<strike>, и это вообще законно ли это???</strike><br>Спасибо
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373291&amp;user=40448&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=1" class="addthx" data-post="373291"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 389thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 16:24 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>Boostyq пишет:<br>но в папке, конечно, ничего нет - причем даже во время работы драйвера <br></I><br>Значит, он удаляется сразу после запуска.<br><br><I>Boostyq пишет:<br>и это вообще законно ли это??? <br></I><br>Нет. Это незаконно, конечно же. Попытка вмешательства в алгоритм работы защищённого ПО.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=373293&amp;user=35473&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=2" class="addthx" data-post="373293"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40448" title="11-03-2017 14:13, ранг:8.4" target="_blank">Boostyq</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 16:24 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Ставишь на виртуалку. Запускаешь, что нужно для работы драйвера. С хоста заходишь на файловую систему виртуалки и забираешь драйвер.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373294&amp;user=1379&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=3" class="addthx" data-post="373294"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 389thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 16:30 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
)<br>.. Кстати, имеются такие утилитки, которые умеют восстанавливать удалённые файлы.<br>Типо &quot;энуреза&quot; из нортон-утилит для доса.<br><br>Хотя, то ещё вопрос, в какой способ файл удалён. Иногда и &quot;энурез&quot; не поможет.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=373295&amp;user=35473&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=4" class="addthx" data-post="373295"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 16:34 <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Jupiter пишет:<br>Ставишь на виртуалку. Запускаешь, что нужно для работы драйвера. С хоста заходишь на файловую систему виртуалки и забираешь драйвер.  </I><br>А по-подробнее, как это сделать?<br>Я запустила сейчас, попробовала GMER, действительно, он показывает, что есть такой драйвер в модулях, но сдампить не открывается контекстное меню.<br>Так же он показал, что: <br><img src="http://s19.radikal.ru/i192/1703/53/096f2b2f6d1d.png" border="0" align="" alt=""><br>Использую WinXP на VMware...
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373296&amp;user=40448&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=5" class="addthx" data-post="373296"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 16:45 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Boostyq</b><br>Либо через Shared Folders, если Online.<br>Либо через VMware-mount из Virtual Disk Development Kit (VDDK) и чтение файла VMDK (Virtual Machine Disk), если Offline.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373297&amp;user=1379&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=6" class="addthx" data-post="373297"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 17:18 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Boostyq пишет:<br>XPx32 на виртуалке </I><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/0ea2_11.03.2017_EXELAB.rU.tgz">0ea2_11.03.2017_EXELAB.rU.tgz</a> - RkUnhooker 3.8.389.593 SR2.7z
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=373300&amp;user=2585&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=7" class="addthx" data-post="373300"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40448" title="11-03-2017 14:12, ранг:8.4" target="_blank">Boostyq</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 17:57 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>Boostyq</b><br><br>&gt; может кто-нибудь объяснить механизм<br><br>Какой механизм ?
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373302&amp;user=40990&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=8" class="addthx" data-post="373302"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 18:04 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>difexacaw</b><br>Механизм дампа/антидампа/как сдампить этот дров. Кэп.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373303&amp;user=1379&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=9" class="addthx" data-post="373303"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 18:19 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Jupiter</b><br><br>Поэтому я спросил, что не понятно о чём речь. Модуль может удалиться, может скрываться, может он запакован - тогда образ будет иной чем на диске. Нет инфы никакой что бы обсуждать механизмы.<br><br>Ничего нельзя извлечь из скрина выше. Пропатчены начала сервисов. Обычно это делается через сервисные таблицы. Чем больше изменений, тем больше мусора в ядре и соотвественно анстаб. Нужен хотя бы дизасм одного хэндлера для начала.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373305&amp;user=40990&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=10" class="addthx" data-post="373305"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 18:25 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Так сдампить удалось, даже тремя методами:<br>1) Сделала снэпшот в vmware и в файле vmem по сигнатуре нашла загруженный драйвер в оперативной памяти, только их там около сотни было, но нужный выцепила<br>2) Через Kernel Detective, правда защита детектит это, но сдампить я успела<br>3) Самый простой вариант был через RkUnhooker, спасибо <b>Gideon Vi</b>, защита не реагирует на него<br>Стало ясно, что дамп, это таки дамп, и таблицы импорта мне там не увидеть, но его, наверное, нечем восстановить?<br>Буду пробовать перехватить оригинальный драйвер, до удаления<br>Точно не уверена, есть ли какой-либо протектор, по дампу плохо ясно, если нет, то простой вариант - это оригинальный файл, а если есть то придется искать как восстановить импорт... хотя может дампа ntoskrnl хватит для изучения, если функции вызываются только его?<br><br><I>Jupiter пишет:<br>difexacaw<br>Механизм дампа/антидампа/как сдампить этот дров. Кэп.  </I><br>Механизм антидампа, т.е. почему драйвер скрыт.<br>Патчи функций ядра есть только пока драйвер запущен.
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373306&amp;user=40448&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=11" class="addthx" data-post="373306"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 19:50 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Boostyq</b><br><br>Может лучше опишите суть задачи, зачем вам этот дров нужен и что он вообще делает.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373309&amp;user=40990&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=12" class="addthx" data-post="373309"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 21:38 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Может лучше опишите суть задачи, зачем вам этот дров нужен и что он вообще делает.  </I><br>Конечно q.q<br>Это драйвер от защиты, она с ним связывается и передает ему команды по своему протоколу, он умеет скрывать процессы, защищать их от записи и чтения, даже от заморозки и все это время процесс находится под эгидой этого драйвера, так что мне нужно получить этот драйвер для изучения протокола<br>Дамп сработал, но во-первых там нет таблицы импорта и я не знаю можно ли ее восстановить готовыми тулзами<br>Кроме того, изучив его немного, я поняла, что скорее всего это лишь компонент, т.е. есть драйвер более высокого уровня, который как-бы распределяет какому драйверу запускаться на какой системе<br>Так же я попробовала просканировать оперативную память снэпшота от vmware небольшим граббером, который только что написала, получилась фигня, мб в памяти все храниться по кусочкам, но ни одного валидного файла
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373310&amp;user=40448&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=13" class="addthx" data-post="373310"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 22:17 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Boostyq</b><br>А ты не пробовала найти драйвер до установки?<br>Ведь можно его исследовать не только в виде дампа, но и в виде исходного драйвера. Пусть даже запакованного/под ВМ.<br><br><b>difexacaw</b><br>Насколько я понимаю задачи тс, она хочет изучить процесс взаимодействия защиты и защищаемой программы.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373312&amp;user=1379&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=14" class="addthx" data-post="373312"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 22:30 <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>Jupiter пишет:<br>Boostyq<br>А ты не пробовала найти драйвер до установки?<br>Ведь можно его исследовать не только в виде дампа, но и в виде исходного драйвера. Пусть даже запакованного/под ВМ. </I><br>Пробовала конечно. Файла просто нет. Я думаю внутри исполняемого файла (он накрыт вм) есть установка этого драйвера, его запуск и удаление, как он только загрузился. Или же сам драйвер умеет себя скрывать каким-либо образом...
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373313&amp;user=40448&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=15" class="addthx" data-post="373313"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 22:46 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Боже, что я здесь читаю, о господи! Какой кошмар. ВМВаре, ага, нам нужно больше виртуалок.<br><br>Давайте по порядку.<br><b>1. Как сделать дамп?</b><br>Чтобы сделать дамп, нужно знать базу образа и размер. В нашем случае нужна база загрузки драйвера и его ImageSize. Как я понимаю, RkU это любезно показывает. Теперь нужно просто загрузить свой драйвер. Потом из него просто считать кусок памяти по указанному адресу (ImageBase) указанного размера (ImageSize). Результат сохранить в файл. Самый простой способ - передать через IOCTL запросы параметры, и принять в буфер результат. <br><br>Детальнее <noindex><a href="http://progbook.ru/c/450-ispolzovanie-microsoft-windows-driver-model.html" rel="nofollow" target="_blank">--&gt; Здесь &lt;--</a></noindex><br><br><b>2. Как работают антируткиты, когда определяют скрытые модули/хуки и прочую лабуду?</b><br>Алгоритмы разные, но в целом есть один простейший подход - вызов оригинальной Nt* функции в обход хуков. Это тема отдельного разговора, но в целом об этом уже писалось ранее. Стоит погуглить старые статьи Ms-Rem.<br><br><b>3. А не взять ли этот драйвер до момента его загрузки?</b><br>Бинго, вариант попроще будет. В самом хардкорном случае берём ядерный дебаггер, ставим брейкпоинт на NtCreateFile, ждём.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373315&amp;user=6336&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=16" class="addthx" data-post="373315"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40448" title="11-03-2017 19:14, ранг:9.4" target="_blank">Boostyq</a>, <a href="action=userinfo&user=11" title="13-03-2017 10:23, ранг:192.3" target="_blank">gloom</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 22:51 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Boostyq</b><br>Имеет смысл отлавливать как раз установку драйвера, пока он ещё не получил управление, но уже распакован.<br>Для этого нужно хукать SetupAPI, OpenSCManager.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373316&amp;user=1379&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=17" class="addthx" data-post="373316"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 марта 2017 23:13 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24625.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Такс, разобралась<br>Защита имеет собственный формат модулей (шифрованные dll без заголовков, сжатый lzo и шифрованный nspack алгоритмом)<br>Вот почему я не могла найти контроллер драйвера, он не был под вм, его просто не было в списке модулей, т.к. был загружен кастомным лоадером. Я не стала мудрить и просто сняла дамп модуля во время его работы, до наложения обфускации.<br>Итак, я получила чистую дллку, оказалось что она и хранила в ресурсах 3 драйвера (для старых ос, для новых 32-битных, и новый для 64-битных)<br>Все три драйвера беззащитны, так что изучение протокола будет проще<br>Всем спасибо, задача решена, пойду изучать
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=373317&amp;user=40448&amp;forum_n=1&amp;topic=24625.html&amp;page=0&amp;anchor=18" class="addthx" data-post="373317"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17319" title="12-03-2017 05:06, ранг:457.0" target="_blank">VodoleY</a>, <a href="action=userinfo&user=11" title="13-03-2017 10:21, ранг:192.3" target="_blank">gloom</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Дамп драйвера</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24625" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
