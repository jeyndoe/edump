<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>ASProtect 2.3 SKE - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет всем! Имеется прога. http://rapidshare.com/files/70411938/Proga.rar.html http://rapidshare.com/files/70411938/Proga.rar.html Защита: ASProtect 2.3 SKE build 04.26 Beta [3]. Пытался следовать статье &quot;Распаковка">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASProtect 2.3 SKE</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]logogin[/b]','')">logogin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=10056">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2007 00:40 <br><script type="text/javascript">QU('logogin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=logogin" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет всем!<br>Имеется прога.<br>http://rapidshare.com/files/70411938/Proga.rar.html http://rapidshare.com/files/70411938/Proga.rar.html <br>Защита: ASProtect 2.3 SKE build 04.26 Beta [3].<br>Пытался следовать статье <b>&quot;Распаковка ASProtect v 2.xx by PE_Kill&quot;</b> но прога генерит огромное количество (скорее всего даже случайное) исключений обращения  по адрессу [00000000] (aka null pointer exception). Но их я все фильтрую и у меня остается тогда до запуска программы 4 исключения int 3 (2  до EntryPoint и 2 после). Но OEP я все же найти не смог. Зато определил, что во фрейме 01720000 находится сам код зашиты, но ее OEP определить тоже не смог. К сожалению, больше из статьи ничего не смог использовать - большие различия.<br>Похоже, что защиту поставили не совсем хорошо. Присутствуют два сегмента кода, один за другим - первый скорее всего как раз отвечает за инициализацию и форму регистрации, второй за саму логику программы. Я так думаю, потому что когда ставил точку останова на втором сегменте, то ни разу не брякался. Код в первом сегменте не выглядит замусоренем хотя конечно есть много вызовов в &quot;дальний&quot; сегмент в 01720000. Кроме того есть много функций-крючков, которые сидят далеко и в разных фреймах. Так что сдампить просто сегменты кода и виртуальную машину не получится.<br>Китайский скрипт  Aspr2.XX_unpacker что-то разпаковал и вот его лог:<br>Address    Message<br>174D6BA    AsprAPIloc: 0175F4D4<br>174D6BA    Aspr1stthunk: 0047202C<br>1749818    SDK stolen code sections = 00000001<br>175CC31    Total API in this Asprotect = 0000000D<br>175CC31    GetRegistrationInformation  0046E290<br>175CC31    CheckKeyAndDecrypt  0046E2D0<br>175CC31    CheckKey  0046E2E0<br>457078     SDK stolen code section address = 02790000<br>457078     Address of IAT = 00472000<br>457078     RVA of IAT = 00072000<br>457078     Size of IAT = 00000640<br>457078     Address of OEP = 00457078<br>457078     RVA of OEP = 00057078<br>Я исправил таблицу импорта, но три функции так и не нашел. Хотя до них дело, похоже, и не дошло - дамп валится с ошибкой при обрашении как раз куда-то в 02790000 (02790258).<br>А теперь вопросы по следующим пунктам:<br>1. Как же все таки самому выйти на OEP и VOEP? Так уж ли это надо? Дамп ведь в принципе можно делать и тогда, когда просто знаешь, что весь код разпакован и загружен.<br>2. Как пофиксить 3 функции из импорта? Вот данные из ImpRec-а<br>FThunk: 0007202C	NbFunc: 00000003<br>0	0007202C	?	0000	0170BFC0<br>0	00072030	?	0000	0170C050<br>0	00072034	?	0000	0170C0F0<br>3. Как пофиксить созданый дамп.<br>4. Если предположить, что алгоритм валидации ключа не находится в виртульной машине и поддается реверсингу, как эффективней всего его найти? Мне удалось выйти на вызовы GetWindowTextA и код там вполне читабелен. Как можно его загрузить в IDA?<br>Кстати, я так и не нашел кода, про который сказал скрипт разпаковки <br>CheckKeyAndDecrypt  0046E2D0<br>CheckKey  0046E2E0<br>там пусто.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=168650&amp;user=10056&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=1" class="addthx" data-post="168650"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Satyr[/b]','')">Satyr</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.1 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.17'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11504">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2007 03:51 <br><script type="text/javascript">QU('Satyr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Satyr" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
по аспр 2.3 есть <a href="http://exelab.ru/rar/dl/CRACKLAB.rU_80.rar" target="_blank">статья Внекрылова</a><br>не мог бы прогу перезалить на ifolder.ru или dump.ru
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=168660&amp;user=11504&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=2" class="addthx" data-post="168660"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2007 10:31 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>logogin</b> <a href="http://www.exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6315" target="_new">http://www.exelab.ru/f/action=vthread&amp;forum=1&amp;topic=6315</a>
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=168676&amp;user=2775&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=3" class="addthx" data-post="168676"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]logogin[/b]','')">logogin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=10056">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2007 11:52 <br><script type="text/javascript">QU('logogin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=logogin" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Satyr</b> <br>http://dump.ru/files/n/n154767589/ http://dump.ru/files/n/n154767589/ <br>Спасибо за ссылки - буду ковырять дальше
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=168680&amp;user=10056&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=4" class="addthx" data-post="168680"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Satyr[/b]','')">Satyr</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.1 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.17'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11504">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2007 05:00 <br><script type="text/javascript">QU('Satyr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Satyr" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>logogin</b><br>OEP в данном случае можно найти методом исключений, он находится по адресу 4635D4, причем протектор навешан без опции &quot;Protect original entry point&quot;, т.е. украденных байтов нет, нужно только декомпильнуть ВМ.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=168831&amp;user=11504&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=5" class="addthx" data-post="168831"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]logogin[/b]','')">logogin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=10056">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2007 12:14 <br><script type="text/javascript">QU('logogin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=logogin" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Satyr</b> <br>странно, китайский скрипт коворит про 0х00457078. Она может быть и не украдена, но есть украденый API. Так что дамп все равно надо будет исправлять. Я пробовал следовать статье, которую ты посоветовал, но пока прога почему-то вылетает при попытке поставить бряк на секцию кода - Protection error. Если можно, то разскажи подробней, как ты нашел OEP, т.е. куда ставить бряк перед последним int 3 и куда смотреть в стеке?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=168879&amp;user=10056&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=6" class="addthx" data-post="168879"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Satyr[/b]','')">Satyr</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 21.1 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.17'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11504">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2007 16:18 <br><script type="text/javascript">QU('Satyr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Satyr" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>logogin</b><br>я тут заснял свои действия на видео, в-общем-то там все понятно.<br>dump.ru/files/n/n73760866/
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=168915&amp;user=11504&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=7" class="addthx" data-post="168915"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]logogin[/b]','')">logogin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=10056">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2007 17:52 <br><script type="text/javascript">QU('logogin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=logogin" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>Satyr</b><br>Теперь догнал! <img src="img/smilies/s1.gif" alt=""> Спасибо. Просто не мог понять что первый push поместили в call и это и есть настоящая OEP. Только у меня почему-то, access violation exception генерится безконечно и я их сразу поставил на фильтрацию в опциях.<br>Теперь вопрос что делать дальше? Есть два варианта: реверсить алгоритм валидации ключа или пытатся сделать рабочий дамп. Даже не знаю что будет легче.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=168929&amp;user=10056&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=8" class="addthx" data-post="168929"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2007 18:25 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>logogin</b> не первое не второе. Я вообще не понимаю зачем ты столько времени потерял из-за этой проги, просто бы тыкнул на ссылку что я тебе дал.<br><br>По существу: В проге есть пошифрованные куски, расшифровать которые можно лишь имея хотя бы забаненый ключ. Реверсить алгоритм можно, но задача будет ОООЧЕНЬ не простая, просто поверь мне))<br>3 функции что ты не нашет, это всего вероятней аспрапи, и я бы на твоем месте узнал бы перед взломом как минимум зачем они нужны, тебе бы сэкономило бы это кучу времени<br><br>00435993   &gt; E9 3B050000    JMP laim_u.00435ED3<br>Вот тут натыкаемся сразу на пошифрованный кусок, можешь сам посмотреть...<br>А это тебе распакованный прог, что бы не мучался уже:<br>rapidshare.com/files/70809935/1212.rar_.html
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=168933&amp;user=2775&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=9" class="addthx" data-post="168933"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]logogin[/b]','')">logogin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=10056">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2007 19:41 <br><script type="text/javascript">QU('logogin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=logogin" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Maximus</b><br>Да я почитал немного. Но решил, что пока не получу дамп или не определю где алгоритм ключа, то пока можно отложить. Но насколько я понял, если найти функции CheckKey или CheckKeyAndDecrypt, то используя тот же асповский SDK можна сделать keygen.<br>Я ходил по твоей ссылке, но там так и написано - если не можете сами пропатчить апи, то дамп вам не поможет. Так что все равно самому разбираться придется. Я думаю это возможно, главное, что бы кто-то только советом помогал.<br>За распаковку спасибо, буду пытаться дальше.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=168937&amp;user=10056&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=10" class="addthx" data-post="168937"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2007 19:51 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>logogin</b> дык<br>1. Алгоритм обернутв VM<br>2. Алгоритм асиметричный, все проверки идут по хешу (блин этож комерческая защита если бы было все просто кто бы ее купил)<br>3. Найти можно только если дыру в реализации, но для этого как минимум надо на тестовом примере посмотреть что куда суется, с известным тебе ключиком.<br>4. Вряд ли кто тебе поможет, на форуме очень мало людей кто кигенил аспр, и то кигенели с одним заведомо известным ключем.<br>5:<br>&gt;Но насколько я понял, если найти функции CheckKey или CheckKeyAndDecrypt, то используя тот же асповский SDK можна сделать keygen<br>Нет! Киген сделать низя,плохо читал, нужна енкрипшн константа, которая есть только у разработчика.
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=168939&amp;user=2775&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=11" class="addthx" data-post="168939"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]logogin[/b]','')">logogin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=10056">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 ноября 2007 00:54 <br><script type="text/javascript">QU('logogin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=logogin" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Maximus</b><br>Почитал получше. Получается что регистрация идет следующим образом<br>1. Разработчик получает текст - в данном случае MD5 хеш логина. Подписывает его своим Private Key используя RSA. Кстати, разве можно по закону использовать длину ключа более 128 битов? <br>2. Подпись идет клиенту. В проге зашит тогда по идее Public Key которым валидируется подпись.<br>3. Зовется CheckKeyAndDecrypt и разкриптовывается участки кода.<br>Прога может знать только Public Keys, но использовать их по разному. Алгоритм проверки подписи RSA может и стандартный, а вот алгоритм разкриптовки наверное другой. Он может просто использовать константы из своего ключа.<br>Какой же тогда выход?<br>Вроде бы есть метод &quot;Attack on Asprotect SKE Activation Key&quot; - замены публичного ключа и атаки на константы. А для чего нужен заведомо известный ключ тогда?<br><br>P.S. дамп почему-то не запускается, еще не смотрел почему - читал <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=169009&amp;user=10056&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=12" class="addthx" data-post="169009"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 ноября 2007 01:04 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>logogin пишет:<br>Кстати, разве можно по закону использовать длину ключа более 128 битов? </I><br><br>для сертификации в соотв. органах? можно ;)<br>это тебе не экспортные ограничения в США, да и те времена прошли - сейчас 128 битный ключ - не проблема.<br><br><br><I>logogin пишет:<br>А для чего нужен заведомо известный ключ тогда?</I><br>а как ты расшифруешь то, что хочешь потом зашифровать своим ключом (подменив его), брутфорсом?
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=169010&amp;user=1379&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=13" class="addthx" data-post="169010"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 ноября 2007 07:57 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>logogin пишет:<br>дамп почему-то не запускается, еще не смотрел почему - читал </I><br>надо раскриптовывать покриптованое, тогда запустится.<br><br>В остальном согласен с <b>Jupiter</b>, хотя ключем можно не только разобрать шифр, но и сбрутить приват ключи и следовательно сделать ключеген, но это уже задача для продвинутых хакирафф...
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=169033&amp;user=2775&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=14" class="addthx" data-post="169033"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]logogin[/b]','')">logogin</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=10056">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2007 12:09 <br><script type="text/javascript">QU('logogin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=logogin" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Maximus</b><br>Ну а если достать хотя бы один валидный ключ? Тогда же вроде как пройзойдет разкриптовка, затем можно пропатчить CheckKeyAndDecrypt, что бы всегда возвращала true и ничего не разшифровывала.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=169188&amp;user=10056&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=15" class="addthx" data-post="169188"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2007 12:50 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=10481.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>logogin</b> все правильно, так аспр и ломают
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=169200&amp;user=2775&amp;forum_n=5&amp;topic=10481.html&amp;page=0&amp;anchor=16" class="addthx" data-post="169200"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASProtect 2.3 SKE</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#17" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="10481">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=10481" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
