<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Quick Unpack - универсальный распаковщик - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Quick Unpack 2.1  История версий -------------- v2.1 [!] исправлены многие ошибки. например, падение при восстановлении ресурсов на некоторых программах [!] многопоточные приложения теперь корректно обрабатываются [+] добавлена">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+8 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Quick Unpack - универсальный распаковщик</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=27.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=26.html">27</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=27.html">28</a> . <b>29</b> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=29.html">30</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=30.html">31</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=31.html">32</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=32.html">33</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=33.html">34</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=29.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]FEUERRADER[/b]','')">FEUERRADER</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/39.jpg" alt=""><br><span class=txtSm>Ранг: 55.8 (постоянный), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=39">Участник</a><br><font color=blue>[www.AHTeam.org]</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 мая 2006 12:51 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('FEUERRADER','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FEUERRADER" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#1');return false;">#1</a> </span><div align=left><br>
<b>Quick Unpack 2.1</b><br><br><br>История версий<br>--------------<br>v2.1<br>[!] исправлены многие ошибки. например, падение при восстановлении ресурсов на некоторых программах<br>[!] многопоточные приложения теперь корректно обрабатываются<br>[+] добавлена возможность установить конец модуля при трассировке функций импорта. Когда найдено обращение к импорту, оно анализируется, ведёт ли оно за пределы модуля (чтобы не трассировать внутренние функции). Некоторые проты перенаправляют импорт в последнюю секцию файла. Чтобы убрать эту проблему и была введена данная возможность. Это RVA<br>[+] добавлена возможность класть таблицу импорта по указанному RVA вместо создания новой секции<br>[+] добавлена возможность установить дельту для хука RDTSC (см. rdtsc_delta в Scripts.rus.txt)<br>[+] добавлена опция Load libraries only к списку методов восстановления импорта. с этой опцией импорт в прямом смысле слова не восстанавливается, просто берётся по 1 функции импорта из каждой из загруженных библиотек. после этого дамп будет загружен со всеми нужными библиотеками, а для импорта будут использоваться старые адреса функций, записанные протектором. эту опцию можно использовать, когда перенаправление импорта уж слишком забористое, но дамп после установки сервис пака или серьёзного апдейта работать перестанет<br>[+] добавлена опция Execute functions while tracing import. по умолчанию во время трассировки импорта функции не исполняются, но некоторые протекторы используют результаты выполнения функций в своей работе, для них и добавлена эта опция<br>[+] добавлена опция Process call xxx/jmp xxx. некоторые протекторы переделывают обращения к импорту из call [xxx]/jmp [xxx] в call xxx/jmp xxx. эта опция позволяет обрабатывать также и такие обращения к импорту<br>[+] добавлено несколько новых функций и переменных для скриптов<br>[+] generic OEP finder от UsAr теперь поддерживает и DLL<br>[+] добавлен новый манифест для Висты<br><br><u>Конструктивные</u> отзывы приветствуются.<br><br>Ссылки на архив:<br><br>http://qunpack.ahteam.org/wp-content/uploads/2008/03/qunpack21.zip http://qunpack.ahteam.org/wp-content/uploads/2008/03/qunpack21.zip <br><br>Сайт: http://qunpack.ahteam.org/ http://qunpack.ahteam.org/
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=69471&amp;user=39&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=1" class="addthx" data-post="69471"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 00:11 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#2');return false;">#2</a> </span><div align=left><br>
<I>mak пишет:<br>Намёк на полный декомпиль Темиды </I><br>ага держи карман шире...
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=387971&amp;user=17432&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=2" class="addthx" data-post="387971"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 00:43 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#3');return false;">#3</a> </span><div align=left><br>
<b>difexacaw</b><br>Можешь сделать лучше - возьми и сделай.<br>Но кроме громких и пафосных слов ничего не видно и не слышно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=387972&amp;user=10534&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=3" class="addthx" data-post="387972"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 04:17 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#4');return false;">#4</a> </span><div align=left><br>
<I>tihiy_grom пишет:<br>Но кроме громких и пафосных слов ничего не видно и не слышно. </I><br><br>это троль. Он существует, пока его замечают.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=387973&amp;user=2585&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=4" class="addthx" data-post="387973"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 190thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 09:06 <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#5');return false;">#5</a> </span><div align=left><br>
Вы еще скажите что он не прав насчет KiDebugRoutine <img src="img/smilies/s1.gif" alt=""> Впрочем какая теперь разница.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=387974&amp;user=21411&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=5" class="addthx" data-post="387974"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 10:47 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#6');return false;">#6</a> </span><div align=left><br>
<I>Alchemistry пишет:<br>Вы еще скажите что он не прав </I><br><br>Конечно же он не прав и просто старается дешёвыми приёмами привлечь внимание к себе. <br><br>Ты тоже пытаешься этим заниматься, но до Клерка тебе как до луны. Так как ты к сожалению уныл и посредственен, а Клерк талантлив.<br><br><I>difexacaw пишет:<br>А если же поделка нужна для работы только с юм, то км не нужно лишний раз трогать, способов достаточно.  </I><br><br>Расскажи тогда про способы эмуляции RDTSC в User Mode?
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=387975&amp;user=31056&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=6" class="addthx" data-post="387975"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 11:00 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#7');return false;">#7</a> </span><div align=left><br>
<I>hors пишет:<br>RDTSC </I><br>ну можно сбросить бит  <b>TSD</b> в <b>CR4</b> это запретит исполнение  <b>RDTSC</b> в ring3, перехватить исключение и подсунуть нужное значение))))
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=387976&amp;user=17432&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=7" class="addthx" data-post="387976"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 11:04 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#8');return false;">#8</a> </span><div align=left><br>
<I>hors пишет:<br>Расскажи тогда про способы эмуляции RDTSC в User Mode? </I><br><br>Про моторы забыл?! <img src="img/smilies/s5.gif" alt=""> Эмуляцией и построением графа, я вот жду когда Клерк выложит последнее решение для подобной эмуляции, свой полный эмулятор, очень интересно технически, но тема как-то заглохла в топике.<br><br><I>ClockMan пишет:<br>mak пишет:<br>Намёк на полный декомпиль Темиды <br>ага держи карман шире...  </I><br>Куплю даже сумку <img src="img/smilies/s6.gif" alt=""> Не предавай своё кредо оптимиста!
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=387977&amp;user=3520&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=8" class="addthx" data-post="387977"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 11:15 &middot; Поправил: hors <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#9');return false;">#9</a> </span><div align=left><br>
<I>ClockMan пишет:<br>ну можно сбросить бит TSD в CR4 это запретит исполнение RDTSC в ring3, перехватить исключение и подсунуть нужное значение))))  </I><br><br>А если защита проверяет значение отладочных регистров?
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=387978&amp;user=31056&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=9" class="addthx" data-post="387978"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 11:25 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#10');return false;">#10</a> </span><div align=left><br>
<I>hors пишет:<br>А если защита проверяет значение отладочных регистров </I><br>что бы их проверить надо быть быстрее моего <u>левого</u> хука<img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=387979&amp;user=17432&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=10" class="addthx" data-post="387979"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 11:57 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#11');return false;">#11</a> </span><div align=left><br>
Доступ к CR-регистрам, как чтение, так и запись, запрещены из ring3.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=387980&amp;user=1556&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=11" class="addthx" data-post="387980"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17432" title="21-09-2018 09:16, ранг:499.8" target="_blank">ClockMan</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 13:37 <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#12');return false;">#12</a> </span><div align=left><br>
<I>mak пишет:<br>я вот жду когда Клерк выложит последнее решение для подобной эмуляции </I><br>По последним обрывочным сведениям клерковизор почти дописан и теперь штурмует микроконтроллеры &quot;на другой архитектуре, не важно актуальна или нет&quot;, потому что &quot;не всё же IA юзать&quot;.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=387981&amp;user=8075&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=12" class="addthx" data-post="387981"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 14:48 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#13');return false;">#13</a> </span><div align=left><br>
<I>hors пишет:<br>А если защита проверяет значение отладочных регистров?  </I><br><br>DR-регистры можно проверить через GetThreadContext(). Но если не завязано на прямых вызовах сервисов через шлюз, то можно перехватить.<br><br><b>Добавлено спустя 2 минуты</b><br><I>hors пишет:<br>Расскажи тогда про способы эмуляции RDTSC в User Mode?  </I><br><br><I>ClockMan пишет:<br>ну можно сбросить бит TSD в CR4 это запретит исполнение RDTSC в ring3, перехватить исключение и подсунуть нужное значение))))  </I><br><br><I>Archer пишет:<br>Доступ к CR-регистрам, как чтение, так и запись, запрещены из ring3.  </I><br><br>без км <strike>никак</strike> только выявлять эмулятором rdtsc и патчить
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=387982&amp;user=24257&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=13" class="addthx" data-post="387982"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 20:35 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#14');return false;">#14</a> </span><div align=left><br>
Не нужно ничего усложнять, решение собирается за вечер под пивас. В данном случае не нужны все эти сложности по профайлу, детектам, формату кода, куча системной обработки етц.<br>Достаточно реализовать простейший визор, это зная принцип задача для ньюби. Берём ксед, от него нужен декодер длин и определение modrm. Забиваем битмапу маркеров не линейных инструкций, это всевозможные ветвления. Используем тлс для многопотока, там реализуем RWX буфер на 16 байт. Из битмапы ветвлений определяем линейная ли инструкция, если это так, то копируем и исполняем и идём дальше в цикл. Ели это ветвление, то пересчитываем адрес и переходим к нему. Если есть адресная выборка(EA(modrm)), то читаем значение и переходим туда. Элементарно это реализуется.<br><br>Нужно есчо поставить нотифи на системные события, но это так же не проблема. Мелкая задача. Когда визор обнаружит опкод вашей rdtsc измените контекст должным образом.<br><br><b>Добавлено спустя 6 минут</b><br><b>mak</b><br><br>&gt; решение для подобной эмуляции, свой полный эмулятор<br><br>Я никогда не писал полноценный эмулятор и не вижу смысла это использовать. Есть лишь один случай, когда это может быть нужно(локально, не вари всякие) - альтернатива прямому исполнению, тоесть инструкцию можно исполнить, но для этого нужна RWX память, что может зарубить защита или привести к детекту. Если задача не затрагивает обход защиты в динамике, то эмуляция никакого смысла не имеет. Тем более что она не профайл, в отличие от прямого исполнения, а до кучи проблем - размеры, а значит и стабильность не фонтан.<br><br>А есчо у эмулятора есть такая фишка, как изолированная выборка данных(атомы). Это просто палево, большее чем даже отладчик <img src="img/smilies/s2.gif" alt=""><br><br><b>Добавлено спустя 18 минут</b><br><b>mak</b><br><br>Кстате по выборке в эмуляторах, если вы не в курсе, то работает это очень просто. Эмулятор пытается транслировать адрес при выборке, а он не валид. Это спец событие формируется эмулируемым кодом. Тогда эмулируемый код попытается декодировать инструкцию, а её нет - эмулятор изолирован от эмулируемого кода(атом). На этом эмуляция закончится.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=387984&amp;user=40990&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=14" class="addthx" data-post="387984"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]hypn0[/b]','')">hypn0</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.9 (посетитель), 94thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.02'>Активность: 0.05<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=21535">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 21:27 <br><script type="text/javascript">QU('hypn0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hypn0" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#15');return false;">#15</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Тогда эмулируемый код попытается декодировать инструкцию, а её нет - эмулятор изолирован от эмулируемого кода(атом). На этом эмуляция закончится.</I><br>И мы все умрём?<br>Я пытался читать с начала, но уснул. Прошу прощения. Но вот под конец, когда эмулятор и эмулируемый код схлестнулись, стало интересно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=387985&amp;user=21535&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=15" class="addthx" data-post="387985"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=1379" title="22-09-2018 08:04, ранг:559.0" target="_blank">Jupiter</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]sefkrd[/b]','')">sefkrd</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/39556.png" alt=""><br><span class=txtSm>Ранг: 77.2 (постоянный), 73thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.88'>Активность: 0.19<span style='color:red'>&searr;</span>0.15</span><br>Статус: <a href="action=userinfo&amp;user=39556">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 21:29 <br><script type="text/javascript">QU('sefkrd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sefkrd" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#16');return false;">#16</a> </span><div align=left><br>
Господа, можно от кого-нибудь дубль ссылки на другой обменник для QU4.3..<br>RG не даёт скачать..<br>Спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=387986&amp;user=39556&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=16" class="addthx" data-post="387986"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]hypn0[/b]','')">hypn0</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.9 (посетитель), 94thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.02'>Активность: 0.05<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=21535">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 21:32 <br><script type="text/javascript">QU('hypn0','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hypn0" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#17');return false;">#17</a> </span><div align=left><br>
<I>sefkrd пишет:<br>QU4.3 </I><br>https://www38.zippyshare.com/v/OLXJeygu/file.html<br>сойдет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=387987&amp;user=21535&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=17" class="addthx" data-post="387987"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39556" title="21-09-2018 18:36, ранг:70.1" target="_blank">sefkrd</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]4kusNick[/b]','')">4kusNick</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1931.jpg" alt=""><br><span class=txtSm>Ранг: 748.2 <font color=magenta>(<b>! !</b>)</font>, 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.1'>Активность: 0.37<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1931">Участник</a><br><font color=blue>bytecode!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2018 23:40 <br><script type="text/javascript">QU('4kusNick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=4kusNick" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#18');return false;">#18</a> </span><div align=left><br>
Вот читаю этот топ и перед глазами ну просто типичная же картина, которая описывается парой слов так ёмко и так полно, что ну не о чём тут просто холиварить:<br><br><b>кому-то шашечки, а кому-то ехать</b>
<br><br><font size="1"><i>-----<br>Флэш, ява, дотнет - на завтрак, обед и ужин. Unity3D на закуску.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=387990&amp;user=1931&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=18" class="addthx" data-post="387990"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2018 01:05 &middot; Поправил: hors <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#19');return false;">#19</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Не нужно ничего усложнять, решение собирается за вечер под пивас. В данном случае не нужны все эти сложности по профайлу, детектам, формату кода, куча системной обработки етц.<br>Достаточно реализовать простейший визор, это зная принцип задача для ньюби. Берём ксед, от него нужен декодер длин и определение modrm. Забиваем битмапу маркеров не линейных инструкций, это всевозможные ветвления. Используем тлс для многопотока, там реализуем RWX буфер на 16 байт. Из битмапы ветвлений определяем линейная ли инструкция, если это так, то копируем и исполняем и идём дальше в цикл. Ели это ветвление, то пересчитываем адрес и переходим к нему. Если есть адресная выборка(EA(modrm)), то читаем значение и переходим туда. Элементарно это реализуется. </I><br><br>Если я правильно понял,ты предлагаешь дизассемблировать каждую отдельную инструкцию, копировать её в буфер, каждый раз настраивать контекст и там исполнять? <br>Всякие WinAPI не эмулировать, а тоже прогонять через твой  &quot;визор&quot;?<br><br><br>Идея конечно интересная, но практической пользы от этого нет. Так как это будет очень и очень медленно.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=387991&amp;user=31056&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=19" class="addthx" data-post="387991"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2018 05:22 &middot; Поправил: Gideon Vi <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#20');return false;">#20</a> </span><div align=left><br>
<I>difexacaw пишет:<br>решение собирается за вечер под пивас </I><br><br>какой пивас пьёшь? Готов заслать, чтобы увидеть решение от тебя в виде исполняемого файла, который будет запускаться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=387994&amp;user=2585&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=20" class="addthx" data-post="387994"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39556" title="22-09-2018 06:05, ранг:70.1" target="_blank">sefkrd</a>, <a href="action=userinfo&user=4554" title="22-09-2018 12:57, ранг:220.6" target="_blank">HandMill</a>, <a href="action=userinfo&user=31056" title="22-09-2018 20:01, ранг:120.1" target="_blank">hors</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2018 23:01 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#21');return false;">#21</a> </span><div align=left><br>
<I>Gideon Vi пишет:<br>какой пивас пьёшь? Готов заслать, чтобы увидеть решение от тебя в виде исполняемого файла, который будет запускаться. </I><br><br>Присоединяюсь. Зашлю в два раза больше того что зашлёт <b>Gideon Vi.</b>
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388009&amp;user=31056&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=21" class="addthx" data-post="388009"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2585" title="22-09-2018 23:13, ранг:1086.4" target="_blank">Gideon Vi</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2018 02:10 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#22');return false;">#22</a> </span><div align=left><br>
<b>difexacaw</b>, продавай квартиру, деньги через меня возвращаем тебе, скан платежки <b>hors</b>, гешефт делим пополам.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=388012&amp;user=2585&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=22" class="addthx" data-post="388012"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2018 08:26 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#23');return false;">#23</a> </span><div align=left><br>
<b>hors</b><br><br>&gt; Так как это будет очень и очень медленно. <br><br>А почему вы так решили ?<br><br>&gt; Всякие WinAPI не эмулировать, а тоже прогонять через твой &quot;визор&quot;?<br><br>Иначе нужно знать все входа в целевой код. Так как из апи бывают обратные вызовы.<br><br><b>Gideon Vi</b><br><br>Хорошо, соберу сегодня вам пример.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388015&amp;user=40990&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=23" class="addthx" data-post="388015"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]nv[/b]','')">nv</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.5 (гость), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.03'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=40928">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2018 11:03 <br><script type="text/javascript">QU('nv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nv" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#24');return false;">#24</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Хорошо, соберу сегодня вам пример. <br> </I><br>Походу сегодня второе свершится пришествие Иисуса.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=388017&amp;user=40928&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=24" class="addthx" data-post="388017"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]TryAga1n[/b]','')">TryAga1n</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 262.5 (наставник), 337thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.45'>Активность: 0.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=31275">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2018 20:43 <br><script type="text/javascript">QU('TryAga1n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TryAga1n" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#25');return false;">#25</a> </span><div align=left><br>
<I>nv пишет:<br>Походу сегодня второе свершится пришествие Иисуса.  </I><br>Наивный<img src="img/smilies/s15.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=388035&amp;user=31275&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=25" class="addthx" data-post="388035"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2018 20:47 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#26');return false;">#26</a> </span><div align=left><br>
Вот собрал пример, фактически лишь немногие рутины взял из прошлых реализаций, что бы собрать чистый пример. В процессе работы выводит в дебаг лог события если встречает сервисный вызов(senter, int, far) и rdtsc, cpuid, smsw. Так как долгое время заняла отладка, я не прикрутил системную обработку, поэтому пока на многопотоке не заведётся. А есчо оно прилично тормозное получилось - 140 раз в сравнении с прямым исполнением, но это из за того что сырая сборка, нет пакетной обработки, кэшей, циклов и прочей оптимизации.<br><br>Работает на xp, 7; 8(wow).<br><br><img src="img/attach.gif" alt=""> <a href="./files/5ec5_23.09.2018_EXELAB.rU.tgz">5ec5_23.09.2018_EXELAB.rU.tgz</a> - d2s.7z
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388037&amp;user=40990&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=26" class="addthx" data-post="388037"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=2585" title="24-09-2018 11:49, ранг:1086.4" target="_blank">Gideon Vi</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Alchemistry[/b]','')">Alchemistry</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 145.8 (ветеран), 190thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.05'>Активность: 0.14<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=21411">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2018 05:52 &middot; Поправил: Alchemistry <br><script type="text/javascript">QU('Alchemistry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alchemistry" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#27');return false;">#27</a> </span><div align=left><br>
<b>difexacaw</b><br>Почему в 2018 году как и в 2009 твои поделия надо трахать под отладчиком чтоб они запустились и выдали хоть что-то? Прям как и сейчас. Если ты думаешь что это порог вхождения для какой-то илиты, то уже пора повзрослеть. Тоже касается описания всего этого. Ну оно работает, с пинка правда, поздравляю, как обычно 99% потенциальной аудитории не поймет ровным счетом ничего.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=388042&amp;user=21411&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=27" class="addthx" data-post="388042"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2018 06:18 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#28');return false;">#28</a> </span><div align=left><br>
<b>Alchemistry</b><br>Чтобы собирать их в отдельную папочку и созерцать осенними вечерами, успокаивая себя &quot;ну вот, а я пока ещё здоров&quot;
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388043&amp;user=1379&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=28" class="addthx" data-post="388043"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2018 17:30 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#29');return false;">#29</a> </span><div align=left><br>
<b>Alchemistry</b><br><br>&gt; надо трахать под отладчиком чтоб они запустились <br><br>А как вы хотите узнать как оно работает, тот же дебаг вывод смотреть. Какой там смысл от адресов, без содержимого по ним. Или вам может нужен гуй и диалог с надписью работает.. Вопрос был выше как трекнуть события типо тск, не ясно чего вы ждёте. В примере фича лишняя с адресами, можно урезать на треть или даже в половину, если выкинуть адресную трансляцию - можно определить указатель в индирект ветвлениях без трансляции, заменить два бита в опкоде и получится push раскодированного значения. Но трансляция позволяет мониторить адреса, строку например в памяти найти и тп. Низкий профайл - если использовать пакетную обработку, не перезагружать без надобности контекст, он повысится ровно на порядок. Это кстате невозможно сделать для обычной эмуляции.<br><br>Что бы завести это на обычном апп нужно допилить системную часть - мониторить потоки, передачи управления из км, обработать сервисы, нп NtContinue. Иначе новые потоки не будут мониториться и при некоторых вызовах для мониторящегося потока слежение за ним будет теряться.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388047&amp;user=40990&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=29" class="addthx" data-post="388047"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 сентября 2018 09:07 <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#30');return false;">#30</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Или вам может нужен гуй и диалог с надписью работает.. </I><br>Как ты не поймёшь - ты и выложил апликуху котора 3 раза выводит MessageBox.<br>Что оно там внутри ещё делает никому нафиг не интересно - практической пользы ноль.<br><br><I>difexacaw пишет:<br>Низкий профайл - если использовать пакетную обработку, не перезагружать без надобности контекст, он повысится ровно на порядок. Это кстате невозможно сделать для обычной эмуляции. </I><br>И нафига тогда этот велосипед?<br>Если можно запустить процесс под отладкой, включить сингл стэп и в обработчике анализировать опкоды.<br>Будет также по скорости, если не быстрее. Плюс стабильнее - т.к. кода минимум, без всех этих дизасмов и т.п.<br><br><I>difexacaw пишет:<br>Что бы завести это на обычном апп нужно допилить системную часть - мониторить потоки, передачи управления из км, обработать сервисы, нп NtContinue. Иначе новые потоки не будут мониториться и при некоторых вызовах для мониторящегося потока слежение за ним будет теряться. </I><br>Воу воу, а как же &quot;не надо усложнять&quot; и &quot;собирается под пивас&quot;???<br><br>В итоге очередная поделка.<br>Если бы она хотя бы делала то что ты сам написал - позволяла запустить любой процесс и писала в лог (не в debug output!) адреса определённых команд (cpuid, rdtsc к примеру) - польза бы была, хоть какая-то.<br>А так очередной мотор и непризнанный гений, а вы все ламо и учите матчасть...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=388055&amp;user=6859&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=30" class="addthx" data-post="388055"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]f13nd[/b]','')">f13nd</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/8075.png" alt=""><br><span class=txtSm>Ранг: 271.2 (наставник), 331thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.63'>Активность: 0.32<span style='color:green'>&nearr;</span>1.49</span><br>Статус: <a href="action=userinfo&amp;user=8075">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 сентября 2018 13:46 <br><script type="text/javascript">QU('f13nd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=f13nd" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=4880&amp;page=28#31');return false;">#31</a> </span><div align=left><br>
Такой ажиотаж, я прямо не удержался.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">23</span><span class="hl_char">.</span><span class="hl_number">09</span><span class="hl_char">.</span><span class="hl_number">2018</span>&nbsp;&nbsp;<span class="hl_number">20</span><span class="hl_char">:</span><span class="hl_number">31</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8 704&nbsp;d2s<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_number">23</span><span class="hl_char">.</span><span class="hl_number">09</span><span class="hl_char">.</span><span class="hl_number">2018</span>&nbsp;&nbsp;<span class="hl_number">20</span><span class="hl_char">:</span><span class="hl_number">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 048&nbsp;<span class="hl_function">Test</span><span class="hl_char">.</span>exe</li><li class="hl_l0"><span class="hl_number">18</span><span class="hl_char">.</span><span class="hl_number">06</span><span class="hl_char">.</span><span class="hl_number">2017</span>&nbsp;&nbsp;<span class="hl_number">12</span><span class="hl_char">:</span><span class="hl_number">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 544 192&nbsp;xedl<span class="hl_char">.</span>dll</li>        </ol>
    </div>
</div></div>
8кб. Ну да, ну под 0.5 пиваса можно 8кб накидать. Внешним дизассемблером оно декодирует по 1 инструкции и переносит в буфер, следом за этой одной инструкцией джамп обратно:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00240000</span>&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">0A104000</span>&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">40100A</span></li><li class="hl_l1"><span class="hl_number">00240000</span>&nbsp;<span class="hl_number">8BFF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">,</span><span class="hl_registr">EDI</span></li><li class="hl_l0"><span class="hl_number">00240000</span>&nbsp;<span class="hl_number">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EBP</span></li><li class="hl_l1"><span class="hl_number">00240000</span>&nbsp;<span class="hl_number">8BEC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">,</span><span class="hl_registr">ESP</span></li><li class="hl_l0"><span class="hl_number">00240000</span>&nbsp;<span class="hl_number">837D</span>&nbsp;<span class="hl_number">08</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">00240000</span>&nbsp;<span class="hl_number">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">00240000</span>&nbsp;<span class="hl_number">56</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">ESI</span></li><li class="hl_l1"><span class="hl_number">00240000</span>&nbsp;<span class="hl_number">68</span>&nbsp;<span class="hl_number">84AC0F77</span>&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_number">770FAC84</span></li><li class="hl_l0"><span class="hl_number">00240000</span>&nbsp;FF75&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
По одной, карл! Помнится шеллшторм выкладывал полторы строчки на си, которые делали то же самое, и они были закиданы ссаными тряпками, а здесь даже базового &quot;дробить по инструкциями перехода&quot; нету, не говоря уже обо всей остальной &quot;прочей оптимизации&quot;. Надо было несколько месяцев парафинить головы, чтоб такой фуфел выкатить.
<br><br><font size="1"><i>-----<br>2 оттенка серого</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=388061&amp;user=8075&amp;forum_n=13&amp;topic=4880&amp;page=28&amp;anchor=31" class="addthx" data-post="388061"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=27.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=26.html">27</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=27.html">28</a> . <b>29</b> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=29.html">30</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=30.html">31</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=31.html">32</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=32.html">33</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=33.html">34</a> . <a href="action=vthread&amp;forum=13&amp;topic=4880&amp;page=29.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Quick Unpack - универсальный распаковщик</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="4880">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=4880" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
