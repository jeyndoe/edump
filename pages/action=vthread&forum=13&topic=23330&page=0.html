<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Взлом игр Electronic Arts (ActivationUI.exe, Activation.dll) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Electronic Arts Origin Service (ака steam №2) https://www.origin.com/ru-ru/store/ (ага! вот там трэшак всякий продают) intro: короче после некоторых событий, которые произошли вот в этой задолбавшей -&gt;теме&lt;-, я волей">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Взлом игр Electronic Arts (ActivationUI.exe, Activation.dll)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2015 11:53 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
<b>Electronic Arts Origin Service</b> (ака steam №2)<br><i class=x>https://www.origin.com/ru-ru/store/</i> (ага! вот там трэшак всякий продают)<br><br><u>intro:</u> короче после некоторых событий, которые произошли вот в этой задолбавшей <img src="img/smilies/s1.gif" alt=""> <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=19719" rel="nofollow" target="_blank">-&gt;теме&lt;-</a></noindex>, я волей неволей столкнулся с <i class=x>EA Origin</i>. Тема для меня новая, поле не паханное. Пообщался с народом - нету ни нормальных туторов, ни статей, ни описания что к чему, ну и, естественно, публичных тузл. <br>Ввиду моего глубокого негодования(НУ ЭТОЖ НЕ СТАРФОРС И НЕ СЕКУРОМ), желаю восполнить данный пробел. Накопал немножко, желаю поделиться. Авось кто восполнит пробелы и можно будет накатать полноценную статью.<br><br><u><b>Что мы имеем вначале:</b></u><br>1. Исходный PE-файл, который зашифрован. Точка входа смотрит сразу в...<br>2. <i class=x>Activation.dll</i>(Core/Activation.dll). Т.е. там сразу выполнен<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_char">[</span>Activation<span class="hl_char">.</span>#100<span class="hl_char">]</span>&nbsp;<span class="hl_char">(</span>ординал&nbsp;<span class="hl_number">100</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br>ну по типу как в старфорсе (или солидшиелде)...ну не важно<br>3. <i class=x>ActivationUI.exe</i>(Core/ActivationUI.exe)<br>4. Клиент origin<br>Главная суть проблемы заключается в расшифровке секций <i class=x>.text</i> и <i class=x>.rdata</i>, которые зашифрованы (если я правильно научился угадывать <strike>мелодию</strike> криптоалго <img src="img/smilies/s6.gif" alt=""> ) - <b>AES</b> с длинной ключа <b>128</b> (...256)<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428B1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>movzx</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>byte_100A0B48<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; &lt;$ignsrch&gt; &quot;AES Rijndael Si / ARIA X1 [..256]&quot;</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428B8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>shr</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">18h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428BB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>movzx</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span>byte_100A0B48<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; &lt;$ignsrch&gt; &quot;AES Rijndael Si / ARIA X1 [..256]&quot;</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428C2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>shr</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428C5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFh</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428CB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>movzx</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>byte_100A0B48<span class="hl_char">[</span><span class="hl_registr">edx</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; &lt;$ignsrch&gt; &quot;AES Rijndael Si / ARIA X1 [..256]&quot;</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428D2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>shl</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428D5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428D7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>shl</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428DA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428DC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFh</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428E2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>movzx</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>byte_100A0B48<span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; &lt;$ignsrch&gt; &quot;AES Rijndael Si / ARIA X1 [..256]&quot;</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428E9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>shl</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428EC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428EE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">+</span><span class="hl_number">0Ch</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428F1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428F3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ror</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428F6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FF00FF00h</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428FC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>rol</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">100428FF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FF00FFh</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">10042904</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">10042906</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">0Ch</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">10042909</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">1004290A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">1004290B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">1004290C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">1004290D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span></li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">10042910</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">retn</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">10042910</span>&nbsp;sub_10042380&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div>
<br>+ сверил с <i class=x>libeay32.dll</i>, прикинул в уме-таки да, похоже AES. OpenSSL - это 100% точно.<br><br><u>Подетально имеем следующую картинку:</u><br><i class=x>Activation.dll</i> сначала делает<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">HMODULE&nbsp;Target_Module_Handle&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">:</span><span class="hl_char">:</span>GetModuleHandleW<span class="hl_char">(</span><span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">:</span><span class="hl_char">:</span>GetModuleFileNameW<span class="hl_char">(</span>Target_Module_Handle<span class="hl_char">,</span><span class="hl_char">&amp;</span>buffer<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span>buf_size<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;target_file&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">:</span><span class="hl_char">:</span>CreateFileW<span class="hl_char">(</span><span class="hl_char">&amp;</span>buffer<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span>GENERIC_READ<span class="hl_char">,</span>FILE_SHARE_READ<span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span>OPEN_EXISTING<span class="hl_char">,</span>FILE_ATTRIBUTE_NORMAL<span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
 <br>чтобы извлечь из цели две структуры:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>Origin_Get_Critical_PE_Data<span class="hl_char">(</span>pSecurity_Table<span class="hl_char">,</span><span class="hl_char">&amp;</span>Target_Origin_block<span class="hl_char">,</span>&nbsp;target_file<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">typedef&nbsp;struct&nbsp;Origin_DATA_struct</li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;Dll_path<span class="hl_char">[</span><span class="hl_number">20</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;any_data<span class="hl_char">[</span><span class="hl_number">84</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;PresetSettingRange<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;Unk1_dword<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;First_Origin_SIGNATURE<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;Second_Origin_SIGNATURE<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;any_data2<span class="hl_char">[</span><span class="hl_number">336</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">}Origin_block<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span>pOrigin_block<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">typedef&nbsp;struct&nbsp;Security_Table__struct</li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;Sec_Unk_data<span class="hl_char">[</span>0x2D0<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;Is_XOR_data<span class="hl_comment">; //as BOOL - CMP BYTE PTR SS:[ESP+66C],0</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;First_Section_offset<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;Sizeof_XOR_data_for_VirtualProtect<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;Sec_Unk_data1<span class="hl_char">[</span>0x1D8<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">}Security_Table_block<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span>pSecurity_Table_block<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>их роль пока не совсем ясна до конца. Причем адрес (более точно: raw-смещение для seek) Security_Table_block берется из Origin_block.<br><br>затем <i class=x>Activation.dll</i> делает:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">CreateMutexA<span class="hl_char">(</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_quote">&quot;CoreXProcState&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>и<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">CreateFileMapping<span class="hl_char">(</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_char">&amp;</span>Target_Mapping<span class="hl_char">,</span>PAGE_READWRITE<span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span>0x1000<span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>т.е. открывает путь для обмена данными между двумя процессами.<br><br><i class=x>Activation.dll</i> затем порождает <i class=x>ActivationUI.exe</i> с аргументом <i class=x>&quot;/SMOID= %хэндл от CreateFileMapping%&quot;</i>, который собственно вторым процессом и выступит. <br>В свою очередь, <i class=x>ActivationUI.exe</i> порождает <i class=x>Origin.exe</i>(origin-клиент) или связывается, если тот уже запущен. Судя по всему, от orgin-клиента требуется только подтверждение входа в origin (offline или online). Кстати, после этого, формально работа активэйшн dll&#039;ки и exe&#039;шника закончена, ибо сам origin может только «правильно» запустить игру (нужен макрос специальный в командной строке, типа такого <i class=x>-=..\..=-\</i> и очевидно есть проверка по PID потом).<br>Короче имеем связь:<br><b><i class=x>Activation.dll</i> &lt;-&gt; <i class=x>ActivationUI.exe</i> &lt;-&gt; <i class=x>Origin.exe</i></b><br>Насчет последних двух уместно заметить, что они завязаны только на авторизации (точки останова на filemapping и mutex в origin-клиенте «молчат»).<br>Однако неформально пойдем далее. dll требует от exe (<i class=x>MapViewOfFile-UnmapViewOfFile</i>) AES-ключ(строка UNICODE «Key») и какие-то параметры лицензии и responce... смс по mapping «шифруются» <b>xor</b> с определенной маской типа <i class=x>6&#036;sjP3qwe1q@pO3o#5jNA</i>(вообще их там несколько, в зависимости от типа смс). Судя по всему, <i class=x>ActivationUI.exe</i> сам вытаскивает откуда-то ключ, который хранится на машине (offline режим никто не отменял). <strike>Я конечно не думаю, что AES ключ вшит в одну из структур, что были приведены выше</strike>. После идет расшифровка секций (проверка CRC этих секций), восстановление импорта и релоков.<br><u>OEP и дамп:</u><br>Переход на OEP осуществляется естественно с dll&#039;ки, причем адрес расшифрован(AES ключом?) и находится в стеке:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ESP</span><span class="hl_char">+</span>0x10<span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br>тащемта, после выхода из игрушки, dll&#039;ка подчищает за собой хендлы, мьютексы, какой-то там свой loop thread закрывает.<br>Ничего особенного с восстановлением дампа нет-PeTools, ImpRec (в моем случае с игрушкой, правда, часть импорта пришлось руками дописать-не распознавался. впрочем, это нормально), релоки... В ИТОГЕ у меня дамп работал без origin; <b>НО</b>, есть небольшой нюанс - в target в самом начале (WinMainCRTStartup когда вызывает код самой программы), стоит маленькая функа, которая проверяет, есть ли связь с Origin-клиентом (чтобы проверить offline/online), так вот её нужно немножко «полечить» EAX=1 или RAX=1 (короче, <i class=x>return true</i>).<br><br><u>Другие наблюдения:</u><br>1. Куча (штук 5) тредов во всех трех цепочках с непонятной функциональностью.<br>2. IGO32.dll (igo64.dll), которые Origin.exe инжектит в target. Причем, хук в target на <i class=x>LoadLibrary</i> остается до конца. Тут работает также <i class=x>igoproxy64.exe</i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=350811&amp;user=26651&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=1" class="addthx" data-post="350811"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37163" title="11-01-2015 10:28, ранг:2.8" target="_blank">hello</a>, <a href="action=userinfo&user=35168" title="11-01-2015 23:16, ранг:9.8" target="_blank">v00doo</a>, <a href="action=userinfo&user=4773" title="12-01-2015 01:52, ранг:142.2" target="_blank">plutos</a>, <a href="action=userinfo&user=31820" title="13-01-2015 09:11, ранг:0.5" target="_blank">gurololicon</a>, <a href="action=userinfo&user=31325" title="24-04-2015 09:12, ранг:3.0" target="_blank">zNob</a>, <a href="action=userinfo&user=4554" title="22-02-2018 17:00, ранг:218.2" target="_blank">HandMill</a>, <a href="action=userinfo&user=46769" title="20-11-2018 01:52, ранг:0.0" target="_blank">jude</a>, <a href="action=userinfo&user=47538" title="02-01-2019 23:51, ранг:0.0" target="_blank">SasukeK93</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]gazlan[/b]','')">gazlan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1744.png" alt=""><br><span class=txtSm>Ранг: 170.1 (ветеран), 96thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=1744">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2015 19:34 <br><script type="text/javascript">QU('gazlan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=gazlan" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>похоже AES</I><br><br>SHA160/AES<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/7d15_11.01.2015_EXELAB.rU.tgz">7d15_11.01.2015_EXELAB.rU.tgz</a> - OriginClientService.exe.cc.7z
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=350852&amp;user=1744&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=2" class="addthx" data-post="350852"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 января 2015 21:11 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
В первых версиях, при наличии ключа, после прогрузки длл и прыжка на оеп. Имели полностью рабочии ехе в памяти. Без ВМ, защиты импорта и остального. Т е снималось не сложнее упх. Потом под еа оригин стали класть вм секурома. Дальше я не копал, т к не знал для чего там секур. По сути он выполнял функу вм без активации, но как то инициализировался.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=350856&amp;user=4618&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=3" class="addthx" data-post="350856"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2015 03:04 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>Ничего особенного с восстановлением дампа нет-PeTools, ImpRec (в моем случае с игрушкой, правда, часть импорта пришлось руками дописать-не распознавался. впрочем, это нормально) </I><br>Вообщето раньше была криптована только секция кода, скопировав в его в оригинальный файл и найдя оригинальную точку входа в Import Directory  и исправив ОЕР можно было получить идеальный экзешен.
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=350868&amp;user=17432&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=4" class="addthx" data-post="350868"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2015 07:35 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>gazlan пишет:<br>SHA160/AES </I><br>ок.<br><I>Nightshade пишет:<br>Дальше я не копал, т к не знал для чего там секур </I><br>Нету больше секурома <img src="img/smilies/s1.gif" alt=""> ни в еа оригин и вообще<br><br>а собственно ключ SHA160/AES мы как получаем? от сервера в обмен на код активации игры?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=350873&amp;user=26651&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=5" class="addthx" data-post="350873"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2018 18:48 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
апаю.<br>накидайте, пожалуйста, в личку dlf-файлов обрыгина, кому не жалко. Желательно игрушек с денувой.<br><i class=x>&quot;C:&#92;ProgramData&#92;Electronic Arts&#92;EA Services&#92;License&#92;*.dlf&quot;</i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=382297&amp;user=26651&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=6" class="addthx" data-post="382297"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]jude[/b]','')">jude</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=46769">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2018 04:31 <br><script type="text/javascript">QU('jude','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=jude" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Приветствую всех, у меня появился вопрос.<br>При запуске игры x64 сначала идет проверка Activation64.dll .. смотрит дальше файл лицензии .. ну а потом закрывает текущий процесс и после всех манипуляций Origin запускает новый процесс игры как я понял с расшифрованными секциями и уже без подгрузки Activation64.dll.<br>Вопрос заключается в том, что exe игры крашится (Access violation writing location ntdll.dll) после всех моих монипуляций: Убрал проверку Activation64.dll и изменил переход OEP на действительный (реальный) старт игры, пофиксил таблицу импорта.<br>Может кто подскажет в чем причина?<br>P.S. Могу записать видео как все делал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=389231&amp;user=46769&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=7" class="addthx" data-post="389231"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2018 10:10 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>jude</b><br>x64 игра - название у игры есть?<img src="img/smilies/s1.gif" alt=""> Небось DENUVO ещё накрыта.<br><I>jude пишет:<br>При запуске игры x64 сначала идет проверка Activation64.dll .. смотрит дальше файл лицензии .. ну а потом закрывает текущий процесс и после всех манипуляций Origin запускает новый процесс игры как я понял с расшифрованными секциями и уже без подгрузки Activation64.dll. </I><br>Нет, не совсем так. В любом случае, будет грузиться Activation64.dll и проверять всегда лицуху. Второй раз - если игра не из клиента origin (правильно OriginCore это называется, судя по SDK) запущена была. Activation64.dll получает по каналу от OriginCore ключ, расшифровывает всё, восстанавливает секции и идёт jmp на OEP. Тут должен быть чистый дамп по всем канонам (помнится OllyDmpEx к x64dbg делал).<br><I>jude пишет:<br>Вопрос заключается в том, что exe игры крашится (Access violation writing location ntdll.dll) после всех моих монипуляций: Убрал проверку Activation64.dll и изменил переход OEP на действительный (реальный) старт игры, пофиксил таблицу импорта. </I><br>Наверное-ж требуется корректно OriginStub вырезать. Первая инициализация (OriginInit) + встроенная в функа (OriginUpdate). В каком месте именно краш(Середина игра - старт игры?)?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=389239&amp;user=26651&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=8" class="addthx" data-post="389239"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]jude[/b]','')">jude</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=46769">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2018 15:39 <br><script type="text/javascript">QU('jude','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=jude" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>x64 игра - название у игры есть? Небось DENUVO ещё накрыта. </I><br>Игра Battlefield 4, версия exe: 1.8.2.48475<br><I>ELF_7719116 пишет:<br>Нет, не совсем так. В любом случае, будет грузиться Activation64.dll и проверять всегда лицуху. Второй раз - если игра не из клиента origin (правильно OriginCore это называется, судя по SDK) запущена была. Activation64.dll получает по каналу от OriginCore ключ, расшифровывает всё, восстанавливает секции и идёт jmp на OEP. Тут должен быть чистый дамп по всем канонам (помнится OllyDmpEx к x64dbg делал). </I><br>Да согласен. Просто не стал расписывать что уже было написанно в начале темы.<br><I>ELF_7719116 пишет:<br>Наверное-ж требуется корректно OriginStub вырезать. Первая инициализация (OriginInit) + встроенная в функа (OriginUpdate). В каком месте именно краш(Середина игра - старт игры?)?  </I><br>На самом старте игры, даже окно игры не успевает создаться.<br><br><b>Добавлено спустя 2 часа 15 минут</b><br>Эхх, столько много проверок OriginStub:<br>OriginStartup,<br>OriginRequestAuthCode,<br>OriginGetSettingSync,<br>OriginGetGameInfoSync,<br>OriginDestroyHandle,<br>OriginShutdown,<br>OriginUpdate,<br>OriginCheckOnline,<br>OriginGetProfileSync,<br>OriginGetProfile,<br>OriginQueryPresence,<br>OriginRegisterEventCallback,<br>OriginStartGame,<br>OriginIGOShutdown<br><br>И это еще не полный список.<br>Даже не знаю как все это вырезать, т.к крашится игра непонятно почему.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=389250&amp;user=46769&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=9" class="addthx" data-post="389250"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]v00doo[/b]','')">v00doo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 80.6 (постоянный), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.07'>Активность: 0.1<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=35168">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2018 18:15 &middot; Поправил: v00doo <br><script type="text/javascript">QU('v00doo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=v00doo" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>Наверное-ж требуется корректно OriginStub вырезать. Первая инициализация (OriginInit) + встроенная в функа (OriginUpdate) </I><br><I>jude пишет:<br>OriginStub </I><br>Это не stub, это Origin SDK, игра получает необходимую информацию, например ник пользователя, статус сети и прочее, тоже самое что есть у steam или uplay, только тут нет никаких публичных документаций само собой, парни со сцены реверсят и пишут эмуляторы клиентов.<br><I>ELF_7719116 пишет:<br>Первая инициализация (OriginInit) + встроенная в функа (OriginUpdate)<br> </I><br>Инит говорит сдк какой идишник игры стартует, update служит для обновления колбечин сдк, его не надо вырезать уж точно.<br>Stub там один, protection id называет его EaDRM, там просто криптовка поверх бинаря, дальше восстанавливаются директории, если они были сперты и  все, бинарь дальше чист, если там нет denuvo.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=389252&amp;user=35168&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=10" class="addthx" data-post="389252"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=1379" title="21-11-2018 15:32, ранг:576.1" target="_blank">Jupiter</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]jude[/b]','')">jude</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=46769">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2018 19:03 <br><script type="text/javascript">QU('jude','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=jude" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Да я в курсе что это Origin SDK &quot;Code&#92;External&#92;EA&#92;OriginSDK&#92;src&#92;impl&#92;OriginSDKstub.cpp&quot;<br>Эмулятор Origin написать не сложно, готовые уже есть.<br>EaDRM вырезал успешно как показывает Protection ID.<br>Но проблема в другом, а в том, что игра крашится по непонятным причинам.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=389253&amp;user=46769&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=11" class="addthx" data-post="389253"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2018 19:10 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>v00doo пишет:<br>Это не stub, это Origin SDK </I><br>Origin SDK это как-бы всё общее. первую инит функа stub/EaDRM, да<br><I>v00doo пишет:<br>и пишут эмуляторы клиентов. </I><br>клиент абсолютно не обязательно эмулить (это 100%)<br><I>v00doo пишет:<br>update служит для обновления колбечин сдк, его не надо вырезать уж точно. </I><br>если стек коллбеков пуст, то оно не нужно. Если не был инициализирован, то он просто выводит OutDebugString а-ля &quot;Origin SDK not running&quot;<br><I>v00doo пишет:<br>Инит говорит сдк какой идишник игры стартует </I><br>не только. В инит 4 параметра должно передаваться:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">typedef&nbsp;struct&nbsp;struct_EA_ACCESS_request</li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;ContentId<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;Title<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;MultiplayerId<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;Language<span class="hl_comment">;</span></li><li class="hl_l0">}EA_ACCESS_request<span class="hl_char">,</span>&nbsp;<span class="hl_char">*</span>pEA_ACCESS_request<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br><I>jude пишет:<br>Игра Battlefield 4, версия exe: 1.8.2.48475 </I><br>Да, знаю такую, ковырял. Ещё теперь внутри интерфейс сетевой игры сделали??<img src="img/smilies/s1.gif" alt=""> Раньше браузер запускался. <br>Если просто дамп корректно сделать, а Origin SDK не трогать - игра будет просто запускаться без крашей (если Origin CORE включен, то оно запустится без проблем в распакованном виде, при замене <b>bf4_dump.exe</b> на <b>bf4.exe</b>)?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=389283&amp;user=26651&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=12" class="addthx" data-post="389283"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]jude[/b]','')">jude</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.5 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 1.64'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=46769">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2018 20:04 &middot; Поправил: jude <br><script type="text/javascript">QU('jude','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=jude" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>Да, знаю такую, ковырял. Ещё теперь внутри интерфейс сетевой игры сделали?? Раньше браузер запускался. <br>Если просто дамп корректно сделать, а Origin SDK не трогать - игра будет просто запускаться без крашей (если Origin CORE включен, то оно запустится без проблем в распакованном виде, при замене bf4_dump.exe на bf4.exe)?  </I><br>Да верно теперь интерфейс внутри игры сделали.<br>Я толком и дамп нормально сделать не могу, вот адресс реального старта игры как я думаю 0x1411840A8 он же в дальнейшем запускает фунцию WinMain.<br>Проблема еще в том, что отладить процесс который был запущен OriginCore-м не получается. Т.к перехватить прямо старт запуска нового процесса игры не получается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=389287&amp;user=46769&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=13" class="addthx" data-post="389287"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2018 20:47 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=23330.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>jude пишет:<br>Т.к перехватить прямо старт запуска нового процесса игры не получается.  </I><br>Дааа, есть такое дело. Необходимо управление успеть перехватить в activation(64).dll<br>Где-то у меня валялся старый bf4_патченный.exe, корректно сдампленный. Со стабом/EaDRM патченным браузер запускался. Скриншот с exe&#039;шника нашел - сам exe файло пока нет.<br><br><b>upd</b><br>BF4_Dumped_1.4.2.23831 в личку отправил<br><br><img src="img/attach.gif" alt=""> <a href="./files/a5b2_22.11.2018_EXELAB.rU.tgz">a5b2_22.11.2018_EXELAB.rU.tgz</a> - TANK.jpg
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=389291&amp;user=26651&amp;forum_n=13&amp;topic=23330.html&amp;page=0&amp;anchor=14" class="addthx" data-post="389291"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=46769" title="22-11-2018 17:58, ранг:2.0" target="_blank">jude</a>, <a href="action=userinfo&user=39556" title="22-11-2018 23:40, ранг:71.4" target="_blank">sefkrd</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Взлом игр Electronic Arts (ActivationUI.exe, Activation.dll)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#15" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="23330">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23330" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
