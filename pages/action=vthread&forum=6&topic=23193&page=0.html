<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>C# Вызвать функцию по адресу - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Вообщем, есть сторонняя программа, а мне из своей нужно вызвать в чужой функцию - как это сделать? Функция располагается по адресу 00402AF0">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> C# Вызвать функцию по адресу</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2014 21:12 <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Вообщем, есть сторонняя программа, а мне из своей нужно вызвать в чужой функцию - как это сделать?<br>Функция располагается по адресу 00402AF0
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348361&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=1" class="addthx" data-post="348361"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2014 21:34 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Никак.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348362&amp;user=6336&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=2" class="addthx" data-post="348362"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2014 22:21 <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Никак.  </I><br>Да, да, вот это ответ который я хотел увидеть. А по делу - не говори если не знаешь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348365&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=3" class="addthx" data-post="348365"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]4kusNick[/b]','')">4kusNick</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1931.jpg" alt=""><br><span class=txtSm>Ранг: 748.2 <font color=magenta>(<b>! !</b>)</font>, 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.1'>Активность: 0.37<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1931">Участник</a><br><font color=blue>bytecode!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2014 22:26 <br><script type="text/javascript">QU('4kusNick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=4kusNick" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Uz_</b><br>Подробней опишите условия.<br><br>Я бы например добавил атрибут MarshalByRefObject к нужному мне методу, прогрузил бы приложение через свой лоадер в отдельный AppDomain и вызывал бы требуемый метод из этого лоадера.<br>Но это не сработает в ряде случаев.
<br><br><font size="1"><i>-----<br>Флэш, ява, дотнет - на завтрак, обед и ужин. Unity3D на закуску.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348366&amp;user=1931&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=4" class="addthx" data-post="348366"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2014 22:45 <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>4kusNick пишет:<br>Подробней опишите условия. </I><br>Есть значит игруха, ее процесс - Gothic2.exe, в игре по адресу 00402AF0 находится конструктор класса zSTRING, воот.<br>Нужно вызвать этот конструктор, а позже и другие функции. На C++ можно подгрузить dll в процесс и вызвать через ассемблерную вставку по типу call адресс.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348367&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=5" class="addthx" data-post="348367"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]TOM_RUS[/b]','')">TOM_RUS</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.9 (новичок), 22thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.38'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3852">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2014 23:09 <br><script type="text/javascript">QU('TOM_RUS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TOM_RUS" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
На C# примерно так же, только надо еще .NET Runtime сначала загрузить в процесс, потом загрузить сборку, в ней создать делегат и заюзать <noindex><a href="http://msdn.microsoft.com/en-us/library/zdx6dyyh(v=vs.100).aspx" rel="nofollow" target="_blank">Marshal.GetDelegateForFunctionPointer</a></noindex>.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348368&amp;user=3852&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=6" class="addthx" data-post="348368"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2014 23:16 <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>TOM_RUS пишет:<br>На C# примерно так же, только надо еще .NET Runtime сначала загрузить в процесс, потом загрузить сборку, в ней создать делегат и заюзать Marshal.GetDelegateForFunctionPointer.  </I><br>dll&#039;ку на С# грузить в процесс и там вызывать? 0_0
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348369&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=7" class="addthx" data-post="348369"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Nimnul[/b]','')">Nimnul</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1619.gif" alt=""><br><span class=txtSm>Ранг: 218.9 (наставник), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1619">Участник</a><br><font color=blue>dotnet</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 00:09 &middot; Поправил: Nimnul <br><script type="text/javascript">QU('Nimnul','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nimnul" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Есть такой <noindex><a href="http://msdn.microsoft.com/ru-ru/library/system.reflection.emit.opcodes.calli%28v=vs.110%29.aspx" rel="nofollow" target="_blank">опкод в msil</a></noindex>, забей в своей длл перемычку. Например void Call(int adr); Потом ildasm&#039;ом декомпильни библиотеку и отредактируй тело метода, вставив туда calli. После чего собери ее назад ilasm&#039;ом<br><br>это будет выглядеть как то так:<br>...<br>ldarg.0<br>calli<br>...<br><br>Будет вызвана функция по адресу adr. Но если тебе нужно передать в функцию параметры, их нужно перед вызовом положить на стек. Если тебе известна сигнатура вызываемой функции напиши ее, я помогу с msil
<br><br><font size="1"><i>-----<br>have a nice day</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348370&amp;user=1619&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=8" class="addthx" data-post="348370"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 00:19 <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Мне тут проще вариант дали, только вот нужные функции типа Write и флаг All не нашел, а так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>public</b></span>&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">(</span>IntPtr&nbsp;injAddress<span class="hl_char">,</span>&nbsp;IntPtr&nbsp;callAddress<span class="hl_char">,</span>&nbsp;params&nbsp;<span class="hl_function">int</span><span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;funcArgs<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tHandle&nbsp;<span class="hl_char">=</span>&nbsp;OpenThread<span class="hl_char">(</span>ThreadAccess<span class="hl_char">.</span>All<span class="hl_char">,</span>&nbsp;<span class="hl_function">false</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">this</span><span class="hl_char">.</span>Process<span class="hl_char">.</span>Threads<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">.</span>Id<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>SuspendThread<span class="hl_char">(</span>tHandle<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;Win32Exception<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;context&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;CONTEXT&nbsp;{&nbsp;ContextFlags&nbsp;<span class="hl_char">=</span>&nbsp;ContextFlags<span class="hl_char">.</span>Control&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>GetThreadContext<span class="hl_char">(</span>tHandle<span class="hl_char">,</span>&nbsp;ref&nbsp;context<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;Win32Exception<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;retaddr&nbsp;<span class="hl_char">=</span>&nbsp;Write<span class="hl_char">&lt;</span>uint<span class="hl_char">&gt;</span><span class="hl_char">(</span>0xDEAD<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;bytes&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;List<span class="hl_char">&lt;</span><span class="hl_function">byte</span><span class="hl_char">&gt;</span><span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;#region&nbsp;ASM</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;eip&nbsp;<span class="hl_char">(</span>stored&nbsp;refernse&nbsp;to&nbsp;next&nbsp;inctruction<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0x68<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span>AddRange<span class="hl_char">(</span>BitConverter<span class="hl_char">.</span>GetBytes<span class="hl_char">(</span>context<span class="hl_char">.</span>Eip<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>pushad</b></span>&nbsp;<span class="hl_char">(</span>stored&nbsp;general&nbsp;registers<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0x60<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>pushfd</b></span>&nbsp;<span class="hl_char">(</span>stored&nbsp;flags<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0x9C<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;pushed&nbsp;to&nbsp;the&nbsp;stack&nbsp;function&nbsp;arguments</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;funcArgs<span class="hl_char">.</span>Length&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">; i &gt;= 0; --i)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;param_address</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0x68<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span>AddRange<span class="hl_char">(</span>BitConverter<span class="hl_char">.</span>GetBytes<span class="hl_char">(</span>funcArgs<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;callAddress</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0xB8<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span>AddRange<span class="hl_char">(</span>BitConverter<span class="hl_char">.</span>GetBytes<span class="hl_char">(</span>callAddress<span class="hl_char">.</span>ToInt32<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0xFF<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0xD0<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;arg_count&nbsp;<span class="hl_char">*</span>&nbsp;pointersize&nbsp;<span class="hl_char">(</span>__cdecl&nbsp;correct&nbsp;stack<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0x83<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0xC4<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">byte</span><span class="hl_char">)</span><span class="hl_char">(</span>funcArgs<span class="hl_char">.</span>Length&nbsp;<span class="hl_char">*</span>&nbsp;IntPtr<span class="hl_char">.</span>Size<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span>retaddr<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0xA3<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span>AddRange<span class="hl_char">(</span>BitConverter<span class="hl_char">.</span>GetBytes<span class="hl_char">(</span>retaddr<span class="hl_char">.</span>ToInt32<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>popfd</b></span>&nbsp;<span class="hl_char">(</span>restore&nbsp;flags<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0x9D<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>popad</b></span>&nbsp;<span class="hl_char">(</span>restore&nbsp;general&nbsp;registers<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0x61<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function">retn</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;bytes<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>0xC3<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;#endregion</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;oldProtect&nbsp;<span class="hl_char">=</span>&nbsp;MemoryProtection<span class="hl_char">.</span>ReadOnly<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Save&nbsp;original&nbsp;<span class="hl_function"><b>code</b></span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;disable&nbsp;protect</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;oldCode&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">this</span><span class="hl_char">.</span>ReadBytes<span class="hl_char">(</span>injAddress<span class="hl_char">,</span>&nbsp;bytes<span class="hl_char">.</span>Count<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>VirtualProtectEx<span class="hl_char">(</span><span class="hl_function">this</span><span class="hl_char">.</span>Process<span class="hl_char">.</span>Handle<span class="hl_char">,</span>&nbsp;injAddress<span class="hl_char">,</span>&nbsp;bytes<span class="hl_char">.</span>Count<span class="hl_char">,</span>&nbsp;MemoryProtection<span class="hl_char">.</span>ExecuteReadWrite<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;oldProtect<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;Win32Exception<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">this</span><span class="hl_char">.</span>Write<span class="hl_char">(</span>injAddress<span class="hl_char">,</span>&nbsp;bytes<span class="hl_char">.</span>ToArray<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;context<span class="hl_char">.</span>Eip&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>uint<span class="hl_char">)</span>injAddress<span class="hl_char">.</span>ToInt32<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>SetThreadContext<span class="hl_char">(</span>tHandle<span class="hl_char">,</span>&nbsp;ref&nbsp;context<span class="hl_char">)</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;ResumeThread<span class="hl_char">(</span>tHandle<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;0xFFFFFFFF<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;Win32Exception<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; i &lt; 0x100; ++i)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System<span class="hl_char">.</span>Threading<span class="hl_char">.</span>Thread<span class="hl_char">.</span>Sleep<span class="hl_char">(</span><span class="hl_number">15</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_function">this</span><span class="hl_char">.</span>Read<span class="hl_char">&lt;</span>uint<span class="hl_char">&gt;</span><span class="hl_char">(</span>retaddr<span class="hl_char">)</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;0xDEAD<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>break</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;restore&nbsp;protection&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;original&nbsp;<span class="hl_function">code</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">this</span><span class="hl_char">.</span>Write<span class="hl_char">(</span>injAddress<span class="hl_char">,</span>&nbsp;oldCode<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>FlushInstructionCache<span class="hl_char">(</span><span class="hl_function">this</span><span class="hl_char">.</span>Process<span class="hl_char">.</span>Handle<span class="hl_char">,</span>&nbsp;injAddress<span class="hl_char">,</span>&nbsp;bytes<span class="hl_char">.</span>Count<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;Win32Exception<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>VirtualProtectEx<span class="hl_char">(</span><span class="hl_function">this</span><span class="hl_char">.</span>Process<span class="hl_char">.</span>Handle<span class="hl_char">,</span>&nbsp;injAddress<span class="hl_char">,</span>&nbsp;bytes<span class="hl_char">.</span>Count<span class="hl_char">,</span>&nbsp;oldProtect<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>out</b></span>&nbsp;oldProtect<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;Win32Exception<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">this</span><span class="hl_char">.</span>Free<span class="hl_char">(</span>retaddr<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br><b>Добавлено спустя -58 минут</b><br>Нашел так-же такое дело на Delphi:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">function&nbsp;CallRemoteProc<span class="hl_char">(</span>ProcessId<span class="hl_char">:</span>&nbsp;CARDINAL<span class="hl_comment">; FuncAddr: POINTER; FuncArg: PFunctionData): BOOL;</span></li><li class="hl_l1">var</li><li class="hl_l0">RemotePMem<span class="hl_char">:</span>&nbsp;POINTER<span class="hl_comment">;</span></li><li class="hl_l1">HProcess<span class="hl_char">,</span>&nbsp;RealWrite<span class="hl_char">,</span>&nbsp;MyThread<span class="hl_char">,</span>&nbsp;CRT&nbsp;<span class="hl_char">:</span>&nbsp;CARDINAL<span class="hl_comment">;</span></li><li class="hl_l0">begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;HProcess&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;OpenProcess<span class="hl_char">(</span>PROCESS_ALL_ACCESS<span class="hl_char">,</span>&nbsp;<span class="hl_function">FALSE</span><span class="hl_char">,</span>&nbsp;ProcessId<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;HProcess&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>FALSE</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;RemotePMem&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;VirtualAllocEx<span class="hl_char">(</span>HProcess<span class="hl_char">,</span>&nbsp;NIL<span class="hl_char">,</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>FuncArg^<span class="hl_char">)</span>&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;MEM_COMMIT<span class="hl_char">,</span>&nbsp;PAGE_READWRITE<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;Assigned<span class="hl_char">(</span>RemotePMem<span class="hl_char">)</span>&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>HProcess<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>FALSE</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;WriteProcessMemory<span class="hl_char">(</span>HProcess<span class="hl_char">,</span>&nbsp;RemotePMem<span class="hl_char">,</span>&nbsp;FuncArg<span class="hl_char">,</span>&nbsp;<span class="hl_function">SizeOf</span><span class="hl_char">(</span>FuncArg^<span class="hl_char">)</span>&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">,</span>&nbsp;RealWrite<span class="hl_char">)</span>&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>HProcess<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>FALSE</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;CRT&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;CreateRemoteThread<span class="hl_char">(</span>HProcess<span class="hl_char">,</span>&nbsp;NIL<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;FuncAddr<span class="hl_char">,</span>&nbsp;RemotePMem<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;MyThread<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;CRT&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>HProcess<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>FALSE</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>HProcess<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;Result&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>TRUE</b></span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348371&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=9" class="addthx" data-post="348371"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Nimnul[/b]','')">Nimnul</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1619.gif" alt=""><br><span class=txtSm>Ранг: 218.9 (наставник), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1619">Участник</a><br><font color=blue>dotnet</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 00:27 &middot; Поправил: Nimnul <br><script type="text/javascript">QU('Nimnul','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nimnul" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Что то ничего простого не вижу <img src="img/smilies/s1.gif" alt="">. Я как то мутил вызов функций через подмену возвращаемого адреса, и то выглядело менее страшно и работало почти также быстро как обычный call
<br><br><font size="1"><i>-----<br>have a nice day</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348372&amp;user=1619&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=10" class="addthx" data-post="348372"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 00:28 <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Nimnul пишет:<br>Что то ничего простого не вижу . Я как то мутил вызов функций через подмену возвращаемого адреса, и то выглядело менее страшно и работало почте таже быстро как обычный call  </I><br>Мне бы примерчик.<br><br><b>Добавлено спустя -59 минут</b><br><I>Nimnul пишет:<br>Что то ничего простого не вижу . Я как то мутил вызов функций через подмену возвращаемого адреса, и то выглядело менее страшно и работало почти также быстро как обычный call  </I><br>Блин, и вообще, через dll не желательно в моем случае.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348373&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=11" class="addthx" data-post="348373"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Nimnul[/b]','')">Nimnul</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1619.gif" alt=""><br><span class=txtSm>Ранг: 218.9 (наставник), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1619">Участник</a><br><font color=blue>dotnet</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 00:32 <br><script type="text/javascript">QU('Nimnul','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nimnul" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Uz_</b><br><br>Еще раз если я правильно понял у тебя есть C# из него тебе надо вызвать Native по адресу?
<br><br><font size="1"><i>-----<br>have a nice day</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348374&amp;user=1619&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=12" class="addthx" data-post="348374"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 00:37 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<i class=x>А по делу - не говори если не знаешь. </i><br>А я продолжаю утверждать, что никак. Вначале нам надо заинжектить свой <strike>говно</strike>код на дотнете, который для этих целей ну совсем не подходит. Как это сделать, описано <noindex><a href="http://www.codeproject.com/Articles/607352/Injecting-Net-Assemblies-Into-Unmanaged-Processes" rel="nofollow" target="_blank">--&gt; тут &lt;--</a></noindex><br><br>Т.к. целевой процесс сам по себе не на дотнете, то, как вы понимаете, некоторые из описанных тут вариантов ну вообще не подходят. Но, допустим, заинжектились и всё получилось.<br><br>Дальше вы начинаете <b> вызвать этот конструктор, а позже и другие функции</b> (цитата).<br>И тут вы понимаете, что тупо дергать функции из другого приложения - вообще не лучшая идея. Они могут быть связаны друг с другом объектами синхронизации, инициализировать глобальные переменные, синглтоны. В общем, скорее всего, желаемые результат не будет достигнут. Поэтому возвращаемся к сокращённому варианту &quot;НИКАК&quot;. Вы просто неправильно решаете задачу.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348375&amp;user=6336&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=13" class="addthx" data-post="348375"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 00:41 <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>А по делу - не говори если не знаешь. <br>А я продолжаю утверждать, что никак. Вначале нам надо заинжектить свой говнокод на дотнете, который для этих целей ну совсем не подходит. Как это сделать, описано --&gt; тут &lt;--<br><br>Т.к. целевой процесс сам по себе не на дотнете, то, как вы понимаете, некоторые из описанных тут вариантов ну вообще не подходят. Но, допустим, заинжектились и всё получилось.<br><br>Дальше вы начинаете вызвать этот конструктор, а позже и другие функции (цитата).<br>И тут вы понимаете, что тупо дергать функции из другого приложения - вообще не лучшая идея. Они могут быть связаны друг с другом объектами синхронизации, инициализировать глобальные переменные, синглтоны. В общем, скорее всего, желаемые результат не будет достигнут. Поэтому возвращаемся к сокращённому варианту &quot;НИКАК&quot;. Вы просто неправильно решаете задачу. <br> </I><br>То что я пытаюсь сделать - уже реализовано, и не через dll.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348376&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=14" class="addthx" data-post="348376"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 00:44 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Пока писал, появились и другие посты. Т.е. оказывается, что и классические способы для вас подходят, и вы всё ещё не оставили планов на изврат.<br><br>Ну, тогда всё достаточно тривиально.  Определяетесь с разрядностью игры, я так понял, что там х86. Потом выделяете память в другом процессе, пишете туда шеллкод, передаёте на него управление.<br><br>Пройдёмся по этапам. Выше код уже привели, разберём суть.<br><br>1. Выделить память. Для этого юзается VirtualAlloEx. Для его вызова нам нужен дескриптор процесса, в котором память будет выделяться. Для этого дёргаем OpenProcess. <br>2. Шеллкод в самом простом случае - набор инструкций push и retn в конце. push передают параметры (если соглашение stdcall или cdecl), а последние push retn эмулируют call. Так просто писать проще, потому что push базонезависимы.<br>3. Выполнить это можно, дёрнув CreateRemoteThread. <br><br>И, конечно, это всё же не очень удобно на дотнете. Но я практически уверен, что это не то, что нужно сделать. Вот опишите задачу, какая ваша конечная цель? Зачем вам дёргать эту функцию?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348377&amp;user=6336&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=15" class="addthx" data-post="348377"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 00:45 &middot; Поправил: Uz_ <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Nimnul пишет:<br>Еще раз если я правильно понял у тебя есть C# из него тебе надо вызвать Native по адресу?  </I><br>Есть процесс игры, в нем по некому адресу лежит функция, мне эту функцию надо вызвать.<br><br>Проще говоря, представим программу(a.exe) в которой есть функция, к примеру:<br>void Func(){<br>  MessageBox.Show(&quot;abc&quot;);<br>}<br>Функция располагается допустим по адресу 00402AF0<br><br>А мы, через нашу программу на C#(b.exe) вызываем эту функцию из памяти программы a.exe<br><br>Мы вызываем и получаем MessageBox с текстом abc.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348378&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=16" class="addthx" data-post="348378"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 01:10 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Uz_</b> я вот тут все это читал.. и молчал.. все что касается .НЕТ както хорошо обсуждалось с пол года назад.. НЕТУ ТАМ по факту адресов.. .НЕТ предкомпиляцию делает.. код перед выполнением. я может сильно не прав.. но как по мне.. надо решать вопрос либо на стадии патчинга, чтоб уже в память разворачивался правильный попатченный код, либо уже в памяти ловить. вообще то все это попахивает дурным скрещиванием гибона с насорогом
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348381&amp;user=17319&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=17" class="addthx" data-post="348381"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Nimnul[/b]','')">Nimnul</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1619.gif" alt=""><br><span class=txtSm>Ранг: 218.9 (наставник), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1619">Участник</a><br><font color=blue>dotnet</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 03:07 <br><script type="text/javascript">QU('Nimnul','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nimnul" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>Uz_ пишет:<br>А мы, через нашу программу на C#(b.exe) вызываем эту функцию из памяти программы a.exe </I><br><br>Ну тогда вызов функции это меньшее из проблем что тебя ожидает. Тут надо делать инъекцию длл. А делать инъекцию .Net длл, в процесс не .Net это жесть, потому что нужно подгрузить весь рантайм. Правильно делать dll на C и мутить дальше.
<br><br><font size="1"><i>-----<br>have a nice day</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348385&amp;user=1619&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=18" class="addthx" data-post="348385"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 03:23 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>Nimnul пишет:<br>Ну тогда вызов функции это меньшее из проблем что тебя ожидает. Тут надо делать инъекцию длл. А делать инъекцию .Net длл, в процесс не .Net это жесть, потому что нужно подгрузить весь рантайм. Правильно делать dll на C и мутить дальше. <br> </I><br> я вот человеку пытаюсь об этапах рассказать.. но чую что не был услышан
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348386&amp;user=17319&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=19" class="addthx" data-post="348386"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 13:01 &middot; Поправил: Uz_ <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Nimnul пишет:<br><br>Ну тогда вызов функции это меньшее из проблем что тебя ожидает. Тут надо делать инъекцию длл. А делать инъекцию .Net длл, в процесс не .Net это жесть, потому что нужно подгрузить весь рантайм. Правильно делать dll на C и мутить дальше. <br> </I><br>Проехали, пробовал на С++ - ничего. Инжектил dll&#039;ку и через нее исполнял команды - программа не реагирует а dll&#039;ка останавливается на вызове. Вот собсна код вызова:взят из проекта Gothic 2 Ext<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>This</b></span>&nbsp;file&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;G2Ext&nbsp;SDK&nbsp;headers<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">The&nbsp;G2Ext&nbsp;SDK&nbsp;headers</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Copyright&nbsp;©&nbsp;<span class="hl_number">2009</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">2010</span>&nbsp;by&nbsp;Paindevs&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;Patrick&nbsp;Vogel</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">All&nbsp;Rights&nbsp;reserved<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">THE&nbsp;WORK&nbsp;<span class="hl_char">(</span>AS&nbsp;DEFINED&nbsp;BELOW<span class="hl_char">)</span>&nbsp;IS&nbsp;PROVIDED</li><li class="hl_l1">UNDER&nbsp;THE&nbsp;TERMS&nbsp;OF&nbsp;<span class="hl_function"><b>THIS</b></span>&nbsp;CREATIVE&nbsp;COMMONS</li><li class="hl_l0"><span class="hl_function"><b>PUBLIC</b></span>&nbsp;LICENSE&nbsp;<span class="hl_char">(</span><span class="hl_quote">&quot;CCPL&quot;</span>&nbsp;<span class="hl_function"><b>OR</b></span>&nbsp;<span class="hl_quote">&quot;LICENSE&quot;</span><span class="hl_char">)</span><span class="hl_char">.</span></li><li class="hl_l1">THE&nbsp;WORK&nbsp;IS&nbsp;PROTECTED&nbsp;BY&nbsp;COPYRIGHT&nbsp;<span class="hl_function">AND</span><span class="hl_char">/</span><span class="hl_function">OR</span></li><li class="hl_l0">OTHER&nbsp;APPLICABLE&nbsp;LAW<span class="hl_char">.</span>&nbsp;ANY&nbsp;USE&nbsp;OF&nbsp;THE&nbsp;WORK</li><li class="hl_l1">OTHER&nbsp;THAN&nbsp;AS&nbsp;AUTHORIZED&nbsp;UNDER&nbsp;<span class="hl_function"><b>THIS</b></span>&nbsp;LICENSE</li><li class="hl_l0"><span class="hl_function"><b>OR</b></span>&nbsp;COPYRIGHT&nbsp;LAW&nbsp;IS&nbsp;PROHIBITED<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">BY&nbsp;EXERCISING&nbsp;ANY&nbsp;RIGHTS&nbsp;TO&nbsp;THE&nbsp;WORK&nbsp;PROVIDED</li><li class="hl_l1">HERE<span class="hl_char">,</span>&nbsp;YOU&nbsp;ACCEPT&nbsp;<span class="hl_function"><b>AND</b></span>&nbsp;AGREE&nbsp;TO&nbsp;BE&nbsp;<span class="hl_function"><b>BOUND</b></span>&nbsp;BY&nbsp;THE</li><li class="hl_l0">TERMS&nbsp;OF&nbsp;<span class="hl_function"><b>THIS</b></span>&nbsp;LICENSE<span class="hl_char">.</span>&nbsp;TO&nbsp;THE&nbsp;EXTENT&nbsp;<span class="hl_function">THIS</span></li><li class="hl_l1">LICENSE&nbsp;MAY&nbsp;BE&nbsp;CONSIDERED&nbsp;TO&nbsp;BE&nbsp;A&nbsp;CONTRACT<span class="hl_char">,</span></li><li class="hl_l0">THE&nbsp;LICENSOR&nbsp;GRANTS&nbsp;YOU&nbsp;THE&nbsp;RIGHTS&nbsp;CONTAINED</li><li class="hl_l1">HERE&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;CONSIDERATION&nbsp;OF&nbsp;YOUR&nbsp;ACCEPTANCE&nbsp;OF</li><li class="hl_l0">SUCH&nbsp;TERMS&nbsp;<span class="hl_function"><b>AND</b></span>&nbsp;CONDITIONS<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Full&nbsp;license&nbsp;at&nbsp;http<span class="hl_char">:</span><span class="hl_char">/</span><span class="hl_char">/</span>creativecommons<span class="hl_char">.</span><span class="hl_function">org</span><span class="hl_char">/</span>licenses<span class="hl_char">/</span>by<span class="hl_char">-</span>nc<span class="hl_char">/</span><span class="hl_number">3</span><span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">/</span>legalcode</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">#ifndef&nbsp;__API_G2_MACROS_H__</li><li class="hl_l1">#define&nbsp;__API_G2_MACROS_H__</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#ifndef&nbsp;__G2EXT_API_HEADER</li><li class="hl_l0">#define&nbsp;__G2EXT_API_HEADER</li><li class="hl_l1">#endif&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>__G2EXT_API_HEADER</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#ifdef&nbsp;_G2EXT_COMPILE_SPACER</li><li class="hl_l0">#error&nbsp;Cannot&nbsp;use&nbsp;gothic&nbsp;headers&nbsp;on&nbsp;spacer&nbsp;dll&nbsp;<span class="hl_char">(</span>_G2EXT_COMPILE_SPACER&nbsp;defined<span class="hl_char">)</span></li><li class="hl_l1">#endif</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#pragma&nbsp;warning<span class="hl_char">(</span>disable<span class="hl_char">:</span><span class="hl_number">4731</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;suppress&nbsp;C4731<span class="hl_char">:</span><span class="hl_quote">&quot;frame pointer register 'ebp' modified by inline assembly code&quot;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_function"><b>macro</b></span>&nbsp;from&nbsp;GothicX&nbsp;<span class="hl_char">(</span>thx<span class="hl_char">,</span>&nbsp;Zerxes<span class="hl_char">!</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#define&nbsp;XCALL<span class="hl_char">(</span>uAddr<span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm&nbsp;{&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ebp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm&nbsp;{&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr"><b>ebp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm&nbsp;{&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;uAddr&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm&nbsp;{&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#undef&nbsp;__G2EXT_API_HEADER</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#endif&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>__API_G2_MACROS_H__</li>        </ol>
    </div>
</div></div>
<br><br>И на Delphi пробовал, но там программа попросту висла <img src="img/smilies/s9.gif" alt=""><br><br><b>Добавлено спустя -58 минут</b><br><I>VodoleY пишет:<br><br>Uz_ я вот тут все это читал.. и молчал.. все что касается .НЕТ както хорошо обсуждалось с пол года назад.. НЕТУ ТАМ по факту адресов.. .НЕТ предкомпиляцию делает.. код перед выполнением. я может сильно не прав.. но как по мне.. надо решать вопрос либо на стадии патчинга, чтоб уже в память разворачивался правильный попатченный код, либо уже в памяти ловить. вообще то все это попахивает дурным скрещиванием гибона с насорогом  </I><br>Может мы друг друга не так поняли? В .Net нет адресов, но я то через программу на Net работаю с обычной программой? Почему бы и нет? Ведь в Net есть Write\Read ProcessMemory<br><br><b>Добавлено спустя -55 минут</b><br>Вот кстати код dll&#039;ки и инжектора на Delphi http://rghost.ru/private/58913448/cae3293cf30e222b4edb776d09dc6b65
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348403&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=20" class="addthx" data-post="348403"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 13:19 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>Uz_</b><br>Возвращаемся к пройденному материалу.<br><br><i class=x>Они могут быть связаны друг с другом объектами синхронизации, инициализировать глобальные переменные, синглтоны. В общем, скорее всего, желаемые результат не будет достигнут.</i><br><br>Но в вашем случае виной всему какие-то корявые реализации людей, пишущих какой-то наркоманский код:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#define&nbsp;XCALL<span class="hl_char">(</span>uAddr<span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm&nbsp;{&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ebp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm&nbsp;{&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr"><b>ebp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm&nbsp;{&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;uAddr&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<span class="hl_char">\</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm&nbsp;{&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div>
<br><br>Это вообще тут к чему? Мне влом это комментировать, но я не могу придумать, как через этот макрос вызвать что-то, кроме краша. Посмотрите в иде, как делается вызов функции.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348404&amp;user=6336&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=21" class="addthx" data-post="348404"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 13:24 <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Это вообще тут к чему? Мне влом это комментировать, но я не могу придумать, как через этот макрос вызвать что-то, кроме краша. Посмотрите в иде, как делается вызов функции.  </I><br>Где посмотреть? в IDE чтоль? Не владею особо терминологией.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348405&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=22" class="addthx" data-post="348405"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 13:28 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
В IDA Pro. Вы ж как-то нашли адрес, где, по вашему мнению, начинается код конструктора. Вот там и посмотрите, как выглядит вызов фунции. В Ida это можно сделать поиском xref. (Х на функции надавите, и счастье).
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348407&amp;user=6336&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=23" class="addthx" data-post="348407"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37721" title="06-11-2014 09:32, ранг:3.0" target="_blank">Uz_</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 13:28 <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Кстати мне тот код через CheatEngine удалось заинжектить в процесс.<br><br><b>Добавлено спустя -56 минут</b><br><I>ARCHANGEL пишет:<br>В IDA Pro. Вы ж как-то нашли адрес, где, по вашему мнению, начинается код конструктора. Вот там и посмотрите, как выглядит вызов фунции. В Ida это можно сделать поиском xref. (Х на функции надавите, и счастье).  </I><br>А, понял, спасибо вам. Щас попробую<br><br><b>Добавлено спустя -46 минут</b><br>Ну, вызов осуществляется через
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>call</b></span>&nbsp;адрес</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348408&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=24" class="addthx" data-post="348408"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Nimnul[/b]','')">Nimnul</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1619.gif" alt=""><br><span class=txtSm>Ранг: 218.9 (наставник), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1619">Участник</a><br><font color=blue>dotnet</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 17:27 &middot; Поправил: Nimnul <br><script type="text/javascript">QU('Nimnul','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nimnul" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>Uz_ пишет:<br>Проехали, пробовал на С++ - ничего. Инжектил dll&#039;ку и через нее исполнял команды - программа не реагирует а dll&#039;ка останавливается на вызове. Вот собсна код вызова:взят из проекта Gothic 2 Ext </I><br><br>Если у вас не получилось сделать на C++ то на C# подавно не получиться. Этож класика инъекция длл в процесс, по этому поводу есть куча мануалов и примеров. А раз программа не реагирует, это не значит что язык плохой... Нужно брать отладчик и разбираться что произошло. Возможно вы использовали не то соглашение о вызове функций их несколько... Или банально не те размеры переменных лежат на стеке, например должно было лежать 2х байтовое число, а у вас на стеке 4х байтовое... Возможно у вас не правильный адрес возврата или миллион других причин может быть. А если в проге используются потоки, то без глубокого реверсинга вобще не обойтись. Поскольку есть вероятность, что вам и не нужно вызывать код функций, а нужно заинлайнить callback на ваш код, когда происходит штатный вызов функции проги в контексте того потока в котором она работает, в народе это называется hook
<br><br><font size="1"><i>-----<br>have a nice day</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348420&amp;user=1619&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=25" class="addthx" data-post="348420"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 17:36 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Я, пожалуй, соглашусь с <b>Nimnul</b>ом. Ну, про 2-х байтовое число на стеке - перебор, я думаю, в остальном же всё так. <br><b>Uz_</b><br>Не сочтите за грубость, нет абсолютно никакой цели кого-то обидеть. Просто я знаю, как это происходит. Вы сидели, писали какие-то программки на шарпе, а потом подумали, что вы уже умеет программировать, и решили, что пора писать читы (или зачем оно вам всё это надо?). Где-то что-то прочитали мельком, погуглили, и в бой. А по факту - ассемблера толком не знаете, про конвенции вызовов не слышали (в шарпе-то какие конвенции), чем длл от сборки отличается представления мало. А нужно теперь изучить системное программирование под винду, почитать что-то на тему реверс-инженерии, попробовать что-то попроще и вот тогда уже браться за читы. <br><br>Конкретно здесь, может, всё получится, но особого понимания процесса оно вам не принесёт.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348421&amp;user=6336&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=26" class="addthx" data-post="348421"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Nimnul[/b]','')">Nimnul</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1619.gif" alt=""><br><span class=txtSm>Ранг: 218.9 (наставник), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1619">Участник</a><br><font color=blue>dotnet</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 17:40 <br><script type="text/javascript">QU('Nimnul','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nimnul" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>ARCHANGEL</b><br><br>Про двух байтовое число я образно <img src="img/smilies/s1.gif" alt="">. Можно легко представить такую же ситуацию с int32 и int64
<br><br><font size="1"><i>-----<br>have a nice day</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=348422&amp;user=1619&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=27" class="addthx" data-post="348422"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Alinator3500[/b]','')">Alinator3500</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 46.8 (посетитель), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.28'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=34465">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2014 21:15 <br><script type="text/javascript">QU('Alinator3500','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alinator3500" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Windows. Создание эффективных Win32-приложений с учётом специфики 64-разрядной версии Windows<br>Джеффри Рихтер<br>Глава 22. Внедрение DLL и перехват API вызовов.<br><br>Я сам на C# пишу.<br>Но для этих целей лучше C/C++/ASM.<br><br>На геймЭнджин вроде автоматизировать можно действия, в IDA тоже.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348428&amp;user=34465&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=28" class="addthx" data-post="348428"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37721" title="06-11-2014 20:58, ранг:4.0" target="_blank">Uz_</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Uz_[/b]','')">Uz_</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37721">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2014 00:57 <br><script type="text/javascript">QU('Uz_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Uz_" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=23193.html&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
Я не чит пытаюсь писать. А так - спасибо всем, буду дальше копать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=348441&amp;user=37721&amp;forum_n=6&amp;topic=23193.html&amp;page=0&amp;anchor=29" class="addthx" data-post="348441"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> C# Вызвать функцию по адресу</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#30" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="23193">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23193" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
