<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Нужна помощь при разборе кода драйвера - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго всем времени суток. Вот столкнулся с такой проблемой - при исследовании одной подлой малвари из неё (из малвари) был извлечён драйвер, который эта малварь использует для завершения процессов популярных антивирусов.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Нужна помощь при разборе кода драйвера</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2008 15:30 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12827.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго всем времени суток. Вот столкнулся с такой проблемой - при исследовании одной подлой малвари из неё (из малвари) был извлечён драйвер, который эта малварь использует для завершения процессов популярных антивирусов. Драйвер - не обычное фуфло с NtOpenProcess-&gt;NtTerminateProcess, для завершения процессов он использует какой-то другой алгоритм. Приложение из третьего колца получает хэндл символьной ссылки драйвера через CreateFileA и передаёт драйверу запрос через WriteFile. В качестве параметра запроса используется идентификатор процесса-жертвы. Далее драйвер что-то с там делает и процесс вырубается, да причём вырубается, даже если является обьектом отладки, например, под олькой отлаживаемый процесс можно вырубить, и олька ничего не заметит. Более того, драйвер вырубает процессы таких зверей, как Антивирус Касперского 8 и Agnitum Outpost 6, хотя они имеют защиту, основанную на перехвате KDT, два процесса в памяти, которые друг друга страхуют, и ещё некоторые другие фичи. Короче, вопрос - помогите исследовать алгоритм, узнать, как драйвер это делает. Проблема в том, что функции режима ядра документированы плохо - мне самому не справиться. Прикладываю архив - в архиве сам драйвер, программа для посылки запросов на завершение процесса, а также KMD Manager by Four-F чтоб установить и запустить драйвер. Я для отладки использовал Айс, но это не очень уж удобно, слишком уже к ольге привык, может, и по этому поводу кто-то что-то подскажет?<br><br><img src="img/attach.gif" alt=""> <a href="./files/66bf_19.09.2008_CRACKLAB.rU.tgz">66bf_19.09.2008_CRACKLAB.rU.tgz</a> - Driver.rar
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=204018&amp;user=6336&amp;forum_n=1&amp;topic=12827.html&amp;page=0&amp;anchor=1" class="addthx" data-post="204018"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]KeBugCheck[/b]','')">KeBugCheck</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.85'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18009">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2008 15:51 <br><script type="text/javascript">QU('KeBugCheck','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=KeBugCheck" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12827.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Sality вариант, практически без изменений.<br>Убивает антивирусы твои простым способом. Сначала она их открывает через ObOpenObjectByPointer, поинтер это EPROCESS через PsLookupProcess...... по Id процесса соот-но. Потом вызывается оригинальный NtTerminateProcess через указатель, по индексу (hardcoded под все винды) из оригинальной SSDT, сама таблица ищется приложением (поищи в приложении KeServiceDescriptorTable строку), драйвер просто вызывает то, что ему передают.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=204023&amp;user=18009&amp;forum_n=1&amp;topic=12827.html&amp;page=0&amp;anchor=2" class="addthx" data-post="204023"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2008 16:00 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12827.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>KeBugCheck пишет:</b><br><i class=x>сама таблица ищется приложением (поищи в приложении KeServiceDescriptorTable строку)</i><br>Ага, есть такое дело в малвари, но в проге, которую я выкладывал - нету, а процессы всё равно умирают - как так?<br><i class=x>Sality вариант, практически без изменений.</i><br>Можно про это подробнее, что за вариант? Где можно найти?<br><i class=x>Сначала она их открывает через ObOpenObjectByPointer, поинтер это EPROCESS через PsLookupProcess...... по Id процесса соот-но</i><br>Ты хотел сказать - через PsLookupProcessbyProcessId?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=204026&amp;user=6336&amp;forum_n=1&amp;topic=12827.html&amp;page=0&amp;anchor=3" class="addthx" data-post="204026"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]KeBugCheck[/b]','')">KeBugCheck</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.85'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18009">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2008 16:19 <br><script type="text/javascript">QU('KeBugCheck','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=KeBugCheck" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12827.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Ты хотел сказать - через PsLookupProcessbyProcessId?  </I><br>Да. PsLookupProcessByProcessId, ObOpenObjectByPointer, RealNtTerminateProcess(handle, 1), ZwClose(handle);<br><br><br><I>ARCHANGEL пишет:<br>Ага, есть такое дело в малвари, но в проге, которую я выкладывал - нету, а процессы всё равно умирают - как так?  </I><br>А оно надо только на инит, потом адрес запоминается в драйвере.<br><br><br><I>ARCHANGEL пишет:<br>Можно про это подробнее, что за вариант? Где можно найти?  </I><br>знающие люди уже все заломали и изучили, см. pdf<br>rapidshare.com/files/144587782/Win32_Sality.rar.html<br><br>+ гугл по имени малваре
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=204032&amp;user=18009&amp;forum_n=1&amp;topic=12827.html&amp;page=0&amp;anchor=4" class="addthx" data-post="204032"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2008 16:27 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12827.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>KeBugCheck пишет:</b><br><i class=x>знающие люди уже все заломали и изучили, см. pdf</i><br>Это хорошо, нам такие люди нужны<img src="img/smilies/s1.gif" alt="">, за ПДФ спасибо<br><i class=x>А оно надо только на инит, потом адрес запоминается в драйвере.</i><br>Попросту говоря, он там жёстко захардкоден?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=204033&amp;user=6336&amp;forum_n=1&amp;topic=12827.html&amp;page=0&amp;anchor=5" class="addthx" data-post="204033"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]KeBugCheck[/b]','')">KeBugCheck</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.85'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18009">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2008 16:30 <br><script type="text/javascript">QU('KeBugCheck','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=KeBugCheck" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12827.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Там переменная, которая запоминает адрес ориг.таблицы, а потом путем захардкоденных констант id сервиса NtTerminateProcess по этой таблице получается адрес оригинала, который и вызывается. От сплайсенга такое не спасет, а от аверских перехватов - то да.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=204034&amp;user=18009&amp;forum_n=1&amp;topic=12827.html&amp;page=0&amp;anchor=6" class="addthx" data-post="204034"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2008 16:35 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12827.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>KeBugCheck пишет:</b><br><i class=x>От сплайсенга такое не спасет, а от аверских перехватов - то да.</i><br>А зачем такое нужно? В драйвере при выполнении ведь всё не так, как в третьем колце - NtTerminateProcess импортируется из ntoskrnl.exe (или аналога), и при вызове из драйвера на KeServiceDescriptorTable не опирается, можно ничё и не искать, а просто вызвать функцию и всё, или нет?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=204035&amp;user=6336&amp;forum_n=1&amp;topic=12827.html&amp;page=0&amp;anchor=7" class="addthx" data-post="204035"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]KeBugCheck[/b]','')">KeBugCheck</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 8.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.85'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18009">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2008 16:52 <br><script type="text/javascript">QU('KeBugCheck','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=KeBugCheck" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12827.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Потому что эта функция не экспортируется ядром, она есть только в виде указателя в SSDT. Экспортируется её r0 заглушка ZwTerminateProcess, которая из r3 не вызывается никогда и в конечном итоге опирается на ту же самую SSDT как и все Zw функции r0, потому что они это переходники с PreviousMode = KernelMode специально для дров. А малвари как раз и нужно грохать защищенные аверские процессы из-под ядра. А вызвав функцию напрямую через указатель ты минуешь хуки ssdt.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=204037&amp;user=18009&amp;forum_n=1&amp;topic=12827.html&amp;page=0&amp;anchor=8" class="addthx" data-post="204037"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 сентября 2008 16:56 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=12827.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>KeBugCheck</b><br>А, ну тогда ясно, в общем, спасибо, я узнал всё, что хотел, более этого - моя мальварь оказалась именно этой Sality, так что все дальнейшие вопросы отпадают сами собой, топик закрываю
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=204039&amp;user=6336&amp;forum_n=1&amp;topic=12827.html&amp;page=0&amp;anchor=9" class="addthx" data-post="204039"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Нужна помощь при разборе кода драйвера</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12827" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
