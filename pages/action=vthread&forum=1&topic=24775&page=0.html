<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Вопрос по SIDE - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет! Вопрос к difexacaw. Допустим я перехватил вызов сискола фильтром. Могу ли я в фильтре скипнуть выполнение системого вызова и подменить возвращаемое значение? Драйвер работает только под XP?">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопрос по SIDE</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Lambda[/b]','')">Lambda</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.3 (новичок), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.56'>Активность: 0.03<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=39981">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2017 19:45 &middot; Поправил: Lambda <br><script type="text/javascript">QU('Lambda','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Lambda" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет! Вопрос к <b>difexacaw</b>.<br><br>Допустим я перехватил вызов сискола фильтром. Могу ли я в фильтре скипнуть выполнение системого вызова и подменить возвращаемое значение?<br><br>Драйвер работает только под XP?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376818&amp;user=39981&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=1" class="addthx" data-post="376818"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 00:29 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>Lambda</b><br><br>Конечно можно.<br>Драйвер работал под XP и 7. До 10-ки думаю можно завести без изменений. Там была фича для скрытия указателя в ядре, так вот этот механизм выше 7 вроде бы крэшил по какой то причине, я не помню подробностей.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376827&amp;user=40990&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=2" class="addthx" data-post="376827"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39981" title="16-06-2017 22:32, ранг:7.4" target="_blank">Lambda</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 00:57 &middot; Поправил: VOLKOFF <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Старше 7-ки не будет работать как минимум из-за реализации теста через INT 2E  <br>Плюс в новых осях x86 использует сплайсинг системных вызовов из за отсутсвия KiFastSystemCall<br>До 7-ки включительно должно быть все норм.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376829&amp;user=5846&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=3" class="addthx" data-post="376829"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 01:23 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>Почему int2e не работает ?<br><br>w8, IDT:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">00828274</span>&nbsp;off_828274&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiRaiseSecurityCheckFailure</li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">00828274</span></li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">00828278</span>&nbsp;dword_828278&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">8EE00h</span></li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">0082827C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiGetTickCount</li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">00828280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">8EE00h</span></li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">00828284</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiCallbackReturn</li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">00828288</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">8EE00h</span></li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">0082828C</span>&nbsp;off_82828C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiRaiseAssertion</li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">0082828C</span></li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">00828290</span>&nbsp;dword_828290&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">8EE00h</span></li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">00828294</span>&nbsp;off_828294&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiDebugService</li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">00828294</span></li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">00828298</span>&nbsp;dword_828298&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">8EE00h</span></li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">0082829C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiSystemService&nbsp;&nbsp;&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;int2e</li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">008282A0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">8EE00h</span></li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">008282A4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiTrap0F</li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">008282A8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">88E00h</span></li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">008282AC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiStartUnexpectedRange@0</li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">008282B0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">88E00h</span></li><li class="hl_l1">INIT<span class="hl_char">:</span><span class="hl_number">008282B4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;_KiUnexpectedInterrupt1</li><li class="hl_l0">INIT<span class="hl_char">:</span><span class="hl_number">008282B8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">88E00h</span></li>        </ol>
    </div>
</div></div>
<br><br>&gt; Плюс в новых осях x86 использует сплайсинг системных вызовов из за отсутсвия KiFastSystemCall<br><br>Зачем это ?<br>Оно не по этой причине не будет работать, к примеру пул не исполняем и прочая защита.<br><br>В данной поделке принцип был в том, что бы можно было обработать сервисы не в ядре, что бы не пилить и отлаживать дров, а передать управление в юм, где можно использовать обычную юзер обработку, отладить это всё юзер отладчиком, в случае ошибки не крэшнет ось.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376830&amp;user=40990&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=4" class="addthx" data-post="376830"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 01:43 &middot; Поправил: VOLKOFF <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Почему int2e не работает ? </I><br>Оно на х64 не через int2e работает, а через шлюз FS:0C0h и будет просто Access violation<br><br>Ну и заводить неподписанные дрова под 8+ не комильфо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376831&amp;user=5846&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=5" class="addthx" data-post="376831"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 01:49 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>Оно 32-хбитное, причём тут x64. Что бы обрабатывать сервисы под wow не нужен драйвер.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376832&amp;user=40990&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=6" class="addthx" data-post="376832"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Lambda[/b]','')">Lambda</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.3 (новичок), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.56'>Активность: 0.03<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=39981">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 01:50 <br><script type="text/javascript">QU('Lambda','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Lambda" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Конечно можно. </I><br><br>ОК. Исполнение программы в начале кода функции фильтра. По ID сискола в EAX я решил, что нужно подменить возвращаемое значение сискола. Каким образом я это могу сделать в своем фильтре? Фильтр вызывается перед перед вызовом перехваченного сискола?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376833&amp;user=39981&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=7" class="addthx" data-post="376833"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 01:56 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>Lambda</b><br><br>&gt; По ID сискола в EAX я решил<br><br>Обычно строится таблица номер_сервиса/хэш_имени и обработка происходит через хэши, а не ID.<br><br>&gt; Фильтр вызывается перед перед вызовом перехваченного сискола? <br><br>Нет, он вызывается при вызове сервиса. Ядро прерывает обработку и возвращает управление в юм на указанный адрес. При этом никакие ресурсы не захватываются, таким образом не нужно их освобождать(возвращать управление в км). Тоесть можно эмулировать сервис.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376834&amp;user=40990&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=8" class="addthx" data-post="376834"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39981" title="09-02-2018 14:05, ранг:13.2" target="_blank">Lambda</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Lambda[/b]','')">Lambda</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.3 (новичок), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.56'>Активность: 0.03<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=39981">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 02:12 &middot; Поправил: Lambda <br><script type="text/javascript">QU('Lambda','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Lambda" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
В коде вашего примера перехватывается ZwYieldExecution. После исполнения сыскола в EAX получаем 0x40000024. Фильтр в примере выглядит так:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_number">0BADC0DE</span></li><li class="hl_l1"><span class="hl_function"><b>INT</b></span>&nbsp;<span class="hl_number">2E</span></li>        </ol>
    </div>
</div></div>
<br>Что мне нужно дописать перед этими инструкциями, что бы вызов ZwYieldExecution всегда возвращал 0xAABBCCDD?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376835&amp;user=39981&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=9" class="addthx" data-post="376835"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 02:14 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Словил жесткое дежавю <img src="img/smilies/s6.gif" alt=""><br>6 лет назад <noindex><a href="https://exelab.ru/f./action=vthread&amp;forum=5&amp;topic=19241&amp;page=2#4" rel="nofollow" target="_blank">это уже было...</a></noindex> <br><br><I>lomeavae пишет:<br>Это x86 код. Что вы его тестите на другой архитектуре. </I><br><I>ntldr пишет: <br>Вообще-то юзермодный x86 код отлично исполняется на Win64 если ему не мешают кривые руки. Ваш, по вашим словам мега-стабильный и супер-безглючный, код не работает. Вывод очевиден: ваш софт к андоку гвоздями прибит и не терпит ни малейших изменений архитектуры. Ладно бы если таких мест одно-два и их невозможно переписать нормально. Но насколько я понял, у вас всё такое.<br>Через пару-тройку лет везде будет x64 и подоспеет винда под ARM, тогда все ваши знания и наработки можно сливать в унитаз и начинать заново. Я же перекомпилирую код, поправлю пару некрасивых мест, прогоню статический анализ и юнит-тесты, и продукт сложностью в тысячи человеко-часов портирован за пару дней работы. </I><br><br>И вот уже 2к17, реально мало людей (даже на 7-ке) которые работают под х86, а &quot;воз и ныне там&quot;...<br>Не пытаюсь принизить уровень ваших знаний, в целом за моторчики респект, но читал ту тему и улыбался <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376836&amp;user=5846&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=10" class="addthx" data-post="376836"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 02:29 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>Lambda</b><br><br>mov eax,0xAABBCCDD<br><br><b>VOLKOFF</b><br><br>Эту тему подняли из за этой <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24749" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>.<br><br>Там x86 приложение и защита. Так как у автора не нашлось пригодного инструмента, он выполнил полный ручной разбор. Для этого не нужна 64 ось. Почему же вы ему ничего дельного не посоветовали, чем сервисы замониторить, да есчо если и запустить под wow - там возможные стандартные драйвера не станут <img src="img/smilies/s15.gif" alt=""><br><br>Обычно приложение для двух архитектур идёт, конечно же вы не ищите лёгких путей и возьмёте 64 и windbg.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376837&amp;user=40990&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=11" class="addthx" data-post="376837"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Lambda[/b]','')">Lambda</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.3 (новичок), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.56'>Активность: 0.03<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=39981">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 02:41 &middot; Поправил: Lambda <br><script type="text/javascript">QU('Lambda','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Lambda" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>difexacaw</b><br><br>Если изменить EAX, то выполнение не возвращается в ядро по INT 2E. Смотрите гифку.<br><br>http://i.imgur.com/6B92h4X.gifv
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376838&amp;user=39981&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=12" class="addthx" data-post="376838"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 03:04 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>Lambda</b><br><br>Вам нужно выполнить прямой возврат mov eax,N и ret 4 что бы снять со стека структуру, вроде так. BADC0DE это возврат в ядро для продолжения обработки сервиса. При этом нужно соответствующие флажки использовать, что бы небыло рекурсий.<br><br><b>Добавлено спустя 9 минут</b><br>На гифке ошибка - invalid sys service, так как ID &gt; max. При таком вызове ID должен быть любым, но &lt; max.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376839&amp;user=40990&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=13" class="addthx" data-post="376839"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39981" title="19-06-2017 19:58, ранг:8.4" target="_blank">Lambda</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Lambda[/b]','')">Lambda</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.3 (новичок), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.56'>Активность: 0.03<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=39981">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 03:17 &middot; Поправил: Lambda <br><script type="text/javascript">QU('Lambda','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Lambda" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>difexacaw</b><br><br>С прямым возвратом все работает. Спасибо.<br><br><I>difexacaw пишет:<br>BADC0DE это возврат в ядро для продолжения обработки сервиса. При этом нужно соответствующие флажки использовать, что бы небыло рекурсий. <br> </I><br><br>Рекурсия будет только если я захочу в своем фильтре вызвать сыскол без сброса флажка. Верно?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376840&amp;user=39981&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=14" class="addthx" data-post="376840"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 03:26 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Lambda</b><br><br>&gt; С прямым возвратом все работает.<br><br>В случае если нужно обработать начало сервиса, отдать управление в ядро и получить его снова при возврате из сервиса, то нужно загрузить в стуктуру адрес ловушки, адрес возврата сохранить в локальном хранилище(тлс) и отдать управление в ядро. Когда из сервиса произойдёт возврат на ловушку, нужно вернуть управление на сохранённый адрес.<br><br>&gt; вызвать сыскол без сброса флажка. Верно? <br><br>Так точно.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376841&amp;user=40990&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=15" class="addthx" data-post="376841"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39981" title="22-06-2017 00:40, ранг:8.4" target="_blank">Lambda</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Lambda[/b]','')">Lambda</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.3 (новичок), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.56'>Активность: 0.03<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=39981">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 03:57 &middot; Поправил: Lambda <br><script type="text/javascript">QU('Lambda','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Lambda" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>difexacaw пишет:<br>то нужно загрузить в стуктуру адрес ловушки </I><br><br>Для обработки начала сервиса мы записываем адрес фильтра(ловушки) по оффсету 0xFFC. Для установки фильтра, который получит управление после вызова сервиса, есть другой оффсет?<br><br>---------------<br><br>Уже понял. Вы имели в виду структуру, адрес которой мы убирали в стеке с помощью &quot;retn 4&quot; при прямом возврате.<br><br>Что это за структура? Какие там еще данные кроме первого DWORD-а, который указывает на адрес возврата после выполнения сервиса?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=376843&amp;user=39981&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=16" class="addthx" data-post="376843"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2017 08:31 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24775.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Lambda</b><br><br>FSTATE, второе её поле это ссылка на аргументы сервиса. Механизм такой: sysenter -&gt; фильтр(FSTATE) -&gt; sysenter(BADC0DE, FSTATE) -&gt; продолжение_обработки_сервиса -&gt; вызов обработчика сервиса(FSTATE.Args) -&gt; возврат из sysenter на FSTATE.Ip<br>Таким образом можно обойти возврат из sysenter на Ki*Ret(), а только так можно в юм словить это событие.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=376844&amp;user=40990&amp;forum_n=1&amp;topic=24775.html&amp;page=0&amp;anchor=17" class="addthx" data-post="376844"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39981" title="30-11-2017 20:20, ранг:11.4" target="_blank">Lambda</a></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопрос по SIDE</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#18" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="24775">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24775" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
