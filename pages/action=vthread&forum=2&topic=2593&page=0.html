<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Опкод EBFE в начало системной функции - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Господа,прошу помочь мне разобраться в следующей ситуации: необходимо разместить опкод EBFE в начало системной функции LoadLibraryA в чужом процессе,чтобы таким образом отследить обращение чужого процесса к данной функции и">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=42610'>r0lka</a>, <a target='_blank' href='?action=userinfo&amp;user=31053'>yashechka</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Опкод EBFE в начало системной функции</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=2&amp;topic=2593&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=2&amp;topic=2593&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 июля 2005 18:08 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Господа,прошу помочь мне разобраться в следующей ситуации:
<br> необходимо разместить опкод EBFE в начало системной функции LoadLibraryA в чужом процессе,чтобы таким образом отследить обращение чужого процесса к данной функции и получить тем самым некоторую информацию (имя загружаемой библиотеки,обратный адрес функции).Собственно в чём проблема...
<br> <pre>
<br>const
<br> Code : WORD = &#036;FEEB;
<br>var
<br> ProcAddress : Pointer;
<br> Temp_Protect : Cardinal;
<br> OriginalData : WORD;
<br> nBytesRead, nBytesWritten : Cardinal;
<br>begin
<br> ProcAddress := GetProcAddress(GetModuleHandle(&#039;Kernel32.dll&#039;), &#039;LoadLibraryA&#039;);
<br>
<br> VirtualProtectEx(processInfo.hProcess, ProcAddress, 2, PAGE_EXECUTE_READWRITE, Temp_Protect);
<br> ReadProcessMemory(processInfo.hProcess, ProcAddress, @OriginalData, 2, nBytesRead);
<br> WriteProcessMemory(processInfo.hProcess, ProcAddress, @Code, SizeOf(WORD), nBytesWritten);
<br> VirtualProtectEx(processInfo.hProcess, ProcAddress, 2, Temp_Protect, Temp_Protect);
<br>...
<br>end;
<br></pre>
<br>...так вот функция VirtualProtectEx возвращает C0000018 (STATUS_CONFLICTING_ADDRESSES) и естесственно вся остальная констукция кода тоже рушится  <img src="img/smilies/s13.gif" alt=""> .
<br>Хотелось бы узнать,почему так происходит ? 
<br>Т.к. такая же кодовая операция только с адресом,к примеру,точки входа проходит без проблем,т.е. на EP размещается необходимый опкод. 
<br>Читал в статьях <b>Ms-Rem</b>&#039;а про &quot;сплайсинг&quot; API-функций,в которых он говорит,что перехват API,находящихся в чужом процессе, - весьма неудобная штука.Следовательно любознательный вопрос - почему это так (неудобно) ?
<br>Далее он приводит просто монструозные коды внедрения собственных библиотек в чужой процесс путём создания удалённого процесса...
<br>Собственно у меня дилемма - как поступить,если мне всего лишь необходимо узнать имя загружаемой библиотеки и обратный адрес функции LoadLibraryA,загружающей эту библиотеку   <img src="img/smilies/s11.gif" alt=""> .
<br>Или как всё-таки заставить вышеприведённый код работать без ошибок ?
<br>
<br>Весьма надеюсь на любые предложения,советы,вопросы с вашей,господа,стороны...
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31328&amp;user=1613&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=1" class="addthx" data-post="31328"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]dMNt[/b]','')">dMNt</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 45.7 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30">Участник</a><br><font color=blue>EBFE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 июля 2005 18:39 <br><script type="text/javascript">QU('dMNt','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dMNt" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>разместить опкод EBFE в начало системной функции LoadLibraryA в чужом процессе,чтобы таким образом отследить обращение чужого процесса к данной функции и получить тем самым некоторую информацию (имя загружаемой библиотеки,обратный адрес функции) </i>
<br>бред какой-то, с таким-же успехом там можно размещать и 90h (тоже весьма информативная комманда) и т.д.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31329&amp;user=30&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=2" class="addthx" data-post="31329"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 июля 2005 18:44 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>EBFE в начало системной функции LoadLibraryA  </i>
<br>Патчить системные функции можно только из Ring-0, а так как прога работает в Ring-3, то винда не позволит проге из Ring-3 патчить системные ф-ции. Т. е или нужно писать драйвер ring-0 либо искать альтернативные пути.
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31333&amp;user=2060&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=3" class="addthx" data-post="31333"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 июля 2005 18:49 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
P. S. Не вкуре зачем это тебе понадобилось, но идея патчить системные ф-ции не самая хорошая<img src="img/smilies/s11.gif" alt="">
<br>Поищи альтернативный способ<img src="img/smilies/s2.gif" alt="">
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31335&amp;user=2060&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=4" class="addthx" data-post="31335"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]AlexZ[/b]','')">AlexZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 203.3 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.22<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=175">Участник</a><br><font color=blue>UPX Killer -d</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 июля 2005 19:05 &middot; Поправил: AlexZ <br><script type="text/javascript">QU('AlexZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZ" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
DillerInc пишет:
<br> VirtualProtectEx(processInfo.hProcess, ProcAddress, 2, PAGE_EXECUTE_READWRITE, <b>@Temp_Protect</b>);
<br> ReadProcessMemory(processInfo.hProcess, ProcAddress, @OriginalData, 2, <b>@nBytesRead</b>);
<br> WriteProcessMemory(processInfo.hProcess, ProcAddress, @Code, SizeOf(WORD), <b>@nBytesWritten</b>);
<br> VirtualProtectEx(processInfo.hProcess, ProcAddress, 2, Temp_Protect, <b>@Temp_Protect</b>);
<br>
<br>Или вместо <b>@</b> поставь <b>ptr()</b>. Возможно в этом причина.
<br><br><font size="1"><i>-----<br>Я медленно снимаю с неё UPX... *FF_User*</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31337&amp;user=175&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=5" class="addthx" data-post="31337"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 июля 2005 19:33 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<i>Error_Log пишет:
<br>Патчить системные функции можно только из Ring-0, а так как прога работает в Ring-3, то винда не позволит проге из Ring-3 патчить системные ф-ции </i>
<br>...примерно подобное объяснение я и собирался услышать... <img src="img/smilies/s13.gif" alt="">
<br><i>AlexZ пишет:
<br>Или вместо @ поставь ptr(). Возможно в этом причина </i>
<br>...наврядли - я же писал выше,что подобный код,только использующий другой адрес,к примеру, &#036;41CCD8B (секция кода чужого процесса), выполняется на ура.
<br><i>Error_Log пишет:
<br>Поищи альтернативный способ </i>
<br>...да,а что делать - придётся думать...
<br>Однако хочется услышать ещё какие-нибудь мнения (в частности по поводу возможного альтернативного способа).
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31339&amp;user=1613&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=6" class="addthx" data-post="31339"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]UsAr[/b]','')">UsAr</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 66.8 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.14'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1854">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 июля 2005 20:33 <br><script type="text/javascript">QU('UsAr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=UsAr" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>в частности по поводу возможного альтернативного способа </i>
<br>ну допустим можно изменить таблицу импортов нужного процесса
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31346&amp;user=1854&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=7" class="addthx" data-post="31346"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 июля 2005 20:57 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<i>Error_Log пишет:
<br>Патчить системные функции можно только из Ring-0, а так как прога работает в Ring-3, то винда не позволит проге из Ring-3 патчить системные ф-ции </i>
<br>Бред сивой кобылы.
<br>
<br><i>Error_Log пишет:
<br>Не вкуре зачем это тебе понадобилось, но идея патчить системные ф-ции не самая хорошая </i>
<br>Идея достаточно хорошая.
<br>
<br><b>DillerInc</b>
<br>Почитай это www.rsdn.ru/article/baseserv/IntercetionAPI.xml
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31350&amp;user=24&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=8" class="addthx" data-post="31350"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 июля 2005 00:07 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Ara</b>
<br>Спасибо за ссылку (я,кстати,с этим материалом уже встречался как-то).
<br>Я заметил,что во всех этих статьях делается упор именно на внедрение своего кода через подгружаемую библиотеку,которая размещается в создаваемом удалённом потоке целевого процесса, т.е. делается упор на единственно возможный вариант сплайсинга API-функций.
<br>Это походу значит,что мой код,приведённый выше,в принципе неработоспособен...а жаль.Поправьте меня,если я ошибаюсь.
<br>Я,кстати,начинаю прикидывать,а не попробовать бы этак динамически собрать необходимую информацию при помощи функции GetThreadContext... <img src="img/smilies/s11.gif" alt="">
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31370&amp;user=1613&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=9" class="addthx" data-post="31370"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 июля 2005 00:23 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>DillerInc</b>
<br>Если не хочешь подгружать длл, то воспользуйся средствами DebugAPI к примеру.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31373&amp;user=24&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=10" class="addthx" data-post="31373"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 июля 2005 00:45 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<i>Ara пишет:
<br>то воспользуйся средствами DebugAPI </i>
<br>А можно тут подробнее...
<br>Ты имеешь в виду использование точек останова,установленных с помощью API-функций ?
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31376&amp;user=1613&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=11" class="addthx" data-post="31376"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ASMax[/b]','')">ASMax</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 62.9 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.06'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2032">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 июля 2005 00:58 <br><script type="text/javascript">QU('ASMax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ASMax" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
В винде есть такие средства для отладки. Вот ссылка в мсдн на пример главного отладочного цикла:
<br>[url=http://msdn.microsoft.com/library/default.asp?url=/library/en-us/ debug/base/writing_the_debugger_s_main_loop.asp][/url]
<br>Установка/снятие бряков - через WriteProcessMemory. По отладочным событиям будешь ловить исключения и делать все что тебе нужно.
<br>
<br>Метод с лоадером куда удобнее, т.к. исчезает рутина с коммуникациями между процессами, не все процессы хотят так отлаживаться, и вообще, находясь в адресном пространстве нужного процесса ты - бог.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31380&amp;user=2032&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=12" class="addthx" data-post="31380"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 июля 2005 00:59 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>Ты имеешь в виду использование точек останова,установленных с помощью API-функций ? </i>
<br>Да, именно.
<br>Посмотри еще <a href="http://exelab.ru/art/amm_ex.php" target="_blank">ЭТУ</a> статью, довольно доступно все изложено и сорсы с комментариями.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31381&amp;user=24&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=13" class="addthx" data-post="31381"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 июля 2005 12:06 <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
ну и тут я импользовал эту технику, если хочешь смотри, код на С++:
<br><a href="http://www.exelab.ru/f/files/9805_unGHF.zip" target="_new">http://www.exelab.ru/f/files/9805_unGHF.zip</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31404&amp;user=26&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=14" class="addthx" data-post="31404"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2005 17:08 &middot; Поправил: DillerInc <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>arnix</b>
<br>Э...а можно,пожалуйста,исходник ?
<br>
<br><b>Ara</b>
<br>Весьма познавательная между прочим статья - спасибо...но я думаю,что придётся побрезговать использованием опкода CC, т.к. я имею дело с протектором,который вполне может применять какие-нибудь антиотладочные приёмы.
<br>
<br>А вообще я сейчас в полном смятении с этим делом <img src="img/smilies/s13.gif" alt=""> .
<br>Нашёл типа временный способ нахождения команды CALL [_LoadLibraryA] :
<br><pre>
<br>const
<br> Opcode : DWORD = &#036;F00015FF;
<br> EntryPoint : DWORD = &#036;41CBF90;
<br>var
<br> Result : Boolean;
<br> EIPValue : Integer;
<br> EIPPtr : DWORD;
<br> SomeThing : DWORD;
<br> nBytesRead : Cardinal;
<br>begin
<br> result := False;
<br> EIPValue := EntryPoint;
<br>repeat
<br> ReadProcessMemory(processInfo.hProcess, PPointer(EIPValue), @Something, SizeOf(DWORD), nBytesRead);
<br> EIPPtr := EIPValue;
<br> InterlockedIncrement(EIPValue);
<br>if Something = Opcode then
<br>// тут я размещаю по адресу EIPPtr опкод EBFE, далее ResumeThread,чтобы процесс подошёл к этому
<br>// смещению и сразу  SuspendThread.Затем я пытаюсь с помощью GetThreadContext получить значение 
<br>// регистра ESP, т.к. на 
<br>// вершине стека должно находится имя загружаемой библиотеки,но тут и происходит какая-то дрянь - 
<br>// GetThreadContext возвращает всё что угодно,но только не то значение,которое реально существует в
<br>// данный момент в регистре ESP чужого процесса ... </pre>
<br>Собственно как же функционирует эта GetThreadContext ?
<br>Такое чувство,что она возвращает контекст какого-то другого потока целевого процесса  <img src="img/smilies/s11.gif" alt=""> .
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31489&amp;user=1613&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=15" class="addthx" data-post="31489"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2005 20:39 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>DillerInc</b>
<br>Ну вот, оказывается, у тебя уже протектор <img src="img/smilies/s1.gif" alt=""> Опиши попонятней и поподробней, что именно ты хочешь получить, что неполучилось и приаттач полный сорс (или полностью нужный кусок).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31510&amp;user=24&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=16" class="addthx" data-post="31510"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]freeExec[/b]','')">freeExec</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 156.1 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2181">Участник</a><br><font color=blue>Капрал</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2005 21:26 <br><script type="text/javascript">QU('freeExec','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=freeExec" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
А АЙСе посмотреть нельзя имя либы, если конечно это единственный раз нужно.Иначе Имхо самый простой способ - это замена адреса в ИТ на свой.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31512&amp;user=2181&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=17" class="addthx" data-post="31512"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2005 21:26 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Вот еще статейка неплохая.<br><br><img src="img/attach.gif" alt=""> <a href="./files/54c8_Методы перехвата API_вызовов в Win32.rar">54c8_Методы перехвата API_вызовов в Win32.rar</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31513&amp;user=24&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=18" class="addthx" data-post="31513"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2005 22:48 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Прежде всего спасибо за участие <img src="img/smilies/s1.gif" alt=""> .
<br><i>Ara пишет:
<br>что именно ты хочешь получить </i>
<br>...значит,распаковка программы,защищённой протектором,происходит в адресном пространстве определённой подгружаемой DLL,поэтому для того,чтобымы были в состоянии влиять на ход распаковки,нам необходимо знать адрес,по которому эта DLL загрузилась.А так как адрес загрузки DLL - вещь непостоянная (по крайней мере в данном случае), то нам необходимо узнавать его динамически.
<br>Следовательно сейчас я стараюсь найти в коде конструкции типа:
<br><pre>
<br> push XXXXXXXX ; имя библиотеки
<br> call    [_LoadLibraryA] ; у меня опкод FF1500F01C04 ... возможно,что только у меня <img src="img/smilies/s9.gif" alt="">
<br> mov dword ptr [XXXXXXXX], eax ;  искомый адрес загрузки
<br></pre>
<br>Найдя по опкоду такое место (команда call [_LoadLibraryA] ),<b>надо как-то на него &quot;встать&quot;, чтобы функция GetThreadContext нормально прочитала значение регистра ESP</b>, на вершине которого должна быть строка с именем актуальной библиотеки,ну а далее можно будет и адрес загрузки узнать таким же макаром.
<br>
<br>Приложил проблемные места кода - надеюсь общий ход мыслей будет ясен.<br><br><img src="img/attach.gif" alt=""> <a href="./files/64fc_Source.txt">64fc_Source.txt</a>
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31531&amp;user=1613&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=19" class="addthx" data-post="31531"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 июля 2005 23:07 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>DillerInc</b>
<br>Хм, вот теперь мне эта идея тоже кажется бредовой... А что ты хочешь получить В ЦЕЛОМ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31538&amp;user=24&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=20" class="addthx" data-post="31538"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 августа 2005 00:41 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<i>Ara пишет:
<br>Хм, вот теперь мне эта идея тоже кажется бредовой... </i>
<br>...обоснуй,пожалуйста <img src="img/smilies/s13.gif" alt=""> ...
<br><i>Ara пишет:
<br>А что ты хочешь получить В ЦЕЛОМ? </i>
<br>...ну,а что здесь можно вообще получить - распакованный исполняемый файл.
<br>
<br>P.S. Может ты что-то неправильно понял из моих объяснений ?
<br>Протектор использует подгружаемую DLL, чтобы по мере надобности распаковывать исполняемый файл (в основном идёт декриптование названий функций).
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31560&amp;user=1613&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=21" class="addthx" data-post="31560"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 августа 2005 00:50 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
я вообще не понял зачем такое нужно делать %) почему просто под отладчиком не поймать загрузку библы ? 
<br>ты лучше скажи для чего тебе это нужно (ну поймаешь програмно загрузку, дальше-то что ?) и что за прот.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31561&amp;user=15&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=22" class="addthx" data-post="31561"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Ara[/b]','')">Ara</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/24.jpg" alt=""><br><span class=txtSm>Ранг: 1288.1 <b><u>(!!!!)</u></b>, 273thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 1.29<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 августа 2005 00:56 <br><script type="text/javascript">QU('Ara','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ara" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>...обоснуй,пожалуйста </i>
<br>Марио обосновал вперед.
<br><i>Mario555 пишет:
<br>ты лучше скажи для чего тебе это нужно (ну поймаешь програмно загрузку, дальше-то что ?) </i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31562&amp;user=24&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=23" class="addthx" data-post="31562"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]freeExec[/b]','')">freeExec</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 156.1 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2181">Участник</a><br><font color=blue>Капрал</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 августа 2005 11:30 <br><script type="text/javascript">QU('freeExec','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=freeExec" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>нам необходимо знать адрес,по которому эта DLL загрузилась. </i>
<br>Что ты нам всем мозги т..ешь, GetModuleHandle(&quot;name_of_Dll.dll&quot;);
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31589&amp;user=2181&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=24" class="addthx" data-post="31589"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 августа 2005 14:40 &middot; Поправил: arnix <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>Э...а можно,пожалуйста,исходник ?  </i>
<br>
<br>хм, я дyмал он там есть... вот держи:
<br>
<br><img src="img/attach.gif" alt=""> <a href="./files/2a00_unGHF_0.3_with_src.rar">2a00_unGHF_0.3_with_src.rar</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31617&amp;user=26&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=25" class="addthx" data-post="31617"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2005 16:32 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
В общем,есть задумка создать некое подобие универсального распаковщика.
<br><i>Mario555 пишет:
<br>что за прот </i>
<br>... Visual Protect http://www.visagesoft.com/products/vp/index.php  .
<br><i>Mario555 пишет:
<br>ну поймаешь програмно загрузку, дальше-то что ? </i>
<br>...как я уже говорил,восстановление названий системных функций происходит в специальной библиотеке протектора.Узнав базовый адрес её загрузки,мы сможем использовать его как стартовую точку для поиска определённых байт,в районе которых мы будем влиять на ход распаковки.
<br> <i>freeExec пишет:
<br>GetModuleHandle(&quot;name_of_Dll.dll&quot;); </i>
<br>...да,кстати,действительно <img src="img/smilies/s6.gif" alt=""> .
<br>Только если я не ошибаюсь,данная функция возвращает дескрипторы тех модулей,которые загружены в вызывающий процесс,а как же поступить с чужим процессом ?
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31721&amp;user=1613&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=26" class="addthx" data-post="31721"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2005 19:13 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>Только если я не ошибаюсь,данная функция возвращает дескрипторы тех модулей,которые загружены в вызывающий процесс,а как же поступить с чужим процессом ? </i>
<br>дык про внедрение в чужой процесс написано много, читай ;) а в твоём случае (написание динамического унпакера) я вообще не понимаю в чём проблема, ведь загрузка библы в отлаживаемый процесс является отладочным событием.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31732&amp;user=15&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=27" class="addthx" data-post="31732"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]freeExec[/b]','')">freeExec</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 156.1 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2181">Участник</a><br><font color=blue>Капрал</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 августа 2005 20:45 <br><script type="text/javascript">QU('freeExec','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=freeExec" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Тогда используй NtQuerySystemInformation из NTDLL.DLL
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=31736&amp;user=2181&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=28" class="addthx" data-post="31736"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 августа 2005 00:21 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
Ну и задолбался же я с этим кодом...
<br>Ближе к делу - по совету <b>Mario555</b> я стал использовать наиболее подходящий,на мой взгляд,вариант.
<br>А именно:
<br><pre>
<br>var
<br> sInfo : TStartupInfo;
<br> pInfo : TProcessInformation;
<br> dEvent : _DEBUG_EVENT;
<br> Base : Cardinal;
<br> dll_Name : array [0..MAX_PATH - 1] of Char;
<br>begin
<br> if CreateProcess(OpenFileName.lpstrFile, NIL, NIL, NIL, False,
<br>                  DEBUG_ONLY_THIS_PROCESS, NIL, NIL, sInfo, pInfo) then
<br>begin
<br>repeat // начинаем бесконечный цикл ожидания отладочного события
<br> WaitForDebugEvent(dEvent, INFINITE);
<br>if dEvent.dwDebugEventCode = LOAD_DLL_DEBUG_EVENT then
<br>{ Если отладочное событие - загрузка библиотеки,то... }
<br>begin
<br> PPointer(Base) := dEvent.LoadDll.lpBaseOfDll; // ...получаем базовый адрес загруженной библиотеки
<br>if GetModuleBaseName(pInfo.hProcess, Base,
<br>                 @dll_Name, SizeOf(dll_Name)) &lt;&gt; 0 then // Пытаемся получить имя библиотеки по её модулю...
<br>begin
<br> Break; // Если предыдущая функция удалась,то выходим из бесконечного цикла 
<br>end else MessageBox(Handle, &#039;Function failed&#039;, NIL, MB_OK);
<br>            DoExit; // Типа убиваем всё наповал :]
<br>end;
<br> ContinueDebugEvent(dEvent.dwProcessId, dEvent.dwThreadId, DBG_CONTINUE);
<br>until False;
<br></pre>
<br>...так вот эта долбаная функция GetModuleBaseName ни под каким соусом не хочет возвращать мне имя модуля,возвращая всё время нуль <img src="img/smilies/s10.gif" alt=""> .
<br>В чём может быть проблема ?
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31955&amp;user=1613&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=29" class="addthx" data-post="31955"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 августа 2005 16:43 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2593&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<i>Ara пишет:
<br>Бред сивой кобылы </i>
<br>Гм... Вот прикольно было бы если любая прога могла в ядро что попало писать... Кста есть такая прога Chameleon Clock, так там прикол как раз в том, что прога умышленно делает попытку записи в ядро, при этом управление передается SEH-обработчику, а он передает его той ветке программы, которая работает в незареганой версии. Теперь обоснуй свое мнение... ИМХО писать что либо в область ядра не так просто...
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=32025&amp;user=2060&amp;forum_n=2&amp;topic=2593&amp;page=0&amp;anchor=30" class="addthx" data-post="32025"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=2&amp;topic=2593&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=2&amp;topic=2593&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Опкод EBFE в начало системной функции</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="2593">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=2593" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
