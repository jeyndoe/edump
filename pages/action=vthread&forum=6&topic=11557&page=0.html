<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Подгружаем свою длл - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Вобщем есть у нас чужое приложение. И есть своя Dll Той длл я хочу расширить(и изменить функционал) приложения. Как я понял есть 2 способа загрузить дллку. 1) Нашел одну статейку где народ делает так. Находим код где есть пустое">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Подгружаем свою длл</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]a1ien[/b]','')">a1ien</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12441">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 18:23 &middot; Поправил: a1ien <br><script type="text/javascript">QU('a1ien','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=a1ien" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Вобщем есть у нас чужое приложение.<br>И есть своя Dll<br><br>Той длл я хочу расширить(и изменить функционал) приложения.<br>Как я понял есть 2 способа загрузить дллку.<br>1) Нашел одну статейку где народ делает так.<br>Находим код где есть пустое место изменяем на него EP<br>Добавляем туда LoadLibrary(грузим свою длл) потом вызываем GetProcAdress и после запускаем свою функцию. и потом прыгаем на OEP<br>2) Добавляем длл в секцию импорта.<br>Только вот тут я так и не понял как вызвать свою функцию.<br><br>И собственно вопрос. Чем кардинально отличаются эти 2 метода. И какой в каких условиях лучше использовать.<br>+ как вызывать функции чужого приложения из своей длл если она к нему подгружена.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184053&amp;user=12441&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=1" class="addthx" data-post="184053"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]sniperZ[/b]','')">sniperZ</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 260.2 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.07'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5211">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 18:37 <br><script type="text/javascript">QU('sniperZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sniperZ" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
когда ты добавляешь в импорт, библа автоматом подгрузиццо, иначе тебе надо руками подгружать через LoadLibrary.. добалять свой код и вызывать функу в любом случае придеццо..<img src="img/smilies/s8.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184055&amp;user=5211&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=2" class="addthx" data-post="184055"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Smon[/b]','')">Smon</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 500.5 (<b>!</b>), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.33'>Активность: 0.23<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 18:42 &middot; Поправил: Smon <br><script type="text/javascript">QU('Smon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Smon" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>a1ien пишет:<br>Только вот тут я так и не понял как вызвать свою функцию.  </I><br><br>В случае LoadLibrary адрес функции ищется стандартным способом:<br>push dll base<br>push procedure name<br>call GetProcAddress, <br>где dll base - адрес загрузки длл который получаешь при LoadLibrary в eax.<br><br>В случае прописи функций твоей библиотеки в импорт - смотри оффсет который будет указывать на нужную функцию в директории импорта исполняемого файла.
<br><br><font size="1"><i>-----<br>&quotПусть видят, что мы не шутим. Стволы для понта, ножи для дела&quot Lock, Stock &amp Two Smoking Barrels</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=184056&amp;user=1449&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=3" class="addthx" data-post="184056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]a1ien[/b]','')">a1ien</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12441">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 18:44 <br><script type="text/javascript">QU('a1ien','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=a1ien" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Это ясно. Но как удобней и лучше делать? Вроде первый способ получше.<br>А как вторым способом вызвать функцию из dll.<br>И еще когда подгружаешь через LoadLibrary вызывается ли DllMain ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184057&amp;user=12441&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=4" class="addthx" data-post="184057"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]a1ien[/b]','')">a1ien</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12441">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 18:46 <br><script type="text/javascript">QU('a1ien','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=a1ien" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Smon пишет:<br>Вызываешь свою функу или по смещению (тогда придётся в отладчике поискать), или стандартным способом:<br>push dll base<br>push procedure name<br>call GetProcAddress,<br>где dll base - адрес загрузки длл который получаешь при LoadLibrary в eax. </I><br>А если мы через Импорт грузим. То как узнатьадрес по которому загрузилась dll?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184059&amp;user=12441&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=5" class="addthx" data-post="184059"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Bitfry[/b]','')">Bitfry</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 495.3 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.8'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=410">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 19:20 <br><script type="text/javascript">QU('Bitfry','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bitfry" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>a1ien пишет:<br>И еще когда подгружаешь через LoadLibrary вызывается ли DllMain ? </I><br>Разумеется. RTFM:<br>If the module is a DLL not already mapped for the calling process, the system calls the DLL&#039;s DllEntryPoint function with the DLL_PROCESS_ATTACH value. If the DLL&#039;s entry-point function does not return TRUE, LoadLibrary fails and returns NULL. <br><I>a1ien пишет:<br>А если мы через Импорт грузим. То как узнатьадрес по которому загрузилась dll? </I><br>Импорт он и есть импорт. Смотри доку PE-формата. Сейчас PE32 уже подробно описан.<br><br>Не заморачивайся с импортом. Разумеется, есть инструменты, которые помогают добавить dll и функции из неё в импорт, но лучше обойтись без этого.<br><br><I>a1ien пишет:<br>Чем кардинально отличаются эти 2 метода. </I><br>1. DllMain в импорте выполняется раньше полной подгрузки импорта и разумеется до того как управление получил главный модуль процесса (то есть до EntryPoint exe-файла). Это может быть важно.<br>2. LoadLibrary медленнее - импорт быстрее (но сомневаюсь что это будет важно).
<br><br><font size="1"><i>-----<br>Всем привет, я вернулся</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=184063&amp;user=410&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=6" class="addthx" data-post="184063"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]a1ien[/b]','')">a1ien</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12441">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 19:42 <br><script type="text/javascript">QU('a1ien','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=a1ien" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Bitfry</b> спасибо большое.<br>А на последний вопроса ответьте пожалуста <img src="img/smilies/s1.gif" alt=""><br>как вызывать функции чужого приложения из своей длл если она к нему подгружена.<br>Тоесть допустим я загрузил свою длл в процес. я знаю адрес по которому лежит фукция в этом процессе. как мне в моей длл ее вызвать? И возможно ли это?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184068&amp;user=12441&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=7" class="addthx" data-post="184068"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Stack[/b]','')">Stack</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 107.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.68'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13953">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 19:55 &middot; Поправил: Stack <br><script type="text/javascript">QU('Stack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Stack" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
насколько я знаю :<br>загоняешь в стек параметры функции в обратном порядке.<br>После - call адрес функции
<br><br><font size="1"><i>-----<br>Md5 fcbb6c9c9a5029b24d70f2d67c7cca74</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=184069&amp;user=13953&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=8" class="addthx" data-post="184069"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]a1ien[/b]','')">a1ien</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12441">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 19:59 &middot; Поправил: a1ien <br><script type="text/javascript">QU('a1ien','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=a1ien" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Тоесть какбудто мы находимся в коде самого приложения?<br>А если DLL на си пишется то как вызвать функцию по адресу?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184071&amp;user=12441&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=9" class="addthx" data-post="184071"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Stack[/b]','')">Stack</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 107.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.68'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13953">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 20:38 <br><script type="text/javascript">QU('Stack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Stack" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Ну на си надо получить поинтер на твою функцию.<br>Вот  код на delphi перевести на си не будет сложно если знаешь.<br><br>var<br>поинтер:function(параметры):что возвращяет или procedure(параметры)<br>.............................<br>@поинтер:=адрес твоей функции     - тут задаешь адрес твоей функции<br>вызываешь так - поинтер(параметры)<br>ЗЫ: DLL внедряет свой код в область кода процесса
<br><br><font size="1"><i>-----<br>Md5 fcbb6c9c9a5029b24d70f2d67c7cca74</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=184074&amp;user=13953&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=10" class="addthx" data-post="184074"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]a1ien[/b]','')">a1ien</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12441">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 21:59 <br><script type="text/javascript">QU('a1ien','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=a1ien" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Ну как вызвать ясно. А какой тим указателья должен быть?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184082&amp;user=12441&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=11" class="addthx" data-post="184082"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Stack[/b]','')">Stack</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 107.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.68'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13953">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 марта 2008 22:08 <br><script type="text/javascript">QU('Stack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Stack" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
так я говорю тип - function(параметры) на delphi , а на си вроде тоже так
<br><br><font size="1"><i>-----<br>Md5 fcbb6c9c9a5029b24d70f2d67c7cca74</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=184086&amp;user=13953&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=12" class="addthx" data-post="184086"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]RSI[/b]','')">RSI</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 284.8 (наставник), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 13:36 <br><script type="text/javascript">QU('RSI','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RSI" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>a1ien пишет:<br>А если DLL на си пишется то как вызвать функцию по адресу? </I><br><br>Что бы из длл вызывать функцию нужно знать ее адресс + какие параметры принимает и что возвращает.<br><br>типа того: у тебя есть фунция по адресу 0х00401000 и она принимает 2 параметра DWORD и ничего не возвращает.<br><br>typedef	void (WINAPI *FUNC)(DWORD, DWORD );<br><br>FUNC	MyFun;<br><br>MyFun = (FUNC)0x00401000;<br><br>MyFun(0 , 1);
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184130&amp;user=6361&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=13" class="addthx" data-post="184130"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]SLV[/b]','')">SLV</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 309.8 (мудрец), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.69'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=663">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 15:24 <br><script type="text/javascript">QU('SLV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SLV" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
&gt; Разумеется. RTFM:<br>смортя с какими флагами вызов, хотя это уже про LoadLibraryEx.<br>&gt; 2. LoadLibrary медленнее - импорт быстрее (но сомневаюсь что это будет важно).<br>по-моему одно и тоже.
<br><br><font size="1"><i>-----<br>Shalom ebanats!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=184138&amp;user=663&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=14" class="addthx" data-post="184138"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Stack[/b]','')">Stack</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 107.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.68'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13953">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 16:03 <br><script type="text/javascript">QU('Stack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Stack" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11557.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>RSI пишет:<br>Что бы из длл вызывать функцию нужно знать ее адресс + какие параметры принимает и что возвращает. <br><br>типа того: у тебя есть фунция по адресу 0х00401000 и она принимает 2 параметра DWORD и ничего не возвращает. <br><br>typedef void (WINAPI *FUNC)(DWORD, DWORD ); <br><br>FUNC MyFun; <br><br>MyFun = (FUNC)0x00401000; <br><br>MyFun(0 , 1); </I><br><br>Я тоже самое говорил просто я синтаксиса си незнаю
<br><br><font size="1"><i>-----<br>Md5 fcbb6c9c9a5029b24d70f2d67c7cca74</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=184142&amp;user=13953&amp;forum_n=6&amp;topic=11557.html&amp;page=0&amp;anchor=15" class="addthx" data-post="184142"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Подгружаем свою длл</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#16" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="11557">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=11557" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
