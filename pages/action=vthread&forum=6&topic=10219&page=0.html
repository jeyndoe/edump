<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как отлечить USB флешь от жесткого диска???? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="я написал програмку для форматирования флешек!! смысл такой! хочу зделать защиту от ДУРАКА! тоесть чтобы ктото случайно сам себе винт не форматнул! как мне в программе реализовать защиту от записи на винт?? флешка имеет точно">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как отлечить USB флешь от жесткого диска????</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=10219&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=10219&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]steepf[/b]','')">steepf</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12838">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 октября 2007 15:27 <br><script type="text/javascript">QU('steepf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=steepf" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
я написал програмку для форматирования флешек!! <br>смысл такой! хочу зделать защиту от ДУРАКА! тоесть чтобы ктото случайно сам себе винт не форматнул! как мне в программе реализовать защиту от записи на винт?? флешка имеет точно такиеже идентификаторы как и жесткий диск!вовсяком случае в бут секторе нигде не упоминуеться что ето сьемный диск!! там есть чтото похожее по смещению 15h длинной 1 байт тип носителя указываеться<br>Тип носителя. Значение 0xF8 указывает на жесткий диск, 0xF0 — на флоппи-диск высокой плотности<br>так вот и у флешки и у винта оно одинаковое!! может ктото вкурсе как можно ето дело проверить! посоветуйте чтото! может я зациклился на чем то и истины уже не вижу))))) всем спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164118&amp;user=12838&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=1" class="addthx" data-post="164118"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]SaNX[/b]','')">SaNX</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 456.3 (мудрец), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.03'>Активность: 0.28<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=2108">Участник</a><br><font color=blue>Android Reverser</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 октября 2007 15:32 <br><script type="text/javascript">QU('SaNX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SaNX" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>steepf</b><br>бугого. самый простой способ<br>function GetDriveType(lpRootPathName: PChar): UINT;
<br><br><font size="1"><i>-----<br>SaNX</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164120&amp;user=2108&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=2" class="addthx" data-post="164120"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 октября 2007 15:33 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>steepf</b>, GetDriVeType
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164121&amp;user=8921&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=3" class="addthx" data-post="164121"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]steepf[/b]','')">steepf</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12838">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 октября 2007 16:03 <br><script type="text/javascript">QU('steepf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=steepf" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
спасибо!!! видите я зашился на низкий уровень! а самого елементарного не видел! аж стыдно елки палки!!)))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164129&amp;user=12838&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=4" class="addthx" data-post="164129"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]steepf[/b]','')">steepf</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 12.2 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.9'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12838">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 октября 2007 16:05 <br><script type="text/javascript">QU('steepf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=steepf" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
хотя нет не все! ета функция GetDriveType гдето ету информацию берет!! откудота читает??? как вы думаете откуда?? тока не надо советовать в дебагере протрасить GetDriveType!интерестно конечно! но может ктото знает откуда она ее читает???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164130&amp;user=12838&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=5" class="addthx" data-post="164130"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 октября 2007 16:19 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>steepf пишет:<br>тока не надо советовать в дебагере протрасить GetDriveType </I><br>Ладно, не будем советовать раз ты сам уже догадался <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164132&amp;user=12867&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=6" class="addthx" data-post="164132"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Bit-hack[/b]','')">Bit-hack</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/198.jpg" alt=""><br><span class=txtSm>Ранг: 303.7 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=198">Участник</a><br><font color=blue>tPORt Manager</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 октября 2007 20:35 <br><script type="text/javascript">QU('Bit-hack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bit-hack" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>steepf</b><br>Думаю, что она спрашивает тип устройства у драйвера, контролирующего его.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164157&amp;user=198&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=7" class="addthx" data-post="164157"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Bit-hack[/b]','')">Bit-hack</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/198.jpg" alt=""><br><span class=txtSm>Ранг: 303.7 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=198">Участник</a><br><font color=blue>tPORt Manager</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 октября 2007 20:38 <br><script type="text/javascript">QU('Bit-hack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bit-hack" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
А вообще цепочка такова GetDriveTypeA -&gt; GetDriveTypeW -&gt; NtQueryInformationProcess -&gt; ZwQueryInformationProcess -&gt; А дальше топаем в ядро, думаю тебе это не интересно. И ещё, потрейсь GetDriveTypeA<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164158&amp;user=198&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=8" class="addthx" data-post="164158"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 00:39 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>steepf пишет:<br>я написал програмку для форматирования флешек!!  </I><br>А format.com разве не рулит??<br><br>GetDriveType скажет DRIVE_REMOVABLE, но ведь эт еще не значит, что это флешка! Это м.б. и флоп, и криво настроеный винт, и еще х.з. что...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164183&amp;user=3910&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=9" class="addthx" data-post="164183"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 01:16 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Проверяй на размер диска. Сколько там максимальная флешка ? 32 ? Пусть утиль не форматирует диски более 32 Гб.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164186&amp;user=702&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=10" class="addthx" data-post="164186"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 03:29 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>ToBad</b>, а через N месяцев флешки подрастут в объеме...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164197&amp;user=8921&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=11" class="addthx" data-post="164197"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 12:53 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I><b>Azur1d</b> пишет:<br>а через N месяцев флешки подрастут в объеме... </I><br><br>Автор выпустит SP1 для своей тулзы, где будет патч 20h на актуальное кол-во гиг на текущий момент. И все, кто обычно случайно форматирует винты вместо флешек по интернету качнут сервис пак и перестанут нечаянно форматировать не то. Будут кстати очень благодарны автору. Напишут благодарственные письма: &quot;До того как я скачал вашу тулзу где то раз в неделю я промахивался и выбирал диск С: вместо флешки. Другие программы молча форматировали и мне приходилось покупать новый жёсткий диск. Но теперь, особенно после установки SP1, программа говорит мне: &quot;Выбери другой диск, лох...&quot;, и ведь права она, знает что диск не тот....&quot; <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164249&amp;user=702&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=12" class="addthx" data-post="164249"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Ice-T[/b]','')">Ice-T</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/12329.jpg" alt=""><br><span class=txtSm>Ранг: 126.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.01'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12329">Участник</a><br><font color=blue>#CCh</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 13:33 <br><script type="text/javascript">QU('Ice-T','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ice-T" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
не проще просто конфирм сделоть.. и вообще зочем нужно ограничение по типам дисков, пусть твоя тулза форматирует и HDD тоже... или твоя задача затереть флешку потихому? )
<br><br><font size="1"><i>-----<br>invoke OpenFire</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164254&amp;user=12329&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=13" class="addthx" data-post="164254"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Bit-hack[/b]','')">Bit-hack</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/198.jpg" alt=""><br><span class=txtSm>Ранг: 303.7 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=198">Участник</a><br><font color=blue>tPORt Manager</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 15:21 <br><script type="text/javascript">QU('Bit-hack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bit-hack" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Azur1d</b><br>ZwQueryInformationProcess тут получишь инфу, а тему закрой.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164273&amp;user=198&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=14" class="addthx" data-post="164273"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]MACKLIA[/b]','')">MACKLIA</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5822.gif" alt=""><br><span class=txtSm>Ранг: 279.1 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.96'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5822">Участник</a><br><font color=blue>wizard</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 18:54 <br><script type="text/javascript">QU('MACKLIA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MACKLIA" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>0xy пишет:<br>GetDriveType скажет DRIVE_REMOVABLE, но ведь эт еще не значит, что это флешка! Это м.б. и флоп </I><br><br>У флопа FAT12 ,а флешка FAT 32  или FAT 16 .
<br><br><font size="1"><i>-----<br>Что один человек сделал , другой всегда сломать может...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164321&amp;user=5822&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=15" class="addthx" data-post="164321"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 19:13 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>MACKLIA пишет:<br>флешка FAT 32 или FAT 16 </I><br>Не факт. Я форматирую свои флешки в NTFS
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164325&amp;user=12867&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=16" class="addthx" data-post="164325"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]GPcH[/b]','')">GPcH</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3.gif" alt=""><br><span class=txtSm>Ранг: 631.1 (<b>!</b>), 62thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.37<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3">Участник</a><br><font color=blue>Автор VB Decompiler</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 19:26 &middot; Поправил: GPcH <br><script type="text/javascript">QU('GPcH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GPcH" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Есть способ точнее - и не надо лезть в ядро - детектить флешку через опрос USB устройств.<br>Я как-то давно для одного клиента писал ActiveX для опроса USB устройств и детекта их коннекта.<br>Так как я понимаю тебе это нужно для коммерческих целей - пиши в приват или в мыло - договоримся, я цены не заламываю.<br><br>Суть моего ActiveX для детекта флешки:<br><br><code>Dim WithEvents USB As DotFixUSB.GetInfo<br><br>Private Sub Form_Load()<br>  Dim i As Long<br>  Set USB = New DotFixUSB.GetInfo<br>  Call USB.HookEvents(frmMain)<br>  For i = 1 To USB.GetDeviceCount<br>    if USB.GetDeviceInfo(i).strDeviceName=&quot;Запоминающее устройство для USB&quot; then<br>      &#039;найдена флешка<br>    end if<br>  Next<br>End Sub</code><br><br>После этого ты знаешь сколько флешек подключено - следовательно столько же букв дисков от конца детектируемых - это флешки.
<br><br><font size="1"><i>-----<br>Никогда не делай то, что возможно. Стремись сделать то что невозможно впринципе!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164326&amp;user=3&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=17" class="addthx" data-post="164326"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Azur1d[/b]','')">Azur1d</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 129.7 (ветеран), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8921">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 19:43 <br><script type="text/javascript">QU('Azur1d','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Azur1d" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>ntldr пишет:<br>Не факт. Я форматирую свои флешки в NTFS </I><br>Но не в фат12.<br><br><I>ToBad пишет:<br>Azur1d пишет: <br>а через N месяцев флешки подрастут в объеме... <br><br>Автор выпустит SP1 для своей тулзы, где будет патч 20h на актуальное кол-во гиг на текущий момент </I><br>И через M месяцев флешки сравняются по объемя с винтами))))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164330&amp;user=8921&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=18" class="addthx" data-post="164330"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]__[/b]','')">__</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.1 (ветеран), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.73'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7172">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 19:45 <br><script type="text/javascript">QU('__','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=__" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
www.codeproject.com/w2k/usbdisks.asp
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164331&amp;user=7172&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=19" class="addthx" data-post="164331"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]ViSoR[/b]','')">ViSoR</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 49.7 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.99'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 21:25 <br><script type="text/javascript">QU('ViSoR','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ViSoR" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>GPcH</b>, а если у меня китайская винда? Вариант определения устройства по его локализированному имени это мощно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164345&amp;user=5618&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=20" class="addthx" data-post="164345"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]GPcH[/b]','')">GPcH</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3.gif" alt=""><br><span class=txtSm>Ранг: 631.1 (<b>!</b>), 62thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.37<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3">Участник</a><br><font color=blue>Автор VB Decompiler</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 22:41 <br><script type="text/javascript">QU('GPcH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GPcH" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>ViSoR пишет:<br>GPcH, а если у меня китайская винда? Вариант определения устройства по его локализированному имени это мощно. </I><br><br>Я образно сказал. Моя DLL предоставляет досуп ко всем данным USB устройства (по их совокупности можно определить флешку). Тем более автор не написал для какого рынка предназнаяена прога.
<br><br><font size="1"><i>-----<br>Никогда не делай то, что возможно. Стремись сделать то что невозможно впринципе!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164355&amp;user=3&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=21" class="addthx" data-post="164355"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]GPcH[/b]','')">GPcH</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3.gif" alt=""><br><span class=txtSm>Ранг: 631.1 (<b>!</b>), 62thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.37<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3">Участник</a><br><font color=blue>Автор VB Decompiler</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 22:44 <br><script type="text/javascript">QU('GPcH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GPcH" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>ViSoR пишет:<br>а если у меня китайская винда?  </I><br><br>[offtop]<br><br>Тогда выложи ее дистрибутив на рапиду - скажу тебе спасибо, уже 2 года ищу дистриб китайской WinXP (именно китайской, а не английской с китайским MUI).<br><br>PS: нужна для тестов юникод специфичных криптоалгоритмов.<br><br>[/offtop]
<br><br><font size="1"><i>-----<br>Никогда не делай то, что возможно. Стремись сделать то что невозможно впринципе!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164357&amp;user=3&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=22" class="addthx" data-post="164357"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Shad0vv[/b]','')">Shad0vv</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 34.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.52'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3393">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 23:24 <br><script type="text/javascript">QU('Shad0vv','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Shad0vv" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>GPcH пишет:<br>уже 2 года ищу дистриб китайской WinXP </I><br><br>В муле всё валяется. <br>Так же можно попарсить google.cn и baidu.cn
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164362&amp;user=3393&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=23" class="addthx" data-post="164362"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]ntldr[/b]','')">ntldr</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 369.8 (мудрец), 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.89'>Активность: 0.39<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12867">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 23:25 <br><script type="text/javascript">QU('ntldr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ntldr" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>GPcH пишет:<br>if USB.GetDeviceInfo(i).strDeviceName=&quot;Запоминающее устройство для USB&quot; then </I><br>И за ЭТО ты требуешь денег? Нам такой дурацкий код и даром не надо.
<br><br><font size="1"><i>-----<br>PGP key <noindex><a href="https://diskcryptor.net/storage/new_key.asc" rel="nofollow" target="_blank">&lt0x1B6A24550F33E44A&gt</a></noindex></i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164363&amp;user=12867&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=24" class="addthx" data-post="164363"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]GPcH[/b]','')">GPcH</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3.gif" alt=""><br><span class=txtSm>Ранг: 631.1 (<b>!</b>), 62thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.37<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3">Участник</a><br><font color=blue>Автор VB Decompiler</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 23:58 <br><script type="text/javascript">QU('GPcH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GPcH" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>ntldr пишет:<br>И за ЭТО ты требуешь денег? Нам такой дурацкий код и даром не надо. </I><br><br>Речь шла о полном ActiveX для парсинга ВСЕХ свойств USB устройств с функциями детекта их плуга и унплуга. Эта DLL и стоит денег и коду там не мало. Тот код, что я привел, всего лишь пример, использующий сотую долю той DLL <img src="img/smilies/s1.gif" alt=""><br><br><I>ntldr пишет:<br>Нам такой дурацкий код и даром не надо. </I><br><br>Ты то вообще тут при чем? Я вообще автору топика советую решение.
<br><br><font size="1"><i>-----<br>Никогда не делай то, что возможно. Стремись сделать то что невозможно впринципе!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164370&amp;user=3&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=25" class="addthx" data-post="164370"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]GPcH[/b]','')">GPcH</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3.gif" alt=""><br><span class=txtSm>Ранг: 631.1 (<b>!</b>), 62thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.37<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3">Участник</a><br><font color=blue>Автор VB Decompiler</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 00:01 <br><script type="text/javascript">QU('GPcH','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GPcH" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>Shad0vv пишет:<br>В муле всё валяется. <br>Так же можно попарсить google.cn и baidu.cn </I><br><br>Ну у меня статик IP нету и порт маппинг не поддерживается модемом плюс для выхода в инет я использую разные приемный и передающий каналы, при этом работая через SOCKS5 proxy, потому о emule мне можно и не мечтать - все равно он не работает на такой многозвенной цепи. Да и качать по нему 600 мегов - извините, это год уйдет. Вот если бы кто выложил на рапиду или еще куда.
<br><br><font size="1"><i>-----<br>Никогда не делай то, что возможно. Стремись сделать то что невозможно впринципе!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164372&amp;user=3&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=26" class="addthx" data-post="164372"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 00:07 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
Имхо топикстартеру нужно, чтобы узер не форматнул себе винт (судя по первому посту). Думаю, достаточно проверки GetDriveType на DRIVE_REMOVABLE. Флопик? Есть GetDiskFreeSpace, к томуже в большинстве случаев у флопиков буква тома A:\ B:\ (защита ведь от дуркака...). Есть еще интерфейсы WMI (искать в MSDN), а также Removable Storage Manager Functions (там же). <br><br><I>GPcH пишет:<br>уже 2 года ищу дистриб китайской WinXP </I><br><br>мегаЛОЛ
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164374&amp;user=2060&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=27" class="addthx" data-post="164374"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Crazy_Death[/b]','')">Crazy_Death</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8946">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 01:55 &middot; Поправил: Crazy_Death <br><script type="text/javascript">QU('Crazy_Death','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Crazy_Death" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
to steepf:<br>можеш поковырять технологию U3, там самый банальный инсталятор<br>проверяет есть ли твой диск, флешка или жестак<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164380&amp;user=8946&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=28" class="addthx" data-post="164380"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Frolls[/b]','')">Frolls</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.79'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=13391">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 октября 2007 11:51 <br><script type="text/javascript">QU('Frolls','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Frolls" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
Steepf: дескрипторы флешки и винта абсолютно идентичны?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164838&amp;user=13391&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=29" class="addthx" data-post="164838"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]HiEndsoft[/b]','')">HiEndsoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 237.0 (наставник), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.74'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13651">Участник</a><br><font color=blue>sysenter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2007 02:02 &middot; Поправил: HiEndsoft <br><script type="text/javascript">QU('HiEndsoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HiEndsoft" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10219&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
DriveName[0]=FirstDriveFromMask(MyDevV-&gt;dbcv_unitmask);<br>DriveName[1] = &#039;:&#039;; DriveName[2] = &#039;&#039;; DriveName[3] = 0;<br>DriveTyp=GetDriveType(DriveName);<br>if (DriveTyp==2) -&gt; Значит сменный носитель.<br>А вообще советую посмотреть:<br><a href="http://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10202" target="_new">http://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=10202</a><br>Если чего непонятно, могу дать кусок своего исходника dll с детектированием подключения - отключения устройств Plug&amp;Play любого класса. На халяву естес-но.
<br><br><font size="1"><i>-----<br>продавец резиновых утёнков</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=165102&amp;user=13651&amp;forum_n=6&amp;topic=10219&amp;page=0&amp;anchor=30" class="addthx" data-post="165102"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=10219&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=10219&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как отлечить USB флешь от жесткого диска????</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=10219" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
