<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>лоадер ставящий memory breakpoint - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT=";Этот код перреписан на ассемблере основан на статье &quot;Using_Memory_Breakpoints_by_Shub-Nigurrath_;v10&quot; ;macro step ;	cmp context.regFlag,1            ; and context.regFlag,100h        ;endm .386 .model flat,stdcall">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a>, <a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> лоадер ставящий memory breakpoint</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ewgeny1987[/b]','')">ewgeny1987</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.9'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=12844">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 июля 2008 07:39 <br><script type="text/javascript">QU('ewgeny1987','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ewgeny1987" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12422.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
;Этот код перреписан на ассемблере основан на статье &quot;Using_Memory_Breakpoints_by_Shub-Nigurrath_;v10&quot;<br>;macro step<br>;	cmp context.regFlag,1<br>          <br>           ; and context.regFlag,100h <br>            <br>;endm<br>.386 <br>.model flat,stdcall <br>option casemap:none <br><br>include			windows.inc <br>include			kernel32.inc <br>include			user32.inc <br>includelib		kernel32.lib<br>includelib		user32.lib<br>includelib  user32.lib<br><br>.data <br><br>tname db    &quot;pexplorer.exe&quot;,0<br> message db &quot;Memory breakpoint!&quot;,0<br> mregeip db &quot;  EXCEPTION_GUARD_PAGE address&quot;,0<br>;pb db 0C7h, 005h, 0C4h, 072h, 05Ch, 000h, 001h, 000h, 000h, 000h, 090h, 090h, 090h<br>mname db &quot;kernel32&quot;,0<br>fname db &quot;DebugActiveProcessStop&quot;,0<br>pva dd 004B2D6Ch;address we want to stop<br>mbva dd 00487908h;this place need to be patching, its give the unlimited trial<br>pb db 0C9h;patching byte<br><br>ek db 13,10<br>;mb db 01h<br>;nb db 090h,090h,090h,090h,090h,90h,90h<br>dwOldProtect dd -1<br>handle dd ?<br>count dd 0<br>format db &quot;%d.&quot;,0<br>.data? <br><br><br>buffer db 5 dup(?) <br>buffer2 db 6 dup(?) <br>startinfo STARTUPINFO &lt;&gt; <br>pi PROCESS_INFORMATION &lt;&gt; <br>DBEvent DEBUG_EVENT &lt;&gt; <br>align dword <br>context CONTEXT &lt;&gt; <br>.code <br>start: <br>main proc<br>invoke GetStdHandle,STD_OUTPUT_HANDLE<br>mov handle,eax<br>invoke GetStartupInfo,addr startinfo <br>invoke CreateProcess, addr tname, NULL, NULL, NULL, FALSE, DEBUG_PROCESS, NULL, NULL, addr startinfo, addr pi<br>cmp eax,0<br>je endd            <br>;invoke WriteProcessMemory,pi.hProcess,mbva,addr pb,1,0<br>invoke VirtualProtectEx,pi.hProcess,pva,1,PAGE_READONLY or PAGE_GUARD,addr dwOldProtect<br>.while TRUE <br>       invoke WaitForDebugEvent, addr DBEvent, 1000 ;wait for debug event<br>       invoke GetThreadContext, pi.hThread, addr context ;read context<br>       <br>  .if DBEvent.dwDebugEventCode==EXIT_PROCESS_DEBUG_EVENT ;process exit<br>      <br>          .break <br>          <br>   .elseif DBEvent.dwDebugEventCode==EXCEPTION_DEBUG_EVENT  <br>                <br>        <br><br>         .if DBEvent.u.Exception.pExceptionRecord.ExceptionCode==80000001h ;EXCEPTION_GUARD_PAGE<br>             mov context.ContextFlags, CONTEXT_FULL <br>            ; invoke SuspendThread,pi.hThread;stop thread<br>            ;Show address of exceptions<br>               ;  invoke wsprintf,addr buffer2,addr format, DBEvent.u.Exception.pExceptionRecord.ExceptionAddress<br>        ; invoke WriteConsole,handle,addr buffer2,sizeof buffer2,0,0<br>;invoke WriteConsole,handle,addr mregeip,sizeof mregeip,0,0<br>;invoke WriteConsole,handle,addr ek,sizeof ek,0,0<br><br>             invoke VirtualProtectEx,pi.hProcess,pva,1,PAGE_READONLY or PAGE_GUARD,0<br>             ;mov ecx,DBEvent.u.Exception.pExceptionRecord.ExceptionAddress<br>             invoke GetThreadContext, pi.hThread, addr context ;read context<br>             cmp DBEvent.u.Exception.pExceptionRecord.ExceptionAddress,004B2D6Ch<br>              je win<br>             jmp next<br>win:<br>inc count<br><br>invoke wsprintf,addr buffer,addr format, count<br>  invoke WriteConsole,handle,addr buffer,sizeof buffer,0,0<br>;invoke WriteConsole,handle,addr ek,sizeof ek,0,0<br>  invoke WriteConsole,handle,addr message,sizeof message,0,0<br>invoke WriteConsole,handle,addr ek,sizeof ek,0,0<br><br>;invoke MessageBox,0,addr message,addr tname,MB_OK<br>            invoke VirtualProtectEx,pi.hProcess,pva,1,addr dwOldProtect,0<br>             ;invoke VirtualProtectEx,pi.hProcess,pva,1,PAGE_EXECUTE_READWRITE,0<br>  ;ACTION IS BEGIN!           <br>            ; invoke GetThreadContext, pi.hThread, addr context<br>            ;mov context.regEax,1<br>            ;inc context.regEip<br>            invoke WriteProcessMemory,pi.hProcess,mbva,addr pb,1,0<br>             ;invoke SetThreadContext,pi.hThread,addr context<br>          ; invoke GetModuleHandle,addr mname<br>          ; invoke GetProcAddress,eax,addr fname<br>          ;call eax; Stop debuging<br> ;jmp endd<br> ;invoke ContinueDebugEvent, DBEvent.dwProcessId, DBEvent.dwThreadId, DBG_CONTINUE <br> invoke ContinueDebugEvent, DBEvent.dwProcessId, DBEvent.dwThreadId, DBG_EXCEPTION_NOT_HANDLED<br> <br>   jmp enddebug       <br> ;jnz next<br>              <br>          <br> next:<br>       ; invoke ResumeThread,pi.hThread<br>         invoke VirtualProtectEx,pi.hProcess,pva,2,PAGE_EXECUTE_READWRITE,0<br>          invoke GetThreadContext, pi.hThread, addr context<br>           ;cmp context.regEip,005492A4h<br>             ; je win <br>         or context.regFlag,100h ;continue tracing<br>        invoke SetThreadContext,pi.hThread, addr context <br>          invoke ContinueDebugEvent, DBEvent.dwProcessId, DBEvent.dwThreadId, DBG_CONTINUE <br>             .continue <br>          <br>          .elseif DBEvent.u.Exception.pExceptionRecord.ExceptionCode==80000003h <br>          invoke ContinueDebugEvent, DBEvent.dwProcessId, DBEvent.dwThreadId, DBG_CONTINUE <br>             .continue<br>          <br>;A trace trap or other single-instruction mechanism signaled that one instruction has been executed.<br>          .elseif DBEvent.u.Exception.pExceptionRecord.ExceptionCode==EXCEPTION_SINGLE_S TEP  <br>           <br>           invoke GetThreadContext,pi.hThread,addr context <br>             and context.regFlag,0FFFFFEFFh ;<br>             <br>             invoke SetThreadContext,pi.hThread, addr context <br>          invoke VirtualProtectEx,pi.hProcess,pva,1,PAGE_READONLY or PAGE_GUARD,addr dwOldProtect<br>invoke ContinueDebugEvent, DBEvent.dwProcessId, DBEvent.dwThreadId,DBG_CONTINUE <br>            <br>             .continue <br>          .endif <br>       .endif <br>     <br>      enddebug:<br>       invoke ContinueDebugEvent, DBEvent.dwProcessId, DBEvent.dwThreadId, DBG_EXCEPTION_NOT_HANDLED <br>    .endw <br>endd:<br>;invoke VirtualProtectEx,pi.hProcess,pva,1,addr dwOldProtect,0<br>;invoke MessageBox,0,addr tname,addr tname,MB_OK<br><br>invoke CloseHandle,pi.hProcess <br>invoke CloseHandle,pi.hThread <br>invoke ExitProcess, 0 <br>ret <br>main endp<br>invoke ExitProcess, 0 <br>end start
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=197157&amp;user=12844&amp;forum_n=6&amp;topic=12422.html&amp;page=0&amp;anchor=1" class="addthx" data-post="197157"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 августа 2008 10:09 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12422.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>ewgeny1987</b><br><i class=x>Этот код перреписан на ассемблере основан на статье &quot;Using_Memory_Breakpoints_by_Shub-Nigurrath_;v10&quot;</i><br>И что дальше?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=200149&amp;user=6336&amp;forum_n=6&amp;topic=12422.html&amp;page=0&amp;anchor=2" class="addthx" data-post="200149"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 августа 2008 16:48 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12422.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
А ничего. Дальше может быть только по лбу за некропостерство.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=200201&amp;user=1556&amp;forum_n=6&amp;topic=12422.html&amp;page=0&amp;anchor=3" class="addthx" data-post="200201"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> лоадер ставящий memory breakpoint</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12422" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
