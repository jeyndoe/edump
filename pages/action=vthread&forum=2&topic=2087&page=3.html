<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Кто знает немецкий язык. (или тутор по снятию SafeDisc 3.xx) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Как известно, многие крэк-группы не хотят делиться туториалами по снятию той или иной защиты, и сидят на закрытых IRC каналах... Нашел тутор по снятию SafeDisc 3.xx. Вещь довольно интересная, только вот я не силен в немецком...">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55991'>kris_sexy</a>, <a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Кто знает немецкий язык. (или тутор по снятию SafeDisc 3.xx)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=2.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=2.html">3</a> . <b>4</b> . <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=4.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Tim[/b]','')">Tim</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 253.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.91'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=161">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 мая 2005 22:42 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Tim','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tim" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#1');return false;">#1</a> </span><div align=left><br>
Как известно, многие крэк-группы не хотят делиться туториалами по снятию той или иной защиты, и сидят на закрытых IRC каналах... Нашел тутор по снятию SafeDisc 3.xx. Вещь довольно интересная, только вот я не силен в немецком... Напишите хоть что-нибудь.
<br>
<br><img src="img/attach.gif" alt=""> <a href="./files/4ace_CIP _ Tutorial Manual unpack NFSU2 (Safedisc v3_xx).rar">4ace_CIP _ Tutorial Manual unpack NFSU2 (Safedisc v3_xx).rar</a>
<br><br><font size="1"><i>-----<br>MicroSoft? Is it some kind of a toilet paper?</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=24150&amp;user=161&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=1" class="addthx" data-post="24150"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2005 15:17 &middot; Поправил: Error_Log <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#2');return false;">#2</a> </span><div align=left><br>
<b>DillerInc</b>
<br><b>OR EBX, 0000000C</b> и <b>OR EBX, 0C</b> это одно и то же;
<br>
<br>Набираешь в SoftICE:
<br>a _address_ ( _address_ - это адрес куда нужно вводить ассемблерные инструкции)
<br>(нажать enter) 
<br>or ebx, 0c
<br>(нажать enter) 
<br>.............................(и т. д.)
<br>(нажать enter) 
<br>Можно также: EB _address_  _data_ (_data_ это последовательность Нех - опкодов, разделять пробелами, например: 
<br><b>EB</b> F4561743 <b>83 CB 0c</b>) 83 cb 0c это опкоды команды <b>OR ebx, 0c </b> которые начнут записываться в память начиная с адреса F4561743 в данном примере.
<br>Еще один способ: ввести <b>db</b> _address_ и в окне данных наведя курсор на Нех-опкод изменяешь на нужный
<br>
<br>Поскольку IceExt не защищает от обнаружения SoftICE через DR7, то вполне возможно, именно так SafeDisk его и определяет (если еще чего-то не намутили, гады...)
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=30750&amp;user=2060&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=2" class="addthx" data-post="30750"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2005 19:04 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#3');return false;">#3</a> </span><div align=left><br>
<i>Error_Log пишет:
<br>это одно и то же </i>
<br>...кроме длины этих команд и соответственно опкодов:
<br>81CB0C000000 OR EBX, 0000000C
<br>83CB0C             OR EBX, 0C
<br><i>Error_Log пишет:
<br>Еще один способ: ввести db _address_ и в окне данных наведя курсор на Нех-опкод изменяешь на нужный </i>
<br>...спасибо - этого я не знал,и это мне помогло написать команды как надо <img src="img/smilies/s1.gif" alt=""> .
<br>
<br>Теперь о грустном - игра (в данном случае Call of Duty - SD 3.10.20) у меня всё равно не запускается <img src="img/smilies/s13.gif" alt=""> .
<br>Может мы закрыли какую-то из дырок,но осталась какая-нибудь другая,так сказать,более свежая... По крайней мере мне хочется на это надеятся, т.е. надеятся на то,что мы движемся в верном направлении.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=30776&amp;user=1613&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=3" class="addthx" data-post="30776"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 июля 2005 20:25 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#4');return false;">#4</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>...кроме длины этих команд и соответственно опкодов: 
<br>81CB0C000000 OR EBX, 0000000C 
<br>83CB0C OR EBX, 0C  </i>
<br>А это уже зависит от ассемблера, который генерирует эти опкоды, предлагаю почитать:<br><br><img src="img/attach.gif" alt=""> <a href="./files/8047_kaspersk01.rar">8047_kaspersk01.rar</a>
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=30785&amp;user=2060&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=4" class="addthx" data-post="30785"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 июля 2005 13:42 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#5');return false;">#5</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>По крайней мере мне хочется на это надеятся, т.е. надеятся на то,что мы движемся в верном направлении </i>
<br>Я нашел решение: будем использовать баг в защите для обхода антиотладки, короче:
<br>1. Грузим защищенный SD файл в дизассемблер (это по вкусу, я использую OllyDbg, за одно там удобно ассемблировать процедуру по восстановлению импорта). Ищем там процедуру декриптования:
<br> CALL ХХХХХХХХ ;Процедура декриптования игры 
<br> ADD ESP,8
<br> CMP EAX,0     ;если EAX = 1,значит ошибка
<br> JE ХХХХХХХХ   ;если декриптование прошло гладко
<br>Через несколько прыжков после нее будет прыжек в другую секцию
<br>В переведенной статье DillerInc по SD 2.30.33 это
<br>008CB0B9   E97645EAFF      JMP 0076F634; это прыгает на ОЕР
<br>2. Вместо jmp OEP_address вписываем туда jmp eip (опкоды EB FE). (Здесь я сразу делаю прыжек на свою процедуру восстановления импорта) Сохраняем изменения.
<br>3. В опция загрузки SoftICE ставим &quot;manual&quot;. После загрузки винды запускаем подопытную игрушку (не забываем вставить диск в CD-ROM). SplashPicture появится на короткое время и исчезнет. (SoftICE не загружен !!!)
<br>4. В командной строке: NET START ICEEXT, после загрузки SoftICE жмем Ctrl-D и мы окажемся после процедуры декриптования прямо перед прыжком на OEP !!! Начиная с этого места уже никто не помешает вам отлаживать программу.
<br>5. Пишем процедуру по восстановлению импорта и краденных байтов. Дампим, делаем Rebuild PE.
<br>6. Если нужно выйти в Windows набираем !Suspend, вернуться назад - !Resume.
<br>
<br>P. S. Данная методика была проверенна на версиях SD начиная с 2.50.ХХ и заканчивая SD 3.XX.XX. Описанные в переведенной DillerInc статье методы восстановления импорта лично в моем случае потребовали доработки, т. к. SD использует там усовершенствованные приемы по затруднению восстановления импорта, подробности расскажу, когда закончу их исследование.
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31065&amp;user=2060&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=5" class="addthx" data-post="31065"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 июля 2005 14:01 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#6');return false;">#6</a> </span><div align=left><br>
И еще, насчет антиотладочных приемов, используемых для обнаружения SoftICE. В статье (C) dragon по исследованию eXtreamProtector-a есть ссылка на небольшой архив. В этом архиве лежит утилита R0cmd. Так вот, если перед запуском SoftICE сделать дамп оригинальной IDT, а после запуска SoftICE подменить IDT с помощью той же утилиты на оригинальную, SoftICE обнаружен не будет. Выводы делайте сами. 
<br>
<br>(Кстати прием с подменой IDT полезно использовать, если прийдется несколько раз запускать игрульку защищенную SD, перед запуском игры загружаем оригинальную IDT, после того, как прога зациклиться, можно подгружать IDT, которую заделал SoftICE при своем запуске)
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31068&amp;user=2060&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=6" class="addthx" data-post="31068"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 июля 2005 18:26 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#7');return false;">#7</a> </span><div align=left><br>
<b>Error_Log</b>
<br>Я знаю,этот способ мы назовём:
<br>&quot;Метод <b>Error_Log</b>-<b>DillerInc</b>&#039;а&quot;
<br><img src="img/smilies/s3.gif" alt="">
<br>Просто сейчас я ковыряюсь с другим &quot;проектом&quot;,а там мне довелось применить следующую технику:
<br>1. CreateProcess в режиме SUSPENDED
<br>2. Размещение опкода EB FE по определённому адресу
<br>3. ResumeThread
<br>4. Ну и далее...
<br>Ну,и я решил применить данный приём на своём любимом Call of Duty - сработало.
<br>Без присутствия загруженного отладчика игра благополучно декриптуется и...бес ей в ребро,зацикливается перед прыжком на OEP.
<br>И далее действуем как ты и описал   <img src="img/smilies/s1.gif" alt=""> .
<br>Единственный недостаток - это то,что в случае чего,придётся перезагружать систему,чтобы повторить операцию.
<br>
<br><i>Error_Log пишет:
<br>прием с подменой IDT </i>
<br>...объясни,пожалуйста,что за IDT...
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31092&amp;user=1613&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=7" class="addthx" data-post="31092"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 июля 2005 13:07 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#8');return false;">#8</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>...объясни,пожалуйста,что за IDT... </i>
<br>
<br>IDT (Interrupt Description Table). Каждое прерывание имеет свой вектор (адрес обработчика). Таблица, в которой хранятся эти вектора и есть IDT. Отладчики ring-0 типа SoftICE, TRW подменяют векторы некоторых прерываний и используют эти прерывания для своих нужд. Этим свойством пользуются большинство протекторов для обнаружения отладчика. 
<br>
<br>Утилита R0cmd (спасибо (С)dragon -у) позволяет просматривать и делать дамп этой таблицы, а также загружать сделанный дамп в память (там есть еще куча возможностей).
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=31143&amp;user=2060&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=8" class="addthx" data-post="31143"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 17:36 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#9');return false;">#9</a> </span><div align=left><br>
Салют,господа!
<br>Легендарная Call of Duty, защищённая протектором SafeDisc 3.10.20, наконец-то распакована.
<br>Если говорить вкратце о защите,то могу честно признаться,что та третья версия протектора,применявшаяся в NFSU2, - это просто цветочки по сравнению с этой.
<br>
<br><b>Error_Log</b>
<br>Дружище,как у тебя дела ?
<br>Ты,как я помню,тоже ковырял SD - есть ли результаты ?
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35151&amp;user=1613&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=9" class="addthx" data-post="35151"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 18:12 &middot; Поправил: Error_Log <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#10');return false;">#10</a> </span><div align=left><br>
Я уже давно распаковал версию 2.51 (Serious Sam II). Отличия: присутствует нечто вроде счетчика, и если процедура SD вызывается слишком часто, то сия процедура делает подставу и неправильно восстанавливает импорт. Исправляется это дело дополнительным патчем процедуры SD. Еще одна трудность, которую там встретил - при исследовании в отладчике нужно обязательно удалять бряки, поставленные на Call[ref.] потому, что в процедуре SD есть проверка первых двух байт, а при поставленном бряке вместо FF там будет СС, опять подстава будет, а не импорт, ну и еще одно - после jmp (5 байт) замененных SafeDisk-ом в тех местах, где были Call[Ref] (6 байт) никакого NOP - там мусорный байт, я писал процедуру, которая &quot;тырила&quot; так называемый &quot;третий параметр&quot; и отнимала его от адреса вызова, разность = 5 или 6 в зависимости от того, что там было на самом деле, потом переход на соотв. процедуру восстановления. Все благополучно восстановил и убрал еще одну проверку основанную на GetDriveTypeA =)). Ну а в 3 SD я мельком заглядывал, с импортом вроде попроще, но там юзаются наномиты, времени пока небыло поковырять. Ну а в твоей версии какие особенности?
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35153&amp;user=2060&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=10" class="addthx" data-post="35153"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 18:52 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#11');return false;">#11</a> </span><div align=left><br>
<i>Error_Log пишет:
<br>в тех местах, где были Call[Ref] (6 байт) никакого NOP - там мусорный байт </i>
<br>...по-видимому,этот NOP присутствовал только в Max Payne ну или ещё в каких-то ранних версиях протектора,т.к. и в NFSU2, и Call of Duty этот байт всегда мусорный.
<br>В версии 3.10.20 использовался способ вызова импорта через регистры,о котором упоминалось во мною переведённой статье.
<br>Далее,что оказалось весьма сложным для меня - процедура SD № 2 (я так назвал для удобства).
<br>К примеру,имеется команда call XXXXXXXX, которая ведёт в область протектора и совершаются определённые действия.
<br>Так вот если в NFSU2 этот механизм вызывал импорт и затем сам восстанавливал вышеприведённую команду:
<br>call XXXXXXXX -&gt; call [_CreateToolhelp32Snapshot] ; для примера
<br>...в этой же версии мало того,что этот механизм ничего сам не восстанавливает,так от ещё и не всегда вызывает импорт.Вместо этого он выполняет в теле протектора оригинальные команды,стоявшие когда-то на месте этого вызова и по возвращению из этого вызова просто вписывает нужные значения в нужные регистры.
<br>Ну и конечно наномиты - куда же теперь без них  <img src="img/smilies/s15.gif" alt=""> .
<br>И если в NFSU2 использовались,как я понимаю,классические наномиты - команды INT 3, то здесь можно было наблюдать также команды:
<br>MWAIT
<br>MONITOR
<br>SDGT ESI
<br>UD2
<br>...и тому подобные.
<br>
<br>В общем,такое чувство,что разработчики начитались всяких статей по взлому их протекторов и модифицировали львиную долю своих защитных механизмов <img src="img/smilies/s1.gif" alt=""> .
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35160&amp;user=1613&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=11" class="addthx" data-post="35160"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 19:50 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#12');return false;">#12</a> </span><div align=left><br>
...Вот только понту с этих защитных механизмов - сделать жуткое тормозилово из игрушки, которую все равно от этого SafeDisk-a отломают, получив более оптимизированный код. Куча лишних процедур, на которое тратится драгоценное процессорное время!!! В обшем полная деградация... 
<br>ЗЫ: можем даже FAQ по снятию SafeDisk-a делать <img src="img/smilies/s1.gif" alt="">)))
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35162&amp;user=2060&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=12" class="addthx" data-post="35162"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Grey[/b]','')">Grey</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 389.6 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.93'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=99">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 20:35 <br><script type="text/javascript">QU('Grey','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Grey" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#13');return false;">#13</a> </span><div align=left><br>
<i>Error_Log пишет:
<br>можем даже FAQ по снятию SafeDisk-a делать ))) </i>
<br>Было бы здорово!
<br><br><font size="1"><i>-----<br>TBR</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35168&amp;user=99&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=13" class="addthx" data-post="35168"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 20:40 &middot; Поправил: DillerInc <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#14');return false;">#14</a> </span><div align=left><br>
<b>Error_Log</b>
<br>Вот мысль из книги Дмитрия Склярова:
<br> &quot;Разработчики всячески стремятся хотя бы максимально усложнить процесс восстановления и, самое главное, предотвратить его полную автоматизацию...&quot; .
<br>В принципе с этим они вполне справляются.
<br>
<br><i>Error_Log пишет:
<br>ЗЫ: можем даже FAQ по снятию SafeDisk-a делать </i>
<br>...ну,не знаю...уж лучше пускай народ читает доступные здесь статьи,пробует и если что,тут спрашивает...     
<br> <img src="img/smilies/s1.gif" alt="">
<br>...хотя если народ хочет,то можно подумать...
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35169&amp;user=1613&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=14" class="addthx" data-post="35169"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]crio[/b]','')">crio</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.32'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1462">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 22:24 <br><script type="text/javascript">QU('crio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crio" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#15');return false;">#15</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>...хотя если народ хочет,то можно подумать... </i>
<br>народ очень хочет <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35173&amp;user=1462&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=15" class="addthx" data-post="35173"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 06:13 <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#16');return false;">#16</a> </span><div align=left><br>
<b>DillerInc</b>
<br>Конечно нужно!
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35182&amp;user=29&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=16" class="addthx" data-post="35182"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 10:05 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#17');return false;">#17</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>и, самое главное, предотвратить его полную автоматизацию...</i> 
<br>Ну автоматические распаковщики, ИМХО, вещь бесполезная ввиду постоянного совершенствования защитных механизмов, а вот сделать нечто вроде интерактивного распаковщика, который облегчил бы труд с уже извесными методами было бы неплохо...
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35192&amp;user=2060&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=17" class="addthx" data-post="35192"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]crio[/b]','')">crio</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.32'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1462">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 14:27 <br><script type="text/javascript">QU('crio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crio" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#18');return false;">#18</a> </span><div align=left><br>
<i>DillerInc пишет:
<br> и, самое главное, предотвратить его полную автоматизацию... </i>
<br>А почему бы и нет Ведь пользуються Стрипером
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35219&amp;user=1462&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=18" class="addthx" data-post="35219"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 15:46 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#19');return false;">#19</a> </span><div align=left><br>
<i>crio пишет:
<br>народ очень хочет </i>
<br><i>nice пишет:
<br>Конечно нужно! </i>
<br>...можно конечно,только я немного не представляю,как всё это будет выглядеть.
<br>Предложите,пожалуйста,возможные варианты.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35226&amp;user=1613&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=19" class="addthx" data-post="35226"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]crio[/b]','')">crio</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.32'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1462">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 15:57 <br><script type="text/javascript">QU('crio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crio" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#20');return false;">#20</a> </span><div align=left><br>
можна сначала составить из вопросов с которыми пришлось столкнуться после прочтения статьи
<br>а потом постепенно добавлять вопросы которые будут задавать  на форуме.
<br>и оформить это либо на сайте как статью либо сделать в ворде и закачать куда то
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35227&amp;user=1462&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=20" class="addthx" data-post="35227"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Bit-hack[/b]','')">Bit-hack</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/198.jpg" alt=""><br><span class=txtSm>Ранг: 303.7 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=198">Участник</a><br><font color=blue>tPORt Manager</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2005 19:55 <br><script type="text/javascript">QU('Bit-hack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bit-hack" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#21');return false;">#21</a> </span><div align=left><br>
Кто там интересовался анти-дебагом для сосульки?<img src="img/smilies/s1.gif" alt=""> Вот драйвер от 4 версии, по адресу 0001158D начинается табличка, ОЧЕНЬ интересная табличка, в ней лежат адреса каких-то функций, эту табличку юзает переход по адресу 00011427. Мне почему-то это напомнило вызов анти-дебага, точнее процедур анти-дебага, по таблице, а таблица сделана для облегчения работы разработчиков из макровюжон, т.е. достаточно добавить в таблицу адреса анти-дебажных процедур и всё, больше не надо добовлять 
<br>код для из вызова<img src="img/smilies/s1.gif" alt=""> Всё очень просто, но я не уверен, что это процедуры для отлова дебаггеров, хотя ОЧЕНЬ похоже...<br><br><img src="img/attach.gif" alt=""> <a href="./files/b673_SECDRV.rar">b673_SECDRV.rar</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35521&amp;user=198&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=21" class="addthx" data-post="35521"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2005 20:39 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#22');return false;">#22</a> </span><div align=left><br>
<b>Bit-hack</b>
<br>Спасибо,когда время будет - посмотрю.
<br>Хотя я этот Call of Duty с его мощной антиотладочной защитой распаковывал с помощью своей утилитки,которая запускает игру и тормозит её перед прыжком на OEP,когда отладчик ещё не загружен.
<br>Единственно неудобно каждый раз перезагружать систему перед повторным &quot;погружением во внутренности исследуемого EXE&quot; <img src="img/smilies/s1.gif" alt=""> .
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35527&amp;user=1613&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=22" class="addthx" data-post="35527"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]crio[/b]','')">crio</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 24.6 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.32'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1462">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2005 23:24 <br><script type="text/javascript">QU('crio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crio" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#23');return false;">#23</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>Единственно неудобно каждый раз перезагружать систему перед повторным &quot;погружением во внутренности исследуемого EXE&quot; </i>
<br> 
<br>а почему необходимо перезагружаться после обнаружения отладчика????
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35551&amp;user=1462&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=23" class="addthx" data-post="35551"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2005 23:48 &middot; Поправил: DillerInc <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#24');return false;">#24</a> </span><div align=left><br>
<b>crio</b>
<br>Потому-что защита,определив,что в системе запущен отладчик,просто отказывается декриптовать защищённый исполняемый файл.Иными словами - не удаётся запустить этот файл.
<br>А когда ты перезагружаешься,то отладчик само собой выгружается,тогда защита может спокойно декриптовать защищённое приложение.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35554&amp;user=1613&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=24" class="addthx" data-post="35554"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2005 09:44 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#25');return false;">#25</a> </span><div align=left><br>
<b>DillerInc</b> , <b>Bit-hack</b> 
<br>Кстати эксперементировал с IDT, точнее с ее подменой. Если грузить отладчик, а потом оригинальную IDT, то исполняемый файл первый раз благополучно декриптуется. После того, как прога зациклилась, грузил пропатченную IDT (которую заделывает SoftICE). Если просто трейсить не ставя бряки, то фокус проходит и второй раз, т.е систему можно не перегружать, просто загрузить оригинальную IDT перед запуском игрушки; а вот если ставить бряки, то даже если все потом удалить, то фокус с подменой не канает, и все равно ребутиться надо. Такое чувство, что эта сволочь SD где-то сохраняет инфу, что его отлаживали. Так же у меня не канало BPM _______ X, да и вообще с бряками туговато было, приходилось изощряться, чтоб они срабатывали.
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35568&amp;user=2060&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=25" class="addthx" data-post="35568"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Bit-hack[/b]','')">Bit-hack</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/198.jpg" alt=""><br><span class=txtSm>Ранг: 303.7 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=198">Участник</a><br><font color=blue>tPORt Manager</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2005 21:07 <br><script type="text/javascript">QU('Bit-hack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bit-hack" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#26');return false;">#26</a> </span><div align=left><br>
Народ, дайте кто-нибудь полную цепочку функций для ContinueDebugActiveProcess (или как-то так, юзается для аттача). С виду похукана NoOpenProcess, но я хука не нашёл<img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35641&amp;user=198&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=26" class="addthx" data-post="35641"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2005 23:29 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#27');return false;">#27</a> </span><div align=left><br>
<b>Bit-hack</b>
<br>Ты имеешь в виду это:
<br><pre>
var
 dEvent : _DEBUG_EVENT;
 sInfo : TStartupInfo;
 pInfo : TProcessInformation;
 OpenDlgBox : TOpenFileName;
begin
 CreateProcess(OpenDlgBox.lpstrFile, NIL, NIL, NIL, False,
                  DEBUG_ONLY_THIS_PROCESS, NIL, NIL, sInfo, pInfo);
repeat
 WaitForDebugEvent(dEvent, INFINITE);
// к примеру,если была загружена библиотека
if dEvent.dwDebugEventCode = LOAD_DLL_DEBUG_EVENT then
begin
// что-то делаем и...
Break; // ...выходим из бесконечного цикла
end;
ContinueDebugEvent(dEvent.dwProcessId, dEvent.dwThreadId, DBG_CONTINUE);
until False;
</pre>
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35663&amp;user=1613&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=27" class="addthx" data-post="35663"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Bit-hack[/b]','')">Bit-hack</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/198.jpg" alt=""><br><span class=txtSm>Ранг: 303.7 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.9'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=198">Участник</a><br><font color=blue>tPORt Manager</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2005 22:37 <br><script type="text/javascript">QU('Bit-hack','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bit-hack" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#28');return false;">#28</a> </span><div align=left><br>
Ниа, я ошибся с функцией, мне надо DebugActiveProcess, которая юзается для аттача. Дак вот мне нужна цепочка функций до ядра
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35690&amp;user=198&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=28" class="addthx" data-post="35690"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]DillerInc[/b]','')">DillerInc</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1613.gif" alt=""><br><span class=txtSm>Ранг: 283.6 (наставник), 56thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1613">Участник</a><br><font color=blue>Author of GeTaOEP</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2005 04:33 <br><script type="text/javascript">QU('DillerInc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DillerInc" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#29');return false;">#29</a> </span><div align=left><br>
Вот на днях распаковал ещё одну игру,защищённую SD версии 3.10.20 :
<br> Empires Dawn of the Modern World (стратегия реального времени, русскоязычная версия от 1С) .
<br>Это называется версия на версию не приходится...
<br>Очень многое реализовано совсем не так,как было в Call of Duty,к примеру:
<br> тут выше мы писали о том,что байт после т.н. longjump&#039;а в новых версиях протектора всегда является мусорным.А вот и ничего подобного.В данном случае примерно 2/3 всех longjmp&#039;ов имеют нормальный шестой байт,т.е. являются командами Call смещение_Jmp[ref], и лишь оставшаяся часть содержит мусорный шестой байт.
<br>Среди наномитов встретился следующий прикол от Macrovision:
<br><pre>
CC int 3
CC int 3
59 pop ecx
59 pop ecx </pre>
<br>Команды POP ECX никак не восстанавливаются,а теперь подумайте,что будет,если при восстановлении наномитов (на основе метода из статьи про третий SD) не убрать эти команды POP ECX ...  <img src="img/smilies/s2.gif" alt="">
<br>Вот чего я не могу понять,должны ли эти команды вообще присутствовать в исполняемом коде?Расположены они как правило следующим образом
<br><pre>
call [ref]
test eax, eax
pop ecx
pop ecx
jz XXXXXXXX </pre>
<br>...что выглядит довольно нелепо <img src="img/smilies/s11.gif" alt=""> .
<br>Пробовал распаковать,заNOPив эти команды и в другом случае сохранив эти команды, - в обоих случаях файл получается рабочий,если не считать одного глюка:
<br> не работает перемещение по карте путём щелчка на мини-карте <img src="img/smilies/s4.gif" alt=""> .
<br>Хотя причины этого глюка могут скрываться и в чём-то другом.
<br><br><font size="1"><i>-----<br>the Power of Reversing team</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=36561&amp;user=1613&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=29" class="addthx" data-post="36561"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2005 04:45 &middot; Поправил: Error_Log <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#30');return false;">#30</a> </span><div align=left><br>
<i>DillerInc пишет:
<br>встретился следующий прикол от Macrovision:  </i>
<br>Это похоже на команду коррекции стека. (add esp, 8) Посмотри в запротекченной проге как меняется указатель стека (esp) в этом месте.
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=36562&amp;user=2060&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=30" class="addthx" data-post="36562"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]Error_Log[/b]','')">Error_Log</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 228.7 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.05'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2060">Участник</a><br><font color=blue>malware research</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2005 05:09 <br><script type="text/javascript">QU('Error_Log','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error_Log" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=2087&amp;page=3#31');return false;">#31</a> </span><div align=left><br>
Вчера решил немного поизучать работу отладчика SafeDisk-a. В общем SafeDisc 3.20.022 восстанавливает только те участки кода, которые многократно вызываются. Самое интересное происходит в ДЛЛ отладчика, я брякнулся на GetThreadContext (ставил бряк ближе к концу АПИ). Немного потрейсив попал сюда:
<br>.txt5:6678FEC1 loc_6678FEC1:                           ; CODE XREF: sub_6678FE04+73j
<br>.txt5:6678FEC1                 mov     eax, [ebp+var_50]
<br>.txt5:6678FEC4                 cmp     eax, 80000003h  ; STATUS_BREAKPOINT
<br>.txt5:6678FEC9                 jz      short EXCEPTION_PROCESS
<br>.txt5:6678FECB                 cmp     eax, 80000004h  ; STATUS SINGLE STEP
<br>.txt5:6678FED0                 jz      short loc_6678FEB4
<br>.txt5:6678FED2                 cmp     eax, 0C0000005h ; STATUS_ACCESS_VIOLATION
<br>.txt5:6678FED7                 jz      short EXCEPTION_PROCESS
<br>.txt5:6678FED9                 cmp     eax, 0C000001Dh ; STATUS_ILLEGAL_INSTRUCTION
<br>.txt5:6678FEDE                 jz      short EXCEPTION_PROCESS
<br>.txt5:6678FEE0                 cmp     eax, 0C000001Eh ; STATUS_INVALID_LOCK_PREFIX
<br>.txt5:6678FEE5                 jz      short EXCEPTION_PROCESS
<br>.txt5:6678FEE7                 cmp     eax, 0C0000096h ; STATUS_PRIVILEGED_INSTRUCTION
<br>.txt5:6678FEEC                 jnz     short loc_6678FF12
<br>.txt5:6678FEEE
<br>.txt5:6678FEEE EXCEPTION_PROCESS:                      ; CODE XREF: sub_6678FE04+C5j
<br>.txt5:6678FEEE                                         ; sub_6678FE04+D3j ...
<br>.txt5:6678FEEE                 mov     ecx, [ebx+8]
<br>.txt5:6678FEF1                 call    sub_6678E5E4
<br>.txt5:6678FEF6                 mov     ecx, [ebp+var_44]
<br>.txt5:6678FEF9                 sub     ecx, eax
<br>.txt5:6678FEFB                 mov     eax, [ebp+arg_0]
<br>.txt5:6678FEFE                 shl     ecx, 8
<br>.txt5:6678FF01                 imul    ecx, [eax]
<br>.txt5:6678FF04                 mov     [eax], ecx
<br>.txt5:6678FF06                 push    eax
<br>.txt5:6678FF07                 lea     eax, [ebp+var_50]
<br>.txt5:6678FF0A                 mov     ecx, ebx
<br>.txt5:6678FF0C                 push    eax
<br>.txt5:6678FF0D                 call    sub_6678FF4F    ; СЮДА ЗАХОДИМ
<br>Далее следует куча Call-ов и jmp-ов, которые не очень интересны, но есть среди них цепочка вложенных вызовов (около 8), которая ведет к WriteProcessMemory. Там используются вызовы типа Call [eax+8], 
<br>Call [eax]. Перед самой процедурой, в которой есть WriteProcessMemory есть о-о-о-очень интересная процедура:
<br>.txt5:6678F553 loc_6678F553:                           ; CODE XREF: sub_6678E6D5+E79j
<br>.txt5:6678F553                 lea     ecx, [ebp-10Ch]
<br>.txt5:6678F559                 call    sub_6672DBE9    ; ОПРЕДЕЛЯЕТСЯ, НУЖНО ЛИ ВПИСЫВАТЬ ОПКОД В СЕКЦИЮ
<br>.txt5:6678F55E                 cmp     ax, 1           ; ИСПРАВЛЯЕМ НА MOV AX, 0001
<br>.txt5:6678F562                 jnz     loc_6678F6C6    ; ВПИСЫВАЕМ MOV EAX,EAX ТРИ РАЗА
<br>После такого патча все наномиты восстанавливаются сразу после первого их выполнения. Саму цепочку Call-ов ведущих к WriteProcessMemory проследить несложно, достаточно брякнуться на WriteProcessMemory (опять-же бряк лучше ставить не на начало или конец, а недалеко от конца АПИ). Далее потрейсить до ret до тех пор пока не выйдем к тому участку, где сравнивается EXCEPTION_CODE. Простым запуском игрушки вписалось 98 байт с пропатченной процедурой, по сравнению с непропатченной<br><br><img src="img/attach.gif" alt=""> <a href="./files/eea8_report_restore_text.txt">eea8_report_restore_text.txt</a>
<br><br><font size="1"><i>-----<br>Research is my purpose</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=36565&amp;user=2060&amp;forum_n=2&amp;topic=2087&amp;page=3&amp;anchor=31" class="addthx" data-post="36565"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=2.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=2.html">3</a> . <b>4</b> . <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=2&amp;topic=2087&amp;page=4.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Кто знает немецкий язык. (или тутор по снятию SafeDisc 3.xx)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="2087">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=2087" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
