<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите восстановить код - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго времени суток. Значит такая ситуация: я распаковал длл, вытянул из нее нужную мне функцию, частично восстановил ее с помощью HEX-Rays. Но проблема в том, что я дальше не могу разобраться как эта функция работает (((">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите восстановить код</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]van_gog[/b]','')">van_gog</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.81'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=13281">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 апреля 2009 01:19 <br><script type="text/javascript">QU('van_gog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=van_gog" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14187.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго времени суток.<br>Значит такая ситуация: я распаковал длл, вытянул из нее нужную мне функцию, частично восстановил ее с помощью HEX-Rays.<br>Но проблема в том, что я дальше не могу разобраться как эта функция работает (((<br>Предыдущую версию этой длл я нормально распаковал и восстановил, а эту не олучается ((<br>Помогите пожалуйста.<br><br>Вот код функции, который выдал HEX-Rays:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"></li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;__stdcall&nbsp;sub_69841240<span class="hl_char">(</span>SOCKET&nbsp;a1<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;a2<span class="hl_char">,</span>&nbsp;signed&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;a3<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;a4<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v4<span class="hl_comment">; // ecx@1</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v5<span class="hl_comment">; // ebx@1</span></li><li class="hl_l1">&nbsp;&nbsp;signed&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v7<span class="hl_comment">; // edx@9</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v8<span class="hl_comment">; // ebx@12</span></li><li class="hl_l1">&nbsp;&nbsp;signed&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v9<span class="hl_comment">; // eax@16</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">*</span>v10<span class="hl_char">)</span><span class="hl_char">[</span><span class="hl_number">13</span><span class="hl_char">]</span><span class="hl_comment">; // ebx@16</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v11<span class="hl_comment">; // al@17</span></li><li class="hl_l0">&nbsp;&nbsp;signed&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v12<span class="hl_comment">; // esi@17</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v13<span class="hl_comment">; // zf@18</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v14<span class="hl_comment">; // sf@18</span></li><li class="hl_l1">&nbsp;&nbsp;unsigned&nbsp;__int8&nbsp;v15<span class="hl_comment">; // of@18</span></li><li class="hl_l0">&nbsp;&nbsp;signed&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v16<span class="hl_comment">; // edx@18</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v17<span class="hl_comment">; // ecx@18</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v18<span class="hl_comment">; // zf@21</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v19<span class="hl_comment">; // sf@21</span></li><li class="hl_l0">&nbsp;&nbsp;unsigned&nbsp;__int8&nbsp;v20<span class="hl_comment">; // of@21</span></li><li class="hl_l1">&nbsp;&nbsp;signed&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v21<span class="hl_comment">; // eax@21</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v22<span class="hl_comment">; // ebx@21</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v23<span class="hl_comment">; // zf@24</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v24<span class="hl_comment">; // sf@24</span></li><li class="hl_l1">&nbsp;&nbsp;unsigned&nbsp;__int8&nbsp;v25<span class="hl_comment">; // of@24</span></li><li class="hl_l0">&nbsp;&nbsp;signed&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v26<span class="hl_comment">; // ecx@24</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v27<span class="hl_comment">; // eax@12</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v28<span class="hl_comment">; // ebx@17</span></li><li class="hl_l1">&nbsp;&nbsp;unsigned&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v29<span class="hl_comment">; // eax@31</span></li><li class="hl_l0">&nbsp;&nbsp;signed&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v30<span class="hl_comment">; // [sp+2Ch] [bp-1002Ch]@1</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v31<span class="hl_comment">; // [sp+30h] [bp-10028h]@1</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v32<span class="hl_comment">; // [sp+34h] [bp-10024h]@2</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v33<span class="hl_comment">; // [sp+35h] [bp-10023h]@4</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v34<span class="hl_comment">; // [sp+36h] [bp-10022h]@5</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v35<span class="hl_comment">; // [sp+37h] [bp-10021h]@6</span></li><li class="hl_l0">&nbsp;&nbsp;signed&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v36<span class="hl_char">[</span><span class="hl_number">16390</span><span class="hl_char">]</span><span class="hl_comment">; // [sp+40h] [bp-10018h]@9</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v37<span class="hl_comment">; // [sp+45h] [bp-10013h]@9</span></li><li class="hl_l0">&nbsp;&nbsp;signed&nbsp;__int64&nbsp;v38<span class="hl_comment">; // [sp+18h] [bp-10040h]@12</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v39<span class="hl_comment">; // [sp+20h] [bp-10038h]@12</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">*</span>v40<span class="hl_char">)</span><span class="hl_char">[</span><span class="hl_number">13</span><span class="hl_char">]</span><span class="hl_comment">; // [sp+28h] [bp-10030h]@17</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;v41<span class="hl_comment">; // [sp+24h] [bp-10034h]@17</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;v42<span class="hl_comment">; // [sp+44h] [bp-10014h]@18</span></li><li class="hl_l1"></li><li class="hl_l0">&nbsp;&nbsp;v5&nbsp;<span class="hl_char">=</span>&nbsp;a2<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v30&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">16</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span>getpeername<span class="hl_char">(</span>a1<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span>struct&nbsp;sockaddr&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>v31<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>v30<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;<span class="hl_char">(</span>v32&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">39</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;v33&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">20</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;v34&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">81</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;v35&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">11</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;off_6984301C<span class="hl_char">(</span>v4<span class="hl_char">,</span>&nbsp;a4<span class="hl_char">,</span>&nbsp;a1<span class="hl_char">,</span>&nbsp;v5<span class="hl_char">,</span>&nbsp;a3<span class="hl_char">,</span>&nbsp;a4<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;dword_69843014&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span>&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">200</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;dword_69843014&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;else</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span>dword_69843014<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v7&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v36<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;a3<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v37&nbsp;<span class="hl_char">=</span>&nbsp;dword_69843014<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;v7&nbsp;<span class="hl_char">&lt;</span>&nbsp;a3&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_char">(</span>_BYTE&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>v36<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">+</span>&nbsp;v7&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_BYTE&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>v7&nbsp;<span class="hl_char">+</span>&nbsp;v5<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span>v7<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;v27&nbsp;<span class="hl_char">=</span>&nbsp;rand<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v38&nbsp;<span class="hl_char">=</span>&nbsp;1717986919i64&nbsp;<span class="hl_char">*</span>&nbsp;v27<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v8&nbsp;<span class="hl_char">=</span>&nbsp;v27&nbsp;<span class="hl_char">%</span>&nbsp;<span class="hl_number">5</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v39&nbsp;<span class="hl_char">=</span>&nbsp;v27&nbsp;<span class="hl_char">%</span>&nbsp;<span class="hl_number">5</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;v27&nbsp;<span class="hl_char">%</span>&nbsp;<span class="hl_number">5</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">2</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;v10&nbsp;<span class="hl_char">=</span>&nbsp;off_69843008<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;v9&nbsp;<span class="hl_char">=</span>&nbsp;strlen<span class="hl_char">(</span>off_69843008<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;LABEL_17<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;v8&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">2</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;v8&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v10&nbsp;<span class="hl_char">=</span>&nbsp;off_6984300C<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v9&nbsp;<span class="hl_char">=</span>&nbsp;strlen<span class="hl_char">(</span>off_6984300C<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;LABEL_17<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;else</li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;v39&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">3</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v10&nbsp;<span class="hl_char">=</span>&nbsp;off_69843004<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v9&nbsp;<span class="hl_char">=</span>&nbsp;strlen<span class="hl_char">(</span>off_69843004<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;LABEL_17<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;v39&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">4</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v10&nbsp;<span class="hl_char">=</span>&nbsp;off_69843000<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v9&nbsp;<span class="hl_char">=</span>&nbsp;strlen<span class="hl_char">(</span>off_69843000<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;LABEL_17<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;v10&nbsp;<span class="hl_char">=</span>&nbsp;off_69843010<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v9&nbsp;<span class="hl_char">=</span>&nbsp;strlen<span class="hl_char">(</span>off_69843010<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">LABEL_17<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;&nbsp;v40&nbsp;<span class="hl_char">=</span>&nbsp;v10<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v12&nbsp;<span class="hl_char">=</span>&nbsp;v9<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v28&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">*</span>v40<span class="hl_char">)</span><span class="hl_char">[</span>rand<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">%</span>&nbsp;v9<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v11&nbsp;<span class="hl_char">=</span>&nbsp;byte_69845020<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v41&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>v28&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">)</span>&nbsp;^&nbsp;0x34<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span>byte_69845020&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;v29&nbsp;<span class="hl_char">=</span>&nbsp;time<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;srand<span class="hl_char">(</span>v29<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;v11&nbsp;<span class="hl_char">=</span>&nbsp;rand<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;byte_69845020&nbsp;<span class="hl_char">=</span>&nbsp;v11<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;v42&nbsp;<span class="hl_char">=</span>&nbsp;v11<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v16&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">5</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v17&nbsp;<span class="hl_char">=</span>&nbsp;a3&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">5</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v15&nbsp;<span class="hl_char">=</span>&nbsp;__SETO__<span class="hl_char">(</span>a3&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">5</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v13&nbsp;<span class="hl_char">=</span>&nbsp;a3&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v14&nbsp;<span class="hl_char">=</span>&nbsp;a3&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">(</span><span class="hl_char">(</span>unsigned&nbsp;__int8<span class="hl_char">)</span><span class="hl_char">(</span>v14&nbsp;^&nbsp;v15<span class="hl_char">)</span>&nbsp;<span class="hl_char">|</span>&nbsp;v13<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_char">(</span>_BYTE&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>v36<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">+</span>&nbsp;v16&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;^<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_char">(</span>_BYTE&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>v36<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">+</span>&nbsp;v16<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span>v16<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;v15&nbsp;<span class="hl_char">=</span>&nbsp;__SETO__<span class="hl_char">(</span>v17<span class="hl_char">,</span>&nbsp;v16<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;v13&nbsp;<span class="hl_char">=</span>&nbsp;v17&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;v16<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;v14&nbsp;<span class="hl_char">=</span>&nbsp;v17&nbsp;<span class="hl_char">&lt;</span>&nbsp;v16<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;v21&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">5</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;LOBYTE<span class="hl_char">(</span>v36<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>_BYTE<span class="hl_char">)</span>v41&nbsp;^&nbsp;<span class="hl_char">(</span>_BYTE<span class="hl_char">)</span>v36<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v22&nbsp;<span class="hl_char">=</span>&nbsp;a3&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">6</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v20&nbsp;<span class="hl_char">=</span>&nbsp;__SETO__<span class="hl_char">(</span>a3&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">6</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v18&nbsp;<span class="hl_char">=</span>&nbsp;a3&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v19&nbsp;<span class="hl_char">=</span>&nbsp;a3&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span>&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">(</span><span class="hl_char">(</span>unsigned&nbsp;__int8<span class="hl_char">)</span><span class="hl_char">(</span>v19&nbsp;^&nbsp;v20<span class="hl_char">)</span>&nbsp;<span class="hl_char">|</span>&nbsp;v18<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_char">(</span>_BYTE&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>v36<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">+</span>&nbsp;v21<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_char">)</span>&nbsp;^<span class="hl_char">=</span>&nbsp;v41<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;v20&nbsp;<span class="hl_char">=</span>&nbsp;__SETO__<span class="hl_char">(</span>v22<span class="hl_char">,</span>&nbsp;v21<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;v18&nbsp;<span class="hl_char">=</span>&nbsp;v22&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;v21<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;v19&nbsp;<span class="hl_char">=</span>&nbsp;v22&nbsp;<span class="hl_char">&lt;</span>&nbsp;v21<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;v26&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;BYTE2<span class="hl_char">(</span>v36<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>_BYTE<span class="hl_char">)</span>v41&nbsp;^&nbsp;0x65<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v25&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;v23&nbsp;<span class="hl_char">=</span>&nbsp;v22&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;v24&nbsp;<span class="hl_char">=</span>&nbsp;v22&nbsp;<span class="hl_char">&lt;</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">(</span><span class="hl_char">(</span>unsigned&nbsp;__int8<span class="hl_char">)</span><span class="hl_char">(</span>v24&nbsp;^&nbsp;v25<span class="hl_char">)</span>&nbsp;<span class="hl_char">|</span>&nbsp;v23<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_char">(</span>_BYTE&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>v36<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">+</span>&nbsp;v26<span class="hl_char">)</span>&nbsp;^<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">*</span>v40<span class="hl_char">)</span><span class="hl_char">[</span>v26&nbsp;<span class="hl_char">%</span>&nbsp;v12&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span>v26<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;v25&nbsp;<span class="hl_char">=</span>&nbsp;__SETO__<span class="hl_char">(</span>v22<span class="hl_char">,</span>&nbsp;v26<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;v23&nbsp;<span class="hl_char">=</span>&nbsp;v22&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;v26<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;v24&nbsp;<span class="hl_char">=</span>&nbsp;v22&nbsp;<span class="hl_char">&lt;</span>&nbsp;v26<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;BYTE3<span class="hl_char">(</span>v36<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>_BYTE<span class="hl_char">)</span>v39&nbsp;^&nbsp;<span class="hl_char">(</span>unsigned&nbsp;__int8<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span>unsigned&nbsp;__int8<span class="hl_char">)</span><span class="hl_char">(</span><span class="hl_char">(</span>_BYTE<span class="hl_char">)</span>v36&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;^&nbsp;<span class="hl_char">(</span>unsigned&nbsp;__int8<span class="hl_char">)</span><span class="hl_char">(</span>v37&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">52</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=228436&amp;user=13281&amp;forum_n=5&amp;topic=14187.html&amp;page=0&amp;anchor=1" class="addthx" data-post="228436"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 апреля 2009 13:29 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14187.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Хм, думаю, сюда и библиотеку следует приаттачить. А так какой толк постить код HEX-Rays, если он - заведомо неверен (восстановлен только частично) ?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=228445&amp;user=6336&amp;forum_n=5&amp;topic=14187.html&amp;page=0&amp;anchor=2" class="addthx" data-post="228445"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]HiEndsoft[/b]','')">HiEndsoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 237.0 (наставник), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.74'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13651">Участник</a><br><font color=blue>sysenter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 апреля 2009 14:01 &middot; Поправил: HiEndsoft <br><script type="text/javascript">QU('HiEndsoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HiEndsoft" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14187.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
HEX-Rays - листинг + асм. листинг нужен, потому что доверия HEX-Rays пока нет.<br>А так код функции похож на recv или send из ws2_32. С заполнением буфера ответом:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;v7&nbsp;<span class="hl_char">&lt;</span>&nbsp;a3&nbsp;<span class="hl_char">)</span>&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;{&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_char">(</span>_BYTE&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>v36<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">+</span>&nbsp;v7&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>_BYTE&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>v7&nbsp;<span class="hl_char">+</span>&nbsp;v5<span class="hl_char">)</span><span class="hl_comment">; </span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span>v7<span class="hl_comment">; </span></li><li class="hl_l0">&nbsp;&nbsp;}</li><li class="hl_l1">где&nbsp;v7&nbsp;<span class="hl_char">-</span>счетчик</li><li class="hl_l0">v5<span class="hl_char">=</span>a2&nbsp;<span class="hl_char">(</span>указатель&nbsp;на&nbsp;буфер&nbsp;с&nbsp;ответом&nbsp;recv<span class="hl_char">)</span></li><li class="hl_l1">v36&nbsp;<span class="hl_char">-</span>внутренний&nbsp;свой&nbsp;буфер<span class="hl_char">,</span>&nbsp;над&nbsp;которым&nbsp;производится&nbsp;потом&nbsp;арифметика</li><li class="hl_l0">a3&nbsp;<span class="hl_char">-</span>&nbsp;длина&nbsp;пакета&nbsp;recv</li>        </ol>
    </div>
</div></div>
<br>Возможно твоя dll сплайсит send и/или recv для какой-то шифровки трафика при связи с определенной машиной в сети, а это обработчик. На это указывает код, где &quot;видно&quot; IP:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"></li><li class="hl_l1"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span>getpeername<span class="hl_char">(</span>a1<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span>struct&nbsp;sockaddr&nbsp;<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">&amp;</span>v31<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>v30<span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;<span class="hl_char">(</span>v32&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">39</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;v33&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">20</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;v34&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">81</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span>&nbsp;v35&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">11</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span>&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;off_6984301C<span class="hl_char">(</span>v4<span class="hl_char">,</span>&nbsp;a4<span class="hl_char">,</span>&nbsp;a1<span class="hl_char">,</span>&nbsp;v5<span class="hl_char">,</span>&nbsp;a3<span class="hl_char">,</span>&nbsp;a4<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>(на recv или send указывает флаг a4, который нигде в этом коде не используется, а только куда-то возвращается).<br>Вообще в таких ситуациях нужно хорошо знать мат.часть и делать выводы на основе предположений и опыта.
<br><br><font size="1"><i>-----<br>продавец резиновых утёнков</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=228447&amp;user=13651&amp;forum_n=5&amp;topic=14187.html&amp;page=0&amp;anchor=3" class="addthx" data-post="228447"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]van_gog[/b]','')">van_gog</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.81'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=13281">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2009 20:27 <br><script type="text/javascript">QU('van_gog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=van_gog" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14187.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Длл здесь: rapidshare.com/files/220510844/rcp.dll.html<br><br>Эта длл инжектит себя в процесс и перехватывает все сообщения, которые посылаются в send.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=228495&amp;user=13281&amp;forum_n=5&amp;topic=14187.html&amp;page=0&amp;anchor=4" class="addthx" data-post="228495"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]HiEndsoft[/b]','')">HiEndsoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 237.0 (наставник), 20thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.74'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13651">Участник</a><br><font color=blue>sysenter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2009 20:35 <br><script type="text/javascript">QU('HiEndsoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HiEndsoft" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14187.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
значит я &quot;угадал&quot;. а что самому дальше лень? это наверно в запросы на взлом.
<br><br><font size="1"><i>-----<br>продавец резиновых утёнков</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=228497&amp;user=13651&amp;forum_n=5&amp;topic=14187.html&amp;page=0&amp;anchor=5" class="addthx" data-post="228497"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]van_gog[/b]','')">van_gog</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.81'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=13281">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2009 21:19 <br><script type="text/javascript">QU('van_gog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=van_gog" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14187.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Ладно, забейте.<br>Я так понял тут никто не хочет помогать начинающим...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=228499&amp;user=13281&amp;forum_n=5&amp;topic=14187.html&amp;page=0&amp;anchor=6" class="addthx" data-post="228499"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2009 21:34 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14187.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Спасение утопающих-дело рук самих утопающих, не вижу тут ничего сложного и какой-то проблемы глобальной. Учебник по асму в зубы да сиди ковыряй, с чего ты взял, что твою работу за тебя должны делать другие.<br>Как скажешь, забито.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=228501&amp;user=1556&amp;forum_n=5&amp;topic=14187.html&amp;page=0&amp;anchor=7" class="addthx" data-post="228501"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите восстановить код</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=14187" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
