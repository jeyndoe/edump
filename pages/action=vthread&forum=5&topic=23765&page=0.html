<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помощь с pin tools - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Написал минимальный трейсер с pin tools. Логика такова: ожидает загрузки нужной длл, после того как начнет исполняется нужная мне функций - проверяю имя файла которое она получила, если подошло - начинаю записывать все исполненые">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=242'>Alf</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помощь с pin tools</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]rev4you[/b]','')">rev4you</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.84'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=39601">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 сентября 2015 23:59 &middot; Поправил: rev4you <br><script type="text/javascript">QU('rev4you','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rev4you" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Написал минимальный трейсер с pin tools.<br>Логика такова: ожидает загрузки нужной длл, после того как начнет исполняется нужная мне функций - проверяю имя файла которое она получила, если подошло - начинаю записывать все исполненые инструкции в этом модуле..<br><br>Все вроде как просто, но лог какой то странный..<br><br>Вот пример выдачи<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">0x70224bde&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;0x70804294</li><li class="hl_l1">0x70224be3&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">0x70224be4&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;0x707c9b50&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">0x7072f80c&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>0x189c<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>edi</b></span>&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;вот&nbsp;тут&nbsp;странный&nbsp;прыжок<span class="hl_char">,</span>&nbsp;пропущены&nbsp;инструкции<span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">0x7072f812&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;0x7072f820</li><li class="hl_l1">0x7072f814&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>0x2410<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">0x7072f81a&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;0x7072fbd8</li>        </ol>
    </div>
</div></div>
<br><br>В дизасме код после вызова такой<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">6FB54BE3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">6FB54BE4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;sub_700F9B50</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">6FB54BE9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">14h</span>&nbsp;<span class="hl_char">-</span>&nbsp;эти&nbsp;инструкции&nbsp;почему&nbsp;то&nbsp;опущены&nbsp;<span class="hl_char">(</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">6FB54BEC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div>
<br><br><br>Трейсер<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#include&nbsp;<span class="hl_char">&lt;</span>iostream<span class="hl_char">&gt;</span></li><li class="hl_l1">#include&nbsp;<span class="hl_char">&lt;</span>fstream<span class="hl_char">&gt;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">#include&nbsp;<span class="hl_quote">&quot;pin.H&quot;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function">std</span><span class="hl_char">:</span><span class="hl_char">:</span>ofstream&nbsp;TraceFile<span class="hl_comment">;</span></li><li class="hl_l0">KNOB<span class="hl_char">&lt;</span>string<span class="hl_char">&gt;</span>&nbsp;KnobOutputFile<span class="hl_char">(</span>KNOB_MODE_WRITEONCE<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;pintool&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;o&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;calltrace.out&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;specify trace file name&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">KNOB<span class="hl_char">&lt;</span>BOOL<span class="hl_char">&gt;</span>&nbsp;&nbsp;&nbsp;KnobPrintArgs<span class="hl_char">(</span>KNOB_MODE_WRITEONCE<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;pintool&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;a&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;1&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;print call arguments &quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">BOOL&nbsp;is_intresting_file&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>FALSE</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">ADDRINT&nbsp;offset0&nbsp;<span class="hl_char">=</span>&nbsp;0x136920&nbsp;<span class="hl_char">+</span>&nbsp;0x23<span class="hl_comment">;</span></li><li class="hl_l0">ADDRINT&nbsp;ptr_v34&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">ADDRINT&nbsp;aeheurBase&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">ADDRINT&nbsp;aeheurSizeOf&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">ADDRINT&nbsp;aeheurEnd&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">ADDRINT&nbsp;calle_ret&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>VOID</b></span>&nbsp;getFirstPTR<span class="hl_char">(</span>ADDRINT&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;ADDRINT&nbsp;<span class="hl_registr">esp</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>struct_v34_from_scan_api&nbsp;<span class="hl_char">*</span><span class="hl_function"><b>ptr</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ptr_v34&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_registr"><b>edi</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calle_ret&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>ADDRINT<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_registr"><b>esp</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDRINT&nbsp;new_ptr&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span>ADDRINT<span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>ptr_v34&nbsp;<span class="hl_char">+</span>&nbsp;0x158<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wchar_t<span class="hl_char">*</span>&nbsp;file_name_ptr&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">(</span>wchar_t<span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">)</span><span class="hl_char">(</span>ptr_v34&nbsp;<span class="hl_char">+</span>&nbsp;0x38<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;buff<span class="hl_char">[</span><span class="hl_number">512</span><span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; file_name_ptr[i]; ++i )</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buff<span class="hl_char">[</span>i<span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;file_name_ptr<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buff<span class="hl_char">[</span>i<span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; </span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_intresting_file&nbsp;<span class="hl_char">=</span>&nbsp;strstr<span class="hl_char">(</span>buff<span class="hl_char">,</span><span class="hl_quote">&quot;C:\123&quot;</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;is_intresting_file&nbsp;<span class="hl_char">)</span>{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TraceFile&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;calle_ret &quot;</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;calle_ret<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TraceFile&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot; ptr &quot;</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;ptr_v34<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TraceFile&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span><span class="hl_quote">&quot;( &quot;</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;buff&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;) &quot;</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;new_ptr&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;endl<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">}<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>VOID</b></span>&nbsp;Trace<span class="hl_char">(</span>INS&nbsp;trace<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>VOID</b></span>&nbsp;<span class="hl_char">*</span>v<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;aeheurBase&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INS&nbsp;tail&nbsp;<span class="hl_char">=</span>&nbsp;trace<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADDRINT&nbsp;instAddr&nbsp;<span class="hl_char">=</span>&nbsp;&nbsp;INS_Address<span class="hl_char">(</span>tail<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">(</span>instAddr&nbsp;<span class="hl_char">&gt;</span><span class="hl_char">=</span>&nbsp;aeheurBase&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;instAddr&nbsp;<span class="hl_char">&lt;</span>&nbsp;aeheurEnd<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;instAddr&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>aeheurBase&nbsp;<span class="hl_char">+</span>&nbsp;offset0<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;calle_ret&nbsp;</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INS_InsertPredicatedCall</span><span class="hl_char">(</span>tail<span class="hl_char">,</span>&nbsp;IPOINT_BEFORE<span class="hl_char">,</span>&nbsp;AFUNPTR<span class="hl_char">(</span>getFirstPTR<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;IARG_REG_VALUE<span class="hl_char">,</span>&nbsp;REG_EDI<span class="hl_char">,</span>&nbsp;&nbsp;IARG_REG_VALUE<span class="hl_char">,</span>&nbsp;REG_ESP<span class="hl_char">,</span>&nbsp;IARG_END<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span>is_intresting_file&nbsp;<span class="hl_char">)</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TraceFile&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>instAddr&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;  &quot;</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;INS_Disassemble<span class="hl_char">(</span>tail<span class="hl_char">)</span><span class="hl_char">.</span>c_str<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;endl<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}while<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>VOID</b></span>&nbsp;Fini<span class="hl_char">(</span>INT32&nbsp;<span class="hl_function">code</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>VOID</b></span>&nbsp;<span class="hl_char">*</span>v<span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;TraceFile&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;# eof&quot;</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;endl<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;TraceFile<span class="hl_char">.</span>close<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>VOID</b></span>&nbsp;ImgLoadNotifyier<span class="hl_char">(</span>IMG&nbsp;&nbsp;img<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>VOID</b></span>&nbsp;<span class="hl_char">*</span>&nbsp;vi<span class="hl_char">)</span>&nbsp;</li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>const</b></span>&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>p&nbsp;<span class="hl_char">=</span>&nbsp;IMG_Name<span class="hl_char">(</span>img<span class="hl_char">)</span><span class="hl_char">.</span>c_str<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">*</span>p&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">+</span><span class="hl_char">+</span>p<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">*</span>p&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_quote">''</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span>p<span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;_stricmp<span class="hl_char">(</span><span class="hl_quote">&quot;\aeheur.dll&quot;</span><span class="hl_char">,</span>&nbsp;p<span class="hl_char">)</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TraceFile&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;FOUND\n&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aeheurBase&nbsp;<span class="hl_char">=</span>&nbsp;IMG_StartAddress<span class="hl_char">(</span>img<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aeheurEnd&nbsp;<span class="hl_char">=</span>&nbsp;IMG_HighAddress<span class="hl_char">(</span>img<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aeheurSizeOf&nbsp;<span class="hl_char">=</span>&nbsp;aeheurEnd&nbsp;<span class="hl_char">-</span>&nbsp;IMG_LowAddress<span class="hl_char">(</span>img<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;Loading %s\n&quot;</span><span class="hl_char">,</span>&nbsp;p&nbsp;<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TraceFile&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;p&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot; at &quot;</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;aeheurBase&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot; SizeOfImage &quot;</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;&nbsp;aeheurSizeOf&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;endl<span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;&nbsp;main<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;argc<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>argv<span class="hl_char">[</span><span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;PIN_InitSymbols<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>&nbsp;PIN_Init<span class="hl_char">(</span>argc<span class="hl_char">,</span>argv<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;TraceFile<span class="hl_char">.</span>open<span class="hl_char">(</span>KnobOutputFile<span class="hl_char">.</span>Value<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">.</span>c_str<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;TraceFile&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;hex<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;TraceFile<span class="hl_char">.</span>setf<span class="hl_char">(</span>ios<span class="hl_char">:</span><span class="hl_char">:</span>showbase<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;IMG_AddInstrumentFunction<span class="hl_char">(</span>ImgLoadNotifyier<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INS_AddInstrumentFunction<span class="hl_char">(</span>Trace<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;PIN_AddFiniFunction<span class="hl_char">(</span>Fini<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;PIN_StartProgram<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>Вопрос - Как собственно pin tools планирует свои call back ?  на каждую инструкцию ? Возникает ощущение что он как то пропускает их..<br><br>Еще пример, а также приложил весь лог.<br>При этом программа не генерирует в этих местах exceptions, и исполняется &quot;линейно&quot; .<br>  <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">0x70667e43&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;0x7057ce00&nbsp;<span class="hl_char">-</span>&nbsp;тут&nbsp;все&nbsp;правильно&nbsp;<span class="hl_char">,</span>&nbsp;возврат&nbsp;<span class="hl_char">+</span><span class="hl_number">5</span>&nbsp;байт</li><li class="hl_l1">0x70667e48&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">0x70667e4a&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;0x70667fef</li><li class="hl_l1">0x70667e50&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">0x70667e51&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;0x70808eec</li><li class="hl_l1">0x70667e56&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0x70804380</li><li class="hl_l0">0x70667e5b&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;0x7057ce00&nbsp;<span class="hl_char">-</span>&nbsp;опять&nbsp;хрень<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;</li><li class="hl_l1">0x706686cb&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span>0x740<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0">0x706686d1&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;0x706686df</li><li class="hl_l1">0x706686d3&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span>0x2674<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0">0x706686d9&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;0x70668882</li><li class="hl_l1">0x706686df&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">0x706686e0&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;0x70808ed8</li><li class="hl_l1">0x706686e5&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0x70804a8c</li><li class="hl_l0">0x706686ea&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;0x7057ce00&nbsp;<span class="hl_char">-</span>&nbsp;опять&nbsp;хрень<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;</li><li class="hl_l1">0x706686df&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">0x706686e0&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;0x70808ed8</li><li class="hl_l1">0x706686e5&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0x70804a8c</li><li class="hl_l0">0x706686ea&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;0x7057ce00&nbsp;<span class="hl_char">-</span>&nbsp;а&nbsp;тут&nbsp;все&nbsp;ок<span class="hl_char">,</span>&nbsp;функция&nbsp;таже<span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">0x706686ef&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">0x706686f1&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;0x70668882</li><li class="hl_l1">0x706686f7&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">0x706686f8&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;0x70804bf0</li><li class="hl_l1">0x706686fd&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0x70804380</li><li class="hl_l0">0x70668702&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;0x7057ce00&nbsp;<span class="hl_char">-</span>&nbsp;опять&nbsp;хрень<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;</li><li class="hl_l1">0x704fa3ec&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span>0x2b7c<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;0x0</li><li class="hl_l0">0x704fa3f4&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;0x704facdf</li><li class="hl_l1">0x704fa3fa&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span>0x790<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;0x1e</li>        </ol>
    </div>
</div></div>
<br><br><img src="img/attach.gif" alt=""> <a href="./files/a390_18.09.2015_EXELAB.rU.tgz">a390_18.09.2015_EXELAB.rU.tgz</a> - calltrace.out
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=358813&amp;user=39601&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=1" class="addthx" data-post="358813"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]hash87szf[/b]','')">hash87szf</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.9 (постоянный), 47thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.33'>Активность: 0.12<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=34301">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2015 09:58 <br><script type="text/javascript">QU('hash87szf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hash87szf" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
мож INS_InsertPredicatedCall замениь на InsertCall ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=358817&amp;user=34301&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=2" class="addthx" data-post="358817"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]rev4you[/b]','')">rev4you</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.84'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=39601">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2015 13:44 &middot; Поправил: rev4you <br><script type="text/javascript">QU('rev4you','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rev4you" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>hash87szf пишет:<br> мож INS_InsertPredicatedCall замениь на InsertCall ?  </I><br>В данном случае она используется только один раз, для определения имени файла.<br>Так что это не влияет на результат, трассы..<br><br>П.С также сменил ее ради интереса на InsertCall ничего не изменилось, если бы изменилось это было бы странно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=358822&amp;user=39601&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=3" class="addthx" data-post="358822"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2015 14:04 &middot; Поправил: ClockMan <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>rev4you</b><br>может почитать мануалы на сайте<noindex><a href="https://software.intel.com/sites/landingpage/pintool/docs/71313/Pin/html/" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=358823&amp;user=17432&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=4" class="addthx" data-post="358823"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]rev4you[/b]','')">rev4you</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.84'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=39601">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2015 14:08 <br><script type="text/javascript">QU('rev4you','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rev4you" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Это было сделано первым делом.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=358825&amp;user=39601&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=5" class="addthx" data-post="358825"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]hash87szf[/b]','')">hash87szf</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.9 (постоянный), 47thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.33'>Активность: 0.12<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=34301">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2015 14:43 &middot; Поправил: hash87szf <br><script type="text/javascript">QU('hash87szf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hash87szf" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<strike>&gt;&gt; данном случае она используется только один раз, для определения имени файла.<br>INS_AddInstrumentFunction(Trace, 0); --&gt; Трэйс() на каждой инстракшн вызывается, a ImgLoadNotifyier на каждой дллки.</strike><br>Я в код не вникал...<br>Как вариан мож с адресами/чеками что-то не в ряд?<br><br>Попробуйте не фильтровать а сделать тупой трэйс.<br>Это канешн будет длиться... и весить...<br><br>А не проше ли руками под антивирь подпиливать?? Или какая другая цель приследуется?<br><br>&gt;&gt;<br>0x70667e5b  call 0x7057ce00 - опять хрень... <br>0x706686cb  cmp dword ptr [esi+0x740], ebp<br><br>Почему хрень? Может Колл не возвращяется через Рет. Попробуйте ловить все Брэнч после Коллов.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=358827&amp;user=34301&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=6" class="addthx" data-post="358827"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]rev4you[/b]','')">rev4you</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.84'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=39601">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 сентября 2015 15:05 &middot; Поправил: rev4you <br><script type="text/javascript">QU('rev4you','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rev4you" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
он возвращается через рет, в отладчике именно так. и антиотладки у него нету.<br><br><b>Добавлено спустя 8 часов 6 минут</b><br><strike>хм тесты на cmd.exe показывают что все впорядке.<br>Значит проблема на моей строне..</strike>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=358828&amp;user=39601&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=7" class="addthx" data-post="358828"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]rev4you[/b]','')">rev4you</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.84'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=39601">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 сентября 2015 02:51 &middot; Поправил: rev4you <br><script type="text/javascript">QU('rev4you','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rev4you" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Странное поведение InsertCall<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>VOID</b></span>&nbsp;Trace<span class="hl_char">(</span>INS&nbsp;trace<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>VOID</b></span>&nbsp;<span class="hl_char">*</span>v<span class="hl_char">)</span>{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;aeheurBase&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;INS&nbsp;tail&nbsp;<span class="hl_char">=</span>&nbsp;trace<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;ADDRINT&nbsp;instAddr&nbsp;<span class="hl_char">=</span>&nbsp;&nbsp;INS_Address<span class="hl_char">(</span>tail<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span><span class="hl_char">(</span>instAddr&nbsp;<span class="hl_char">&gt;</span><span class="hl_char">=</span>&nbsp;aeheurBase&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;instAddr&nbsp;<span class="hl_char">&lt;</span>&nbsp;aeheurEnd<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INS_InsertCall<span class="hl_char">(</span>tail<span class="hl_char">,</span>&nbsp;IPOINT_BEFORE<span class="hl_char">,</span>&nbsp;AFUNPTR<span class="hl_char">(</span><span class="hl_function">TEST</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;IARG_REG_VALUE<span class="hl_char">,</span>&nbsp;REG_EBP<span class="hl_char">,</span>&nbsp;&nbsp;IARG_REG_VALUE<span class="hl_char">,</span>&nbsp;REG_EIP<span class="hl_char">,</span>&nbsp;IARG_END<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TraceFile&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;thread id: &quot;</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;PIN_ThreadId<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">&lt;</span><span class="hl_char">&lt;</span><span class="hl_quote">&quot;  &quot;</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;&nbsp;instAddr&nbsp;&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;  &quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TraceFile<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;INS_Disassemble<span class="hl_char">(</span>tail<span class="hl_char">)</span><span class="hl_char">.</span>c_str<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;endl<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">}</li><li class="hl_l0"><span class="hl_function"><b>VOID</b></span>&nbsp;<span class="hl_function">TEST</span><span class="hl_char">(</span>ADDRINT&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;ADDRINT&nbsp;eip<span class="hl_char">)</span>{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TraceFile&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;<span class="hl_quote">&quot;Test trace \n&quot;</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_comment">;</span></li><li class="hl_l1">}<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Вывод:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5b439&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span>0x8<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;0x1</li><li class="hl_l1">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5b43e&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;0x70c5b445</li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5b440&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;0x70c5e602</li><li class="hl_l1"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e602&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e603&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e605&nbsp;&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;<span class="hl_registr">esp</span><span class="hl_char">,</span>&nbsp;0x10</li><li class="hl_l1">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e608&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span>0x70cc12bc<span class="hl_char">]</span></li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e60d&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">-</span>0x8<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;0x0</li><li class="hl_l1">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e611&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">-</span>0x4<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;0x0</li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e615&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e616&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e617&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;0xbb40e64e</li><li class="hl_l1">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e61c&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e61e&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;0xffff0000</li><li class="hl_l1">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e623&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;0x70c5e632</li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e625&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e627&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;0x70c5e632</li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e629&nbsp;&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e62b&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span>0x70cc12c0<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e630&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;0x70c5e692</li><li class="hl_l1"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>Test</b></span>&nbsp;trace&nbsp;</li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e692&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e693&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e694&nbsp;&nbsp;<span class="hl_function"><b>leave</b></span>&nbsp;</li><li class="hl_l1">thread&nbsp;id<span class="hl_char">:</span>&nbsp;0x1&nbsp;&nbsp;0x70c5e695&nbsp;&nbsp;<span class="hl_function"><b>ret</b></span>&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>Это конечно не то что ожидалось, оказывается все добавленные обработчики срабатывают после jmp\call\ret ..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=358847&amp;user=39601&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=8" class="addthx" data-post="358847"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]hash87szf[/b]','')">hash87szf</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.9 (постоянный), 47thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.33'>Активность: 0.12<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=34301">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 сентября 2015 16:53 <br><script type="text/javascript">QU('hash87szf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hash87szf" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
AFUNPTR(TEST)?<br>В примерах (AFUNPTR)docount. (AFUNPTR)TEST?<br><br>&gt;&gt; оказывается все добавленные обработчики срабатывают после jmp\call\ret .. <br>Я думаю это из за Basic Block &quot;формата&quot;.<br>Если вставить <br>TraceFile&lt;&lt; INS_Disassemble(tail).c_str() &lt;&lt; endl;<br>в TEST() то он будет правильно делать.<br>Пин инлайнит ТЕСТ() перед каждой инстракшн, а шо он делает с Trace(), хз.<br><br>Also, В манах есть Order of Instrumentation.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=358857&amp;user=34301&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=9" class="addthx" data-post="358857"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]rev4you[/b]','')">rev4you</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.84'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=39601">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2015 01:43 &middot; Поправил: rev4you <br><script type="text/javascript">QU('rev4you','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rev4you" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<i class=x>Пин инлайнит ТЕСТ() перед каждой инстракшн, а шо он делает с Trace(), хз.</i><br>Я  TRACE_ из пин не используют, просто имя функции такое. там INS_AddInstrumentFunction(Trace, 0);
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=358859&amp;user=39601&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=10" class="addthx" data-post="358859"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]hash87szf[/b]','')">hash87szf</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.9 (постоянный), 47thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.33'>Активность: 0.12<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=34301">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 сентября 2015 12:27 <br><script type="text/javascript">QU('hash87szf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hash87szf" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
// Pin calls this function every time a new instruction is encountered<br>VOID Instruction(INS ins, VOID *v)<br><br>// This function is called before every instruction is executed<br>VOID docount() { icount++; }<br><br>Как я понимаю docount инлайнится, а Instruction() хз<br>У вас ТЕСТ инлайн, а Trace хз
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=358873&amp;user=34301&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=11" class="addthx" data-post="358873"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]hash87szf[/b]','')">hash87szf</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.9 (постоянный), 47thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.33'>Активность: 0.12<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=34301">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 октября 2015 21:39 <br><script type="text/javascript">QU('hash87szf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hash87szf" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23765.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Подниму тред.<br>Так оно и естъ имхо изза бэйзик блоков.<br>http://deroko.phearless.org/rce.html<br>pinlog.zip<br><br>Чел парзит как и в Пин примерах все инстракшн одного BBL.<br><br>Чел с shell-stom на гитхабе сорцы его пинтулз, делает похожеe. Но он нигде весь трэйс не записывает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=359312&amp;user=34301&amp;forum_n=5&amp;topic=23765.html&amp;page=0&amp;anchor=12" class="addthx" data-post="359312"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помощь с pin tools</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#13" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="23765">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23765" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
