<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Взлом защиты основаной на создании нового процесса - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Кто нить может поделится знаниями по этому поводу? Т.е. есть прога , естественно защищенная все вроде бы хорошо, да вот незадача прога создает новый процесс и ему передает управление, как отловить это место? т.е. передачу">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41556'>subword</a>, <a target='_blank' href='?action=userinfo&amp;user=55853'>rtsgreg1989</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Взлом защиты основаной на создании нового процесса</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Tupis[/b]','')">Tupis</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.15'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 14:19 <br><script type="text/javascript">QU('Tupis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tupis" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Кто нить может поделится знаниями по этому поводу? Т.е. есть прога , естественно защищенная все вроде бы хорошо, да вот незадача прога создает новый процесс и ему передает управление, как отловить это место? т.е. передачу управления новому процессу и собственно как его тогда трейсить?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164262&amp;user=1828&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=1" class="addthx" data-post="164262"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]DMD[/b]','')">DMD</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 15:28 <br><script type="text/javascript">QU('DMD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DMD" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>Tupis пишет:<br>как отловить это место? т.е. передачу управления новому процессу и собственно как его тогда трейсить? </I><br><br>все описано в самом вопросе: ловить CreateProcess. как трейсить - зависит от сообразительности.<br>даже флаги создания процесса не важны <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164274&amp;user=892&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=2" class="addthx" data-post="164274"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]RSI[/b]','')">RSI</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 284.8 (наставник), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 15:58 <br><script type="text/javascript">QU('RSI','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=RSI" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Tupis</b><br>мож ты имеешь ввиду какую-нить прогу установки ( на основе installshield ) тогда как тебе сказали лови CreateProcessA и затем запускай сам с такими параметрами процесс. Илю  юзай windbg он вроде позволяет отлаживать создаваемые процессы тоже.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164279&amp;user=6361&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=3" class="addthx" data-post="164279"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Tupis[/b]','')">Tupis</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.15'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 16:19 <br><script type="text/javascript">QU('Tupis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tupis" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>RSI</b><br>Нет это не инсталятор...<br>ПРога называется Leko в ранних версиях не было создания второго процесса и лечилось впринципе легко. Теперь же имя даже ключ (Guardant) который прога почему то не хочет принимать все затруднилось.<br>На проге висит конверт он снимается тулзовиной Инферно без вопросов. Поверху еще прога запакована UPX так вот после распаковки упх уже второй процесс не создается и естесно не передается управление, прога выходит по экситпроцесс. Если же в отладчике доходить до ОЕР то прога таки создает второй процесс и как то передает ему управление после чего естесно она говорит что проблемы при работе с ключем вот такая вот беда. Куда копать пока не понимаю. Кроме того еще в проге есть замеры вермени между отдельными блоками опятьже ка ких обходить плагин фантом  для оли вроде не работает тут.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164280&amp;user=1828&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=4" class="addthx" data-post="164280"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]DMD[/b]','')">DMD</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 16:49 &middot; Поправил: DMD <br><script type="text/javascript">QU('DMD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DMD" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>Tupis пишет:<br>Если же в отладчике доходить до ОЕР то прога таки создает второй процесс и как то передает ему управление после чего естесно она говорит что проблемы при работе с ключем вот такая вот беда.  </I><br><br>если ловить CreateProcess, то и доходить до OEP (ввиду, похоже, имеется окончание распаковки UPX) нет небходимости - все равно не &quot;проскочишь&quot;.<br>трейс дочернего процесса будет зависить от того, что, собственно, запускается. те. заведомо известный exe или что-то предварительно собранное. но в любом случае никто не мешает поставить защелку (0хEBFE) на OEP дочернего процесса и снять ее после аттача к нему<br>и если повезло и дочерний процесс запускается неупакованным - можно получить все что нужно для дизассемблирования. ну или тут уж варианты....<br>Все подсказки, похоже, сделаны <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164287&amp;user=892&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=5" class="addthx" data-post="164287"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Tupis[/b]','')">Tupis</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.15'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 октября 2007 17:05 <br><script type="text/javascript">QU('Tupis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tupis" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>DMD</b><br>Спасибо за подсказки буду пробовать. <br>Да походу как создается дочерний процесс: прога мапится в памяти тот же самй экзешник только неупакованый и ему передается управление ну во всяком случае я именно так понял пока разбирался со всем этим.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164295&amp;user=1828&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=6" class="addthx" data-post="164295"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]DMD[/b]','')">DMD</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 10:16 <br><script type="text/javascript">QU('DMD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DMD" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Успехов тебе, конечно.<br>мне только не понятен вот этот момент:<br><br><I>Tupis пишет:<br>Поверху еще прога запакована UPX  </I><br><br><I>Tupis пишет:<br>прога мапится в памяти тот же самй экзешник только неупакованый и ему передается управление </I><br><br>в любом случае, если дочерний процесс стартует неупакованным (по описанию можно понять, что так и происходит), то не получить new.exe для дальнейших исследование почти грешно.  а если new.exe еще будет успешно запускаться как самостоятельный *.exe, то сложность первоначальной задачи резко понижается.<img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164400&amp;user=892&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=7" class="addthx" data-post="164400"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Tupis[/b]','')">Tupis</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.15'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 12:58 <br><script type="text/javascript">QU('Tupis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tupis" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>DMD</b><br>Беда в том что мапится то он в памяти, а не на диске. У меня навыков такого ковыряния очень мало т.е. как его из памяти дампануть на диск я ХЗ. Теретически понимаю что нужно найти EP у зампленного экзешника и потом его с этого места задампить, но как??
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164421&amp;user=1828&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=8" class="addthx" data-post="164421"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 15:09 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Tupis пишет:<br> Поверху еще прога запакована UPX так вот после распаковки упх уже второй процесс не создается и естесно не передается управление, прога выходит по экситпроцесс. </I><br>Или это не UPX или ты что то путаеш..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164452&amp;user=293&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=9" class="addthx" data-post="164452"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]DMD[/b]','')">DMD</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 85.5 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.59'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=892">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 15:52 &middot; Поправил: DMD <br><script type="text/javascript">QU('DMD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DMD" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Tupis пишет:<br>Беда в том что мапится то он в памяти, а не на диске </I><br><br>а это тут причем?!<br><br>BOOL WINAPI CreateProcess(<br>  __in          LPCTSTR lpApplicationName,<br>  __in_out      LPTSTR lpCommandLine,<br>  __in          LPSECURITY_ATTRIBUTES lpProcessAttributes,<br>  __in          LPSECURITY_ATTRIBUTES lpThreadAttributes,<br>  __in          BOOL bInheritHandles,<br>  __in          DWORD dwCreationFlags,<br>  __in          LPVOID lpEnvironment,<br>  __in          LPCTSTR lpCurrentDirectory,<br>  __in          LPSTARTUPINFO lpStartupInfo,<br>  __out         LPPROCESS_INFORMATION lpProcessInformation<br>);<br><br>Parameters<br>lpApplicationName <br>The name of the module to be executed. This module can be a Windows-based application. It can be some other type of module (for example, MS-DOS or OS/2) if the appropriate subsystem is available on the local computer. <br><br>The string can specify the full path and file name of the module to execute or it can specify a partial name. In the case of a partial name, the function uses the current drive and current directory to complete the specification. The function will not use the search path. If the file name does not contain an extension, .exe is assumed. Therefore, if the file name extension is .com, this parameter must include the .com extension.<br><br>The lpApplicationName parameter can be NULL. In that case, the module name must be the first white space-delimited token in the lpCommandLine string. If you are using a long file name that contains a space, use quoted strings to indicate where the file name ends and the arguments begin; otherwise, the file name is ambiguous. For example, consider the string &quot;c:\program files\sub dir\program name&quot;. This string can be interpreted in a number of ways. The system tries to interpret the possibilities in the following order:<br><br><br>c:\program.exe files\sub dir\program name <br>c:\program files\sub.exe dir\program name <br>c:\program files\sub dir\program.exe name <br>c:\program files\sub dir\program name.exe <br>If the executable module is a 16-bit application, lpApplicationName should be NULL, and the string pointed to by lpCommandLine should specify the executable module as well as its arguments.<br><br>To run a batch file, you must start the command interpreter; set lpApplicationName to cmd.exe and set lpCommandLine to the name of the batch file.<br><br> * * *<br><br>те. если ты тормознулся на CreateProcess, то в параметрах будет lpApplicationName. те. нужный тебе <b>готовый</b> exe. да и параметры lpCommandLine как на ладони (если они есть, конечно). <br><br>Если CreateProcess может что-то стартануть из памяти directly - пусть старшие товарищи меня поправят! <img src="img/smilies/s2.gif" alt=""> <br><br><I>pavka пишет:<br>ты что то путаеш<b>Ь</b></I><br>возможно и не путает.<br>у меня однажды был случай: после распаковки собственно код работал корректно, а вот dll, которую программа создавала из внутренного pseudo-образа с минимальной обработкой, после распаковки получалась не dll, а не_пойми_что. так что вполне возможно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164469&amp;user=892&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=10" class="addthx" data-post="164469"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 16:32 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Tupis пишет:<br>На проге висит конверт он снимается тулзовиной Инферно без вопросов. Поверху еще прога запакована UPX так вот после распаковки упх уже второй процесс не создается  </I><br>Если я правильно понял, <b>сперва</b> файл упакован упх, а <b>сверху</b> еще висит конверт? И после снятия конверта прога еще ведет себя нормально, а затем ты снимаешь упх, и поведение проги меняется. Если все именно так (и ты уверен, что это именно упх), то 95%, что прога проверяет размер файла.<br><br>PS<br>Выложи прогу чтоль.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164482&amp;user=3910&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=11" class="addthx" data-post="164482"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 17:30 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>DMD пишет:<br>у меня однажды был случай: после распаковки собственно код работал корректно, а вот dll, которую программа создавала из внутренного pseudo-образа с минимальной обработкой, после распаковки получалась не dll, а не_пойми_что. так что вполне возможно. </I><br>Так упх причем ?он ни биндер а простой упаковщик ..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164501&amp;user=293&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=12" class="addthx" data-post="164501"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Tupis[/b]','')">Tupis</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.15'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 17:46 <br><script type="text/javascript">QU('Tupis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tupis" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Вообщем дела такие: <br>после снятия конверта прога еще живет а вот после сняти упх она выходит по экситпроцесс причем происходит все тоже самое т.е. мапится файл но почему то управдение ему не передается. да еще там стоят временные замеры фантомплагин не спасает даже с драйвером. ( <br>прогу прогу залил на рапиду 1,3 метра где то.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164506&amp;user=1828&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=13" class="addthx" data-post="164506"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Tupis[/b]','')">Tupis</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.15'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 17:54 <br><script type="text/javascript">QU('Tupis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tupis" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Сори забыл ссылку дать (((<br>rapidshare.com/files/64615447/leko.rar.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164508&amp;user=1828&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=14" class="addthx" data-post="164508"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 октября 2007 23:14 &middot; Поправил: [HEX] <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Tupis</b><br>Малец глянул и вижу что к упакованой проге приклеены в конце еще 400 байт хрени которые после снятия UPX естественно уползают ХЗ куда от чего прога точно не запуститься, так как читает она эти 400h байт именно с конца.<br><br>Ну и создаются два процесса с параметрами k 32 и l 38, а основной выходит по Exit. За что именно отвечают параметры пока еще не разбирался.<br><br>И явная проверка на распакованость. Тупой проверкой по размеру. Если больше 1500000 байт, то идут все на йух.<br><br>Так что вернуть работоспособность файлу можно упаковав файл и приклеив к нему в конец 400h байт хрени из оригинального файла. Или же найти место проверки размера файла и нагнуть ;)<br><br>Пофиксил распакованый файл заменой условных прыжков везде где было сравнивнение с числом 1500000 + приклеил к распакованому файлу 400h хрени и вроде стало запускаться. Вот результат http://hexcsl.com/upload/stats/339 http://hexcsl.com/upload/stats/339  За полную работоспособность не отвечаю, так что теория изложена, а дальше сами.<br><br>Правда у меня всеже чувство что это самопальная защита ресурсов, так как ресурсы в основном не видны даже после снятия UPX, либо это вшитая в ПО защта Guardian (ниразу не ковырял посему и незнаю как выглядит).
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=164582&amp;user=2365&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=15" class="addthx" data-post="164582"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Tupis[/b]','')">Tupis</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.15'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 октября 2007 11:31 <br><script type="text/javascript">QU('Tupis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tupis" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>[HEX]</b><br>Спасибо за проделаную работу.<br>То что запускается два процесса увидел и сам, но каким образом им передается управление?<br>КРоме того в проге действительно есть апи гвадранта.<br>И еще вопрос как боротся с защитой по времени выполнения? я немогу отлаживать прогу так как она очень быстро вываливается из-за этого.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164650&amp;user=1828&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=16" class="addthx" data-post="164650"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]0xy[/b]','')">0xy</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 218.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.37'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3910">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 октября 2007 20:49 <br><script type="text/javascript">QU('0xy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0xy" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Tupis пишет:<br>как боротся с защитой по времени выполнения?  </I><br>Если юзаются GetSystemTime/GetLocalTime, GetTickCount -- пропатч их.<br><br><I>Tupis пишет:<br>в проге действительно есть апи гвадранта.  </I><br>А КАКИЕ апи заюзаны? Если есть Transform, то, ИХМО, лучше забей на эту прогу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164911&amp;user=3910&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=17" class="addthx" data-post="164911"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]-= XjekaCR =-[/b]','')">-= XjekaCR =-</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 13.9 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.72'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=13772">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 октября 2007 21:24 <br><script type="text/javascript">QU('-= XjekaCR =-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-= XjekaCR =-" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Tupis пишет: <br>Если юзаются GetSystemTime/GetLocalTime, GetTickCount -- пропатч их. <br><br>ещё может быть GetFileTime и GetFileAtributes - всё что помню
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164914&amp;user=13772&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=18" class="addthx" data-post="164914"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Tupis[/b]','')">Tupis</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.15'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 октября 2007 09:06 <br><script type="text/javascript">QU('Tupis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tupis" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>0xy</b><br>Какие сказать тяжело так как используется АПИ 5.01 нету логгера под это чудо, но говорю же у меня есть ключ но он не хочет работать после того как в нем поменяли содержимое ячейки nProg даже после того как ее первоначальное содержание  вернул назад прога все равно пишет ошибка при работе с ключем. <br>Интересует естесно почему такая лажа... ПРога точно юзает и RDTSC и GetTicCount что еще она юзает ХЗ
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=164979&amp;user=1828&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=19" class="addthx" data-post="164979"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b][HEX][/b]','')">[HEX]</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2365.gif" alt=""><br><span class=txtSm>Ранг: 467.7 (мудрец), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.92'>Активность: 0.27<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2365">Участник</a><br><font color=blue>Иной :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 октября 2007 11:44 &middot; Поправил: [HEX] <br><script type="text/javascript">QU('[HEX]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[HEX]" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=10227.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>Tupis</b><br>Распаковку сделал, а дальше уж ты сам ковыряй. Управление передается путем тупого создания процесса (бряк на CreateProcessA) с параметрами для запуска <b>k 32</b> - 1й процесс и <b>l 38</b> - 2й процесс. Основной процесс ничем не занимется кроме как проверка на распакованость, проверка через длл (лейка32.dll) не запущено ли дважды и создание двух процессов. Выполнив эти действия родительский процесс завершается нормально. Прога напичкана таймерами, но пофиксить их можно ручками. Так что отладчик в руки и вперед.
<br><br><font size="1"><i>-----<br>Computer Security Laboratory</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=165005&amp;user=2365&amp;forum_n=1&amp;topic=10227.html&amp;page=0&amp;anchor=20" class="addthx" data-post="165005"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Взлом защиты основаной на создании нового процесса</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#21" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="10227">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=10227" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
