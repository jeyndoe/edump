<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Декомпилятор ВМ - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Вашему вниманию предлагаются наработки по декомпиляции ВМ. Проект на сегодняшний день для меня завершен, но жаль если результат &quot;ляжет на полку&quot;, может кому-нибудь и пригодится. Предлагаю сначала ознакомиться с обзором,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+8 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Декомпилятор ВМ</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=7.html">8</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=22.html">23</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=23.html">24</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 12:33 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Вашему вниманию предлагаются наработки по декомпиляции ВМ.<br>Проект на сегодняшний день для меня завершен, но жаль если результат &quot;ляжет на полку&quot;, может кому-нибудь и пригодится. Предлагаю сначала ознакомиться с обзором, и если будет интерес то могу выложить и сам плагин, или здесь или в личку заинтересованным лицам, каким образом, пока ещё не решил...<br>Но если кто-либо ожидает увидеть &quot;автоматическое чудо&quot;, то сразу скажу - его нет. Для того чтобы получить результат нужна ручная предварительная работа:<br>- с исследуемой программы должна быть снята упаковка<br>- точки входа в ВМ находятся вручную<br>- возможно неоднократное &quot;жамкание&quot; клавиш в OllyDbg, а возможно и модификация кода, чтобы попасть в нужное место, в зависимости от защищенной функции<br>- необходимо вручную прицепить к программе требуемый секцию<br>- запись результатов в файл это тоже ручная работа, но уже более приятная<br><br>Не всё гладко обстоит с определением реализаций ВМ, на сегодняшний день примерно каждая третья реализация автоматом не определяется, приходится под неё модернизировать плагин, т.к. не могу сразу предусмотреть все случаи &quot;издевательств&quot; ВМ с кодом примитивов. Лучше дела с восстановлением &quot;исходного&quot; кода защищенных функций - 70% нормально восстанавливается, хотя во многом это зависит от самой структуры функции. Таким образом, если будет заинтересованность и помощь в нахождении подобных ситуаций, то проект может быть доведен до релизной стадии.<br><br>ЗЫ: Речь идет об <i class=x>Ореановских</i> машинах. Нигде специально не упоминал.<br><br><img src="img/attach.gif" alt=""> <a href="./files/9c41_03.03.2010_CRACKLAB.rU.tgz">9c41_03.03.2010_CRACKLAB.rU.tgz</a> - VMSweeperLst.rar
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253056&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=1" class="addthx" data-post="253056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 12:50 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
выкладывай плуг обзор смотреть не интересно
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=253057&amp;user=293&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=2" class="addthx" data-post="253057"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 13:24 <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Vamit пишет:<br>Речь идет об Ореановских машинах. </I><br><br>Из приведенного обзора (описания пикода в частности) видно что речь идет не обо всех Ореановских а только CISC, ну может CISC-2.
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253059&amp;user=6801&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=3" class="addthx" data-post="253059"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 14:34 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>OKOB пишет:<br>не обо всех Ореановских </I><br>Я и не говорил, что обо всех, реализовал те, которые попались - два типа, а возможно и две разновидности одного типа (различия в кол-ве регистров и опкодов), как нызываются - просто не знаю, вполне возможно и CISC.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253062&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=4" class="addthx" data-post="253062"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 14:39 &middot; Поправил: BoRoV <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
ну ты будешь вылаживать плуг или как?<br><br><br>ок, тогда ждем <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253063&amp;user=15500&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=5" class="addthx" data-post="253063"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 14:51 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>BoRoV пишет:<br>ну ты будешь вылаживать плуг или как? </I><br>Буду, дайте только Help дописать, а то не разберетесь... <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253064&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=6" class="addthx" data-post="253064"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 15:07 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Выкладывай будем тестить <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253065&amp;user=17432&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=7" class="addthx" data-post="253065"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 16:48 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Вот оно... <img src="img/smilies/s1.gif" alt=""><br><br><img src="img/attach.gif" alt=""> <a href="./files/3919_03.03.2010_CRACKLAB.rU.tgz">3919_03.03.2010_CRACKLAB.rU.tgz</a> - VMSweeper.rar
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253070&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=8" class="addthx" data-post="253070"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 18:01 <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Цитата из хелпа: <br>&quot;2. Стартуем OllyDbg, загружаем программу, находим точку входа в ВМ в восстанавливаемой функции (это jmp на секцию с телом ВМ), ставим на него Breakpoint (F2). &quot;<br><br>Пример полностью подпадающий под вышеприведенный обзор и данный пункт хэлпа. (Themida 2.1.1.0)<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFA6C</span>&nbsp;sub_5EFA6C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function">near</span></li><li class="hl_l1"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFA6C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFA6D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l1"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFA6F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFA70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFA72</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFA73</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>offset</b></span>&nbsp;loc_5EFAB8</li><li class="hl_l1"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFA78</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFA7B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">fs</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l1"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFA7E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VM_callstub_01_j00</li><li class="hl_l0"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFA7E</span>&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;МУСОР</span></li><li class="hl_l0"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFAB7</span>&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l1"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFAB7</span></li><li class="hl_l0"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFAB7</span>&nbsp;locret_5EFAB7<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFAB7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">retn</span></li><li class="hl_l0"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">005EFAB7</span>&nbsp;sub_5EFA6C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">endp</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">00CA121E</span>&nbsp;VM_callstub_01_j00<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">00CA121E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">60EDB533h</span></li><li class="hl_l0"><span class="hl_number">0000</span><span class="hl_char">:</span><span class="hl_number">00CA1223</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_C9E456</li>        </ol>
    </div>
</div></div>
<br><br>однако машина RISC VM и ничего не взлетит, поэтому хорошо бы привести пример жертвы на которой можно опробывать с адресами входа в ВМ или описать как определить именно этот тип ВМ под который заточен плаг.
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253085&amp;user=6801&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=9" class="addthx" data-post="253085"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 18:04 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Интересно, по стилю изложения, по меткам в листингах , похож на автора декомпиляции вм орианс , выложенной в теме на васме Ктонибудь ковырял ВМпротект, это продолжение той работы? Исходники ожидаются? <br><br>Деобфускация и трассировка флагов процессора , очень интересная тема, очень много новых решений в защите программ... без эмуля не обойтись, хотя он примитивный всеравно будет как в деморфе аспровых команд.<br><br>Есть план расширить инф. в статью с более детальными коментариями - мыслями , кусками исходного кода , вариантами дальнейшего развития?!
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253087&amp;user=3520&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=10" class="addthx" data-post="253087"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 18:08 &middot; Поправил: OKOB <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>mak пишет:<br>похож на автора декомпиляции вм орианс , выложенной в теме на васме Ктонибудь ковырял ВМпротект </I><br><br>да это один к одному тот материал (hxxp://www.wasm.ru/forum/viewtopic.php?pid=335280) Ник - VAM, просто ВАСМ пал и все тут проклевываются (в Дневниках и Блогах еще один завсегдатай ВАСМ с My Dos Explorer).
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253088&amp;user=6801&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=11" class="addthx" data-post="253088"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Sunzer[/b]','')">Sunzer</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12088.gif" alt=""><br><span class=txtSm>Ранг: 67.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.06'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 18:44 <br><script type="text/javascript">QU('Sunzer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sunzer" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>OKOB пишет:<br>просто ВАСМ пал </I><br><br>В последнее время уже нормально работает
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=253090&amp;user=12088&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=12" class="addthx" data-post="253090"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 19:14 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>OKOB пишет:<br>однако машина RISC VM и ничего не взлетит </I><br>Не понял высказывание, да, код похож, а что говорит плагин? Тип ВМ он определит сам, если не способен обработать то сообщит. За свою прогу можете не волноваться ни один байт в файле без вашего участия изменен не будет.<br><I>mak пишет:<br>это продолжение той работы? </I><br>Да это таже работа и автор тот же <img src="img/smilies/s1.gif" alt=""><br><I>Исходники ожидаются? </I><br>Нет, используемые алгоритмы задействованы не только здесь, но ещё и в коммерческих проектах.<br><I>Есть план расширить инф. в статью с более детальными коментариями - мыслями , кусками исходного кода , вариантами дальнейшего развития?! </I><br>Пока нет, всё зависит от интереса к проекту, если будет дальнейшее развитие проги, то почему бы и не поделиться информацией...<br><I>OKOB пишет:<br>просто ВАСМ пал и все тут проклевываются </I><br>ВАСМ не пал, просто активность там низкая и специфика здесь ближе к практике...
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253098&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=13" class="addthx" data-post="253098"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 19:28 &middot; Поправил: OKOB <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>Vamit пишет:<br>Тип ВМ он определит сам </I><br><br>Да далее нет ожидаемого плагином цикла выбора опкодов, а ... (в продолжение кода приведенного выше)<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00C9E456</span>&nbsp;sub_C9E456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function">near</span></li><li class="hl_l1"><span class="hl_number">00C9E456</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_number">00C9E458</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pushf</span></li><li class="hl_l1"><span class="hl_number">00C9E459</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pusha</span></li><li class="hl_l0"><span class="hl_number">00C9E45A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">nop</span></li><li class="hl_l1"><span class="hl_number">00C9E45B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">nop</span></li><li class="hl_l0"><span class="hl_number">00C9E45C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">$</span><span class="hl_char">+</span><span class="hl_number">5</span></li><li class="hl_l1"><span class="hl_number">00C9E461</span>&nbsp;loc_C9E461<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">00C9E461</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_number">00C9E462</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>offset</b></span>&nbsp;loc_C9E461<span class="hl_char">+</span><span class="hl_number">8094FECh</span><span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_number">00C9E468</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">nop</span></li><li class="hl_l1"><span class="hl_number">00C9E469</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">nop</span></li><li class="hl_l0"><span class="hl_number">00C9E46A</span>&nbsp;loc_C9E46A<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">00C9E46A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>offset</b></span>&nbsp;VM_callstub_info01<span class="hl_char">+</span><span class="hl_number">8094FECh</span><span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_number">00C9E46F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_number">00C9E471</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">00C9E472</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span>VM_Context<span class="hl_char">+</span><span class="hl_number">8094FECh</span><span class="hl_char">+</span><span class="hl_registr">ebp</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00C9E478</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">00C9E47D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_number">598h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00C9E483</span>&nbsp;loc_C9E483<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">00C9E483</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lock</b></span>&nbsp;<span class="hl_function"><b>xchg</b></span>&nbsp;<span class="hl_registr">bl</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00C9E486</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">bl</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">bl</span></li><li class="hl_l0"><span class="hl_number">00C9E488</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_C9E48C</li><li class="hl_l1"><span class="hl_number">00C9E48A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_C9E49C</li><li class="hl_l0"><span class="hl_number">00C9E48C</span>&nbsp;loc_C9E48C<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">00C9E48C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pusha</span></li><li class="hl_l0"><span class="hl_number">00C9E48D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">00C9E48F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span>dword_93CE42<span class="hl_char">+</span><span class="hl_number">8094FECh</span><span class="hl_char">+</span><span class="hl_registr">ebp</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00C9E495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popa</span></li><li class="hl_l1"><span class="hl_number">00C9E496</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_C9E483</li><li class="hl_l0"><span class="hl_number">00C9E498</span>&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l1"><span class="hl_number">00C9E498</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_C9E46A</li><li class="hl_l0"><span class="hl_number">00C9E49A</span>&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l1"><span class="hl_number">00C9E49A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;loc_C9E4A3</li><li class="hl_l0"><span class="hl_number">00C9E49C</span>&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l1"><span class="hl_number">00C9E49C</span></li><li class="hl_l0"><span class="hl_number">00C9E49C</span>&nbsp;loc_C9E49C<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">00C9E49C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">00C9E49D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_number">35Ch</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_number">00C9E4A3</span></li><li class="hl_l0"><span class="hl_number">00C9E4A3</span>&nbsp;loc_C9E4A3<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">00C9E4A3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l0"><span class="hl_number">00C9E4A8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_number">434h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_number">00C9E4AE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">28h</span><span class="hl_char">+</span>var_4<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>offset</b></span>&nbsp;VMStub<span class="hl_char">+</span><span class="hl_number">8094FECh</span><span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_number">00C9E4B6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">28h</span><span class="hl_char">+</span>var_4<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l1"><span class="hl_number">00C9E4BA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popa</span></li><li class="hl_l0"><span class="hl_number">00C9E4BB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popf</span></li><li class="hl_l1"><span class="hl_number">00C9E4BC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">retn</span></li><li class="hl_l0"><span class="hl_number">00C9E4BC</span>&nbsp;sub_C9E456&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>endp</b></span>&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>Доступ к таблице блоков пикода, ожидание освобождения исполнителя и т.д.
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253101&amp;user=6801&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=14" class="addthx" data-post="253101"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 20:04 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>Vamit пишет:<br>Исходники ожидаются? <br>Нет, используемые алгоритмы задействованы не только здесь, но ещё и в коммерческих проектах. </I><br>Используется что то не стандартное? Или просто комерческая тайна из за комерческого продукта? Про промежуточный код можно поподробнее рассказать?<br><br><I>Vamit пишет:<br>сть план расширить инф. в статью с более детальными коментариями - мыслями , кусками исходного кода , вариантами дальнейшего развития?! <br>Пока нет, всё зависит от интереса к проекту, если будет дальнейшее развитие проги, то почему бы и не поделиться информацией... </I><br><br>Интерес уже давно у многих есть, но в основном не в готовых решениях а в методах , интерес имеется в виду в плане тестирования? <br><br>Выложи пожалуста цель , под которой можно посмотреть работу.
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253102&amp;user=3520&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=15" class="addthx" data-post="253102"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 09:54 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>mak пишет:<br>Про промежуточный код можно поподробнее рассказать? </I><br>Можно, будет конкретный вопрос - будет и ответ, только желательно при вопросе ссылаться на определенную часть <b>Описания ВМ</b> для соблюдения терминологии и взаимопонимания.<br><br><I>интерес имеется в виду в плане тестирования? </I><br>Нет, вернее не только, для меня интерес определяется не тем, что кто-то сказал &quot;мне интересно&quot;, а рейтингом темы, если в ней идет диалог - то всё нормально, если больше месяца затишье - интерес кончился.<br><br><I>Выложи пожалуста цель , под которой можно посмотреть работу. </I><br>Легко сказать - сложно сделать, то что &quot;копал&quot; по определенным причинам выложить не могу, а другого просто нет. Могу ответить на этот вопрос <I>OKOB: описать как определить именно этот тип ВМ под который заточен плаг </I>, более подробно детализировать тип ВМ, чем это описано в файле BodyVM.cpp и обозначить ключевые моменты по которым VMSweeper (далее VMS или ВМС) определяет возможность её обработки, если, конечно,  это вам нужно...<br>Понимаете, ВМ не сообщает о себе открыто, я такая-то и такая, использую то-то и то-то, поэтому я даже конкретно ответить не могу каким протектором подготовить файл для исследования, могу только сказать, что это одна из последних версий CodeVirtualizer.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253140&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=16" class="addthx" data-post="253140"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 13:34 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Vamit</b><br>&gt; <i class=x>то что &quot;копал&quot; по определенным причинам выложить не могу, а другого просто нет</i><br><br>т.е. получается, что тестирование было только на одном примере?
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253151&amp;user=1379&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=17" class="addthx" data-post="253151"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 14:20 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>Jupiter пишет:<br>получается, что тестирование было только на одном примере? </I><br>Нет, обработано было 6 разных программ одной тематики, в каждом файле по 3 реализации ВМ (двух типов или две разновидности одного типа, не знаю, как правильнее), общее кол-во восстановленных функций &gt; 100.<br><br>ЗЫ: Приложил подробное описание ВМ<br><br><img src="img/attach.gif" alt=""> <a href="./files/493a_04.03.2010_CRACKLAB.rU.tgz">493a_04.03.2010_CRACKLAB.rU.tgz</a> - BodyVMFull.cc
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253152&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=18" class="addthx" data-post="253152"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 14:39 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b><i class=x>3.	Создание из значимых команд примитивов промежуточного <br>рабочего ассемблерного кода, заменяющего интерпретатор ВМ.</i></b><br>и<br><b><i class=x>Итог шага: ВМ исключена из работы и заменена декодированным промежуточным рабочим кодом. Этот код является «грязным», т.к. имеет большую степень обфускации, вот его чисткой мы и займемся далее.</i></b><br><br><b><i class=x>В дополнение прилагается полный листинг «дизассемблированного» пикода PiCodeVM.rar и полный листинг промежуточного рабочего кода DecodeVM.rar</i></b><br><br><br>Как формируется промежуточный код ? Какие правила формирования промежуточного кода? Правила синтаксиса?<br><br>Я так понял , он прогоняется поэтапно , поэтому и спросил , этапы формирования до конечного асм кода, нашел<br><br><b><i class=x>Шаг 2<br>Дизассемблируем и конвертируем полученный промежуточный код в структуры инструкций (insn_t) и операндов (op_t), позаимствованные у IDA. На это есть две причины. Первое – структуры IDA, описывающие команды ассемблера очень упорядоченные, по сравнению со структурами Olly, в которых, мягко говоря, полный бардак. Второе – дальнейший обработчик кода позаимствован из Декомпилятора <br>С++, который работает с IDA’шными структурами. Создаем карту всех переходов с <br>сохранением/восстановлением состояний трассировки кода в точках возможного разрыва линейного анализа. Например, блоки if … else. Файл карты xRefs.stat есть в приложении logs.rar. Инициализируем структуры всех регистров, стека и памяти. В этой точке мы готовы к статической трассировке промежуточного кода. <br>Трассировку проводим в два прохода. Первый проход линейный, разрывов потоков данных в точках присвоения (их мы ещё и не выявили) не происходит, в местах взаимо исключаемых переходов осуществляется сохранение-восстановление всех данных.<br>На первом проходе:<br>- строятся массивы точек изменения состояний нативных регистров (EMPTY, UNKNOWN, INIT, CHANGE, USE)<br>- строятся массивы всех присвоений ячейкам памяти и изменений значений в памяти<br>- создаются логические блоки следующих типов: CNGFLAG, JMP и JCC, CALL и осуществляется юстировка их границ, если требуется<br>- определяются границы блоков входа и выхода из ВМ (ENTRY/RESTORE)<br>Состояние после первого прохода приведено в логе, секция 000.<br> <br>После первого прохода создаем:<br>- Блоки ENTRY и RESTORE<br>- Блоки всех присвоений и изменений для всех ячеек памяти - ASSIGN (MEM)<br>- Блоки всех присвоений и изменений для всех регистров ВМ  - ASSIGN (REGVM), это та же ячейка памяти, только находится по специальному адресу.<br>- Блоки некоторых присвоений и изменений для некоторых нативных регистров - ASSIGN (REG) по специальному алгоритму<br>- Блоки всех присвоений (помещение в стек) для всех аргументов функций - ASSIGN (ARG)<br>Состояние приведено в логе, секция 001.<br>Далее следуют несколько обработчиков созданных блоков, которые вызываются последовательно, в нашем случае, первый обработчик юстирует начальные границы блоков, когда переход идет внутрь блока или на пустое место, которое не принадлежит ни одному блоку, в этом месте создается блок <br>«пустышка» DUMMY. Второй обработчик корректирует начальные границы блоков для исключения разрывов. Состояние приведено в логе, секция 003.</i></b><br><br><br>Как происходит назначение регистров для формирования асм кода? Меня интеерсует вопрос о универсальности , когда код , разморфлен , а потом переведен в вм вариант , при этом вычисления внутри вм уже идут не по значениям или офсетам настоящей проекции архитектуры х86 , а совершенно беспорядочно , нов даже тут есть порядок , определенный вектор , при смешивании или перестройки регистров , внутри вм , этот вектор не нарушается , если стэковые команды с гемором мы опознаем , то уже другии интерпретации придется прогонять через анализатор и карту распределения регистров , для декомпиляции. Поэтому вопрос заданный выше относится только к твоему коду , все остальное , мысли вслух о других модификациях вм. <br><br><b><i class=x>Данные при перемещении или изменении из/в регистров, ячеек памяти и стека не затирают друг друга, а выстраиваются в логические цепочки выражений. Далее эти структуры выстраиваются в строки (не текстовые), которые составят двусвязный список текста. Результат этого прохода виден в логе, секция а00. Как видно большая часть обфускации кода после этих операций исчезла.</i></b><br><br>Что значит деобфускация исчезла? Если я правильно понял , то это не совсем деобфускация , а лишь одно из следствий применения виртуальной машины как защиты ?! Или?<br><br><b><i class=x>Шаг 3 (заключительный)<br>дальнейшая обработка будет производиться над строками и текстом.<br><br>Производим деобфускацию констант и корректируем стековые смещения. Лог, секция а04.</i></b><br><br>Принцип построения деобфускатора? Заточен только под конкретную цель ?<br><br>Далее на шаге три <br><b><i class=x>Заменяем регистры ВМ нативными регистрами. Лог, секция а06.</i></b><br><br>Поподробнее можно пожалуста <img src="img/smilies/s1.gif" alt=""><br><br><b><i class=x>Деобфускация и трассировка флагов процессора</i></b><br><br>Привидите примеры кода из вашей программы защищенной , думаю это ее не скомпрометирует <img src="img/smilies/s2.gif" alt=""><br><br>Сэнкс!<br><br>П.С. Коменты просто смотрятся по дурацки , совершенно не приятно для чтения , а вот тэги как у кода , белые , очень хорошо. Но такой глюк бывает.
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253153&amp;user=3520&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=19" class="addthx" data-post="253153"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 15:14 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>mak пишет:<br>Code: </I><br>А пустые окошки кода - это что? Или глюк скрипта, когда в окошке одна длинная строка, то она накрывается полосой прокрутки, можно пост подправить, пожалуйста...<br>Может в данном случае лучше использовать тег цитаты вместо тега кода.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253157&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=20" class="addthx" data-post="253157"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 15:37 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>Vamit пишет:<br>А пустые окошки кода - это что? Или глюк скрипта, когда в окошке одна длинная строка, то она накрывается полосой прокрутки </I><br>а что у тя за браузер? у мну все нормально
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253158&amp;user=15500&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=21" class="addthx" data-post="253158"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 16:02 <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>Vamit пишет:<br>Приложил подробное описание ВМ </I><br><br>На сегодняшний момент несколько устарело и некоторые куски кода ошибочно отнесены к обфускации.<br><br>В Фиме 2.1.1.0 это выглядит так как представлено ниже. Максимальное количество хэндлеров (в вашей терминалогии примитивов) 169 для 32-бит ВМ и 201 для 64-бит ВМ. А вообще у вас 168 примитивов из-за большого количества виртуализированого кода. В ВМ вставляются после виртуализации кода только необходимые хэндлеры и их количество прописывается в коде ВМ_Ентри.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0061B425</span>&nbsp;SLcisc32_VMEntry&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function">near</span></li><li class="hl_l1"><span class="hl_number">0061B425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pushf</span></li><li class="hl_l0"><span class="hl_number">0061B426</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_number">0061B427</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_number">0061B428</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_number">0061B429</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">0061B42A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esp</span></li><li class="hl_l1"><span class="hl_number">0061B42B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0"><span class="hl_number">0061B42C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1"><span class="hl_number">0061B42D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0"><span class="hl_number">0061B42E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">cld</span></li><li class="hl_l1"><span class="hl_number">0061B42F</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">0061B431</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">$</span><span class="hl_char">+</span><span class="hl_number">5</span></li><li class="hl_l1"><span class="hl_number">0061B436</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0"><span class="hl_number">0061B437</span></li><li class="hl_l1"><span class="hl_number">0061B437</span>&nbsp;@base<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">0061B437</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">11111111h</span></li><li class="hl_l1"><span class="hl_number">0061B43D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FFFFF000h</span></li><li class="hl_l0"><span class="hl_number">0061B443</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">14h</span></li><li class="hl_l1"><span class="hl_number">0061B446</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0"><span class="hl_number">0061B448</span></li><li class="hl_l1"><span class="hl_number">0061B448</span>&nbsp;SLcisc_VMEntry_addrVMContext_patch<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">0061B448</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">11111111h</span></li><li class="hl_l1"><span class="hl_number">0061B44E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">7EAA0004h</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">0061B454</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;@setNewBase</li><li class="hl_l1"><span class="hl_number">0061B456</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;@go</li><li class="hl_l0"><span class="hl_number">0061B458</span>&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l1"><span class="hl_number">0061B458</span></li><li class="hl_l0"><span class="hl_number">0061B458</span>&nbsp;@setNewBase<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">0061B458</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">7EAA0004h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">0061B45E</span></li><li class="hl_l1"><span class="hl_number">0061B45E</span>&nbsp;SLcisc_VMEntry_numHandlers_patch<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">0061B45E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">11111111h</span></li><li class="hl_l1"><span class="hl_number">0061B463</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;@check_loop</li><li class="hl_l0"><span class="hl_number">0061B465</span>&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l1"><span class="hl_number">0061B465</span></li><li class="hl_l0"><span class="hl_number">0061B465</span>&nbsp;@begin_loop<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">0061B465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;@do_rebase</li><li class="hl_l0"><span class="hl_number">0061B467</span>&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l1"><span class="hl_number">0061B467</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_registr">ecx</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">+</span><span class="hl_number">7EBB0003h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">0061B46E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;@shift_loop</li><li class="hl_l1"><span class="hl_number">0061B470</span>&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l0"><span class="hl_number">0061B470</span></li><li class="hl_l1"><span class="hl_number">0061B470</span>&nbsp;@do_rebase<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">0061B470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_registr">ecx</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">+</span><span class="hl_number">7EBB0002h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_number">0061B477</span></li><li class="hl_l0"><span class="hl_number">0061B477</span>&nbsp;@shift_loop<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">0061B477</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dec</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_number">0061B478</span></li><li class="hl_l1"><span class="hl_number">0061B478</span>&nbsp;@check_loop<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">0061B478</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">0061B47A</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;@begin_loop</li><li class="hl_l0"><span class="hl_number">0061B47C</span></li><li class="hl_l1"><span class="hl_number">0061B47C</span>&nbsp;@go<span class="hl_char">:</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; pcode address</span></li><li class="hl_l0"><span class="hl_number">0061B47C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">24h</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">0061B480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>esi</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; as hashing key</span></li><li class="hl_l0"><span class="hl_number">0061B482</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_number">0061B484</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">0061B489</span></li><li class="hl_l1"><span class="hl_number">0061B489</span>&nbsp;@wait_loop<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">0061B489</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_number">0061B48B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lock</b></span>&nbsp;<span class="hl_function"><b>cmpxchg</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_number">7EAA0005h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_number">0061B493</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>short</b></span>&nbsp;@wait_loop</li><li class="hl_l1"><span class="hl_number">0061B495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lodsb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; get crypted opcode</span></li><li class="hl_l0"><span class="hl_number">0061B496</span>&nbsp;<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_number">0061B496</span>&nbsp;<span class="hl_comment">; decrypt opcode (unique combination with use hash)</span></li><li class="hl_l0"><span class="hl_number">0061B496</span>&nbsp;<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_number">0061B496</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>movzx</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l0"><span class="hl_number">0061B499</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">+</span><span class="hl_registr">eax</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">0061B49C</span>&nbsp;<span class="hl_comment">; ---------------------------------------------------------------------- -----</span></li><li class="hl_l0"><span class="hl_number">0061B49C</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">popa</span></li><li class="hl_l1"><span class="hl_number">0061B49D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">retn</span></li><li class="hl_l0"><span class="hl_number">0061B49D</span>&nbsp;SLcisc32_VMEntry&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div>
<br><br>Кроме этого новым по сравнению с рассматриваемым вами является &quot;плавающее&quot; (определяется во время сборки ВМ) положение полей контекста (в вашей терминологии 17..19 регистров). В выше приведенном коде константы типа 7EBB0002h..7EBB0005h это идентификаторы полей контекста которые при сборке конкретной ВМ будут заменены на смещения в контексте.
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253159&amp;user=6801&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=22" class="addthx" data-post="253159"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 16:51 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>BoRoV пишет:<br>а что у тя за браузер? </I> IE6<br><br><b>mak</b><br>Можно задавать по одному - два вопроса, а то на все сразу не ответишь, а в дальнейшем просто затеряются или забудутся.<br><br><I>Как формируется промежуточный код ? </I><br>Вот ответ на этот вопрос, надеюсь полный <img src="img/smilies/s1.gif" alt=""><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Создание&nbsp;промежуточного&nbsp;ассемблерного&nbsp;кода&nbsp;<span class="hl_char">(</span>листинг&nbsp;DecodeVM<span class="hl_char">.</span>txt<span class="hl_char">)</span>&nbsp;производится&nbsp;одновременно</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;с&nbsp;расшифровкой&nbsp;пикода&nbsp;<span class="hl_char">(</span>листинг&nbsp;PiCodeVM<span class="hl_char">.</span>txt<span class="hl_char">)</span>&nbsp;за&nbsp;один&nbsp;проход&nbsp;в&nbsp;одном&nbsp;цикле<span class="hl_char">.</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;DecodeVM<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">while</span><span class="hl_char">(</span><span class="hl_function">TRUE</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;dcom&nbsp;<span class="hl_char">=</span>&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>DecodePiVM<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>dcom&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error</span><span class="hl_char">(</span><span class="hl_quote">&quot;Can't execute VM command 0x%02X in addres 0x%08X!&quot;</span><span class="hl_char">,</span>&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>GetPiCode<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>GetIp<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DeleteVm</span><span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>dcom&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>break</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">if</span><span class="hl_char">(</span>dcom&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">2</span><span class="hl_char">)</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DeleteVm<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;vVM<span class="hl_char">:</span><span class="hl_char">:</span>DecodePiVM<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;получить&nbsp;расшифрованный&nbsp;пикод&nbsp;примитива</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetPiCode<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;вызвать&nbsp;обработчик&nbsp;конкретного&nbsp;примитива</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;m_pfnPiCode<span class="hl_char">[</span>m_nPiCode<span class="hl_char">]</span><span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;vVM<span class="hl_char">:</span><span class="hl_char">:</span>GetPiCode<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;cmd&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span>m_pPiTable<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;выполнение&nbsp;шаблона&nbsp;хеширования&nbsp;<span class="hl_char">(</span>декодирование&nbsp;пикода<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ExecuteTemplate<span class="hl_char">(</span>cmd<span class="hl_char">,</span>&nbsp;dt_byte<span class="hl_char">,</span>&nbsp;<span class="hl_function">FALSE</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;в&nbsp;комментариях&nbsp;одна&nbsp;из&nbsp;реализаций&nbsp;хеширования&nbsp;пикода</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;LOBYTE<span class="hl_char">(</span>m_nHash<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd&nbsp;^<span class="hl_char">=</span>&nbsp;0xD2<span class="hl_comment">;					//(((0xF6 ^ 0x5A) + 1) &amp; 0x8E) + 0xF6 + bh(0x50)</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd&nbsp;<span class="hl_char">-</span><span class="hl_char">=</span>&nbsp;0xF1<span class="hl_comment">;					//~0x7E ^ 0x59 ^ 0x29</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_nHashBt<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;cmd<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_nPiCode&nbsp;<span class="hl_char">=</span>&nbsp;cmd<span class="hl_comment">;</span></li><li class="hl_l0">}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;обработчик&nbsp;одного&nbsp;из&nbsp;примитивов</li><li class="hl_l1"><span class="hl_function"><b>int</b></span>&nbsp;vVM<span class="hl_char">:</span><span class="hl_char">:</span>Pi_MovConstLong<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_number">69</span></li><li class="hl_l0">{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;описание&nbsp;действия</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>const</b></span>&nbsp;<span class="hl_function">dword</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;получить&nbsp;значение&nbsp;константы</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;value&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span><span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">*</span><span class="hl_char">)</span>s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>m_pPiTable<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>m_pPiTable&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">4</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;декодировать&nbsp;константу</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>ExecuteTemplate<span class="hl_char">(</span>value<span class="hl_char">,</span>&nbsp;dt_dword<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;в&nbsp;комментариях&nbsp;одна&nbsp;из&nbsp;реализаций&nbsp;хеширования&nbsp;константы</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;^<span class="hl_char">=</span>&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>m_nHash<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;<span class="hl_char">-</span><span class="hl_char">=</span>&nbsp;0x0F657E8D<span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;0x04F85DFF<span class="hl_comment">;			//0 - (0x453775A5 + 0x3B5446C7) - 0x7A7BE595</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;0x0F657E8D<span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;^<span class="hl_char">=</span>&nbsp;0x4D1928C3<span class="hl_comment">;			//0xC3A5A56F - 0x768C7CAC</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>m_nHash&nbsp;^<span class="hl_char">=</span>&nbsp;value<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;создать&nbsp;<span class="hl_quote">&quot;переменную&quot;</span>&nbsp;типа&nbsp;константа</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vVarVM&nbsp;var<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var<span class="hl_char">.</span>SetVarConst<span class="hl_char">(</span>value<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var<span class="hl_char">.</span>CorrectVarName<span class="hl_char">(</span>s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>m_nRegAddr<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;поместить&nbsp;её&nbsp;в&nbsp;регистр&nbsp;#EDX#</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>m_RegCpu<span class="hl_char">[</span>REG_EDX<span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;var<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;вывод&nbsp;информации&nbsp;в&nbsp;листинг&nbsp;DecodeVM<span class="hl_char">.</span>txt</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>SetOpCode<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>SetParametr<span class="hl_char">(</span>value<span class="hl_char">,</span>&nbsp;vP_DWORD<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>SetCommand<span class="hl_char">(</span><span class="hl_quote">&quot;mov    edx, %08X&quot;</span><span class="hl_char">,</span>&nbsp;value<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>SetDescription<span class="hl_char">(</span>var<span class="hl_char">.</span>GetName<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>AddtolistVm<span class="hl_char">(</span>s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>m_nIP<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;сместить&nbsp;#EIP#&nbsp;машины</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>m_nIP&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">5</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;создать&nbsp;команду&nbsp;промежуточного&nbsp;ассемблерного&nbsp;кода</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;s_pVm<span class="hl_char">-</span><span class="hl_char">&gt;</span>CreateAsmCode<span class="hl_char">(</span><span class="hl_number">4</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;mov    edx, 0x%08X&quot;</span><span class="hl_char">,</span>&nbsp;value<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br><br><I>OKOB пишет:<br>На сегодняшний момент несколько устарело</I><br>Устарело чем? Что нет программ накрытых этой ВМ, скажу так, программа 2008г - версия ВМ с 17 регистрами, таже прога следующей версии начало 2009г аналогично, следующая версия - конец 2009г - ВМ с 19 регистрами.<br><br><I>некоторые куски кода ошибочно отнесены к обфускации </I><br>Если речь идет о входе в ВМ до цикла декодирования, то да, скорее это незначимые сроки для данной реализации. А что касается цикла декодирования и примитива, то должно быть правильно, хотя, неважно, мог и ошибиться...
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253161&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=23" class="addthx" data-post="253161"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 17:05 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<img src="img/smilies/s1.gif" alt=""> не затеряются , у нас и у вас большой ведь интерес! Можно вернуться и прочитать позже) Вообщем повторять не буду , лучше как будет время по порядку напишите вернувшись назад.  Тем более часть вопросов у <b>OKOB</b> тоже описываются. Подробное описание ВМ посмотрим) За пример формирования IR кода спасибо , попробую разобраться.
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253163&amp;user=3520&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=24" class="addthx" data-post="253163"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 18:40 <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Для реализации девиртуализации (и не изобретения велосипеда при этом) не плохо бы было взглянуть на процесс виртуализации, что и было сделано (http://www.woodmann.com/forum/showthread.php?p=78770&amp;postcount=23). Файл который в прицепе поста к сожалению уже недоступен и у себя я нашел только результат работы того что было там представлено (позже может найду все). Вкратце, юзаются ДЛЛки вынутые из недр Фимы или КодеВиртуализера (Oreansf1.dll и ОreansX2dllR.dll) и исследуются все этапы виртуализации.<br><br>1) исходный код<br>00040129ch: PUSH EBP<br>00040129dh: MOV EBP, ESP<br>00040129fh: SUB ESP, 40<br>0004012a2h: PUSH ESI<br>0004012a3h: PUSH EDI<br>0004012a4h: MOV dword ptr [EBP + 0ffffffe8h], 000000000h<br>0004012abh: JMP 000401411h<br><br>2) код дизассемблированный ореанс<br>feed:<br> section .code base 0000000h code<br>@label1:<br>	PUSH	EBP<br>	MOV	EBP, ESP<br>	SUB	ESP, 40<br>	PUSH	ESI<br>	PUSH	EDI<br>	MOV	dword ptr [EBP + 0ffffffe8h], 000000000h<br>	JMP	@label13<br>@label2:<br><br>3) промежуточный пикод<br>02 00 00 80 03 00 00 00 30 00 00 f0 00 00 <br>00 00 00 00 06 00 00 00 00 00 00 00 00 00 <br>02 00 00 80 03 00 00 00 38 00 00 f0 00 00 <br>00 00 00 00 06 00 00 00 00 00 00 00 00 00 <br>02 00 00 80 03 00 00 00 30 00 00 f0 00 00 <br>01 00 00 00 06 00 00 00 00 00 00 00 00 00 <br>02 00 00 80 03 00 00 00 38 00 00 f0 00 00 <br>00 00 00 00 06 00 00 00 00 00 00 00 00 00 <br>00 00 00 00 22 00 00 00 28 00 00 00 00 00 <br>0c 00 00 00 1a 00 00 00 00 00 00 00 00 00 <br>01 00 00 00 1e 00 00 00 00 00 00 00 00 00 <br>02 00 00 80 03 00 00 00 38 00 00 f0 00 00 <br>08 00 00 00 03 00 00 00 04 00 00 00 00 00 <br>01 00 00 00 06 00 00 00 00 00 00 00 00 00 <br>02 00 00 80 03 00 00 00 20 00 00 f0 00 00 <br>00 00 00 00 06 00 00 00 00 00 00 00 00 00 <br>02 00 00 80 03 00 00 00 28 00 00 f0 00 00 <br>00 00 00 00 06 00 00 00 00 00 00 00 00 00 <br><br>4) декомпилированный промежуточный пикод во мнемокод<br>; PUSH EBP<br>move addr, f0000030h<br>load dword ptr [addr] <br><br>; MOV EBP, ESP<br>move addr, f0000038h<br>load dword ptr [addr] <br>move addr, f0000030h<br>store dword ptr [addr] <br><br>; SUB ESP, 40<br>move addr, f0000038h<br>load dword ptr [addr] <br>load dword 28<br>sub dword <br>store FLAGS <br>move addr, f0000038h<br>add addr, 00000004h<br>store dword ptr [addr] <br><br>; PUSH	ESI<br>move addr, f0000020h<br>load dword ptr [addr] <br><br>; PUSH	EDI<br>move addr, f0000028h<br>load dword ptr [addr] <br><br>Кстати ОreansX2dllR.dll - виртуализирует под CISC VM<br>a ОreansX3dllR.dll - виртуализирует под RISC VM<br><br>В прицепе полный файл из которого приведены фрагменты.<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/6b49_04.03.2010_CRACKLAB.rU.tgz">6b49_04.03.2010_CRACKLAB.rU.tgz</a> - long.txt
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253167&amp;user=6801&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=25" class="addthx" data-post="253167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 20:30 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>OKOB пишет:<br>Для реализации девиртуализации (и не изобретения велосипеда при этом) не плохо бы было взглянуть на процесс виртуализации </I><br>Что-то мы с вами говорим об одном и том-же на разных языках, я правда, больше молчу... <img src="img/smilies/s1.gif" alt=""><br>Да, приведенные вами примеры ВМ очень похожи на разобранную мной ВМ, даже можно сказать, что в чем-то одинаковы, только что вы хотите этим сказать я так и не понял, хотя за них спасибо. Если то, что ВМС не может их декомпилировать, дак он и не должен, поймите, я писал инструмент не под какие-то существующие типы ВМ, а под то, в чем была необходимость - и это было реализовано. Если будет необходимость, то и приведенные вами типы ВМ будут обрабатывается ВМС по реализованному алгоритму, нужно только описать разновидность ВМ. Определить же тип разобранной мной машины пока тоже никто не смог, но я больше практик, чем теоретик и поэтому могу сказать что для реализации девиртуализации совсем необязательно знать процесс виртуализации - главное понимать как выполняется код, а не как он сделан, и между прочим - это универсальный подход для реализации любых декомпиляторов. Как сделан код нужно знать лишь в том случае, если мы хотим получить после декомпилятора исходник как можно ближе к оригиналу, для декомпилятора ВМ это не нужно, асм он и Африке асм, а вот для декомпилятора С++ нужно знать как из исходника получен асм, иначе лучшего чем в НехРей нам не видать. Но это уже отступление от темы...<br><br><I>mak пишет:<br>Как происходит назначение регистров для формирования асм кода? </I><br>К каким регистрам относится этот вопрос? К этим - <I>- Блоки некоторых присвоений и изменений для некоторых нативных регистров - ASSIGN (REG) по специальному алгоритму</I>?<br><I>совершенно беспорядочно , нов даже тут есть порядок , определенный вектор , при смешивании или перестройки регистров , внутри вм , этот вектор не нарушается , если стэковые команды с гемором мы опознаем , то уже другии интерпретации придется прогонять через анализатор и карту распределения регистров , для декомпиляции. </I><br>С регистрами не сложнее чем со стеком - обратите внимание на файлы &quot;имя_регистра&quot;.stat в обзоре ( особенно на edx.stat). Каждый нативный регистр в конкретной точке выполнения программы в общем виде всегда имеет одно из 5 состояний: EMPTY - значение регистра не важно, UNKNOWN - значение регистра важно, но неизвестно, INIT - регистру присваивается значение, CHANGE - значение регистра изменяется, USE - значение из регистра используется. На каждой асм команде осуществляется трассировка значений всех регистров, для статического анализа вернее сказать состояний регистров, т.к. содержимое регистров мы не знаем. Фиксируем точки изменения состояний регистров, точка фиксации - адрес асм кода, если регистр в одной команде проходит через несколько состояний, то записываем их последовательно под одним адресом. Далее анализ - определение точек перезагрузок регистра в контексте конкретного логического блока кода. Уже на этом этапе - часть обфускированного кода будет устранена. Пример, показывающий это: имеем цепочку изменения состояний регистра (цифра - номер шага) 1 INIT, 2 CHANGE, 3 CHANGE, 4 INIT, 5 USE и т.д. Отсюда видно, что шаги 1-3 являются обфускацией (избыточны), а 4-5 значимы.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253173&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=26" class="addthx" data-post="253173"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2010 21:17 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<img src="img/smilies/s1.gif" alt=""> ага , это мне понятно , но хорошо что обьяснили повторно , я понял о чем речь , примерно тоже самое что делать регистровую деобфускацию через ССА , очень практичный метод для деморфа и деобфускации. Можно даже граф построить.<br><br>Я наверное выразился не так , я особо не ковырял орианс , выше вы сказали что есть определенное число регистров , одни служебные , вторые настоящие от процессора , так вот имеется ввиду , известно ли назначение регистров заранее по офсетам и таблицам офсетов ? Или же у орианс регистры типа блэкбокс , где нет точной копии скажем регистра еах , мы вообще не можем определить где какой регистр , мы можем только по логике построить код а потом делать назначение регистров. Тут же спросил , про назначение .... судя по тому как вы описали , каждый регистр и его именной эквивалент для х86 архитектуры известен?! Правильно ? Это собственно последнее что я хотел узнать.<br><br>Было бы классно уже и под риск адаптировать дллку ... Тип вм чаще всего определяют по входу в саму вм ....
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253175&amp;user=3520&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=27" class="addthx" data-post="253175"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2010 09:35 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>mak пишет:<br>известно ли назначение регистров заранее по офсетам и таблицам офсетов ? </I><br>Заранее известны только регистры для нужд самой ВМ, регистры же для сохранения контекста программы (нативных регистров) неизвестны, известен только блок, в который они поместятся, а какой нативный регистр на какое место неизвестно. В каждой реализации ВМ это место своё. Но это легко вычисляется при создании промежуточного кода следующим образом: при входе в ВМ нативные регистры сохраняются в стеке, далее в логическом блоке ENTRY нативные регистры из стека перегружаются в регистры ВМ и вся дальнейшая работа до выхода из ВМ осуществляется с этими регистрами, т.е. для конкретной реализации ВМ можно выявить жесткое соответствие между нативными регистрами и регистрами ВМ.<br>Вот раскладки регистров ВМ:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;два&nbsp;индекса&nbsp;через&nbsp;<span class="hl_char">:</span>&nbsp;обозначают&nbsp;разные&nbsp;типы&nbsp;машин&nbsp;с&nbsp;<span class="hl_number">17</span>&nbsp;и&nbsp;<span class="hl_number">19</span>&nbsp;регистрами</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;индекс&nbsp;регистра&nbsp;зависит&nbsp;от&nbsp;реализации&nbsp;VM&nbsp;<span class="hl_char">(</span>приведена&nbsp;одна&nbsp;из&nbsp;реализаций<span class="hl_char">)</span></li><li class="hl_l1">RVM_EBP&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">00</span>&nbsp;real&nbsp;<span class="hl_registr">ebp</span></li><li class="hl_l0">RVM_ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">04</span>&nbsp;real&nbsp;<span class="hl_registr">esi</span></li><li class="hl_l1">RVM_EDX&nbsp;&nbsp;&nbsp;<span class="hl_number">2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">08</span>&nbsp;real&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0">RVM_EDI&nbsp;&nbsp;&nbsp;<span class="hl_number">3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">0C</span>&nbsp;real&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1">RVM_ECX&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">10</span>&nbsp;real&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0">RVM_EAX&nbsp;&nbsp;&nbsp;<span class="hl_number">5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">14</span>&nbsp;real&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">RVM_EBX&nbsp;&nbsp;&nbsp;<span class="hl_number">6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">18</span>&nbsp;real&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;регистры&nbsp;состояния&nbsp;ВМ&nbsp;<span class="hl_char">(</span>жесткое&nbsp;назначение<span class="hl_char">)</span></li><li class="hl_l1">RVM_EFL&nbsp;&nbsp;&nbsp;<span class="hl_number">7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">1C</span>&nbsp;real&nbsp;flags</li><li class="hl_l0">RVM_8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">20</span>&nbsp;признак&nbsp;условного&nbsp;перехода</li><li class="hl_l1">RVM_9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">9</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">24</span>&nbsp;счетчик&nbsp;значимых&nbsp;бит&nbsp;для&nbsp;условного&nbsp;перехода</li><li class="hl_l0">RVM_ECX_INDEX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">10</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">28</span>&nbsp;индекс&nbsp;<span class="hl_registr"><b>ECX</b></span>&nbsp;регистра&nbsp;для&nbsp;операций&nbsp;<span class="hl_function"><b>jcxz</b></span>&nbsp;и&nbsp;аналогичных</li><li class="hl_l1">RVM_11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">11</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">2C</span>&nbsp;смещение&nbsp;адреса&nbsp;возврата&nbsp;из&nbsp;процедуры</li><li class="hl_l0">RVM_12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">12</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">30</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;при&nbsp;входе&nbsp;в&nbsp;процедуру</li><li class="hl_l1">RVM_13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">13</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">34</span></li><li class="hl_l0">RVM_14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">14</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">38</span>&nbsp;кол<span class="hl_char">-</span>во&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;удаляемое&nbsp;из&nbsp;стека&nbsp;при&nbsp;входе&nbsp;в&nbsp;процедуру</li><li class="hl_l1"><span style="word-break: break-all">RVM_15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">3C</span></li><li class="hl_l0">RVM_TMP&nbsp;&nbsp;&nbsp;<span class="hl_number">15</span>&nbsp;<span class="hl_char">:</span>&nbsp;<span class="hl_number">16</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">3C</span>&nbsp;<span class="hl_char">:</span>&nbsp;<span class="hl_number">40</span>&nbsp;temporary</li><li class="hl_l1">RVM_16_17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">16</span>&nbsp;<span class="hl_char">:</span>&nbsp;<span class="hl_number">17</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_number">40</span>&nbsp;<span class="hl_char">:</span>&nbsp;<span class="hl_number">44</span></li><li class="hl_l0">RVM_18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">18</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">48</span></li>        </ol>
    </div>
</div></div>
<br>часть регистров в разобранных реализациях не используется, поэтому их назначение мне неизвестно.<br><br><I>mak пишет:<br>Тип вм чаще всего определяют по входу в саму вм ....  </I><br>Понятно, но каким образом? Вопрос такого плана, подвержена ли точка входа конкретного типа ВМ и само тело ВМ (до цикла интерпретатора пикода) мутации при создании реализации ВМ?<br><b>OKOB</b> привел пару листингов тел ВМ, в посте №14 - видно что это другой тип ВМ, а вот в посте №22 - тип очень похож на разобранный, но есть небольшие нюансы, вот и хотелось бы знать, может это мутации одного типа, если так, то небольшая доработка ВМС позволит обрабатывать и эту ВМ.<br><br>ЗЫ: Вопрос не по теме, но важный для меня, <a href="http://www.exelab.ru/f/action=vthread&amp;forum=13&amp;topic=11325&amp;page=8.html" target="_blank">здесь</a> пост №9 я спрашивал о типе упаковщика, может кто-нибудь поможет определить его тип?<br>Могу дать наводку - функция tmainCRTStartup накрыта ВМ, т.к. процедуры _setenvp, _cinit и _WinMain вызываются из ВМ, но найти OEP мне не удалось.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253197&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=28" class="addthx" data-post="253197"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2010 10:17 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>Vamit пишет:<br>может кто-нибудь поможет определить его тип? </I><br>Так там тебе ответили вмпротект и версия судя по импорту не очень свежая
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=253199&amp;user=293&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=29" class="addthx" data-post="253199"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2010 10:19 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>Vamit пишет:<br>Вопрос не по теме, </I><br>похоже на вм прот, ближе к стабу ничего не нашёл пока<br>00454150     33C0                                 XOR EAX,EAX
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253200&amp;user=3230&amp;forum_n=13&amp;topic=15906&amp;page=0&amp;anchor=30" class="addthx" data-post="253200"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=7.html">8</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=22.html">23</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=23.html">24</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Декомпилятор ВМ</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="15906">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15906" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
