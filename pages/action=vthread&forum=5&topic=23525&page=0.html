<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите с проверкой целостности кода - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем добрый вечер! Есть две программы у обеих есть проверка на целостность кода. Программа 1 1. Написана на - сейчас затрудняюсь ответить. 2. Упаковщик - UPX (с этим проблем нет) 3. Ограничение на запуск, только один экземпляр">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=42860'>igorcauret</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите с проверкой целостности кода</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]OttoDeFix[/b]','')">OttoDeFix</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39077">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 19:51 &middot; Поправил: OttoDeFix <br><script type="text/javascript">QU('OttoDeFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OttoDeFix" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем добрый вечер!<br>Есть две программы у обеих есть проверка на целостность кода.<br>Программа 1<br>1. Написана на - сейчас затрудняюсь ответить.<br>2. Упаковщик - UPX (с этим проблем нет)<br>3. Ограничение на запуск, только один экземпляр программы можно запустить.<br>4. Присутствует реклама.<br>После распаковки и восстановления импорта программа запускается, но коннекта к серверу нет, сначала подумал, что накосячил с распаковкой. Скачал автораспаковщик, распаковал им, результат тот же, запускается но коннекта нет. На время забросил разбираться с коннектом, с запуском нескольких экземпляров разобрался и сделал инлаин патч в виде загрузчика.<br>Сейчас вернулся к проблеме с коннектом, когда возился с инлаин патчем я понял, что в программе идет проверка на целостность (когда встроил патч в упакованный exe файл). Для пущей убедительности в упакованном exe файле немного изменил PE заголовок, а конкретно прописал контрольную сумму изначально она была 000000, в результате поведение повторилось прога запускается, а коннекта нет.<br>Подскажите, как отловить проверку? и какие методы проверки есть (с помощью каких апи функций). Так же буду благодарен, если до кучи кинете crackme с проверками целостности, но не сильно мудреные (crackme от PEkilla  не предлагать <img src="img/smilies/s5.gif" alt=""> ).<br><br>Программа 2<br>1. Написана на Delphi 7<br>2. Упаковщик UPX<br>3. Есть цифровая подпись - не знаю может ли она на что-то влиять.<br>4. Регистрация - хочу написать кейген<br><br>После распаковки выводит сообщение о повреждении файла, не могу отловить данное окошко, подскажите какими методами можно отловить создание окна. Проверка срабатывает, даже если переименовать упакованный exe файл.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354564&amp;user=39077&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=1" class="addthx" data-post="354564"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 20:05 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>OttoDeFix пишет:<br>какие методы проверки есть (с помощью каких апи функций) </I><br><br>ImageHlp.MapFileAndCheckSum.  Но она ни при чём, скорее всего.<br><br><I>OttoDeFix пишет:<br>4. Регистрация - хочу написать кейген </I><br><br>Так зачем тогда ковырять проверку целостности?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354565&amp;user=35473&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=2" class="addthx" data-post="354565"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 20:06 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>OttoDeFix</b><br>без ссылок на программы (в упакованном/запакованном виде) дальнейший разговор не имеет смысла - т.е. софт в студию. <br>А без софта - обычные гадания.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354566&amp;user=26651&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=3" class="addthx" data-post="354566"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=1989" title="18-04-2015 19:08, ранг:454.8" target="_blank">OnLyOnE</a>, <a href="action=userinfo&user=12980" title="19-04-2015 20:57, ранг:62.9" target="_blank">Creckerhack</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]OttoDeFix[/b]','')">OttoDeFix</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39077">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 20:26 <br><script type="text/javascript">QU('OttoDeFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OttoDeFix" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>dosprog пишет:<br>Так зачем тогда ковырять проверку целостности?  </I><br>Как-то разбирать алгоритм проверки ключа, а тем более его найти в упакованной проге очень муторно.<br><br><I>ELF_7719116 пишет:<br>А без софта - обычные гадания.  </I><br>А мне для начала это и надо, иначе у меня потеряется интерес. Я хочу понять, как можно отловить проверку, если пользователю не выводится сообщение и какие методы проверки на целостность есть.<br>А вот если сам уже не осилю, тогда уже скажу, что запрога и кто-нибудь ее разберет за 5 мин.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354567&amp;user=39077&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=4" class="addthx" data-post="354567"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]TryAga1n[/b]','')">TryAga1n</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 262.5 (наставник), 337thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.45'>Активность: 0.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=31275">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 20:50 <br><script type="text/javascript">QU('TryAga1n','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=TryAga1n" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>OttoDeFix пишет:<br>Я хочу понять, как можно отловить проверку </I><br>CreateFile, ReadFile, MapFileAndCheckSum<br><br>Если хочешь съесть арбуз, нужно думать как арбуз. Читать от корки до корки: <noindex><a href="http://rsdn.ru/article/files/classes/selfcheck.xml" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354568&amp;user=31275&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=5" class="addthx" data-post="354568"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 20:52 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>TryAga1n пишет:<br>CreateFile, ReadFile, MapFileAndCheckSum </I><br><br>.. MapViewOfFile ..<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354569&amp;user=35473&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=6" class="addthx" data-post="354569"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 21:07 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>TryAga1n пишет:<br>Если хочешь съесть арбуз, нужно думать как арбуз. Читать от корки до корки: </I><br>имхо хрень.. <br>есть старый баян.. еще с времен доса.. &quot;ловля на дрозофила&quot; и неебет<br>суть в чем.. заменяеш 1 байт.. и смотриш.. работает ли твоя прога.. если нет.. ищеш другое место.. если да. то варианта 2. либо чтение памяти, либо чтения файла. ВСЕ!!!
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=354570&amp;user=17319&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=7" class="addthx" data-post="354570"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 21:09 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>VodoleY пишет:<br>суть в чем.. заменяеш 1 байт..  </I><br><br>Так ТС так и делал - заменил сумму в упакованном файле. Функционал при этом исчез.<br>С его слов.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354571&amp;user=35473&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=8" class="addthx" data-post="354571"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 21:16 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>dosprog пишет:<br> Функционал при этом исчез. </I><br>более тонкий подход.. это менять в памяти... если функционал остался.. значит образ файла проверяется? или на оборот.. на ЕР стоим.. и меняем в памяти данные на оригинал.. узнаем каким хером чекается проверка
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=354572&amp;user=17319&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=9" class="addthx" data-post="354572"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 21:24 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>VodoleY пишет:<br>узнаем каким хером чекается проверка  </I><br><br>В общем, надо смотреть на файл. Кстати, нет ли там оверлея, где записана сумма. Иначе я не представляю, как такое можно сделать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354573&amp;user=35473&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=10" class="addthx" data-post="354573"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]DimitarSerg[/b]','')">DimitarSerg</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/24946.png" alt=""><br><span class=txtSm>Ранг: 253.5 (наставник), 684thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.26'>Активность: 0.26<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=24946">Участник</a><br><font color=blue>radical</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 21:35 <br><script type="text/javascript">QU('DimitarSerg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DimitarSerg" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>OttoDeFix пишет:<br>Есть цифровая подпись - не знаю может ли она на что-то влиять </I><br>Да. wintrust.WinVerifyTrust (юзается у продуктов MC &amp; Renox), тоже под UPX
<br><br><font size="1"><i>-----<br>ds</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=354574&amp;user=24946&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=11" class="addthx" data-post="354574"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]OttoDeFix[/b]','')">OttoDeFix</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39077">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 22:09 <br><script type="text/javascript">QU('OttoDeFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OttoDeFix" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>TryAga1n пишет:<br>Читать от корки до корки </I><br>Спасибо за доку, почти то что искал, еще бы crackme желательно с примером решения.<br><I>dosprog пишет:<br>MapViewOfFile </I><br>Это как у asprotect? А где можно прочитать, как с ее помощью осуществляется проверка?<br><I>VodoleY пишет:<br>более тонкий подход.. это менять в памяти... </I><br>В памяти все норм, с помощью загрузчика (который патчит процесс упакованного файла на возможность запуска второго окна) все нормально, открыто два окна и есть связь.<br>Всем еще раз спасибо, пойду читать статью и поищу инфу по поводу  MapViewOfFile
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354575&amp;user=39077&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=12" class="addthx" data-post="354575"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]OnLyOnE[/b]','')">OnLyOnE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 22:12 <br><script type="text/javascript">QU('OnLyOnE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OnLyOnE" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>DimitarSerg пишет:<br>Да. wintrust.WinVerifyTrust (юзается у продуктов MC &amp; Renox), тоже под UPX  </I><br>Гадаем на кофейной гуще? Пусть ТС выкладывает дистриб или весь словесный понос не имеет смысла. <img src="img/smilies/s11.gif" alt="">
<br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=354576&amp;user=1989&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=13" class="addthx" data-post="354576"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 22:36 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>OttoDeFix пишет:<br>А где можно прочитать, как с ее помощью осуществляется проверка? </I><br><br>Что там читать.. В памяти по возвращаемому адресу оказывается целиком весь рассматриваемый файл.<br>Это такой упрощённый (для юзера) вариант, заменяющий буферизированное чтение файла.<br>Дальше в зависимости от собственной фантазии можно проверять его как угодно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354579&amp;user=35473&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=14" class="addthx" data-post="354579"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]OttoDeFix[/b]','')">OttoDeFix</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39077">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 22:59 <br><script type="text/javascript">QU('OttoDeFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OttoDeFix" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>dosprog пишет:<br>В памяти по возвращаемому адресу оказывается целиком весь рассматриваемый файл. </I><br>Точнее в EAX адрес начала. Уже разобрался, дальше вызывается функция для подсчета CRC.<br>Я не совсем новичек, просто этим не занимался 8 лет, с трудом но вспоминается былое.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354582&amp;user=39077&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=15" class="addthx" data-post="354582"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 апреля 2015 23:37 &middot; Поправил: Kindly <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>OttoDeFix</b>, может быть реализована кастомная проверка, может проверяться по наличии определенной сигнатуры упакованного файла и т.д. <br>Смотреть надо, а не гадать.
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=354585&amp;user=1883&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=16" class="addthx" data-post="354585"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]unknownproject[/b]','')">unknownproject</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.1 (постоянный), 247thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.52'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=27422">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 апреля 2015 05:45 <br><script type="text/javascript">QU('unknownproject','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unknownproject" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Зачем ее обходить вообще ? <img src="img/smilies/s11.gif" alt=""> Пускаешь на исполнение в отладчике и секцию с кодом фолловишь в дизассемблер.Все.Делать с кодом чо хошь.
<br><br><font size="1"><i>-----<br>TEST YOUR MIGHT</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=354590&amp;user=27422&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=17" class="addthx" data-post="354590"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]OttoDeFix[/b]','')">OttoDeFix</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39077">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 апреля 2015 19:14 &middot; Поправил: OttoDeFix <br><script type="text/javascript">QU('OttoDeFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OttoDeFix" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
В общем, чет я запутался в этой проге, вот ссылка <noindex><a href="http://rghost.ru/8Jy5fsfGh" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex> гляньте у кого время есть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354606&amp;user=39077&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=18" class="addthx" data-post="354606"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 апреля 2015 19:58 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>OttoDeFix пишет:<br>В общем, [..] </I><br><br>В общем, запускать у себя её не буду, нету времени.<br>Но чтение обычным ReadFile, подсчёт суммы и сравнение её с данными, записанными в оверлее (80 dec. байтов).<br>Имхо
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354610&amp;user=35473&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=19" class="addthx" data-post="354610"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39077" title="21-04-2015 09:25, ранг:1.2" target="_blank">OttoDeFix</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 апреля 2015 22:42 &middot; Поправил: Kindly <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>OttoDeFix</b> (nastya), если не хочешь возиться с вычислениями перенаправляй проверку на копию оригинала через GetModuleFileNameA, либо делай что-то с проверками начиная отсюда: 009A1D78<br>Наверное, врядли прога даст запатчить напрямую, но как вариант попробуй подменить требуемые данные.<br>Суть топика помочь, а не сделать - ведь так? <img src="img/smilies/s2.gif" alt="">
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=354612&amp;user=1883&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=20" class="addthx" data-post="354612"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=39077" title="21-04-2015 09:24, ранг:1.2" target="_blank">OttoDeFix</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]OttoDeFix[/b]','')">OttoDeFix</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39077">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 апреля 2015 06:15 &middot; Поправил: OttoDeFix <br><script type="text/javascript">QU('OttoDeFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OttoDeFix" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>dosprog пишет:<br>Но чтение обычным ReadFile, подсчёт суммы и сравнение её с данными, записанными в оверлее (80 dec. байтов) </I><br>Блин... оверлей! Извини не заметил твое сообщение, где ты про оверлей спрашивал, а сейчас глянул в упакованном экзешние.<br><I>Kindly пишет:<br>если не хочешь возиться с вычислениями перенаправляй проверку на копию оригинала через GetModuleFileNameA, либо делай что-то с проверками начиная отсюда: 009A1D78 </I><br>Уфф... ну значит я в правильном направлении шел, как раз разбирал функцию по адресу 9A1D8D - после ее выполнения в стек заносится размер файла в юникоде, но без оверлея (в распакованном, оверлея нет) я и заплутал.<br><I>Kindly пишет:<br>Суть топика помочь, а не сделать - ведь так? </I><br>Это точно, иначе интерес потеряется, я за эту прогу взялся ради любопытства (увидел на компе пользователя не знакомый софт) и решил поковырять.<br><br>P.S. Как можно организовать с помощью патча автосмену имени объекта mutex?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354616&amp;user=39077&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=21" class="addthx" data-post="354616"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 апреля 2015 11:19 <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>OttoDeFix пишет:<br>[..] как раз разбирал функцию по адресу 9A1D8D - после ее выполнения в стек заносится размер файла в юникоде, но без оверлея (в распакованном, оверлея нет) [..] </I><br><br>В распакованном оверлей есть.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354625&amp;user=35473&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=22" class="addthx" data-post="354625"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]OttoDeFix[/b]','')">OttoDeFix</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39077">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 апреля 2015 12:19 <br><script type="text/javascript">QU('OttoDeFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OttoDeFix" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>dosprog пишет:<br>В распакованном оверлей есть. </I><br>Откуда он там возьмется? При снятии дампа, он отлетает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354628&amp;user=39077&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=23" class="addthx" data-post="354628"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 апреля 2015 12:24 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>OttoDeFix пишет:<br>Откуда он там возьмется? При снятии дампа, он отлетает.  </I><br><br>Какое снятие дампа?.. Используйте команду<br>C&gt; <b>UPX -D shareman.exe</b><br><br>Специально же сделано, чтоб было удобнее<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354629&amp;user=35473&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=24" class="addthx" data-post="354629"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]OttoDeFix[/b]','')">OttoDeFix</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39077">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2015 11:36 <br><script type="text/javascript">QU('OttoDeFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OttoDeFix" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Всем спасибо!<br>Разобрался в алгоритме, сгенерил правильный оверлей, прикрепил к дампу и все пошло-поехало.<br><br>P.S. Тему пока не закрываю, так как осталось еще одна прога упомянутая в начале.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354664&amp;user=39077&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=25" class="addthx" data-post="354664"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Kindly[/b]','')">Kindly</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/1883.jpg" alt=""><br><span class=txtSm>Ранг: 275.9 (наставник), 340thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.13'>Активность: 0.22=0.22</span><br>Статус: <a href="action=userinfo&amp;user=1883">Участник</a><br><font color=blue>RBC</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2015 12:04 <br><script type="text/javascript">QU('Kindly','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kindly" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>OttoDeFix пишет:<br>осталось еще одна прога упомянутая в начале.  </I><br>ну так выкладывай
<br><br><font size="1"><i>-----<br>Array[Login..Logout] of Life</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=354667&amp;user=1883&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=26" class="addthx" data-post="354667"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]OttoDeFix[/b]','')">OttoDeFix</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.23'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=39077">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2015 16:46 <br><script type="text/javascript">QU('OttoDeFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OttoDeFix" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
Подскажите, как в ольке отловить чекбос и нажатие на кнопку?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354673&amp;user=39077&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=27" class="addthx" data-post="354673"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 апреля 2015 16:54 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23525.html&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>OttoDeFix</b><br><noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14847" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=354674&amp;user=18316&amp;forum_n=5&amp;topic=23525.html&amp;page=0&amp;anchor=28" class="addthx" data-post="354674"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите с проверкой целостности кода</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#29" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="23525">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23525" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
