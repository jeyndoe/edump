<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Вызов API-функций из OllyScript - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Мне нужно получить при выполнении скрипта хэндл текущего процесса. Пробывал через последовательность FindWindow, GetWindowProcessID, OpenProcess, но возникает проблема с параметрами FindWindow: нет ни класса, ни имени окна.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=44014'>user99</a>, <a target='_blank' href='?action=userinfo&amp;user=7823'>ManHunter</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вызов API-функций из OllyScript</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2005 06:33 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Мне нужно получить при выполнении скрипта хэндл текущего процесса.  Пробывал через последовательность FindWindow, GetWindowProcessID, OpenProcess, но возникает проблема с параметрами FindWindow: нет ни класса, ни имени окна. OllyDbd предоставляет данные об ИД потока (вкладка Thread), но это значение почему-то не правильное (PE-редактор указывает на другое значение).
<br>Если ли какие-нибудь другие варианты получения хэндла?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42164&amp;user=1631&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=1" class="addthx" data-post="42164"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Cigan[/b]','')">Cigan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=208">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2005 15:08 <br><script type="text/javascript">QU('Cigan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Cigan" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
А ты попробуй через (GetModuleHandleA,NULL)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42193&amp;user=208&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=2" class="addthx" data-post="42193"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2005 00:53 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>tar4 пишет:
<br>Мне нужно получить при выполнении скрипта хэндл текущего процесса. </I>
<br>ты лучше напиши зачем это надо ;) я много скриптов писал к олли, но получать идентификатор процесса через апи как-то надобности небыло =), единтственно в скрипте для армы надо было что-то подобное (идентификатор второго процесса, но там его можно получить перехватив скриптом оригинальную функцию)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42237&amp;user=15&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=3" class="addthx" data-post="42237"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2005 05:56 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>Mario555 пишет:
<br>ты лучше напиши зачем это надо </I>
<br>Хочу просканировать виртуальные области, созданные протектором. В последнем аспре их много. Эти области чередуются с участками невыделенной памяти. При использовании  функций find и fingop, при обращении к невыделенным участкам памяти,  возникает ошибка. Чтобы этого не происходило, решил для проверки сначало использовать ReadProcessMemory, которая возвращает 0, если память не выделена. Ну а для ее использования, нужен хэндл процесса. Впрочем, может как-то иначе можно решить этот вопрос.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42243&amp;user=1631&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=4" class="addthx" data-post="42243"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2005 06:30 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Ты же перехватываеш VirtualAlloc, так используй его.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42244&amp;user=2420&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=5" class="addthx" data-post="42244"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2005 08:27 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>SergSh пишет:
<br>Ты же перехватываеш VirtualAlloc, так используй его </I>
<br>Нет, я хочу сканировать эти участки, стоя на ОЕР (ну или на секции кода), в статическом режиме не запуская прогу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42249&amp;user=1631&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=6" class="addthx" data-post="42249"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2005 15:58 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
с глючным файндом оллискрипта такое точно не сделаешь ;) и вообще это будет работать _очень_ долго... лучше получай адреса страниц динамически ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42309&amp;user=15&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=7" class="addthx" data-post="42309"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]arnix[/b]','')">arnix</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 210.5 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.14<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 ноября 2005 17:35 &middot; Поправил: arnix <br><script type="text/javascript">QU('arnix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=arnix" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>tar4 пишет:
<br>Хочу просканировать виртуальные области, созданные протектором. В последнем аспре их много. Эти области чередуются с участками невыделенной памяти. При использовании функций find и fingop, при обращении к невыделенным участкам памяти, возникает ошибка. Чтобы этого не происходило, решил для проверки сначало использовать ReadProcessMemory, которая возвращает 0, если память не выделена. Ну а для ее использования, нужен хэндл процесса. Впрочем, может как-то иначе можно решить этот вопрос. </I>
<br>
<br>Вместа OllyScript используй плагин OllyMachine (аналог OllyScript), там можно сделать например так (из дока):
<br>
<br>__asm
<br>{
<br>mov eax, 1
<br>push 0
<br>call ExitProcess
<br>}
<br>
<br>Поправка:
<br>Я еще посмотрел в доке, можно и так:  INVOKE Api_Name, parameter1, parameter2, ...
<br>
<br>приаттачил.
<br>
<br><img src="img/attach.gif" alt=""> <a href="./files/eb74_OM_0.20.RAR">eb74_OM_0.20.RAR</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42318&amp;user=26&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=8" class="addthx" data-post="42318"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]gloom[/b]','')">gloom</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 192.3 (ветеран), 18thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11">Участник</a><br><font color=blue>stoned machine-gunner</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2005 01:43 <br><script type="text/javascript">QU('gloom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=gloom" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>arnix</b>
<br>да, это уже круче =) спасибо за новость
<br><br><font size="1"><i>-----<br>once you have tried it, you will never want anything else</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=42346&amp;user=11&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=9" class="addthx" data-post="42346"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2005 05:49 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Mario555 пишет:
<br> глючным файндом оллискрипта такое точно не сделаешь ; </I>
<br>Да, я то же убедился, что он сильно глючит. Но сейчас новый автор вроде взялся за его сопровождение,
<br>что внушает некоторый оптимизм.
<br>В принципе, скрипт я написал. Единственное, что мне не нравится, так это то, что нужно после его выполнения прогу перегружать и править значение PID (OpenProcess). А это очень неудобно. Поэтому сейчас актуально автоматическое получение ID  процесса. Заметил, что при разных PID хэндл процесса
<br>почему-то остается одним и тем же для одной проги.
<br>Что касается  OllyMachine, я его видел, по моему была только одна версия, обновления не было. 
<br>И все равно, это не решает моего вопроса. Как получить ID  процесса при выполнении скрипта?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42359&amp;user=1631&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=10" class="addthx" data-post="42359"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2005 11:15 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
ну дык GetCurrentProcessId получаешь PID дальше OpenProcess и получаешь Handle ;) 
<br>
<br>PS всё таки твой способ изврат ибо динамически получается проще и быстрее.
<br>PPS саму GetCurrentProcessId  вызывать необязательно, проще взять значение PID оттуда откуда она его берёт, ведь например в XPSP2 весь её код это:
<br><code>7C80994E  MOV EAX,DWORD PTR FS:[18]
<br>7C809954  MOV EAX,DWORD PTR [EAX+20]
<br>7C809957  RETN</code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42366&amp;user=15&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=11" class="addthx" data-post="42366"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2005 12:28 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Mario555 пишет:
<br> GetCurrentProcessId получаешь PID дальше </I>
<br>Господи, так просто. Я же работал с этой функцией. Спасибо за подсказку. Сейчас вроде все работает.
<br>А насчет того, что проще динамически получать нужную информацию - возможно. 
<br>Но я написал так и он получился совсем простой. Весь смысл: просканировать все области, созданные
<br>протектором и вывести в лог адреса входов в ВМ для последующего анализа (типа в области 00d40000-00d41000 присутствует 10 вызовов типа Call 01200000, а в следующей области  - столько то и т.д.).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42376&amp;user=1631&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=12" class="addthx" data-post="42376"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 ноября 2005 12:42 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>tar4 пишет:
<br>Но я написал так и он получился совсем простой. Весь смысл: просканировать все области, созданные 
<br>протектором и вывести в лог адреса входов в ВМ для последующего анализа (типа в области 00d40000-00d41000 присутствует 10 вызовов типа Call 01200000, а в следующей области - столько то и т.д.). </I>
<br>гы, ну сам подумай, память в которой находится вход в ВМ аллоченная, следовательно проту полюбому надо прописывать эти &quot;call VM&quot; во _все_ места где они должны быть. И делает он это в одном небольшом цикле, вклиниваешься в этот цикл и получаешь все адреса входов в ВМ без всяких поисков сигнатур и т.п. (можно тут сразу и фиксить код). Также можно получить адреса всех вызовов call aspr_import ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42705&amp;user=15&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=13" class="addthx" data-post="42705"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 ноября 2005 13:38 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>Mario555 пишет:
<br> делает он это в одном небольшом цикле </I>
<br>Интересная мысль, я как-то с этой стороны не подходил к распаковки. Просто, тот путь, по которому я иду - уже мной апробирован и я знаю,  как распаковать прогу с ВМ . Но там слишком много ручной работы, вот и пытаюсь с помощью скриптов хоть как-то ее автоматизировать. Нет достойных инструментов: OllyScript  - интересный плугин, но еще много глюков и недостаточно возможностей. Самому писать плагин - можно, но есть неудобства в отладке и т.д.
<br>Кстати, может будет интересно. Просканировав с помощью скрипта одну прогу с ВМ, упакованную аспром, я обнаружил более 10 зааллоченных секций, в которых находилось от 10 до 100 вызовов типа Call VM !!!Вручную это не осилишь.
<br>Так может немного подробнее скажешь, где искать этот &quot;заветный&quot; цикл?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42829&amp;user=1631&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=14" class="addthx" data-post="42829"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]sanniassin[/b]','')">sanniassin</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.0 (посетитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=42">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 ноября 2005 16:23 <br><script type="text/javascript">QU('sanniassin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sanniassin" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>tar4 пишет:
<br>где искать этот &quot;заветный&quot; цикл? </I>
<br>брякайся на VirtualAlloc и смотри, когда пойдут адреса по к-рым будет спёртый код лежать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42843&amp;user=42&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=15" class="addthx" data-post="42843"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Asterix[/b]','')">Asterix</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 450.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=58">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 ноября 2005 19:36 <br><script type="text/javascript">QU('Asterix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Asterix" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>tar4 пишет:
<br> Самому писать плагин - можно, но есть неудобства в отладке и т.д. </I>
<br>
<br>какие такие неудобства в отладке? ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42858&amp;user=58&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=16" class="addthx" data-post="42858"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2005 05:35 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Asterix пишет:
<br>какие такие неудобства в отладке </I>
<br>Ну а как трассировать пошагово код Dll во время ее работы?
<br><I>sanniassin пишет:
<br>брякайся на VirtualAlloc и смотри, когда пойдут адреса  </I>
<br>Ты имеешь ввиду процесс создания заалоченных областей? Во время работы протектора, их может создаваться достаточно много. Не совсем понимаю, как может помочь использование VirtualAlloc. Разве только для получения списка заалоченных областей.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42897&amp;user=1631&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=17" class="addthx" data-post="42897"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Asterix[/b]','')">Asterix</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 450.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=58">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2005 06:12 <br><script type="text/javascript">QU('Asterix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Asterix" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>tar4 пишет:
<br>Ну а как трассировать пошагово код Dll во время ее работы? </I>
<br>
<br>нормально так трассировать, как и обычный exe
<br>можно ставить проверочные бряки
<br>можно юзать дебажные макросы для вывода дебажной инфы
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42900&amp;user=58&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=18" class="addthx" data-post="42900"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]sanniassin[/b]','')">sanniassin</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.0 (посетитель), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=42">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2005 07:48 <br><script type="text/javascript">QU('sanniassin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sanniassin" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>tar4 пишет:
<br>Во время работы протектора, их может создаваться достаточно много. </I>
<br>дык, найди цикл выделения памяти специально под спёртый код с помощью бряков на VirtualAlloc, и уже цикл копай
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42905&amp;user=42&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=19" class="addthx" data-post="42905"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2005 15:17 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Asterix пишет:
<br>можно ставить проверочные бряки </I>
<br>Спасибо, я понял как это делать. Как-то раньше до отладки Dll  руки не доходили.
<br><I>sanniassin пишет:
<br>найди цикл выделения памяти специально под спёртый код </I>
<br>Поискал, не нашел. Вернее, место, где выделяется память под секцию, из которой, в свою очередь,
<br>осуществляются вызовы ВМ - я, конечно, нашел. Но что потом делать, я пока не знаю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42967&amp;user=1631&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=20" class="addthx" data-post="42967"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2005 21:09 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3247.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>tar4 пишет:
<br>Поискал, не нашел. Вернее, место, где выделяется память под секцию, из которой, в свою очередь, 
<br>осуществляются вызовы ВМ - я, конечно, нашел. Но что потом делать, я пока не знаю. </I>
<br>бряк на запись поставить на место где будет любой из call VM ;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43171&amp;user=15&amp;forum_n=1&amp;topic=3247.html&amp;page=0&amp;anchor=21" class="addthx" data-post="43171"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вызов API-функций из OllyScript</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#22" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="3247">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=3247" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
