<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Отладка удаленного потока - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет, у меня такая проблема: Инжектю кусок кода в стиле шел-кода в експлорер. Потом создаю через CreateRemoteThread() удаленный поток. Созданный поток получает управление и тут експлорер падает и перезапускается. Вобщем">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Отладка удаленного потока</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]kap00stik[/b]','')">kap00stik</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.38'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28092">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 16:53 <br><script type="text/javascript">QU('kap00stik','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kap00stik" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем привет,<br><br>у меня такая проблема: Инжектю кусок кода в стиле шел-кода в експлорер. Потом создаю через CreateRemoteThread() удаленный поток. Созданный поток получает управление и тут експлорер падает и перезапускается. Вобщем что-то где-то коряво работает.<br><br>Мой вопрос: Как, чем и можно ли вообще отлаживать уже именно этот созданный поток??? OllyDbg???<br>Конечно можно отладить сам инжектируемый код чтоб работал ровно а потом уже его инжектить, но хотелось-бы<br>именно поток.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277618&amp;user=28092&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=1" class="addthx" data-post="277618"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 17:24 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
зацикливай поток и аттачся к процессу.
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277619&amp;user=2981&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=2" class="addthx" data-post="277619"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=12088" title="22-02-2011 15:20, ранг:65.1" target="_blank">Sunzer</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 17:25 <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Можно поставить бряк на StartAddress до вызова CreateRemoteThread в том же OllyDbg.
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277620&amp;user=24900&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=3" class="addthx" data-post="277620"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]kap00stik[/b]','')">kap00stik</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.38'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28092">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 18:14 <br><script type="text/javascript">QU('kap00stik','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kap00stik" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>Flint пишет:<br>зацикливай поток и аттачся к процессу </I><br><br>Вот именно отсюда пожалуйста поподробнее.<br>Что именно, как когда? Куда тыкать?<br><br>Короче ставлю бряк на CreateRemoteThread() так?<br>а дальнейшие действия???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277621&amp;user=28092&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=4" class="addthx" data-post="277621"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Sunzer[/b]','')">Sunzer</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12088.gif" alt=""><br><span class=txtSm>Ранг: 67.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.06'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 18:20 <br><script type="text/javascript">QU('Sunzer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sunzer" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
А нельзя замороженый поток создать, к нему приаттачиться, и дебажить?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277622&amp;user=12088&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=5" class="addthx" data-post="277622"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 18:21 &middot; Поправил: ajax <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>kap00stik</b><br>В начале шелл кода типа EB FE (jump на себя), потом аттачься чем хочешь к процессу, и отлаживай.<br><b>Sunzer</b><br>Был бы смысл <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277623&amp;user=8830&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=6" class="addthx" data-post="277623"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 18:26 <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Int 3.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277625&amp;user=17964&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=7" class="addthx" data-post="277625"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 18:36 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>Clerk</b><br>При наличии отладчика режима ядра <img src="img/smilies/s1.gif" alt="">  Иногда вещи не совместимы с варей, а на реальном компе - нах-нах, еще закачки загадит <img src="img/smilies/s1.gif" alt=""><br><b>kap00stik</b><br>При зацикливании тормоза могут быть, предупреждаю.
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277628&amp;user=8830&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=8" class="addthx" data-post="277628"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]kap00stik[/b]','')">kap00stik</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.38'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28092">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 18:41 <br><script type="text/javascript">QU('kap00stik','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kap00stik" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Clerk пишет:<br>Int 3.  </I><br><br>вот это то что надо, спасибо всем!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277630&amp;user=28092&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=9" class="addthx" data-post="277630"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Sunzer[/b]','')">Sunzer</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12088.gif" alt=""><br><span class=txtSm>Ранг: 67.4 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.06'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 18:47 <br><script type="text/javascript">QU('Sunzer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sunzer" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>ajax пишет:<br>При зацикливании тормоза могут быть, предупреждаю. </I><br><br>invoke Sleep, -1 ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277631&amp;user=12088&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=10" class="addthx" data-post="277631"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]kap00stik[/b]','')">kap00stik</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.38'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28092">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 19:18 &middot; Поправил: kap00stik <br><script type="text/javascript">QU('kap00stik','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kap00stik" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Так ну в общем с отладкой разобрались. Отладили так сказать, во время отладки у меня чуть не выпрыгнули глаза<img src="img/smilies/s14.gif" alt=""><br>Короче такое дело, этот код работал безотказно на XP SP2 и 3. После долгого перерыва опять зачасались руки и решил погадить немного. Откопал етот сурс, компилю его теперь уже под Win 7 все ок, при запуске вылетает експлорер (ну вы уже знаете)<br><br>Лажу код, прохожу нахождение kernel32.dll базы все нормально. (адрес: 0х75870000)<br>Нахожу адрес GetProcAddress(),  (адресс функции: 0х75876C5B)  сохраняю его для далнейшего пользования<br>но оставляю его в регистре EAX.<br><br>pushe на стэк адрес базы и адресс строки с именем функции которую хочу найту и вызываю<br>GetProcAddress()<br>вот тут-то и начинается самое интересное:<br>Процесс терминируетса, acess violation при вызове адреса из EAX. (он какого-то хера стал не 0х75876C5B а 0xFFFFFFFF).<br><br>Проделывал сию операцию много раз, результат один и тот-же.<br>Непосредственно перед вызовом, лучше сказать во время вызова адресс вызываемой функции заменяетса прямо у меня на глазах с 0х75876C5B на 0xFFFFFFFF.<br>Вопрос: кто или что шутит со мной такие шутки???<br>При этом при всем этот-же код опять-таки работает под win xp без проблем.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277632&amp;user=28092&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=11" class="addthx" data-post="277632"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 19:19 &middot; Поправил: ELF_7719116 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Sunzer</b><br>за<br>himself: jmp himself<br>разговор был, если я правильно понял. Цпу на полную грузит(по крайней мере если поток на ядро и ядер в процессоре больше одного то как таковых тормозов не будет)<br><b>kap00stik</b><br>Трасиш F8 в ольке, доходиш до CALL EAX, F8 И EAX=-1 вместо GetProc...? Просто так регист не может измениться!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277633&amp;user=26651&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=12" class="addthx" data-post="277633"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 20:01 &middot; Поправил: neomant <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>kap00stik</b>, выкладывай что-ли кодом где у тебя исключение вываливается, а то со слов нихрена не понять.
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277634&amp;user=24900&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=13" class="addthx" data-post="277634"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ToBad[/b]','')">ToBad</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/702.gif" alt=""><br><span class=txtSm>Ранг: 450.3 (мудрец), 13thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=702">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 22:16 <br><script type="text/javascript">QU('ToBad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ToBad" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>kap00stik пишет:<br>кто или что шутит со мной такие шутки??? </I><br><br>Видимо другой шел-код от одного из твоих товарищей.... <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277640&amp;user=702&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=14" class="addthx" data-post="277640"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]kap00stik[/b]','')">kap00stik</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.38'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28092">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 23:09 &middot; Поправил: kap00stik <br><script type="text/javascript">QU('kap00stik','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kap00stik" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Ну вот я и разобрался.<br>Дело в том что функция возвращавшая мне Kernel Image Base адрес возвращает мне какойто левый адрес.<br>Выходит что код, не плохо послуживший мне под win xp отказывается это делать под win 7, ну и походу под висту.<br>использовал PEB метод описанный здесь:<br><noindex><a href="http://www.hick.org/code/skape/papers/win32-shellcode.pdf" rel="nofollow" target="_blank">http://www.hick.org/code/skape/papers/win32-shellcode.pdf</a></noindex><br><br>Вопрос: ну и что теперь делать с этим Windows 7 ???<br>Как окапаться на нем?<br>Надо еще два другие SEH i topstack метода поробовать.<br><br>А может кто уже сталкивался с этим под семеркой???<br>Всмысле как писать базонезависимый код работающий также в win vista и 7???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277645&amp;user=28092&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=15" class="addthx" data-post="277645"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Clerk[/b]','')">Clerk</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 255.8 (наставник), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.86'>Активность: 0.15<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=17964">Участник</a><br><font color=blue>vx</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2011 23:45 &middot; Поправил: Clerk <br><script type="text/javascript">QU('Clerk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Clerk" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>kap00stik</b><br>В начале про термины. То что вы назвали шелл&#039;кодом это код с плавающей базой судя по всему. Реальный шелл получает управление при переполнении локальных буферов, его не вызывают через создание удалённых потоков. У вас же пикод, таким образом размер его не критичен(для шелла он критичен). Отсюда нужно и плясать. Незачем брать кернел из загрузчика(в 7 там вроде уже kernelbase), он должен быть найден средствами нэйтива. Тоесть LdrGetDllHandle() etc. Не следует людей путать <img src="img/smilies/s13.gif" alt=""><br><br>&gt;  как писать базонезависимый код работающий также в win vista и 7???<br>Также как и привязанный к базе и работающий в 7, только оформлять надлежащим образом. Так как пикод не морфится, то можно и фиксапы использовать. Выполнить релокацию вручную. В более полноценном варианте используется загрузка из памяти, а весь функционал представляет собой длл.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277648&amp;user=17964&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=16" class="addthx" data-post="277648"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]kap00stik[/b]','')">kap00stik</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.38'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28092">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2011 01:51 <br><script type="text/javascript">QU('kap00stik','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kap00stik" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Clerk пишет:<br>В начале про термины. То что вы назвали шелл&#039;кодом это код с плавающей базой судя по всему. Реальный шелл получает управление при переполнении локальных буферов, его не вызывают через создание удалённых потоков. У вас же пикод, таким образом размер его не критичен(для шелла он критичен).  </I><br><br>Спасибо за поправку, но я помоему говорил что код толко в стиле shell кода. <br>А насчет терминов ты прав, надо называть вещи своими именами<img src="img/smilies/s5.gif" alt=""> (если конечно знаеш их имена :s6<img src="img/smilies/s1.gif" alt=""><br><br><I>Clerk пишет:<br>Незачем брать кернел из загрузчика(в 7 там вроде уже kernelbase)</I><br><br>Вот тут нихрена не понял, ты имееш в виду что программа носитель сама находит все адреса, прописывает их в placeholder&#039;ы в инжектируемом коде и потом его инжектит? Типа чтобы внедренный код попу не морщил с поиском адресов а сразу принимался за работу? (В принципе если нихера не разберусь, то пожалуй так я и сделаю)<br><br>P.S. Ребят я не русский, не пинайте меня<img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277658&amp;user=28092&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=17" class="addthx" data-post="277658"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]kannabis[/b]','')">kannabis</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.41'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=27949">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2011 08:03 <br><script type="text/javascript">QU('kannabis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kannabis" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
В начале шеллкода ставь int 3, в софтайсе делай i3here on и отлаживай сколько влезет. Проверено, работает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277665&amp;user=27949&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=18" class="addthx" data-post="277665"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2011 09:38 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>kap00stik</b><br><i class=x> Незачем брать кернел из загрузчика(в 7 там вроде уже kernelbase), он должен быть найден средствами нэйтив</i><br>Он говорит что в Windows 7 кроме kernel32.dll откуда вы берете свои API, есть kernelbase.dll(туда перенесена часть процедур). Нейтив - использовать ntdll.dll для получения низкоуровневых функций(в kernel32 лежат &quot;wrappers&quot; т.е. обвертки низкоуровневых API). Например GetModuleHandle() есть обвертка LdrGetDllHandle(). Впрочем Native API требуют unicode строки и заполнения специальных структур, удобно ли вам их будет использовать, незнаю. Вообще как уже кто-то успел сказать, Win 7 не самая лучшая ось для реверсера.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277666&amp;user=26651&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=19" class="addthx" data-post="277666"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]kap00stik[/b]','')">kap00stik</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.38'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=28092">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2011 14:21 &middot; Поправил: kap00stik <br><script type="text/javascript">QU('kap00stik','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kap00stik" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=17799.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>ELF_7719116 пишет:<br>Он говорит что в Windows 7 кроме kernel32.dll откуда вы берете свои API, есть kernelbase.dll(туда перенесена часть процедур).  </I><br>Вот этого я не знал (век живи, век учись), надо покопаться в ней, только один хрен не понимаю, зачем перенесенны, и почему тогда только часть процедур... (ну это походу одному ms известно).<br>Вот именно это походу и делает мой старый код не работоспособным. Потому-что например LoadLibraryA() я в семерке в kernel32.dll уже не нашел <img src="img/smilies/s14.gif" alt=""> Ну чтоже, гимороя добавляется.<br><br><I>ELF_7719116 пишет:<br>Нейтив - использовать ntdll.dll для получения низкоуровневых функций(в kernel32 лежат &quot;wrappers&quot; т.е. обвертки низкоуровневых API). Например GetModuleHandle() есть обвертка LdrGetDllHandle(). Впрочем Native API требуют unicode строки и заполнения специальных структур, удобно ли вам их будет использовать, незнаю.  </I><br><br>Да это-то в принципе понятно, только гимороя шибко много.<br><br><I>ELF_7719116 пишет:<br>Вообще как уже кто-то успел сказать, Win 7 не самая лучшая ось для реверсера.  </I><br>Мдаааа, походу так есть, но если что то я не реверсер. Просто как уже писал, после долгого перерыва (лет 5-6) захотелось опять покодить, кинулся, а не один софт из времен win xp под семеркой не работает<img src="img/smilies/s10.gif" alt=""><br><br><br>Aaaaaaaaaaaaaaaaaaaaaaaaaa.<br>Ну вот я и нашел все ответы на свои вопросы, кому будет интересно смотреть здесь:<br>blog.harmonysecurity.com/2009/06/retrieving-kernel32s-base-address.html<br><br>Ну тем не менее всем спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277714&amp;user=28092&amp;forum_n=6&amp;topic=17799.html&amp;page=0&amp;anchor=20" class="addthx" data-post="277714"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Отладка удаленного потока</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#21" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="17799">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=17799" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
