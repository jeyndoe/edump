<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>WSASend в стеке - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Привет, прошу подсказать по функции WSASend - где она держит данные для отправки, фрагмент стека при остановке на её вызове: Code:       ESP0012ECC8&nbsp;&nbsp;&nbsp;00000594&nbsp;&nbsp;|Socket&nbsp;=&nbsp;5940012ECCC&nbsp;&nbsp;&">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=41144'>Adler</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> WSASend в стеке</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ohos[/b]','')">ohos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.04'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25774">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2011 00:10 <br><script type="text/javascript">QU('ohos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ohos" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Привет, прошу подсказать по функции WSASend - где она держит данные для отправки, фрагмент стека при остановке на её вызове:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_registr">ESP</span></li><li class="hl_l1"><span class="hl_number">0012ECC8</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000594</span>&nbsp;&nbsp;<span class="hl_char">|</span>Socket&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">594</span></li><li class="hl_l0"><span class="hl_number">0012ECCC</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0012ECFC</span>&nbsp;&nbsp;<span class="hl_char">|</span>pBuffers&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0012ECFC</span></li><li class="hl_l1"><span class="hl_number">0012ECD0</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000001</span>&nbsp;&nbsp;<span class="hl_char">|</span>nBuffers&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">0012ECD4</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0012ECF8</span>&nbsp;&nbsp;<span class="hl_char">|</span>pBytesSent&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0012ECF8</span></li><li class="hl_l1"><span class="hl_number">0012ECD8</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;<span class="hl_char">|</span>Flags&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_number">0012ECDC</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">200F14E0</span>&nbsp;&nbsp;<span class="hl_char">|</span>pOverlapped&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">200F14E0</span></li><li class="hl_l1"><span class="hl_number">0012ECE0</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000000</span>&nbsp;&nbsp;<span class="hl_char">\</span>Callback&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l0"><span class="hl_number">0012ECE4</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0255CF30</span></li><li class="hl_l1"><span class="hl_number">0012ECE8</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0"><span class="hl_number">0012ECEC</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0255CD00</span></li><li class="hl_l1"><span class="hl_number">0012ECF0</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0"><span class="hl_number">0012ECF4</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0255CD00</span></li><li class="hl_l1"><span class="hl_number">0012ECF8</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00000000</span></li><li class="hl_l0"><span class="hl_number">0012ECFC</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">000003F0</span></li><li class="hl_l1"><span class="hl_number">0012ED00</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">208A5010</span></li><li class="hl_l0"><span class="hl_number">0012ED04</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0255CE00</span></li><li class="hl_l1"><span class="hl_number">0012ED08</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">0255CF30</span></li><li class="hl_l0"><span class="hl_number">0012ED0C</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">000003F0</span></li><li class="hl_l1"><span class="hl_number">0012ED10</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">006D83C0</span>&nbsp;&nbsp;RETURN&nbsp;to&nbsp;Client<span class="hl_char">.</span><span class="hl_number">006D83C0</span></li>        </ol>
    </div>
</div></div>
<br><br>если я правильно понял описание функции с MSDN http://msdn.microsoft.com/en-us/library/ms742203%28v=vs.85%29.aspx , то pBuffers содержит указатель на массив данных (пакет), но где найти сам пакет, как узнать это из указателя?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=286710&amp;user=25774&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=1" class="addthx" data-post="286710"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2011 00:23 &middot; Поправил: neomant <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>0012ECCC   0012ECFC  |pBuffers = 0012ECFC</b> // указатель на массив структур WSABUF<br><b>0012ECD0   00000001  |nBuffers = 1</b> // количество таких структур<br><br>сама структура<br><b>0012ECFC   000003F0</b> // длина буфера<br><b>0012ED00   208A5010</b> // указатель на буфер<br><br>смотри передаваемый буфер по адресу <b>208A5010</b>
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=286711&amp;user=24900&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=2" class="addthx" data-post="286711"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ohos[/b]','')">ohos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.04'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25774">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2011 00:35 &middot; Поправил: ohos <br><script type="text/javascript">QU('ohos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ohos" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
1. а по адресу 208A5010 находится сам пакет или иные данные?<br><br>2. пожалуй глупый вопрос, но где адрес 208A5010 нужно искать в (дампе, стеке, коде)?<br><br>3. чтобы не блуждать вокруг напишу, что моя конечная цель найти место в коде программы где она берет введенные на экране данные, шифрует, передает WSASend для отправки серверу - правильно ли я выбрал путь &quot;реверс WSASend&quot; или есть более простой способ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=286713&amp;user=25774&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=3" class="addthx" data-post="286713"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2011 09:57 <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
1. Да, по этому адресу находятся именно передаваемые данные.<br>2. Это хоть и какой-то подозрительный, но адрес в памяти. Смотреть нужно под отладкой при бряканье на WSASend.<br>3. WSASend уж точно реверсить не стоит. Можно её использовать как отправную точку и копать назад: какие и откуда ей передавались данные для пересыли. Вашу задачу можно решить и более простыми спосабами, например, перехватом функций получения данных с контролов.
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=286734&amp;user=24900&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=4" class="addthx" data-post="286734"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2011 14:59 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>neomant</b><br>А можно подробнее про <i class=x>перехватом функций получения данных с контролов.</i>?<br><br><b>Добавлено</b><br>Понятно.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=286764&amp;user=6336&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=5" class="addthx" data-post="286764"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2011 15:04 <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
я имел в виду бряки на GetWindowText и ей подобные.
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=286765&amp;user=24900&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=6" class="addthx" data-post="286765"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ohos[/b]','')">ohos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.04'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25774">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2011 21:28 &middot; Поправил: ohos <br><script type="text/javascript">QU('ohos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ohos" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
GetWindowText и многие другие &quot;стандартные&quot; решения попросту не сработают, ведь интерфейс программы написан на lua + xml<br><br><I>neomant пишет:<br>1. Да, по этому адресу находятся именно передаваемые данные. </I><br><br>а как понять, до какого момента с начала 208A5010 будет идти пакет?<br><br>offtop у меня есть возможность в программе в нужном месте вызывать функцию возвращающую время в секундах с момента запуска компьютера, какую Win API можно брякнуть для этого?<br><br>и еще один вопрос, как на ассемблере может выглядеть псевдо (lua) код<br><br>local a = 0<br>a = a + 11<br>a = a + 11<br>a = a + 11<br>a = a + 11<br>a = a + 11<br>a = a + 11<br><br>? так как в нужном месте программы я тоже могу его подсунуть
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=286779&amp;user=25774&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=7" class="addthx" data-post="286779"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2011 22:53 &middot; Поправил: neomant <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>а как понять, до какого момента с начала 208A5010 будет идти пакет?</I><br><b>0012ECFC 000003F0</b> // длина буфера<br><b>0012ED00 208A5010</b> // указатель на буфер<br><br><I>ohos пишет:<br>какую Win API можно брякнуть для этого? </I><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;WINAPI&nbsp;GetTickCount<span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><I>ohos пишет:<br>как на ассемблере может выглядеть псевдо (lua) код </I><br>На ассемблере это будет выглядеть как интерпретатор интерпретирующий (<i class=x>каламбур</i>) скрипт LUA.<br>Если цель разобрать алгоритм шифрования, то лучше не доходить до Win32 API, а ковырять исходник на LUA, скорее всего в нём происходит шифрование и отправка.
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=286787&amp;user=24900&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=8" class="addthx" data-post="286787"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ohos[/b]','')">ohos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.04'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25774">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 июля 2011 23:03 &middot; Поправил: ohos <br><script type="text/javascript">QU('ohos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ohos" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>neomant пишет:<br>Если цель разобрать алгоритм шифрования, то лучше не доходить до Win32 API, а ковырять исходник на LUA, скорее всего в нём происходит шифрование и отправка.  </I><br><br>это конечно тоже было бы круто, но цель иная - найти место в котором данные отдаются на формирование пакета и подменить их, но вся сложность в том, что псевдо исходник луа грузится динамически, т.е. сама программа написана фактически на C/C#/C++ точно не знаю на каком из них
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=286788&amp;user=25774&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=9" class="addthx" data-post="286788"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ohos[/b]','')">ohos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.04'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25774">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2011 21:11 &middot; Поправил: ohos <br><script type="text/javascript">QU('ohos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ohos" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
я решил не создавать отдельную тему и спросить в этой же вопрос прямо относящийся к WSASend, а он таков:<br><br>если в WSASend &quot;данные&quot; уже попадают в виде пакета, то как эти самые данные ранее собираются обычно в пакет?<br><br>1. для этого есть готовые Win API, можно узнать названия?<br>2. подобный функционал пишут сами, как он обычно выглядят на ASM?<br><br>p.s. возможно Win API я уже нашел и это WSABUF http://msdn.microsoft.com/en-us/library/ms741542%28v=vs.85%29.aspx , уж слишком сильно строчка похожа на то, что надо:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>char</b></span>&nbsp;SendBuf<span class="hl_char">[</span><span class="hl_number">1024</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;Test data to send.&quot;</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>но как в неё передаются множественные данные? например сразу и строка, и число и булевые например...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=286937&amp;user=25774&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=10" class="addthx" data-post="286937"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2011 22:02 <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>ohos пишет:<br>1. для этого есть готовые Win API, можно узнать названия?</I><br>Можно посмотреть на GetWindowText, GetDlgItemText, GetDlgItemInt<br><I>ohos пишет:<br>2. подобный функционал пишут сами, как он обычно выглядят на ASM?</I><br>На асме это будет выглядеть как интерпретатор Lua и я не уверен, что копание в нём решит поставленную вами задачу.<br><I>ohos пишет:<br>но как в неё передаются множественные данные? например сразу и строка, и число и булевые например</I><br>Не вижу причин для непонимания. Передаём в одном буфере строку, за которой идёт число, за которым булевый тип.<br><br>Возможно изначальный посыл неверный? Неплохо для начала выяснить на чём писалось приложение, потом соответственно выбрать инструментарий и методы.<br>Давайте ссылку на пациента, возможно сможем что-нибудь более толковое посоветовать.
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=286942&amp;user=24900&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=11" class="addthx" data-post="286942"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ohos[/b]','')">ohos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.04'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25774">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2011 22:33 <br><script type="text/javascript">QU('ohos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ohos" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>neomant пишет:<br>Можно посмотреть на GetWindowText, GetDlgItemText, GetDlgItemInt </I><br><br>попробую, но из-за того, что интерфейс игры написан на lua + xml, думаю это может не сработать<br><br>имеется mmorpg игра Runes of Magic (программа) в которую встроен интерпретатор lua + xml кода, таким образом весь интерфейс игры написан на таких файлах<br><br>PEID сказал про игру: http://imglink.ru/show-image.php?id=9b36e7965d471ca84896df3e49ed9b03<br><br>игра весит 4 гига, скачать можно тут http://rmonline.ru/download/client/ , либо с торрентов http://rutracker.org/forum/viewtopic.php?t=2806944 (с бесплатной регистрацией), http://rutor.org/torrent/106631 (без регистрации)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=286945&amp;user=25774&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=12" class="addthx" data-post="286945"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2011 23:06 <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Да, размер впечатляет. Могу вам только посоветовать поискать в экзешнике такие строки: curl, ssl, zlib.
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=286948&amp;user=24900&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=13" class="addthx" data-post="286948"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ohos[/b]','')">ohos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.04'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25774">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2011 23:44 <br><script type="text/javascript">QU('ohos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ohos" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
нашел все строки через олли Search for &gt; All referenced text strings:<br><br>c curl там нет ничего, с ssl только две строки<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ASCII&nbsp;<span class="hl_quote">&quot;asio.ssl&quot;</span></li><li class="hl_l1"><span class="hl_quote">&quot;asio.ssl error&quot;</span></li>        </ol>
    </div>
</div></div>
<br><br>с zlib было только<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">ASCII&nbsp;<span class="hl_quote">&quot;zlib memory error&quot;</span></li><li class="hl_l1">ASCII&nbsp;<span class="hl_quote">&quot;zlib version error&quot;</span></li><li class="hl_l0">ASCII&nbsp;<span class="hl_quote">&quot;Unknown zlib error&quot;</span></li>        </ol>
    </div>
</div></div>
<br><br>это что-то дает? хотя в папке с игрой есть дллки curllib, zlib, zlib1
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=286951&amp;user=25774&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=14" class="addthx" data-post="286951"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2011 00:10 <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>ohos пишет:<br>это что-то дает? хотя в папке с игрой есть дллки curllib, zlib, zlib1</I><br>Да, даёт и многое. Т.е. уже наверняка не придётся копать WSASend, а почитать ман по curl. Посмотреть импорт в экзешнике по curl. Ман по boost::asio пригодится.
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=286954&amp;user=24900&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=15" class="addthx" data-post="286954"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]ohos[/b]','')">ohos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.04'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25774">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2011 00:55 <br><script type="text/javascript">QU('ohos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ohos" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
offtop: обязательно посмотрю их, а они отвечают за взаимодействие с текстом или его передачу с рамок? а вообще попробую поискать реализацию перехвата :GetText() метода в xml, ведь именно он вытаскивает там текст из рамки и уже передает в С++ основному коду игры
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=286955&amp;user=25774&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=16" class="addthx" data-post="286955"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2011 02:00 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>ohos пишет:<br>ель иная - найти место в котором данные отдаются на формирование пакета и подменить их </I><br>реверсите екзешник<br>учитывая что строки boost asio ssl, то найти сетевой обработчик будет легче<br>а от него уже ищите/разбирайте остальной алго<br>зная точку в программе откуда данные появляются, и имея разобраный сетевой обработчик<br>уже можно не только то что вы хотите сделать, но и отдельно крипто алго разобрать<br><br><I>ohos пишет:<br>имеется mmorpg игра Runes of Magic (программа) в которую встроен интерпретатор lua + xml кода, таким образом весь интерфейс игры написан на таких файлах </I><br>ну и пусть, вам ведь место появления данных найти нужно, а это наверняка функция в exe или dll самой игры<br>вообщем наверняка там где и функция WSASend, а может и просто send
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=286956&amp;user=15381&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=17" class="addthx" data-post="286956"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2011 13:33 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>ohos пишет:<br>а они отвечают за взаимодействие с текстом или его передачу с рамок </I><br>CURL является высокоуровневой оберткой для низкоуровневых функций работы с сокетами. Так что надо копать в сторону враппера CURL библиотеки ИМХО.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=286979&amp;user=3232&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=18" class="addthx" data-post="286979"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]ohos[/b]','')">ohos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.04'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25774">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2011 14:49 &middot; Поправил: ohos <br><script type="text/javascript">QU('ohos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ohos" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
сразу прощу прощения за очередной оффтоп:<br><br>из-за того, что интерфейс игры написан на lua + xml и вдобавок эти файлы можно легко изменять, я могу поставить встроенную в игру функцию TakeScreenshot() сразу же перед вызовом нужной мне в исходном коде интерфейса написанном на lua, TakeScreenshot() делает обычный снимок экрана, затем записывает его в .bmp файл в папку screenshots расположенную в папке игры, не проще ли будет в таком случае через перехват вызова обычных Win API с созданием файла или съемкой экрана после этого просто продолжить трассировку и попасть в нужную функцию идущую сразу за TakeScreenshot() ?<br><br>можно узнать названия Win API отвечающих за создание файлов и создание снимка экрана?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=286981&amp;user=25774&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=19" class="addthx" data-post="286981"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]ohos[/b]','')">ohos</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.4 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.04'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25774">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2011 22:22 <br><script type="text/javascript">QU('ohos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ohos" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=18415.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
я уже нашел нужные API, но мои следующие вопросы уже касаются записи логов, поэтому думаю создать другую тему и уже в ней спрашивать про логи, все отписавшимся мои благодарности нубика <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=286997&amp;user=25774&amp;forum_n=5&amp;topic=18415.html&amp;page=0&amp;anchor=20" class="addthx" data-post="286997"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> WSASend в стеке</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#21" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="18415">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=18415" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
