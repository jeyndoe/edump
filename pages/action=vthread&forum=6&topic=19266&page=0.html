<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Обработка memory (и не только) break&#039;ов с помощью VEH - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT=" Как я себе это представляю: 1. Прога ставит бряки и внедряет либу в процесс-жертву 2. Либа устанавливает VEH 3. Когда возникает исключение, прога должна каким-то образом получить от внедренной DLL-ки EXCEPTION_RECORD с кодом">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55953'>laslo</a>, <a target='_blank' href='?action=userinfo&amp;user=1288'>UniSoft</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Обработка memory (и не только) break&#039;ов с помощью VEH</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]GoldenJoe[/b]','')">GoldenJoe</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.66'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30679">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2011 21:43 &middot; Поправил: GoldenJoe <br><script type="text/javascript">QU('GoldenJoe','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GoldenJoe" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
<img src="img/smilies/s1.gif" alt=""><br>Как я себе это представляю:<br>1. Прога ставит бряки и внедряет либу в процесс-жертву<br>2. Либа устанавливает VEH<br>3. Когда возникает исключение, прога должна каким-то образом получить от внедренной DLL-ки EXCEPTION_RECORD с кодом исключения и прочей инфой. Прога должна проверить, а наш ли это бряк (а, может, совсем даже не бряк <img src="img/smilies/s1.gif" alt=""> ) и неведомым образом сообщить внедренной либе, что делать дальше (CONTINUE_SEARCH или CONTINUE_EXECUTION вернуть, например).<br><br>По первым двум пунктам вопросов нет. С 3 пунктом посложнее. Есть именованный FileMapping да event-ы, есть сокеты. А КРАСИВЫХ решений, я так понимаю, нет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295526&amp;user=30679&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=1" class="addthx" data-post="295526"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]nepwk[/b]','')">nepwk</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.8 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.66'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30692">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2011 22:17 <br><script type="text/javascript">QU('nepwk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nepwk" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Колбек зарегать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295528&amp;user=30692&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=2" class="addthx" data-post="295528"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 ноября 2011 22:26 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Шаред мем нормальное решение
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295531&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=3" class="addthx" data-post="295531"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 00:07 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Зачем, если стек есть ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295632&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=4" class="addthx" data-post="295632"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]q1nex[/b]','')">q1nex</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.92'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=22013">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 04:05 <br><script type="text/javascript">QU('q1nex','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=q1nex" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Т.е. вопрос - как организовать обмен инфой между процессами?<br>Все, что уже предложили + вообще нафиг обработчик эксепшена делать в другом процессе? Можно весь код засунуть в либу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295637&amp;user=22013&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=5" class="addthx" data-post="295637"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 05:09 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Затем, что ТС хочет сделать подобие отладчика на технологии VEH, вот и спрашивает, как управлять ядром отладчика внутри процесса.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295638&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=6" class="addthx" data-post="295638"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 09:05 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Вызываем в длл функу RegisterCallback(). Она сохраняет в переменной указанную ссылку. Потом при нужно событии вызывает эту ссылку как процедуру, передавая через стек контекст и инфу про фолт. Тоже самое что и VEH. Это если всё в текущем процессе выполнять, ну я думал что нужно с текущим.<br><br>Если в другом процессе, то нужно какойто IPC механизм, самый простейший это как сказали секция + евентпейр(EventPair), что реализовано в ядре как LPC специально для этого. Хотя андок и <b>PE_Kill</b> брызгая слюной будет доказывать что не тру и механизм изменится(чего не произошло в W8) <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295649&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=7" class="addthx" data-post="295649"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 10:40 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Зачем мне что то доказывать тому, кто даже не понял сразу ТЗ? И зачем использовать андок, да еще и LPC, когда можно использовать документированные и отточеные метода, которые и в W50 не изменятся?<br><br>Мапь проекцию и через локи сделай протокол общения, вот и всё.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295666&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=8" class="addthx" data-post="295666"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=25176" title="19-11-2011 07:03, ранг:51.3" target="_blank">sys_dev</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]q1nex[/b]','')">q1nex</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.92'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=22013">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 16:01 <br><script type="text/javascript">QU('q1nex','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=q1nex" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
1. ТС хочет &quot;КРАСИВОЕ решение&quot;.<br>2. Ядро отладчика это видимо вех хендлер, который передает 2 структуры другому процессу? Круто.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295694&amp;user=22013&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=9" class="addthx" data-post="295694"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 16:15 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>q1nex пишет:<br>Ядро отладчика это видимо вех хендлер, который передает 2 структуры другому процессу? Круто </I><br>А разве Debug API делают больше?
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295698&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=10" class="addthx" data-post="295698"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]GoldenJoe[/b]','')">GoldenJoe</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.66'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30679">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 18:02 &middot; Поправил: GoldenJoe <br><script type="text/javascript">QU('GoldenJoe','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GoldenJoe" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>ТС хочет сделать подобие отладчика на технологии VEH </I><br><img src="img/smilies/s1.gif" alt=""><br><I>q1nex пишет:<br>Ядро отладчика это видимо вех хендлер, который передает 2 структуры другому процессу? Круто </I><br>Даже трейсить можно, если подумать. VirtualProtect с опцией PAGE_READWRITE (можно читать и писать, но выполнять нельзя) на первый байт инструкции. Затем на первый байт следующей инструкции и так далее. Правда, для этого нужен дизасм длин.<br>Можно еще хуков наставить и перехватывать загрузку DLL-ок, создание потоков, да что угодно.<br>К тому же такой отладчик не палится протами (теоретически) в отличии от отладчика на Debug API.<br><I>PE_Kill пишет:<br>Мапь проекцию и через <b>локи</b> сделай протокол общения, вот и всё </I><br>Что еще за локи?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295710&amp;user=30679&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=11" class="addthx" data-post="295710"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 18:13 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>GoldenJoe пишет:<br>Даже трейсить можно, если подумать. VirtualProtect с опцией PAGE_READWRITE (можно читать и писать, но выполнять нельзя) на первый байт инструкции. </I><br>Что за изврат, если есть Trap flag?<br><br><I>GoldenJoe пишет:<br>Что еще за локи?  </I><br>LOCK - префикс ассемблерных инструкций.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295713&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=12" class="addthx" data-post="295713"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]GoldenJoe[/b]','')">GoldenJoe</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.66'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30679">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 19:17 &middot; Поправил: GoldenJoe <br><script type="text/javascript">QU('GoldenJoe','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GoldenJoe" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>Trap flag </I><br>Палевно же.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295717&amp;user=30679&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=13" class="addthx" data-post="295717"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 19:51 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
А VirtualProtect не палево? Ещё и на 1 байт. Мне очень интересно, как ты это сделаешь. И да, будет пахать всё это медленно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295724&amp;user=1556&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=14" class="addthx" data-post="295724"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 19:55 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>&gt; LOCK - префикс ассемблерных инструкций. <br><br>Бредятина.<br><br>&gt; PAGE_READWRITE (можно читать и писать, но выполнять нельзя)<br><br>Как это так. У меня пае выключен. Посему вообще атрибут PAGE_EXECUTE не робит <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295727&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=15" class="addthx" data-post="295727"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]GoldenJoe[/b]','')">GoldenJoe</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.66'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30679">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 22:12 <br><script type="text/javascript">QU('GoldenJoe','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GoldenJoe" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>Шаред мем </I><br>Ну, так и быть, заюзаю. А чтоб красиво, можно класс-обертку над апишками запилить.<br><br>А VirtualProtect не вариант, да. Как спалить его использование, кстати? Самим же VirtualProtect&#039;ом?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295753&amp;user=30679&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=16" class="addthx" data-post="295753"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 22:23 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>bowrouco пишет:<br>Бредятина </I><br>Клерк ..., аминь.<br><br><b><font color="red">От модератора: на сутки... ну ты понял</font></b>
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295754&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=17" class="addthx" data-post="295754"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29820" title="17-11-2011 18:45, ранг:2.0" target="_blank">SegFault</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 22:46 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Вместо PAGE_READWRITE ставьте PAGE_GUARD, тогда при любом обращении будет EXCEPTION_PAGE_GUARD, а самое интересное что этот флаг будет автоматически сниматься при срабатывании.<br>Но как уже сказали это медленно.<br>Если не нравится trap flag, можно ставить аппаратные бряки на начало инструкций, ловить EXCEPTION_SINGLE_STEP и смотреть context.Dr6 и другие context.Dr* регистры, какой сработал. Если не наш, отдаем проге.<br>Только придется перехватить ZwGet/ZwSetContextThread чтоб не палить бряки.<br><br>Кстати надеюсь после установки векторного прерывания делаете хук AddVectoredExceptionHandler? Тк отлаживаемая прога может воткнуть свой обработчик вперед вашего<br><br>P.S.<br><I>в отличии от отладчика на Debug API.</I><br>Если немного пропатчить пару функций в ntdll, то почти все проты, за исключением некоторых, идут лесом<br><br><br><I>пусть trap flag тогда уж. Чтоб не спалиться, надо, как и в случаи с аппаратными бряками, перехватывать ZwGetThreadContext</I><br>Trap flag можно считать простой последовательностью PUSHFD/POP REG. Однако при трейсе можно сравнить следующий опкод команды с 0x9C и если это он то поставить Int3 или еще какой бряк за ней, чтоб не попасться.<br>Заодно и POPFD(0x9D), на случай если tf будет выставлять программа
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295756&amp;user=3136&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=18" class="addthx" data-post="295756"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=30679" title="17-11-2011 18:52, ранг:6.2" target="_blank">GoldenJoe</a>, <a href="action=userinfo&user=29629" title="17-11-2011 21:07, ранг:43.3" target="_blank">bowrouco</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]GoldenJoe[/b]','')">GoldenJoe</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.66'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30679">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 23:07 <br><script type="text/javascript">QU('GoldenJoe','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GoldenJoe" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>Veliant</b>, для трассировки пусть trap flag тогда уж. Чтоб не спалиться, надо, как и в случаи с аппаратными бряками, перехватывать ZwGetThreadContext, я так понимаю.<br><I>Veliant пишет:<br>хук AddVectoredExceptionHandler </I><br>Когда с шаред мем разберусь, и все будет работать, тогда уж займусь хуками.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295761&amp;user=30679&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=19" class="addthx" data-post="295761"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]0x90h[/b]','')">0x90h</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.48'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=27614">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 ноября 2011 23:15 <br><script type="text/javascript">QU('0x90h','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=0x90h" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Veliant пишет:<br>Вместо PAGE_READWRITE ставьте PAGE_GUARD, то </I><br><br>на многоядерниках проблемы + GUARD_PAGE_VIOLATION генерируется частенько системой (сторож стек). <br>К тому-же если перехватывать Nt/Zw может уже перехватить KiUserExceptionDispatcher?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295762&amp;user=27614&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=20" class="addthx" data-post="295762"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]GoldenJoe[/b]','')">GoldenJoe</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 7.7 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.66'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=30679">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 00:09 <br><script type="text/javascript">QU('GoldenJoe','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GoldenJoe" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>0x90h</b>, чем VEH хуже?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295765&amp;user=30679&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=21" class="addthx" data-post="295765"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 00:13 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>0x90h пишет:</b><br><i class=x>К тому-же если перехватывать Nt/Zw может уже перехватить KiUserExceptionDispatcher?</i><br><br>И то, и то, т.к. разные механизмы, тут не надо выбирать, первые чисто читают контекст, а вторая дотягивается до него, когда он копируется ядром.<br><br><i class=x>на многоядерниках проблемы + GUARD_PAGE_VIOLATION генерируется частенько системой (сторож стек)</i><br><br>А вы думаете, как олли работает? Сравнивать надо, куда поставили, если вы собрались так делать трейс, но не будете ставить бряки ниже ImageBase. (или очень хитрый прот)<br><br><b>GoldenJoe пишет:</b><br><i class=x>для трассировки пусть trap flag тогда уж. Чтоб не спалиться, надо, как и в случаи с аппаратными бряками, перехватывать ZwGetThreadContext, я так понимаю</i><br><br>Трап флаг сам сбрасывается каждый раз, не надо его скрывать хуком. Думаете, зачем его надо каждый раз выставлять после иксепшена.<br><br><b>Veliant пишет:</b><br><i class=x>Заодно и POPFD(0x9D), на случай если tf будет выставлять программа</i><br><br>Как общее решение не заработает.<br><i class=x>После выполнения pop ss следующая за ней инструкция будет выполнена, но отладчик не остановится на ней</i> (Из Антиотладочных трюков)
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295767&amp;user=6336&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=22" class="addthx" data-post="295767"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=30679" title="17-11-2011 20:19, ранг:6.2" target="_blank">GoldenJoe</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 01:21 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
&gt; Чтоб не спалиться..<br><br>Гиблая затея. Обнаружить установленный TF есть овер 9000 способов.<br><br>&gt;  Сравнивать надо, куда поставили, если вы собрались так делать трейс, но не будете ставить бряки ниже ImageBase. (или очень хитрый прот)<br><br>Очень содержательное выражение.. хз что это значит, но как по мне так нету разницы какой адрес, лиш бы за пределами стека. Если загрузить диапазон адресов в TEB, на которых возникнет останов, то ядро не развернёт фолт при доступе к сторожевой странице.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295780&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=23" class="addthx" data-post="295780"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]q1nex[/b]','')">q1nex</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.92'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=22013">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 01:57 &middot; Поправил: q1nex <br><script type="text/javascript">QU('q1nex','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=q1nex" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
Объясните, кто-нибудь, пожалуйста, в чем проблема с гвард пейдж на многоядерниках?<br><br><b>PE_Kill</b><br>А разве Debug API - ядро отладчика? <br><br><b>bowrouco</b><br>Гляньте личку плиз
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295785&amp;user=22013&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=24" class="addthx" data-post="295785"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 02:31 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>q1nex</b><br>Тут порченая лк, сообщения не доставляются, посему ничего не пришло.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295786&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=25" class="addthx" data-post="295786"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 05:58 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>q1nex пишет:<br>А разве Debug API - ядро отладчика?  </I><br>Debug API - интерфейс ядра отладчика.<br><br><I>bowrouco пишет:<br>Гиблая затея. Обнаружить установленный TF есть овер 9000 способов. </I><br>Видать никто кроме клерка их не знает, ну собственно как обычно.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295793&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=26" class="addthx" data-post="295793"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Zorn[/b]','')">Zorn</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 53.9 (постоянный), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.25'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4376">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 07:05 &middot; Поправил: Zorn <br><script type="text/javascript">QU('Zorn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Zorn" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
Обычным pushfd насколько я помню нельзя спалить флаг Т. Потому что<br><I>ARCHANGEL пишет:<br>Трап флаг сам сбрасывается каждый раз </I><br><br>А вот так можно<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ss</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">pushfd</span></li>        </ol>
    </div>
</div></div>
<br>При трейсе pop ss следующая остановка будет на инструкции после pushfd и в стек попадет значение с взведенным флагом Т.<br>Детали не помню, но в мане описано почему.<br>У Securom&#039;а помнится был такой антитрейс.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295796&amp;user=4376&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=27" class="addthx" data-post="295796"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 07:32 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Это всё баяны, которые описаны 100 лет назад. В данном случае это обходится установкой int 3 бряка на pushfd. Есть еще try, который обходится хуком диспетчера, Get/Set ThreadContext, что тоже лечится.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=295797&amp;user=3232&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=28" class="addthx" data-post="295797"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 08:42 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Ну например при вызове сискола с TF возникает задержка, гдето в полтора раза медленее. Или например баг приводящий к дедлоку(генерация любого исключения, кроме #DB с TF) позволяет определить TF. Вот есчо пример - хардварный сброс RPL на каждой инструкции. Или напрямую получить контекст. А есчо можно через теневые колбеки.. Хадварный останов на память - почему бы через ядро не читать(через сервисы, где Dr-контекст ядерный). Способов сколько угодно, это даже в ядре не решается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295805&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=29" class="addthx" data-post="295805"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]bowrouco[/b]','')">bowrouco</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.7 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.01'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29629">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2011 19:55 <br><script type="text/javascript">QU('bowrouco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bowrouco" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19266&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>PE_Kill</b><br><br>Гдеже ответ то ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=295845&amp;user=29629&amp;forum_n=6&amp;topic=19266&amp;page=0&amp;anchor=30" class="addthx" data-post="295845"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=6&amp;topic=19266&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Обработка memory (и не только) break&#039;ов с помощью VEH</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="19266">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19266" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
