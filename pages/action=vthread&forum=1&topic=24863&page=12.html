<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Взлом .NET (part 2) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Со времени создания топика много обсудили, во много м разобрались и много осталось за кадром. Решил подшить выкладываемый софт и линки Инструменты: dnSpy - бодрый декомпилятор и отладчик тут беты Gray Wolf - DE-ObfuScatE / Edit">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Взлом .NET (part 2)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=11.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=9.html">10</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=10.html">11</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=11.html">12</a> . <b>13</b> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=13.html">14</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=14.html">15</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=15.html">16</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=13.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2017 12:06 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#1');return false;">#1</a> </span><div align=left><br>
Со времени создания топика много обсудили, во много м разобрались и много осталось за кадром. Решил подшить выкладываемый софт и линки<img src="img/smilies/s1.gif" alt=""><br><br><b>Инструменты:</b><br><br><noindex><a href="https://github.com/0xd4d/dnSpy/releases" rel="nofollow" target="_blank">dnSpy</a></noindex> - бодрый декомпилятор и отладчик <noindex><a href="https://ci.appveyor.com/project/0xd4d/dnspy/build/artifacts" rel="nofollow" target="_blank">тут беты</a></noindex><br><br><noindex><a href="https://www.digitalbodyguard.com/graywolf.html" rel="nofollow" target="_blank">Gray Wolf</a></noindex> - DE-ObfuScatE / Edit IL(Live) / Add payloads / Edit attributes(public/privet) / Copy strong names signing on EXE/DLL<br><noindex><a href="http://download.jetbrains.com/resharper/ReSharperSetup.6.0.2093.79.msi" rel="nofollow" target="_blank">ReSharper 6.0 Build 2093 Pre-Release</a></noindex> - Очень навороченый декомпилер, побробности <noindex><a href="http://blogs.jetbrains.com/dotnet/2011/02/resharper-6-bundles-decompiler-free-standalone-tool-to-follow/" rel="nofollow" target="_blank">--&gt; ТУТ &lt;--</a></noindex>.<br>Рег-данные: <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">User&nbsp;Name<span class="hl_char">:</span>&nbsp;ReSharper&nbsp;EAP&nbsp;User</li><li class="hl_l1">License&nbsp;Key<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">-</span>A60kqsqDMPkvPrLC3bz1<span class="hl_char">/</span>jmns4<span class="hl_char">/</span>DAUV6</li><li class="hl_l0">which&nbsp;is&nbsp;valid&nbsp;until&nbsp;<span class="hl_number">31</span>&nbsp;March&nbsp;<span class="hl_number">2010</span></li>        </ol>
    </div>
</div></div>
<br><noindex><a href="http://download.red-gate.com/ReflectorInstaller.exe" rel="nofollow" target="_blank">Reflector 8.3.3.115</a></noindex> - платный декомпилятор .NET <noindex><a href="http://rghost.net/51196934" rel="nofollow" target="_blank">8.3.0.95 + (дополнение к нему)</a></noindex><br><noindex><a href="http://reflector.red-gate.com/download.aspx" rel="nofollow" target="_blank">Седьмая версия рефлектора</a></noindex> - думаю все знают<br><noindex><a href="http://www.rsdn.ru/forum/tools/3568228.1.aspx" rel="nofollow" target="_blank">Сборка Add-in&#039;ов для Reflector</a></noindex> - есть много полезных вещей<br><noindex><a href="http://rongchaua.net/Web/Tool/DotNet%20Id.zip" rel="nofollow" target="_blank">.Net ID 1.0.0.3</a></noindex> - определение защиты<br><noindex><a href="http://www.mediafire.com/?gtj38dm60ddcmma" rel="nofollow" target="_blank">DNiD by Rue</a></noindex> - сигнатурный анализатор<br><noindex><a href="http://sourceforge.net/projects/dile/" rel="nofollow" target="_blank">Dotnet IL Editor (DILE)</a></noindex>- Opensource дизассемблер и дебаггер<br><noindex><a href="http://www.softkey.info/reviews/review6780.php" rel="nofollow" target="_blank">Xenocode Fox Code Analyzer</a></noindex>- профайлер и дизассемблер<br><noindex><a href="http://www.multiupload.com/OS7GKJ4HYX" rel="nofollow" target="_blank">Reactor Decryptor 1.7</a></noindex> - что то декриптит, но что не понятно(с) zeppe1in<br><noindex><a href="http://code.google.com/p/simple-assembly-explorer/" rel="nofollow" target="_blank">Simple Assembly Explor (SAE)</a></noindex> - Assembler, Disassembler, Deobfuscator, IL editor and more...<br><noindex><a href="http://rghost.ru/4619516" rel="nofollow" target="_blank">DotNet Dumper 1.0</a></noindex> - Дампер .net&#039;овских приложений. <noindex><a href="https://ssl.exelab.ru/f/action=vthread&amp;forum=1&amp;topic=16650&amp;page=4#30" rel="nofollow" target="_blank"> Подробное описание</a></noindex><br><noindex><a href="http://www.4shared.com/file/tSj6cvgj/KDT.html" rel="nofollow" target="_blank">Kurapica dotNET Tracer 1.1</a></noindex> - трейсер от известного автора инструментов для .net<br><noindex><a href="http://build.sharpdevelop.net/BuildArtefacts/#ILSpy" rel="nofollow" target="_blank">ILSpy 1.0.0.481</a></noindex> - Opensource комбайн, на подобие SAE. Подробности <noindex><a href="http://wiki.sharpdevelop.net/ilspy.ashx" rel="nofollow" target="_blank">тут</a></noindex><br><noindex><a href="http://download-ln.jetbrains.com/dottrace/dotTracePerformanceSetup.4.0.665.4.msi" rel="nofollow" target="_blank">dotTrace Performance 4.0.665.4</a></noindex> - Неплохой трейсер для .Net приложений. Умеет делать трейсы не смешивая потоки как KDT. Умеет сравнивать трейсы двух запусков программы<br>Рег-данные:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Name<span class="hl_char">:</span>&nbsp;exelab</li><li class="hl_l1">Serial<span class="hl_char">:</span>&nbsp;OLgDSHG0hJghkLdXYJh1IjM3ytMrqKcn</li>        </ol>
    </div>
</div></div>
<br><noindex><a href="http://rghost.ru/4704286" rel="nofollow" target="_blank">Universal Fixer 1.0</a></noindex> - fix dumps after dumping them whit Dotnet Dumper or other similiar tools and will also fix nasty things: multiple assembly/module definitions, wrong extends, etc.<br><noindex><a href="http://sourceforge.net/projects/improvenetdeobf/" rel="nofollow" target="_blank">iMPROVE .NET Deobfuscator</a></noindex> - деобфускатор<br><br><br><noindex><a href="http://www.solidfiles.com/d/aa589ef0ba/" rel="nofollow" target="_blank">ConfuserDumper</a></noindex><br><noindex><a href="http://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=16650&amp;page=21#12" rel="nofollow" target="_blank">ConfuserDelegateKiller</a></noindex><br><noindex><a href="http://www23.zippyshare.com/v/50597806/file.html" rel="nofollow" target="_blank">CodeCrackerTools: ConfuserMethodsDecryptor, ConfuserDelegateKiller, ConfuserStringDecryptor, MegaDumper, etc.</a></noindex><br><br><b>Документация:</b><br><noindex><a href="https://www.visualstudio.com/license-terms/ecma-c-common-language-infrastructure-standards/" rel="nofollow" target="_blank">--&gt; Microsoft &lt;--</a></noindex><br><noindex><a href="http://download.microsoft.com/download/1/5/4/1546A0C9-A650-4CE4-B056-36EC09C4CFC0/Partition_II_Metadata.zip" rel="nofollow" target="_blank">--&gt; Metadata and File Format &lt;--</a></noindex><br><noindex><a href="http://download.microsoft.com/download/1/5/4/1546A0C9-A650-4CE4-B056-36EC09C4CFC0/Partition_III_CIL.zip" rel="nofollow" target="_blank">--&gt; CIL(опкоды с полным пояснениями) &lt;--</a></noindex><br><br><b>Статьи с хабры:</b><br><noindex><a href="http://habrahabr.ru/blogs/net/106262/" rel="nofollow" target="_blank">Защита .NET приложений</a></noindex> - Субъективная теоретическая муть с хабры, выдаваемая за обзор обфускаторов(только для фанатов)<br><noindex><a href="http://habrahabr.ru/blogs/net/108955/" rel="nofollow" target="_blank">Как обмануть NET.Reflector</a></noindex> - вот это уже годная статья, в которой рассматривается ручная обфускация в стихах и картинках<br><noindex><a href="http://habrahabr.ru/blogs/net/109117/" rel="nofollow" target="_blank">Взлом программ для чайников</a></noindex> - ну не знаю...прописные истины, но приятно, что все это есть на русском языке и нормально оформлено<br><noindex><a href="http://habrahabr.ru/blogs/net/109689/" rel="nofollow" target="_blank">Реверс-инжиниринг обфусцированной сборки .NET </a></noindex> - один только заголовок чего стоит. По сути статья информативная<br><noindex><a href="http://habrahabr.ru/blogs/net/108947/" rel="nofollow" target="_blank">Инъекции MSIL кода в стороннюю сборку при помощи Mono.Cecil. Реализация принципов АОП в NET</a></noindex><br><noindex><a href="http://habrahabr.ru/blogs/net/111330/" rel="nofollow" target="_blank">Избавление .NET программы от регистрации на примере BEM</a></noindex><br><noindex><a href="http://habrahabr.ru/company/luxoft/blog/247447/" rel="nofollow" target="_blank">Снимаем дамп объектов с памяти .Net приложения</a></noindex><br><br><b>Другое:</b><br><noindex><a href="http://www.multiupload.com/EBCEYWANN0" rel="nofollow" target="_blank">.NET Reflector v7.0.0.198 (C# Source by wangshy)</a></noindex><br><noindex><a href="http://lifeinhex.com/string-decryption-with-de4dot/" rel="nofollow" target="_blank">String decryption with de4dot</a></noindex><br><br>Прошлый топик https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=16650&amp;page=-1 <br><br>-<br><br>Last edit: 2012-02-17, Links fixed. Jupiter
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378699&amp;user=1556&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=1" class="addthx" data-post="378699"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31332" title="01-10-2018 17:14, ранг:0.0" target="_blank">prorab777</a>, <a href="action=userinfo&user=43371" title="05-01-2020 16:17, ранг:0.0" target="_blank">ViruSZ7</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2019 15:17 &middot; Поправил: ajax <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#2');return false;">#2</a> </span><div align=left><br>
<b>Medsft</b><br>StrongNameSign... на диске либу проверят. он патчит в памяти. только что дебаггером проверил. нюанс в том, что к моменту LoadLibraryExW либа уже загружена. соотв-но хук со сравнением имени &quot;пролетит&quot;
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398164&amp;user=8830&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=2" class="addthx" data-post="398164"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Medsft[/b]','')">Medsft</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 330.4 (мудрец), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.16<span style='color:green'>&nearr;</span>0.17</span><br>Статус: <a href="action=userinfo&amp;user=332">Участник</a><br><font color=blue>ILSpector Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2019 16:25 <br><script type="text/javascript">QU('Medsft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Medsft" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#3');return false;">#3</a> </span><div align=left><br>
api монитор говорит обратное, посмотрим запилит лоадер там видно будет. Учитывай что net dll не тоже самое что простой натив телам еще надос скомпилится, расположится в памяти и т.д.<br>Если он прав ломанем все)))<br><br><b>Добавлено спустя 20 минут</b><br>если <I>ajax пишет: хук со сравнением имени &quot;пролетит&quot; </I> создаю социальный заказ на универсальный генератор лоадеров для NET сборок)))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398167&amp;user=332&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=3" class="addthx" data-post="398167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]zds[/b]','')">zds</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 57.0 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.42'>Активность: 0.05<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=31361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2019 21:04 <br><script type="text/javascript">QU('zds','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zds" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#4');return false;">#4</a> </span><div align=left><br>
<b>Medsft</b><br>вот посмотри<br>https://mega.nz/#!eAwGDCYZ!MATZZ0Wo7sJDgV7WOpRq9oZWhj_YXh0vWZDkzQitPw8<br>dll не mixed поэтому через LoadLibraryExW не чекается. сделал через костыль, как умею...я не такой профи как большинство здесь... но вроде работает. патч только одно байта
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398172&amp;user=31361&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=4" class="addthx" data-post="398172"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=11966" title="12-09-2019 18:07, ранг:570.6" target="_blank">r_e</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2019 21:10 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#5');return false;">#5</a> </span><div align=left><br>
Для mixed длл зачастую можно подцепиться через цепочку зависимостей.<br>Думаю что тот семпл что ты дал можно через сторонний инжект сделать (CreateRemoteThread + DLL = patch) потому что у тебя по кнопке все. А вот если бы оно со старта вызывало протекченный код - было бы гораздо хуже. Впрочем, тоже решаемо.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398173&amp;user=11966&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=5" class="addthx" data-post="398173"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31361" title="12-09-2019 19:54, ранг:46.9" target="_blank">zds</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]zds[/b]','')">zds</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 57.0 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.42'>Активность: 0.05<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=31361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2019 22:58 <br><script type="text/javascript">QU('zds','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zds" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#6');return false;">#6</a> </span><div align=left><br>
<b>r_e</b><br>было бы полезно узнать как отлавливать загрузку net моделей (не mixed), чтобы патчить их на старте<br>тот жуткий костыль что у меня в примере я иногда использую, но он мне самому не нравится. но на большее у меня не хватило фантазии
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398181&amp;user=31361&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=6" class="addthx" data-post="398181"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2019 03:46 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#7');return false;">#7</a> </span><div align=left><br>
Исходить нужно из того, что это dll:<br><br>1. Образы на диске и в памяти различаются из за формата, в частности базовые поправки адресов и выравнивание секций.<br>2. Загрузчик(ntldr) не может загружать копию модуля. Как минимум для этого есть проверка на уровне ядра(NtAreMapped).<br><br>Это значит что в проверке загрузчик не участвует. Проверяющий код самостоятельно прочитает файл, напрямую или через проекцию. Тогда при открытии файла открыть оригинальный, либо если используются проекции - после отображения восстановить изменённые области(при этом так как проекция файловая, то можно менять её атрибуты на запись). Лучше второй способ, так как по описателям может быть запрос инфы про файл, например проверка что модуль и проекция из одного файла, теоретически.<br><br>NtMapView -&gt; if MemoryMappedFilenameInformation(handle) == target_file: NtProtectVi(Base) -&gt; fix_data.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398184&amp;user=40990&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=7" class="addthx" data-post="398184"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Medsft[/b]','')">Medsft</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 330.4 (мудрец), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.16<span style='color:green'>&nearr;</span>0.17</span><br>Статус: <a href="action=userinfo&amp;user=332">Участник</a><br><font color=blue>ILSpector Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2019 08:49 <br><script type="text/javascript">QU('Medsft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Medsft" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#8');return false;">#8</a> </span><div align=left><br>
<I>zds пишет:<br>вот посмотри </I> ссылка не рабочая
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398187&amp;user=332&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=8" class="addthx" data-post="398187"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]zds[/b]','')">zds</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 57.0 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.42'>Активность: 0.05<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=31361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2019 09:05 <br><script type="text/javascript">QU('zds','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zds" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#9');return false;">#9</a> </span><div align=left><br>
<b>Medsft</b><br>сорри<br>https://mega.nz/#!aAgiDCST!MATZZ0Wo7sJDgV7WOpRq9oZWhj_YXh0vWZDkzQitPw8
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398188&amp;user=31361&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=9" class="addthx" data-post="398188"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Medsft[/b]','')">Medsft</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 330.4 (мудрец), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.16<span style='color:green'>&nearr;</span>0.17</span><br>Статус: <a href="action=userinfo&amp;user=332">Участник</a><br><font color=blue>ILSpector Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2019 10:12 <br><script type="text/javascript">QU('Medsft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Medsft" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#10');return false;">#10</a> </span><div align=left><br>
Признаю работает. 5 Вам) Щас усложню тест<br><br><b>Добавлено спустя 8 часов 27 минут</b><br>Такс усложню задачу.Теперь на форме 2 кнопочки и два разных метода проверки strongName с использованием стандартных апи.<br>Необходимо чтобы  оба выдавали правильное сообщение<br>Патчить только 1 байтик<br><br><img src="img/attach.gif" alt=""> <a href="./files/126a_13.09.2019_EXELAB.rU.tgz">126a_13.09.2019_EXELAB.rU.tgz</a> - test.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398189&amp;user=332&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=10" class="addthx" data-post="398189"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2019 22:43 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#11');return false;">#11</a> </span><div align=left><br>
<b>Medsft</b><br><br>Я немного покодил, получается вот что. Файл читается многократно(W7), отображается как Image два раза, затем отображается как не pe, при этом не разделяем, те эксклюзивное чтение. Из за этого попытки что либо сделать с образом приводят к нехватке прав, так как секция создана с недостаточными правами, которые задаются при открытии файла.<br><br>Что бы не возиться с секциями(возникают траблы с отображением на запись), проще вернуть описатель копии образа при открытии файла. Но и это не снимает основную проблему.<br><br>Каким образом определить что происходит валидация образа ?<br><br>Этот комовский рантайм сам проецирует файлы, при этом они не исполняемы(в com образы нет передач управления, те там NX).<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">Entry</span></li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>advapi32<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>msvcrt<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>sechost<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>rpcrt4<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Microsoft<span class="hl_char">.</span>NET<span class="hl_char">\</span>Framework<span class="hl_char">\</span>v4<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">30319</span><span class="hl_char">\</span>mscoreei<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>shlwapi<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>gdi32<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>user32<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>lpk<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>usp10<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>imm32<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>msctf<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>Mup<span class="hl_char">\</span>vmware<span class="hl_char">-</span>host<span class="hl_char">\</span>Shared&nbsp;Folders<span class="hl_char">\</span>cit<span class="hl_char">\</span>medsft<span class="hl_char">\</span>p<span class="hl_char">\</span><span class="hl_number">5</span><span class="hl_char">\</span><span class="hl_number">20</span><span class="hl_char">\</span>WindowsFormsApplication2<span class="hl_char">.</span>exe</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>Mup<span class="hl_char">\</span>vmware<span class="hl_char">-</span>host<span class="hl_char">\</span>Shared&nbsp;Folders<span class="hl_char">\</span>cit<span class="hl_char">\</span>medsft<span class="hl_char">\</span>p<span class="hl_char">\</span><span class="hl_number">5</span><span class="hl_char">\</span><span class="hl_number">20</span><span class="hl_char">\</span>WindowsFormsApplication2<span class="hl_char">.</span>exe</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Microsoft<span class="hl_char">.</span>NET<span class="hl_char">\</span>Framework<span class="hl_char">\</span>v4<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">30319</span><span class="hl_char">\</span>clr<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>msvcr100_clr0400<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Globalization<span class="hl_char">\</span>Sorting<span class="hl_char">\</span>SortDefault<span class="hl_char">.</span>nls</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>assembly<span class="hl_char">\</span>NativeImages_v4<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span>30319_32<span class="hl_char">\</span>mscorlib<span class="hl_char">\</span><span class="hl_number">246f1a5abb686b9dcdf22d3505b08cea</span><span class="hl_char">\</span>mscorlib<span class="hl_char">.</span>ni<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>ole32<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>cryptbase<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>uxtheme<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Microsoft<span class="hl_char">.</span>NET<span class="hl_char">\</span>Framework<span class="hl_char">\</span>v4<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">30319</span><span class="hl_char">\</span>nlssorting<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Microsoft<span class="hl_char">.</span>NET<span class="hl_char">\</span>Framework<span class="hl_char">\</span>v4<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">30319</span><span class="hl_char">\</span>sortdefault<span class="hl_char">.</span>nlp</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>cryptsp<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>rsaenh<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>rsaenh<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Microsoft<span class="hl_char">.</span>NET<span class="hl_char">\</span>Framework<span class="hl_char">\</span>v4<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">30319</span><span class="hl_char">\</span>clrjit<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>assembly<span class="hl_char">\</span>NativeImages_v4<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span>30319_32<span class="hl_char">\</span>System<span class="hl_char">\</span><span class="hl_number">964da027ebca3b263a05cadb8eaa20a3</span><span class="hl_char">\</span>System<span class="hl_char">.</span>ni<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>assembly<span class="hl_char">\</span>NativeImages_v4<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span>30319_32<span class="hl_char">\</span>System<span class="hl_char">.</span>Drawing<span class="hl_char">\</span>dd57bc19f5807c6dbe8f88d4a23277f6<span class="hl_char">\</span>System<span class="hl_char">.</span>Drawing<span class="hl_char">.</span>ni<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>assembly<span class="hl_char">\</span>NativeImages_v4<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span>30319_32<span class="hl_char">\</span>System<span class="hl_char">.</span>Windows<span class="hl_char">.</span>Forms<span class="hl_char">\</span><span class="hl_number">17e020ae92d7fab33bcc1c98b25019d0</span><span class="hl_char">\</span>System<span class="hl_char">.</span>Windows<span class="hl_char">.</span>Forms<span class="hl_char">.</span>ni<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>winsxs<span class="hl_char">\</span>x86_microsoft<span class="hl_char">.</span>windows<span class="hl_char">.</span>common<span class="hl_char">-</span>controls_6595b64144ccf1df_5<span class="hl_char">.</span><span class="hl_number">82</span><span class="hl_char">.</span><span class="hl_number">7601</span><span class="hl_char">.</span>17514_none_ec83dffa859149af<span class="hl_char">\</span>comctl32<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>winsxs<span class="hl_char">\</span>x86_microsoft<span class="hl_char">.</span>windows<span class="hl_char">.</span>common<span class="hl_char">-</span>controls_6595b64144ccf1df_6<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">7601</span><span class="hl_char">.</span>17514_none_41e6975e2bd6f2b2<span class="hl_char">\</span>comctl32<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>dwmapi<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>winsxs<span class="hl_char">\</span>x86_microsoft<span class="hl_char">.</span>windows<span class="hl_char">.</span>gdiplus_6595b64144ccf1df_1<span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">.</span><span class="hl_number">7601</span><span class="hl_char">.</span>17825_none_72d273598668a06b<span class="hl_char">\</span>GdiPlus<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Users<span class="hl_char">\</span>Indy<span class="hl_char">\</span>AppData<span class="hl_char">\</span><span class="hl_function">Local</span><span class="hl_char">\</span>GDIPFONTCACHEV1<span class="hl_char">.</span>DAT</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>tahoma<span class="hl_char">.</span>ttf</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>tahoma<span class="hl_char">.</span>ttf</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>msjh<span class="hl_char">.</span>ttf</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>msjh<span class="hl_char">.</span>ttf</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>msyh<span class="hl_char">.</span>ttf</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>msyh<span class="hl_char">.</span>ttf</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>malgun<span class="hl_char">.</span>ttf</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>malgun<span class="hl_char">.</span>ttf</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>micross<span class="hl_char">.</span>ttf</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>micross<span class="hl_char">.</span>ttf</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>segoeui<span class="hl_char">.</span>ttf</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>segoeui<span class="hl_char">.</span>ttf</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Fonts<span class="hl_char">\</span>StaticCache<span class="hl_char">.</span>dat</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>oleaut32<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>Mup<span class="hl_char">\</span>vmware<span class="hl_char">-</span>host<span class="hl_char">\</span>Shared&nbsp;Folders<span class="hl_char">\</span>cit<span class="hl_char">\</span>medsft<span class="hl_char">\</span>p<span class="hl_char">\</span><span class="hl_number">5</span><span class="hl_char">\</span><span class="hl_number">20</span><span class="hl_char">\</span>testLibrary<span class="hl_char">.</span>dll</li><li class="hl_l1">Image</li><li class="hl_l0">M<span class="hl_char">:</span>&nbsp;0x78563412</li><li class="hl_l1">RW&nbsp;0x0</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>Mup<span class="hl_char">\</span>vmware<span class="hl_char">-</span>host<span class="hl_char">\</span>Shared&nbsp;Folders<span class="hl_char">\</span>cit<span class="hl_char">\</span>medsft<span class="hl_char">\</span>p<span class="hl_char">\</span><span class="hl_number">5</span><span class="hl_char">\</span><span class="hl_number">20</span><span class="hl_char">\</span>testLibrary<span class="hl_char">.</span>dll</li><li class="hl_l1">Image</li><li class="hl_l0">M<span class="hl_char">:</span>&nbsp;0x78563412</li><li class="hl_l1">RW&nbsp;0x0</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>System32<span class="hl_char">\</span>RpcRtRemote<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>Mup<span class="hl_char">\</span>vmware<span class="hl_char">-</span>host<span class="hl_char">\</span>Shared&nbsp;Folders<span class="hl_char">\</span>cit<span class="hl_char">\</span>medsft<span class="hl_char">\</span>p<span class="hl_char">\</span><span class="hl_number">5</span><span class="hl_char">\</span><span class="hl_number">20</span><span class="hl_char">\</span>WindowsFormsApplication2<span class="hl_char">.</span>exe</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>Mup<span class="hl_char">\</span>vmware<span class="hl_char">-</span>host<span class="hl_char">\</span>Shared&nbsp;Folders<span class="hl_char">\</span>cit<span class="hl_char">\</span>medsft<span class="hl_char">\</span>p<span class="hl_char">\</span><span class="hl_number">5</span><span class="hl_char">\</span><span class="hl_number">20</span><span class="hl_char">\</span>WindowsFormsApplication2<span class="hl_char">.</span>exe</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>Microsoft<span class="hl_char">.</span>NET<span class="hl_char">\</span>Framework<span class="hl_char">\</span>v2<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">50727</span><span class="hl_char">\</span>mscorwks<span class="hl_char">.</span>dll</li><li class="hl_l0"><span class="hl_char">\</span>Device<span class="hl_char">\</span>HarddiskVolume1<span class="hl_char">\</span>Windows<span class="hl_char">\</span>winsxs<span class="hl_char">\</span>x86_microsoft<span class="hl_char">.</span>vc80<span class="hl_char">.</span>crt_1fc8b3b9a1e18e3b_8<span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">.</span><span class="hl_number">50727</span><span class="hl_char">.</span>4940_none_d08cc06a442b34fc<span class="hl_char">\</span>msvcr80<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">\</span>Device<span class="hl_char">\</span>Mup<span class="hl_char">\</span>vmware<span class="hl_char">-</span>host<span class="hl_char">\</span>Shared&nbsp;Folders<span class="hl_char">\</span>cit<span class="hl_char">\</span>medsft<span class="hl_char">\</span>p<span class="hl_char">\</span><span class="hl_number">5</span><span class="hl_char">\</span><span class="hl_number">20</span><span class="hl_char">\</span>testLibrary<span class="hl_char">.</span>dll</li><li class="hl_l0">File</li><li class="hl_l1">Readonly</li>        </ol>
    </div>
</div></div>
<br><br>Вопрос - критерий, по которому можно определить факт проверки файла. Разумеется без хардкода системных процедур(смотреть бэктрейс стековый). Выборка на компиляцию и валидацию идёт из одного и того же модуля.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398209&amp;user=40990&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=11" class="addthx" data-post="398209"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Medsft[/b]','')">Medsft</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 330.4 (мудрец), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.16<span style='color:green'>&nearr;</span>0.17</span><br>Статус: <a href="action=userinfo&amp;user=332">Участник</a><br><font color=blue>ILSpector Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 00:11 <br><script type="text/javascript">QU('Medsft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Medsft" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#12');return false;">#12</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Каким образом определить </I> код что я реализовал в этом примере ничем не закрыт и его можно посмотреть любым декомпилем (к примеру dnspy) ради интереса скачайте этот инструмент статик анализа и взгляните на тело метода checkv2. Я просто применил малозадокументизированную апи, код её самой натив вы в нем уче разбираетесь чем я. Как определить.... Да я хз первое что приходит на ум отловить readprocessmemory когда процесс матка читает сам себя. NET изначально был ограничен майкрософтом в прямом доступе к памяти, незачем ему это подразумевалось. <br>Пишу с телефона поэтому не вижу полной картины своего поста). zds лоадер будет? <br>difexacaw а вы защиту пишите?))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398216&amp;user=332&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=12" class="addthx" data-post="398216"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 08:58 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#13');return false;">#13</a> </span><div align=left><br>
<b>Medsft</b><br><br>Что бы обойти проверку нужно знать конкретный механизм проверки. Иначе может быть проверка уже загруженного модуля, тогда вообще не отличить - идёт компиляция или данные выбираются для вычисления контр суммы. Для вашего семпла первые два вызова NtMapView это загрузка модуля из clr, третий вызов это отображение для проверки из mscorwks. При этом разница - для загрузки отображение Image, для проверки Map, тоесть проверка происходит образа как файла, а не как pe. Достаточно сменить права на запись, что бы отображение произошло не как R, а как RW и восстановить там файловые данные. Либо во втором способе можно открыть исходный файл и вернуть его описатель.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398223&amp;user=40990&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=13" class="addthx" data-post="398223"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 11:17 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#14');return false;">#14</a> </span><div align=left><br>
<b>Medsft</b><br>соглашусь с <b>r_e</b>. и добавлю, что если статик линковка - все тоже, как 2 бита переслать
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398225&amp;user=8830&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=14" class="addthx" data-post="398225"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]zds[/b]','')">zds</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 57.0 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.42'>Активность: 0.05<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=31361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 12:00 <br><script type="text/javascript">QU('zds','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zds" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#15');return false;">#15</a> </span><div align=left><br>
<b>Medsft</b><br>вот<br>https://mega.nz/#!aRxiUayI!yCj8AM6P5C5B_5mofWHMkaRiOvMgVHmNeRDuXcEOvbU<br>все продолжает работать. поменял только адрес для патча<br><br>PS, тут не совсем понятно когда срабатывает лоадер, возможно уже после ваших проверок. для чистоты эксперимента добавьте в следующий тест перед проверкой вызов лоадера<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">[</span>DllImport<span class="hl_char">(</span><span class="hl_quote">&quot;loader.dll&quot;</span><span class="hl_char">,</span>&nbsp;CallingConvention&nbsp;<span class="hl_char">=</span>&nbsp;CallingConvention<span class="hl_char">.</span><span class="hl_function">StdCall</span><span class="hl_char">,</span>&nbsp;CharSet&nbsp;<span class="hl_char">=</span>&nbsp;CharSet<span class="hl_char">.</span>Auto<span class="hl_char">)</span><span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;extern&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;init<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>тогда уже будет точно ясно срабатывают ваши проверки или нет
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398228&amp;user=31361&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=15" class="addthx" data-post="398228"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 12:16 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#16');return false;">#16</a> </span><div align=left><br>
<b>zds</b><br><br>А как это работает ?<br><br>Проверка заключается в эксклюзивном открытии файла, отображении его в память на R и вызове криптоапи. У вас в сурке поиск файловых проекций и какие то манипуляции с ними(в не image проекции R данные никаким образом из юзермод изменить невозможно, только переотобразить) или загрузочными апи. Это всё не имеет отношения к самой проекции и как следствие к механизму проверки. Получается что результат проверки файла вообще не используется, хотя эта проверка есть ?
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398229&amp;user=40990&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=16" class="addthx" data-post="398229"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]zds[/b]','')">zds</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 57.0 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.42'>Активность: 0.05<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=31361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 12:38 <br><script type="text/javascript">QU('zds','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zds" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#17');return false;">#17</a> </span><div align=left><br>
<b>difexacaw</b> извиняюсь, но я не понял вопроса<br>у меня лоадер делает только патч 1 байта, которого попросил сделать Medsft<br>я уже говорил выше, что код сделан хреново (на сколько хватает моих скудных познаний). т.к. тестовая dll не mixed mode, я не могу отследить ее старт через LoadLibraryExW. Поэтому все сделано через жопу и есть вероятность, что лоадер патчит нужный байт уже после вызова CheckV2 или CheckV1. Поэтому я попросил в следующий тест добавить прямой вызов лоадера перед вызовом CheckV2 или CheckV1, чтобы точно знать, что в момент вызова проверки лоадер уже отработал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398231&amp;user=31361&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=17" class="addthx" data-post="398231"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40990" title="14-09-2019 10:02, ранг:299.7" target="_blank">difexacaw</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 12:52 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#18');return false;">#18</a> </span><div align=left><br>
<b>zds</b><br><br><noindex><a href="https://ibb.co/JyH7DDx" rel="nofollow" target="_blank"> <img src="https://i.ibb.co/X3tsccy/mapvi.png" border="0" align="" alt=""></a></noindex><br><br>Твой семпл под отлачиком. Как и без твоего загрузчика. Два отображения Image и одно R-map. Если пофиксить в Image, то всё равно происходит детект. В Map пофиксить нельзя без ремап, если туда поставить останов и при выборке подставить оригинальные данные, то тест проходит. Но твой лодер ничего не делает с этим отображением, не смотря на это тест проходит. В чём подвох ?<br><br><b>Добавлено спустя 3 минуты</b><br><b>Medsft</b><br><br>Плохой семпл, не смотря на хорошую проверку с эксклюзивным отображением её школьники прошли, хоть и не ясно как ^<br>Результат проверки теряется, каким то образом это побочный эффект <img src="img/smilies/s13.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398232&amp;user=40990&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=18" class="addthx" data-post="398232"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Medsft[/b]','')">Medsft</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 330.4 (мудрец), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.16<span style='color:green'>&nearr;</span>0.17</span><br>Статус: <a href="action=userinfo&amp;user=332">Участник</a><br><font color=blue>ILSpector Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 13:11 <br><script type="text/javascript">QU('Medsft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Medsft" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#19');return false;">#19</a> </span><div align=left><br>
Так опять с телефона поэтому уж извините к коду доступа нет.<br>1)chevkv1 работает с образом на диске<br>2)checkv2 работает с развёрнутой image. Многократно нажатие вызывает каждый раз проверку image на целостность.<br>Как работает net сначала образ с диска мапируется на память и по мере надобности компилирует методы и располагает уже натив код где-то откуда и происходит дальнейший процессинг (это наше исследование с dife). Похоже ты залез в промежуток между. Компа нет поблизости не могу сделать модификацию семпла и даже пока не знаю как без перекрытия jit
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398233&amp;user=332&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=19" class="addthx" data-post="398233"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 13:19 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#20');return false;">#20</a> </span><div align=left><br>
<b>Medsft</b><br><br>Что такое checkvX, это места проверки ?<br><br>Мне интересно как <b>zds</b> это решил, он скипнул проверку зная конкретное место ?<br><br>В любом случае результат проверки каким то образом скипнут, не трогая при этом сам механизм.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398235&amp;user=40990&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=20" class="addthx" data-post="398235"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Medsft[/b]','')">Medsft</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 330.4 (мудрец), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.16<span style='color:green'>&nearr;</span>0.17</span><br>Статус: <a href="action=userinfo&amp;user=332">Участник</a><br><font color=blue>ILSpector Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 13:21 <br><script type="text/javascript">QU('Medsft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Medsft" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#21');return false;">#21</a> </span><div align=left><br>
Процедура check это уже проверка и её патчем одного байта не пройти. Он как бы задание выполнил меняет 1 байт в процедуре сложения двух чисел 2 и 2 меняя одно из них на 3<br><br><b>Добавлено спустя 2 минуты</b><br>Результатом является то что 2+2=5)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398236&amp;user=332&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=21" class="addthx" data-post="398236"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 13:26 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#22');return false;">#22</a> </span><div align=left><br>
<b>Medsft</b><br><br>Тогда как прошла проверка, StrongNameSignatureVerification() не тронута(??), так как не тронуто отображение. Это фикс места проверки, что это есчо может быть.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398237&amp;user=40990&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=22" class="addthx" data-post="398237"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]zds[/b]','')">zds</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 57.0 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.42'>Активность: 0.05<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=31361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 13:34 <br><script type="text/javascript">QU('zds','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zds" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#23');return false;">#23</a> </span><div align=left><br>
<b>difexacaw</b><br>я хз как это работает. меня вполне устраивает тот факт, что это работает и я этим пользуюсь уже давно. когда не будет работать, буду искать другие варианты<br>и не надо оскорблять, я уже давно не школьник, мне за 30. и я вроде тут не кого не оскорблял, ни кому ни чего не пытался доказать или принизить. <br><br><b>Medsft</b><br>многократно не получается нажать, после закрытия окна результата прога закрывается <br>как я говорил выше возможно сначала выполняется твой checkv2, в процессе подгружаются какие-то dll через LoadLibraryExW, в результате лоадер наконец-то находит твою dll в памяти и патчит ее (уже после того как checkv2 был выполнен). либо убери закрытие проги после закрытия окна, либо добавь вызов лоадера перед checkv2<br>кстати заметил, если запустить твою тестовую прогу как есть и нажать на тест2, результат появляется через 4-5сек, если запускать с лоадером, то мгновенно. но я ничего с этим не делал, только патч 1 байта, как ты просил. исходники есть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398238&amp;user=31361&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=23" class="addthx" data-post="398238"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 13:37 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#24');return false;">#24</a> </span><div align=left><br>
<b>zds</b><br><br>Если пропатчить Image, то проверка не проходит. Так как сама проверка в Map, мне уже надоело повторять это.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398239&amp;user=40990&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=24" class="addthx" data-post="398239"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 15:27 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#25');return false;">#25</a> </span><div align=left><br>
<b>zds</b><br>не реагируй на брызги (...&quot;школьник&quot;... блаблабла). Работает и ладно. Пусть разбираются =)
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=398241&amp;user=11966&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=25" class="addthx" data-post="398241"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Medsft[/b]','')">Medsft</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 330.4 (мудрец), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.16<span style='color:green'>&nearr;</span>0.17</span><br>Статус: <a href="action=userinfo&amp;user=332">Участник</a><br><font color=blue>ILSpector Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 18:38 <br><script type="text/javascript">QU('Medsft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Medsft" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#26');return false;">#26</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Если пропатчить Image, то проверка не проходит </I>г уверен?<br><br><b>Добавлено спустя 15 минут</b><br>Еще<br>difexacaw - zds же исходники прилагает, там же наверное понятно что патчится то.<br>zds сделай генератор лоадеров который на вход принимает паф и таблицу :смещение что на что а потом генерится stand alone loader
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398244&amp;user=332&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=26" class="addthx" data-post="398244"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]zds[/b]','')">zds</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 57.0 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.42'>Активность: 0.05<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=31361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 19:50 <br><script type="text/javascript">QU('zds','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zds" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#27');return false;">#27</a> </span><div align=left><br>
<b>Medsft</b><br>не вижу смысла автомитизировать это в текущем виде. как я говорил выше, главная проблема тут это детект нужной dll. <br>частое выполнение GetDLLsBaseAddresses (перебор всех регионов памяти, см исходники) заметно сильно тормозит выполнение реальных приложений, особенно если это еще все накрыть чем-то. <br>поэтому я делаю первый тестовый прогон, смотрю в логе при загрузке какой dll в MyLoadLibraryExW происходит обнаружение нужного нам модуля, беру ее и еще +3 и -3 dlls и ставлю их условием при котором будет срабатывать GetDLLsBaseAddresses. в этом случае производительность не падает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398246&amp;user=31361&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=27" class="addthx" data-post="398246"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Medsft[/b]','')">Medsft</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 330.4 (мудрец), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.16<span style='color:green'>&nearr;</span>0.17</span><br>Статус: <a href="action=userinfo&amp;user=332">Участник</a><br><font color=blue>ILSpector Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 21:15 <br><script type="text/javascript">QU('Medsft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Medsft" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#28');return false;">#28</a> </span><div align=left><br>
Что есть нужная dll?<br><br><b>Добавлено спустя 3 минуты</b><br>Есть  такая классная прога https://www.apimonitor.com/ ловит все в том числе api mscoree. Кстати может кто полечит оч нужная вещь при исследовании net программ<br><br><b>Добавлено спустя 4 минуты</b><br>Заранее спасибо<br>zds прогон мой тест через неё может что станет понятней
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398248&amp;user=332&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=28" class="addthx" data-post="398248"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]zds[/b]','')">zds</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 57.0 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.42'>Активность: 0.05<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=31361">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 22:42 <br><script type="text/javascript">QU('zds','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zds" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#29');return false;">#29</a> </span><div align=left><br>
<I>Medsft пишет:<br>Что есть нужная dll? </I><br>та которую нужно патчить
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398250&amp;user=31361&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=29" class="addthx" data-post="398250"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]uncleua[/b]','')">uncleua</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 81.0 (постоянный), 88thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.72'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=7358">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2019 23:06 <br><script type="text/javascript">QU('uncleua','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=uncleua" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#30');return false;">#30</a> </span><div align=left><br>
<I>Medsft пишет:<br>Есть такая классная прога https://www.apimonitor.com/ ловит все в том числе api mscoree. Кстати может кто полечит оч нужная вещь при исследовании net программ </I><br><br>http://www.apimonitor.com/download/fulledition/APIMonitor.exe<br><br>SN: 2091178488-C4FF1B543386BCBC
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398251&amp;user=7358&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=30" class="addthx" data-post="398251"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3520" title="14-09-2019 21:33, ранг:652.7" target="_blank">mak</a>, <a href="action=userinfo&user=17048" title="15-09-2019 00:37, ранг:111.4" target="_blank">CyberGod</a>, <a href="action=userinfo&user=332" title="15-09-2019 06:51, ранг:317.4" target="_blank">Medsft</a>, <a href="action=userinfo&user=6946" title="16-09-2019 11:44, ранг:755.0" target="_blank">Isaev</a>, <a href="action=userinfo&user=37000" title="17-09-2019 16:56, ранг:5.8" target="_blank">Orlyonok</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]Medsft[/b]','')">Medsft</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 330.4 (мудрец), 334thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.83'>Активность: 0.16<span style='color:green'>&nearr;</span>0.17</span><br>Статус: <a href="action=userinfo&amp;user=332">Участник</a><br><font color=blue>ILSpector Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2019 00:33 <br><script type="text/javascript">QU('Medsft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Medsft" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=24863&amp;page=12#31');return false;">#31</a> </span><div align=left><br>
Uncleua большое спасибо.<br>zds длл которую нужно патчить это аргумент читающей апи смотри когда мои апи по проверке стронг нейм в логе появятся
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=398252&amp;user=332&amp;forum_n=1&amp;topic=24863&amp;page=12&amp;anchor=31" class="addthx" data-post="398252"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=11.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=9.html">10</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=10.html">11</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=11.html">12</a> . <b>13</b> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=13.html">14</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=14.html">15</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=15.html">16</a> . <a href="action=vthread&amp;forum=1&amp;topic=24863&amp;page=13.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Взлом .NET (part 2)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="24863">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24863" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
