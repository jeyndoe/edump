<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите разобраться с прогой - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть прога T-FLEX CAD 10. написана на VC++. ничем не упакована. Защищена ключем HASP HL. Суть в том , что от ключа толку мало,т.к. например в версии 9.015 достаточно было сделать retn в процедурах выхода (PostQuitMessage) и прога">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите разобраться с прогой</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=7884&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=7884&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 февраля 2007 11:52 &middot; Поправил: Tolkin <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Есть прога T-FLEX CAD 10. написана на VC++. ничем не упакована.<br>Защищена ключем HASP HL.<br><br>Суть в том , что от ключа толку мало,т.к.  например в версии 9.015 достаточно было сделать retn в процедурах выхода (PostQuitMessage) и прога нормально работала!<br><br>В последующих версиях эта оплошность была немного исправлена. В даной 10 версии например, если сделать retn на вызовах PostQuitMessage прога продолжает работать, но только все кнопки на панелях заблокированы(неактивны). А вот блокированы они изначально или после проверки наличия ключа, я не знаю. Проблема еще и в том, что класс всех панелей - Afx:00400000:8:00010011:00000010:00000000 и стандартные сообщения для работы с кнопками как для ToolBar они не используют.<br><br>Подскажите в каком направлении надо двигаться, на что ставить бряки или что искать в проге?<br>Как в даном классе окон происходит работа с кнопками панелей, может кто знает?<br><br>прога здесь: ftp://ftp.topsystems.ru/T-FLEX ftp://ftp.topsystems.ru/T-FLEX  10/T-FLEX CAD 10.zip<br>login: support  ;  password: eligarf1002
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=122404&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=1" class="addthx" data-post="122404"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2007 00:48 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Может вопрос не в тот форум?<br>Что, никаких намеков?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=122978&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=2" class="addthx" data-post="122978"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2007 03:44 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Tolkin пишет:<br>Проблема еще и в том, что класс всех панелей  </I><br> Название класса не может &quot;:&quot; содержать - ты что-то путаешь. Afx по моему связан с MFC - посмотри список DLL.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123140&amp;user=4072&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=3" class="addthx" data-post="123140"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 февраля 2007 05:42 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Да , прога написана с использованием MFC (MFC80U.dll) - но мне это ничего не дает,я в MFC не разбираюсь.<br>А с класом окон ничего не путаю - именно Afx:00400000:8:00010011:00000010:00000000 - что панели, что меню, что основное окно проги( смотрел разными SPY++).<br>Заблокированы основные пункты меню - &quot;открыть&quot; и т.д и связанные с пунктами кнопки на панели и акселераторы.<br>С разблокировкой кнопок панли ничего не вышло - не нашел как изменять их св-ва для даного класа.<br>Для меню попроще - стандартные API - EnableMenuItem - разблокировать можно - но при нажатии на них ничего не происходит (гдето проверяется что-то?). А разобраться со значениями параметров EnableMenuItem пока не получилось, там много переходов на разные процедуры, повторяющиеся неоднократно <img src="img/smilies/s9.gif" alt="">   Но попробую это сделать(только ручками трудно пока мне все это делать), раз других направлений действий никто не подсказывает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123331&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=4" class="addthx" data-post="123331"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 февраля 2007 01:29 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Tolkin</b><br><br>Ты еще бодаешься с ней? Если что - next hint: попробуй снять лог запросов к ключу: какие именно функции она использует (DeviceIoControl). Возможно, будет проще перейти на другой уровень.
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=123496&amp;user=8962&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=5" class="addthx" data-post="123496"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 февраля 2007 11:09 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Функции DeviceIoControl для общения с ключем я нашел.Но сами вызовы завуалированы в куче кода со множеством переходов, а так как самого ключа у меня нет то и разобраться где в конечном итоге происходит определение, что ключа нет, у меня не выходит, очень мало опыта<img src="img/smilies/s13.gif" alt=""><br><br>Как я понял, для ломки прог с HASP нужно иметь сам ключик. С другой стороны - в даной проге (если смотреть предыдущие версии) толку от такой защиты мало, так как снимается она изменением 5 байт в программе.Просто в даной версии нововведение - по умолчанию прога запускается в неактивном режиме(все функции деактивированы), а в предыдущих версиях - по дефолту все нормально и активно.<br><br>Хотя как именно сделана прога   -    изначально сделана неактивной и активируется только при наличии ключа или изначально активна но при отсутствии ключа деактивируется я не понял, а от этого зависит направление поиска. Как можно это определить?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123777&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=6" class="addthx" data-post="123777"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2007 05:53 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
&gt; Функции DeviceIoControl для общения с ключем я нашел<br><br>Отлично, разбери какие именно функции ключа (у ключа есть функции - например):<br><br>   /*<br>    *   Services common to All Local keys. HASP3, MEMOHASP, TIMEHASP.<br>    */<br>   LOCALHASP_ISHASP     =  1,<br>   LOCALHASP_HASPCODE   =  2,<br>   LOCALHASP_HASPSTATUS =  5,<br>   HASPAPI_VERSION      =  5,<br><br>Примерный формат вызова:<br><br>void HASPAPI hasp( int service,<br>                   int seed,<br>                   int lptnum,<br>                   int pass1,<br>                   int pass2,<br>                   int HASP_FAR* p1,<br>                   int HASP_FAR* p2,<br>                   int HASP_FAR* p3,<br>                   int HASP_FAR* p4 );<br><br>Исследуя какие именно функи вызываются и с какими параметрами - можно<br>задумацца о муляции.<br><br>&gt; Как я понял, для ломки прог с HASP нужно иметь сам ключик.<br><br>Не всегда. Допустим, если используется содержимое памяти ключа - нужно понять<br>зачем она проге: для явного сравнения или на вход какой-то CRC-подобной<br>функции подаюцца...<br><br>Искать использование ответов ключа удобнее (имхо) искать через bpm (break<br>on memory access).<br><br>&gt; Хотя как именно сделана прога [...]<br><br>Уверен - когда &quot;ключ&quot; ответит правильно хотя бы на пару первых<br>запросов - логика программы станет ГОРАЗДО яснее. Обычно первые<br>запросы - типа &quot;IsHaspHere?&quot; самые простые для муляции.
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=123903&amp;user=8962&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=7" class="addthx" data-post="123903"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 февраля 2007 23:42 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
То что ты описываешь, было реализовано в 8 версии проги где использовался HASP4. Причем все логи отлично отображались в эмуляторе HASP от brstudio поэтому там было полегче.<br><br>В 9 и 10 версиях используется HASP HL usb- формата (зеленого цвета - глянул на сайте - <br>вроде HASP HL Max :  - Защита до 112 локальных приложений или модулей на один ключ. <br>                                   - Защищенная память (4,096 байт). <br>                                   - Уникальный ID номер. <br>                                   - Высокий уровень защиты (алгоритм AES/128).)<br><br>Эмулятор от BRSTUDIO настроен наверно только на LPT ключи, поэтому с этими ключами ничего не отображается <img src="img/smilies/s9.gif" alt=""><br><br>В 9 и 10 первый же вызо ключа такой:<br><br><code>0041CDCE  |. 6A 00          PUSH 0                                   ; /hTemplateFile = NULL<br>0041CDD0  |. 6A 00          PUSH 0                                   ; |Attributes = 0<br>0041CDD2  |. 6A 03          PUSH 3                                   ; |Mode = OPEN_EXISTING<br>0041CDD4  |. 6A 00          PUSH 0                                   ; |pSecurity = NULL<br>0041CDD6  |. 6A 03            PUSH 3                                   ; |ShareMode = FILE_SHARE_READ|FILE_SHARE_WRITE<br>0041CDD8  |. 68 000000C0    PUSH C0000000                            ; |Access = GENERIC_READ|GENERIC_WRITE<br>0041CDDD  |. 50             PUSH EAX                                 ; |FileName =&gt; &quot;&#92;.FEnteDev&quot;<br>0041CDDE  |. FF15 00D24F00  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.CreateFile&gt;; CreateFileA<br>0041CDE4  |. 8BF0           MOV ESI,EAX<br>0041CDE6  |. 83FE FF        CMP ESI,-1<br>0041CDE9  |. 0F84 8E000000  JE TFlex.0041CE7D<br>0041CDEF  |. 8D4C24 0C      LEA ECX,DWORD PTR SS:[ESP+C]<br>0041CDF3  |. 6A 00          PUSH 0                                   ; /pOverlapped = NULL<br>0041CDF5  |. 51             PUSH ECX                                 ; |pBytesReturned<br>0041CDF6  |. 68 00200000    PUSH 2000                                ; |OutBufferSize = 2000 (8192.)<br>0041CDFB  |. 57             PUSH EDI                                 ; |OutBuffer<br>0041CDFC  |. 68 00200000    PUSH 2000                                ; |InBufferSize = 2000 (8192.)<br>0041CE01  |. 57             PUSH EDI                                 ; |InBuffer<br>0041CE02  |. 68 A824409C    PUSH 9C4024A8                            ; |IoControlCode = 9C4024A8<br>0041CE07  |. 56             PUSH ESI                                 ; |hDevice<br>0041CE08  |. FF15 04D24F00  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.DeviceIoCo&gt;; DeviceIoControl<br>0041CE0E  |. 56             PUSH ESI                                 ; /hObject<br>0041CE0F  |. 8BD8           MOV EBX,EAX                              ; |<br>0041CE11  |. FF15 20D14F00  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.CloseHandl&gt;; CloseHandle<br>0041CE17  |. 85DB           TEST EBX,EBX<br>0041CE19  |. 74 62          JE SHORT TFlex.0041CE7D<br>0041CE1B  |. 837C24 0C 08   CMP DWORD PTR SS:[ESP+C],8<br>0041CE20  |. 72 5B          JB SHORT TFlex.0041CE7D<br>0041CE22  |. 8B0F           MOV ECX,DWORD PTR DS:[EDI]<br>0041CE24  |. 33DB           XOR EBX,EBX<br>0041CE26  |. 85C9           TEST ECX,ECX<br>0041CE28  |. 55             PUSH EBP<br>0041CE29  |. 8D47 08        LEA EAX,DWORD PTR DS:[EDI+8]<br>0041CE2C  |. 76 42          JBE SHORT TFlex.0041CE70<br>0041CE2E  |. 8B4C24 20      MOV ECX,DWORD PTR SS:[ESP+20]<br>0041CE32  |. 8B7424 1C      MOV ESI,DWORD PTR SS:[ESP+1C]<br>0041CE36  |&gt; 83FB 0A        /CMP EBX,0A<br>0041CE39  |. 73 35          |JNB SHORT TFlex.0041CE70<br>0041CE3B  |. 8B68 04        |MOV EBP,DWORD PTR DS:[EAX+4]<br>0041CE3E  |. 8B10           |MOV EDX,DWORD PTR DS:[EAX]<br>0041CE40  |. 85ED           |TEST EBP,EBP<br>0041CE42  |. 77 25          |JA SHORT TFlex.0041CE69<br>0041CE44  |. 72 08          |JB SHORT TFlex.0041CE4E<br>0041CE46  |. 81FA FFFF0000  |CMP EDX,0FFFF<br>0041CE4C  |. 77 1B          |JA SHORT TFlex.0041CE69<br>0041CE4E  |&gt; 8B29           |MOV EBP,DWORD PTR DS:[ECX]<br>0041CE50  |. 66:8914AE      |MOV WORD PTR DS:[ESI+EBP*4],DX<br>0041CE54  |. 8B50 08        |MOV EDX,DWORD PTR DS:[EAX+8]<br>0041CE57  |. 8B29           |MOV EBP,DWORD PTR DS:[ECX]<br>0041CE59  |. C1EA 10        |SHR EDX,10<br>0041CE5C  |. 66:8954AE 02   |MOV WORD PTR DS:[ESI+EBP*4+2],DX<br>0041CE61  |. 8B29           |MOV EBP,DWORD PTR DS:[ECX]<br>0041CE63  |. 45             |INC EBP<br>0041CE64  |. 83C0 10        |ADD EAX,10<br>0041CE67  |. 8929           |MOV DWORD PTR DS:[ECX],EBP<br>0041CE69  |&gt; 8B17           |MOV EDX,DWORD PTR DS:[EDI]<br>0041CE6B  |. 43             |INC EBX<br>0041CE6C  |. 3BDA           |CMP EBX,EDX<br>0041CE6E  |.^72 C6          JB SHORT TFlex.0041CE36<br>0041CE70  |&gt; 57             PUSH EDI                                 ; /hMemory<br>0041CE71  |. FF15 08D24F00  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.LocalFree&gt;&gt;; LocalFree<br>0041CE77  |. 5D             POP EBP<br>0041CE78  |. 5F             POP EDI<br>0041CE79  |. 5E             POP ESI<br>0041CE7A  |. 5B             POP EBX<br>0041CE7B  |. 59             POP ECX<br>0041CE7C  |. C3             RETN<br>0041CE7D  |&gt; 57             PUSH EDI                                 ; /hMemory<br>0041CE7E  |. FF15 08D24F00  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.LocalFree&gt;&gt;; LocalFree<br>0041CE84  |&gt; 5F             POP EDI<br>0041CE85  |. 5E             POP ESI<br>0041CE86  |. 5B             POP EBX<br>0041CE87  |. 59             POP ECX<br>0041CE88  . C3             RETN</code><br><br>Входной буфер при этом забит нулями.<br><br>Если вернуться по дереву вызовов , видим интересные строки:<br><br>0040D070  |. 68 740C5D00    PUSH TFlex.005D0C74<br>0040D075  |. 68 481B5000    PUSH TFlex.00501B48                      ;  ASCII &quot;ghIpRlTDffgUg/ZNFWXTHOk1Y0aiiAb59AcMk4WlYN/FxJ9XobUaABmqmLeARH3Q7rGws p8C9jQRez/FGZkPalFFLfjq5lgqt1jA413oonZJ23WHrKVMWi7D/z52gVI+wWHmaJ1G3vz gNZTdDMkjOn+2fja7yH7EV7GsL2t6NsLb/rvWI4JsEGxrjQo1KU8zUxyb3vmdT1VUt3+xl u2zpV9Vkzo9zv3F+O5kufQKcZNah&quot;...<br>0040D07A  |. 68 0040FFFF    PUSH FFFF4000<br>0040D07F  |. E8 ECE60000    CALL TFlex.0041B770    <br>0040D084  |. 83F8 0B        CMP EAX,0B<br>0040D087  |. 0F84 86020000  JE TFlex.0040D313<br>0040D08D  |. 33FF           XOR EDI,EDI<br>0040D08F  |. 3BC7           CMP EAX,EDI<br>0040D091  |. 75 3C          JNZ SHORT TFlex.0040D0CF<br><br>Не похож ли один из входных параметров на ключ расшифровки AES ?<br>Хотя входной буфер пуст - просто читаем память ключа?<br><br>Эсли идти по аналогии версий проги, то думаю что сами данные или функции проги  не шифруются,<br>т.к. в 9.015 мы только убирали переходы на выходы из программы (ключ не эмулировали) и прога отлично работала. Не думаю, что защита сильно изменилась (только стало все неактивно).<br><br>С другой стороны, если что пошифровано - то без люча - полный пипец?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=123982&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=8" class="addthx" data-post="123982"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2007 00:56 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
&gt; Входной буфер при этом забит нулями<br><br>Не могу в это поверить... Вот тут:<br><br>...<br>0041CDF6 |. 68 00200000 PUSH 2000 ; |OutBufferSize = 2000 (8192.) <br>0041CDFB |. 57 PUSH EDI ; |OutBuffer <br>0041CDFC |. 68 00200000 PUSH 2000 ; |InBufferSize = 2000 (8192.) <br>0041CE01 |. 57 PUSH EDI ; |InBuffer <br>0041CE02 |. 68 A824409C PUSH 9C4024A8 ; |IoControlCode = 9C4024A8 <br>0041CE07 |. 56 PUSH ESI ; |hDevice <br>0041CE08 |. FF15 04D24F00 CALL DWORD PTR DS:[&lt;&amp;KERNEL32<br><br>На что указывают ОБА указателя до и после вызова? По идее - это пакет в драйвер, там должны быть как минимум пассы. Потом размер - 2000 - можешь сдампить все? Пакет может быть шифрован (xor AA+rol).<br><br>&gt; Не похож ли один из входных параметров на ключ расшифровки AES ? <br><br>Мне кажецца - base64. С HL вообще не работал, но возможно ты прав. Возможно это &quot;вендор id&quot; - типа пасса на доступ к глючу(!)/совсем не те старые два по 16 бит.<br><br>&gt; Хотя входной буфер пуст - просто читаем память ключа?<br><br>Обязательно надо нарыть номер функции, оно в пакете.<br><br>&gt; С другой стороны, если что пошифровано - то без люча - полный пипец?<br><br>Для тех кто не знает (я, etc) что в ключе... но AES&#039;а скорее всего (99,8) в нем нет.
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=123991&amp;user=8962&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=9" class="addthx" data-post="123991"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2007 05:56 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
При обычном запуске обращается 2 раза:<br><br><code>7C801625   CALL to DeviceIoControl from TFlex.0041CE08<br>             hDevice = 00000170 (window)<br>             IoControlCode = 9C4024A8<br>             InBuffer = 00074EA0<br>             InBufferSize = 2000 (8192.)<br>             OutBuffer = 00074EA0<br>             OutBufferSize = 2000 (8192.)<br>             pBytesReturned = 00FEF854<br>             pOverlapped = NULL<br>7C801625   Breakpoint at kernel32.DeviceIoControl<br><br>7C801625   CALL to DeviceIoControl from TFlex.0041CE08<br>             hDevice = 000002B8<br>             IoControlCode = 9C4024A8<br>             InBuffer = 00075A70<br>             InBufferSize = 2000 (8192.)<br>             OutBuffer = 00075A70<br>             OutBufferSize = 2000 (8192.)<br>             pBytesReturned = 00FEF644<br>             pOverlapped = NULL<br>7C801625   Breakpoint at kernel32.DeviceIoControl</code><br><br>в обоих случаях буферы забиты нулями ( может 0 - функция инициализации?)<br><br>после считывания ключа и преобразовний до ret (см. код выше) получается что все байты в буфере кроме первых 8 преобразуются в #FE<br><br>-первый ответ<br><br><code>00074EA0  F0 9F 07 00 80 A0 06 00 EE FE EE FE EE FE EE FE  рџ.Ђ .оюоюоюою<br>00074EB0  EE FE EE FE EE FE EE FE EE FE EE FE EE FE EE FE  оюоюоюоюоюоюоюою<br>00074EC0  EE FE EE FE EE FE EE FE EE FE EE FE EE FE EE FE  оюоюоюоюоюоюоюою</code><br><br>-второй ответ<br><code>00075A70  08 E0 07 00 78 01 05 00 EE FE EE FE EE FE EE FE  а.x.оюоюоюою<br>00075A80  EE FE EE FE EE FE EE FE EE FE EE FE EE FE EE FE  оюоюоюоюоюоюоюою<br>00075A90  EE FE EE FE EE FE EE FE EE FE EE FE EE FE EE FE  оюоюоюоюоюоюоюою</code><br><br>Наверно надо искать далее обращение к этим 8 байтам и смотреть что там происходит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124046&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=10" class="addthx" data-post="124046"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2007 06:13 &middot; Поправил: Tolkin <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Хотя я ошибся, это действие функции LocalFree<br><br>После получения ответа проверяем ESP+С ( у меня =0) и на выход<br> <br><code>0041CE1B  |. 837C24 0C 08   CMP DWORD PTR SS:[ESP+C],8<br>0041CE20  |. 72 5B          JB SHORT TFlex.0041CE7D<br><br>0041CE7D  |&gt; 57             PUSH EDI                                     ; /hMemory = 00074EA0<br>0041CE7E  |. FF15 08D24F00  CALL DWORD PTR DS:[&lt;&amp;KERNEL32.LocalFree&gt;]    ; LocalFree<br>0041CE84  |&gt; 5F             POP EDI<br>0041CE85  |. 5E             POP ESI<br>0041CE86  |. 5B             POP EBX<br>0041CE87  |. 59             POP ECX<br>0041CE88  . C3             RETN<br><br></code><br><br>могут параметры в стеке после DeviceIoControl интерпретироваться как какойто ответ от ключа?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124049&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=11" class="addthx" data-post="124049"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2007 07:09 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Сори,неувязочка.<br>Снес эмулятор и поставил заново дрова на HASP<br><br>Теперь немного изменилось.<br><br>ESP+C  --&gt; это ( pBytesReturned = 00FEF854)   теперь не равно нулю - драйвер без ключа чтото возвращает, так что надо проверить все заново
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124061&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=12" class="addthx" data-post="124061"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2007 12:39 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Первый кусок мне нравился больше <img src="img/smilies/s2.gif" alt=""><br><br>Немного странно что пакет такой huge (0x2000), но если это точно так, а еще бы я еще раз проверил что это DeviceIo с хэндлом от открытого FEnteDev или Hardlock, то, my humble op, там точно должны валяцца ненулевые чиселки...<br><br>Про шифрование я уже писал выше:<br><br>xor AAh + ror 4,<br><br>но это было в хазп4.<br><br>&gt; могут параметры в стеке после DeviceIoControl интерпретироваться как какойто ответ от ключа?<br><br>Я такого не видел, вряд ли. Как правило пуляют на вход inBuff=OutBuff одинакого размера (как у тебя в первом примере). Перед входом в DeviceIo - по этим указателям пакет запроса, первая часть открыта (небольшая), потом пошифровано (выше).<br><br>&gt; Наверно надо искать далее обращение к этим 8 байтам и смотреть что там происходит.<br><br>I would do so. Я бы юзал bpm, скорее всего лучше - как ты говоришь - на &quot;интересные&quot; байты.<br><br>PS Еще можно посмотреть память процесса (&quot;s&quot; в сайсе) на предмет пассов глюча (пассы к твоей проге можно попытацца найти на сайте MeteO/ru-board/etc).
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=124119&amp;user=8962&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=13" class="addthx" data-post="124119"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 февраля 2007 22:01 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
С первым вызовом вроде разобрался<img src="img/smilies/s1.gif" alt=""><br>Этот код лежит в свободном доступе, входной буфер забит нулями - это не что иное , как определение версии драйвера (IoControlCode = 9C4024A8), остальные вызовы попрятаны в коде, позже выложу лог обращений.<br><br>Пассы ключа я знаю: 426B:6981
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124167&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=14" class="addthx" data-post="124167"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 февраля 2007 04:08 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Следующие обращения к ключу:<br><br>7C801625   CALL to DeviceIoControl<br>             hDevice = 0000016C<br>             IoControlCode = 9C402450<br>             InBuffer = 00FEF664<br>             InBufferSize = 6<br>             OutBuffer = 00FEF664<br>             OutBufferSize = 6<br>             pBytesReturned = 00FEF66C<br>             pOverlapped = NULL<br>7C801625   Breakpoint at kernel32.DeviceIoControl<br><br><br>00FEF664  01 00 00 00 03 00                                ....        (вход)<br><br>00FEF664  01 00 FA FA 57 03                                .ъъW   (выход)<br><br><br>7C801625   CALL to DeviceIoControl<br>             hDevice = 0000016C<br>             IoControlCode = 9C4024A0<br>             InBuffer = 00FEF66C<br>             InBufferSize = 4<br>             OutBuffer = 00FEF66C<br>             OutBufferSize = 4<br>             pBytesReturned = 00FEF668<br>             pOverlapped = NULL<br>7C801625   Breakpoint at kernel32.DeviceIoControl<br><br>00FEF66C  B2 BA EF BE                                      Ієпѕ<br><br>00FEF66C  BE BA FE 2A                                      ѕєю*<br><br>7C801625   CALL to DeviceIoControl<br>             hDevice = 0000016C<br>             IoControlCode = 9C402450<br>             InBuffer = 00FEF618<br>             InBufferSize = 6<br>             OutBuffer = 00FEF618<br>             OutBufferSize = 6<br>             pBytesReturned = 00FEF620<br>             pOverlapped = NULL<br>7C801625   Breakpoint at kernel32.DeviceIoControl<br><br>00FEF618  00 00 00 00 10 9D                                ....ќ<br><br>00FEF618  00 00 FA FA 28 03                                ..ъъ(<br><br>7C801625   CALL to DeviceIoControl from TFlex.004506DA<br>             hDevice = 0000016C<br>             IoControlCode = 9C402458<br>             InBuffer = 00069D10<br>             InBufferSize = 100 (256.)<br>             OutBuffer = 00069D10<br>             OutBufferSize = 100 (256.)<br>             pBytesReturned = 00FEF688<br>             pOverlapped = NULL<br>7C801625   Breakpoint at kernel32.DeviceIoControl<br><br>00069D10  23 18 6E 52 D8 75 7C CF E5 C8 F0 DF D6 59 E4 EF  #nRШu|ПеИрЯЦYдп<br>00069D20  72 1D AE E6 BC 5D 41 84 0E 61 D0 26 5C 06 C1 ED  r®жј]A„aР&amp;Бн<br>00069D30  6D 88 01 DC 6E 21 F1 DE BA F7 46 79 AE 4C 5F 2D  m€Ьn!сЮєчFy®L_-<br>00069D40  ED 48 19 C0 CD 06 B2 66 8C B1 11 2E 91 F8 E0 21  нHАНІfЊ±.‘ша!<br>00069D50  4A 06 6D 6B 14 EA C6 B8 3B 75 CA C4 5C 04 69 BE  JmkкЖё;uКДiѕ<br>00069D60  BF 0F 0A 04 2E 3B 80 50 5B DF 2E 78 5C 49 0F 5E  ї..;ЂP[Я.xI^<br>00069D70  B7 50 2C 75 3E 8E 9C AA F4 BA 11 17 D0 4F 85 45  ·P,u&gt;ЋњЄфєРO…E<br>00069D80  54 51 A9 26 76 3D 85 69 07 E4 7E 4F C1 1B 28 51  TQ©&amp;v=…iд~OБ(Q<br>00069D90  CC A5 9A 5F D8 92 07 40 69 A2 CB 09 45 73 9B D5  МҐљ_Ш’@iўЛ.Es›Х<br>00069DA0  06 2D 52 99 DE 2A 4E 7A BE 0E 40 5E B0 EE 25 4C  -R™Ю*Nzѕ@^°о%L<br>00069DB0  7F DA F5 51 6F CF F1 4A 67 BC 21 78 DB FE 6A D2  ЪхQoПсJgј!xЫюjТ<br>00069DC0  E6 37 AA FB 6F C5 D9 04 17 3F 02 00 62 7F 01 05  ж7ЄыoЕЩ?.b<br>00069DD0  8E 0A 89 05 86 0A 89 05 8E 1A A9 35 B6 3A C9 D5  Ћ.‰†.‰Ћ©5¶:ЙХ<br>00069DE0  DE FC 19 B6 52 6D 70 89 04 7E A5 1E CC DB 07 8D  Юь¶Rmp‰~ҐМЫЌ<br>00069DF0  1C 94 09 81 F8 2F F2 2A E6 19 A2 58 5D 68 AB 72  ”.Ѓш/т*жўX]h«r<br>00069E00  AA 5C 6F A4 55 6F A9 59 6C AB 6C AC 6A A9 F7 89  Єo¤Uo©Yl«l¬j©ч‰<br><br>00069D10  23 1A 6A 50 D5 7C 83 D4 E6 CB F7 EC DF 74 F7 08  #jPХ|ѓФжЛчмЯtч<br>00069D20  80 0B 7E D9 CC 50 2D 7B 26 6C F1 3B AB 35 1A 83  Ђ~ЩМP-{&amp;lс;«5ѓ<br>00069D30  F6 17 9B 80 1B 8D 2B 25 46 39 9F E8 23 B2 F3 F1  ц›ЂЌ+%F9џи#Іус<br>00069D40  A1 05 DF 90 C6 06 B9 70 B1 2E 81 84 9B 1A CB E6  ЎЯђЖ№p±.Ѓ„›Лж<br>00069D50  20 66 54 5C 08 DB 9A F0 43 D4 05 24 75 35 D8 6A   fTЫљрCФ&#036;u5Шj<br>00069D60  20 8E BF 15 9E 06 6D 02 A9 C6 1F C5 B7 50 60 4F   Ћїћm©ЖЕ·P`O<br>00069D70  C7 DC F2 F9 FD 06 4F 18 56 12 4F 1E 1D 6C 15 0D  ЗЬтщэOVOl.<br>00069D80  E2 35 87 FB 23 78 6B 43 DC 9D E1 B1 24 7C 82 95  в5‡ы#xkCЬќб±&#036;|‚•<br>00069D90  CC D9 02 FC A1 93 3F A9 09 79 E7 47 AB 15 7B E7  МЩьЎ“?©.yзG«{з<br>00069DA0  4D A7 FF 7A F5 70 E5 3E BD 3C BD 3A BD 40 8D EE  M§яzхpе&gt;Ѕ&lt;Ѕ:Ѕ@Ќо<br>00069DB0  54 9E E4 6B F8 7B 02 48 88 D8 29 BA 4B 9A E5 69  Tћдkш{H€Ш)єKљеi<br>00069DC0  F7 8F CB 06 41 74 0F 4F 8F 14 02 00 50 62 43 74  чЏЛAtOЏ.PbCt<br>00069DD0  32 86 D9 AE 08 5D 39 8D EA CF B7 10 64 3D AA 10  2†Щ®]9ЌкП·d=Є<br>00069DE0  65 37 AD 00 56 51 48 1D 9C 20 77 6F 5B 61 39 BF  e7­.VQHњ wo[a9ї<br>00069DF0  52 2A C0 95 EF 0D 6F 8E EF 14 6B 91 E7 03 5B 40  R*А•п.oЋпk‘з[@<br>00069E00  13 86 D8 CC A1 35 F2 26 C6 95 09 6A 8C F4 BB A7  †ШМЎ5т&amp;Ж•.jЊф»§<br><br>В последнем вызове входные данные каждый раз разные. Далее происходит исключение 6D9.<br><br>Указанные 4 вызова образуют HASP API 01 - IsHasp (смотрел аналогию с 8 версией)<br><br>Что делать дальше? Куда можно применить указанную тобой шифровку и как?<br><br>Ключи для T-Flex высших версий поддерживают и низшие версии, так что думаю шифроваться должно одинаково для совместимости (Верно?)<br>Если это так, то можно попробовать данные из 10 расшифровать с помощью 8 с эмулятором?<br>Но входные данные каждый раз меняются, нужна процедура преобразования (на Delfi например) с использованием структуры EDStruct издампа для эмулятора.<br><br>Просмотрев логи обращений в 8 я увидел, что I<b>oControlCode = 9C402458</b> используется для всех вызовов HASP API - 05,06, 32, <b>3D</b>  --  т.е. выходит все данные обмена шифруются?<br><br>REG файл для эмулятора могу предоставить, если надо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124204&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=15" class="addthx" data-post="124204"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 февраля 2007 13:05 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Нашел в программе начальный вызов API HASP (только он немного изменен), там и пассы ключа есть, и в буфере входные данные нормальные (незашифрованные еще). Попробую в этом месте поковырять.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124339&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=16" class="addthx" data-post="124339"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 февраля 2007 14:17 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Я посмотрел твои первые вызовы. Первые 3 вроде бы действительно &quot;проходные&quot;, а вот с буфером длиной 0x100 - действительно чудной. Возможно это тот самый vendor id, мне рассказывали про него. Дешифровка ничего не дала (xorAA/ror 4), калькулятор на всякий случай приложил. Единственное что странновато: если проксорить ответ на запрос, то получаецца:<br><br>23 18 6E 52 D8 75 7C CF E5 C8 F0 DF D6 59 E4 EF<br>^<br>23 1A 6A 50 D5 7C 83 D4 E6 CB F7 EC DF 74 F7 08<br>=<br>00 02 04 02 0D 09 FF 1B 01 03 07 33 09 2D 13 E7<br><br>Наверное, это ничего не значит... Надо смотреть использование и/или образование запроса, возможно там еще один алго дешифровки.<br><br>Завтра напишу подробнее.<br><br><img src="img/attach.gif" alt=""> <a href="./files/dfaa_25.02.2007_CRACKLAB.rU.tgz">dfaa_25.02.2007_CRACKLAB.rU.tgz</a> - xorAA.rar
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=124344&amp;user=8962&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=17" class="addthx" data-post="124344"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 07:14 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Да, верно, первые вызовы до вызова с буфером 0х100 получают сведения о версии драйвера , именно поэтому не работал эмулятор от глаши и в нем ничего не отображалось, т.к. в нем используются дрова от HASP4, в котором по видимому первое обращение с буфером 0х200 не срабатывало (возвращались одни нули). Наверно новый драйвер от HASP HL поддерживает новые функции<br><br><b>кстати, есть ли инфа о новых API в HASP HL, и способах их вызова(параметры), ничего не сменилось?</b><br><br>на даный момент первые ответы я сэмулировал как для нового драйвера, так что эмулятор от глаши теперь работает и хоть можно просмотреть логи запросов к ключу (если в параметрах функций ничего не поменялось - то можно доверять), логи выложу.<br><br><b>Не знает ли кто, есть ли дрова для эмулятора от глаши для HASP HL?</b><b> или другие эмуляторы с поддержкой HASP HL?</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124457&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=18" class="addthx" data-post="124457"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 07:26 &middot; Поправил: Tolkin <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
значения исходно буфера 0х100 до всяких преобразований:<br>сначала:<br><code>00069D10  00 00 00 00 00 00 04 00 6B 42 00 00 81 69 00 00  .......kB..Ѓi..<br>00069D20  00 00 00 00 00 00 00 00 00 00 00 00 01 00 78 03  .............x<br>00069D30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>00069D40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>00069D50  00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00  ...............<br>00069D60  00 00 48 00 00 00 00 00 00 00 00 00 00 00 00 00</code><br><br>затем<br><code>00069D10  03 55 00 00 00 00 04 00 6B 42 00 00 81 69 00 00  U.....kB..Ѓi..<br>00069D20  00 00 00 00 00 00 00 00 00 00 00 00 01 00 78 03  .............x<br>00069D30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>00069D40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>00069D50  00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00  ...............<br>00069D60  00 00 48 00 00 00 00 00 00 00 00 00 00 00 00 00</code><br><br>а потом до вызова DeviceIoControl преобразуются и не один раз в хрень, каждый раз разную.<br><br>ясно видно пассы ключа  426B:6981
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124460&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=19" class="addthx" data-post="124460"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 07:48 &middot; Поправил: Tolkin <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Этот вызов в эмуляторе отображается как команда 00, значение регистров возврата<br>AX 0000  BX 13A7  CX 001D  DX 3892<br><br>выходной буфер после всех преобразований<br><code>00069D10  03 55 00 00 00 00 04 00 6B 42 00 00 81 69 00 00  U.....kB..Ѓi..<br>00069D20  00 00 00 00 00 00 00 00 00 00 00 00 01 00 78 03  .............x<br>00069D30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>00069D40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................<br>00069D50  00 00 00 00 00 00 74 54 D5 B3 00 00 81 00 00 00  ......tTХі..Ѓ...<br>00069D60  00 00 48 00 00 00 00 00 00 00 00 00 00 00 00 00  ..H.............</code><br><br>Еще раз повторюсь, что эмулятор работает только как с HASP4
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124463&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=20" class="addthx" data-post="124463"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 07:52 &middot; Поправил: Tolkin <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Для HASP4 <br>Service1=Service 0 (00h) : (It is not documentary)<br>Description1=Initialize HASP key.<br><br>Как проверить, верно ли он все вернул, и не надо ли в этом вызове что-нить изменять?<br><br>Номера остальных команд: 08, 06, 05, 4Е  в эмуляторе<br><br>Service1=Service 8 (08h) : CheckHaspGeneration<br>Description1=Checks if connected key is a HASP4 generation key.<br><br>Service1=Service 6 (06h) : HaspID<br>Description1=Determine the HASP ID number.<br><br>Service1=Service 5 (05h) : HaspStatus<br>Description1=Check the type of HASP connected to the computer. Also check to which<br><br>Service1=Service 78 (4Eh) : HaspID<br>Description1=Determine the Time HASP ID number.<br><br>Не уверен что для HASP HL значения вызовов теже
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124465&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=21" class="addthx" data-post="124465"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 10:49 &middot; Поправил: Chingachguk <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
&gt; Номера остальных команд: 08, 06, 05, 4Е в эмуляторе<br><br>Ты хочешь сказать что видишь как прога зовет эти функи?<br><br>ps На ru-board AlexVel сегодня изложил достаточно интересную вводную информацию по этому поводу, втч про пакет 0x100.
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=124486&amp;user=8962&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=22" class="addthx" data-post="124486"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 12:08 &middot; Поправил: Tolkin <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
да, именно эти номера отображаются в эмуляторе<br>а в проге на DeviceIoControl для всех этих команд один размер пакета 0х100 и<br> один номер IoControlCode = 9C402458<br><br>не нашел что-то я инфы, скинь ссылку плиз
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124500&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=23" class="addthx" data-post="124500"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 12:59 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
forum.ru-board.com,<br>регистрация нужна,<br>затем в &quot;андеграунд-&gt;варезник&quot;,<br>отселектировать темы по &quot;hasp&quot;
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=124506&amp;user=8962&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=24" class="addthx" data-post="124506"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 13:24 &middot; Поправил: Tolkin <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Спасибо, надыбал.<br>Но маловато инфы. Интересно все же, то что у меня отображается в эмуле для HASP4 - полная эрунда?<br><br>Но если глянуть на буфер даных до и после вызова (те что не зашифрованы) то видно, что структура такаяже как и до вызова, добавляется несколько байт.Т.е можно предполагать, что оно все же эмулируется?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124511&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=25" class="addthx" data-post="124511"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 23:32 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Полагаю, все функи кроме новых эмуляцца нормально. Но это только гипотеза. Обычно если нет ключа но есть корректный драйвер, то все заканчивается на 2-3 вызове (например на 5-ой функе) - приложению этого достаточно чтобы сделать &quot;выводы&quot;.<br><br>Однако раз после какой-то функи все обрывается, то отсюда может следовать что все же чего-то ему в конце-концофф не понравилось. Мое имхо счас - тип (поколение) ключа.<br><br>ps check PM
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=124566&amp;user=8962&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=26" class="addthx" data-post="124566"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2007 06:30 &middot; Поправил: Tolkin <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
=== ЧИТАТЬ ВСЕМ (новичкам) ===<br><br>Я около 2х недель топтался на месте с этой прогой а на путь истинный меня так и не направили ( спасибо хоть <b>Chingachguk</b> откликнулся).<br><br>И вот за один вечер я прозрел и решил выложить свои мыслишки.<br>А все началось с того, что от нехватки информации я пошел на ... сайт Алладина и там нашел ответы на почти все свои вопросы <img src="img/smilies/s1.gif" alt=""><br><br>Итак, что я там нашел:<br>- HASP_HL_Guide_RU.zip - руководство пользователя HASP HL на русском языке, где описаны все новые функции (20 штук) параметры их вызовов, возвращаемые данные и коды ошибок.(в аттач не влезает)<br><br>-две dll с HASP API для HASP4 и HASP hl.<br><br>Проанализировав свою прогу я увидел, что вней код HASP API , такой же как и код в DLL, т.е. теперь поиск HASP API в программах становиться тривиальной задачей и может быть автоматизирован (по сигнатурам например).<br><br>Порывшись в инете я публичных эмуляторов для HASP HL не нашел<img src="img/smilies/s4.gif" alt=""><br><br>И тут меня осенило: почему все питаются писать эмуляторы в виде драйверов - это и сложно, и необходимо физически эмулировать все HASP API (а для HASP HL функции hasp_decrypt() Дешифрует буфер с помощью алгоритма AES и hasp_encrypt() Шифрует буфер с помощью алгоритма AES реализовать можно только табличным способом наверно), что для меня лично невероятно сложно.<br><br>Но зачем все так усложнять?<br>Ведь тот же логгер, дампер и эмулятор достаточно просто реализовать даже начинающему в RING 3, перехватывая сами HASP API !<br><br>Хотя этот метод не универсален, но для почти любой программы может быть реализован при наличии ключа в минимальные сроки (даже с помощью скрипта к Olly).<br><br><br>Именно так я и попробую сломать свою прогу <img src="img/smilies/s1.gif" alt=""><br><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/5cd8_28.02.2007_CRACKLAB.rU.tgz">5cd8_28.02.2007_CRACKLAB.rU.tgz</a> - dll.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124805&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=27" class="addthx" data-post="124805"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2007 07:37 <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
Справочник по HASP HL API (выдержки)<br><br><img src="img/attach.gif" alt=""> <a href="./files/aae5_28.02.2007_CRACKLAB.rU.tgz">aae5_28.02.2007_CRACKLAB.rU.tgz</a> - Справочник по HASP HL API.txt
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124812&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=28" class="addthx" data-post="124812"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2007 11:53 &middot; Поправил: Chingachguk <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
&gt; и необходимо физически эмулировать все HASP API<br><br>На самом деле число API для приложения часто более has diversity чем число функций ключа<br><br>А скажи еще раз plz самые последние данные по тому, какие функи вызываюцца у твоего приложения.
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=124846&amp;user=8962&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=29" class="addthx" data-post="124846"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Tolkin[/b]','')">Tolkin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 64.0 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.04<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=131">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2007 22:06 &middot; Поправил: Tolkin <br><script type="text/javascript">QU('Tolkin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tolkin" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=7884&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
Достал ключик к проге только для 9 версии <br>вручную вызовы HASP API проверю и логи выложу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124882&amp;user=131&amp;forum_n=5&amp;topic=7884&amp;page=0&amp;anchor=30" class="addthx" data-post="124882"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=7884&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=7884&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите разобраться с прогой</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="7884">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=7884" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
