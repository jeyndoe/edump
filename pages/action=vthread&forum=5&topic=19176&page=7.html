<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка StarForce 4.70 - Пьеса в нескольких действиях - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Информации об исследовании данной защиты в свободном доступе почти нет,кроме мануала про снятие SF 5.50 с игры King&#039;s Bounty. Особого интереса этот мануал не представляет по той причине,что на игру есть нормальные NoDVD.">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=41144'>Adler</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка StarForce 4.70 - Пьеса в нескольких действиях</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=6.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=6.html">7</a> . <b>8</b> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=9.html">10</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=8.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Calypso[/b]','')">Calypso</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30561">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 октября 2011 23:54 <br><script type="text/javascript">QU('Calypso','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Calypso" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#1');return false;">#1</a> </span><div align=left><br>
Информации об исследовании данной защиты в свободном доступе почти нет,кроме мануала про снятие SF 5.50 с игры King&#039;s Bounty. Особого интереса этот мануал не представляет по той причине,что на игру есть нормальные NoDVD.<br>Идея была такая - снять дамп с запущенного через эмулятор процесса ,затем восстанавливать недостающие процедуры из Protect.dll.<br>Версия 4.70 очень поганая, запустить её с эмулятором удается с 10-15 раза.<br>Если в отладчике открывать сам exe-файл ,то после тыкания Shift+F9 выбрасывает в Protect.dll . Никакого EP нет.<br>Вообщем пусть гуру объяснят как тут надо действовать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=293888&amp;user=30561&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=1" class="addthx" data-post="293888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Calypso[/b]','')">Calypso</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30561">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 17:56 &middot; Поправил: Calypso <br><script type="text/javascript">QU('Calypso','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Calypso" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#2');return false;">#2</a> </span><div align=left><br>
В статье чувака,который ломал King Bounty написано что надо поставить бряку на секцию .text и поставить EIP на начало ВМ, т.е. на адрес 02071FE2. Затем пустить трассировку и увидим на какой адрес petka.exe выйдет отладчик. И его надо подменить в нашем джампе. Я так это понял<br><I>ThugboyZ пишет:<br>чувак тебе повезло у тебя уже есть дамп, есть восстановленный IAT, тебе даже сказали как дампить ВМ. Тебе осталось только сдампить секцию sforce3 и всю выделеную память приклеить её к petka.exe и импорт через IMPRec зафигачить всё! У тебя он будет работать тебе хватит цпуиди тебе нафиг-то фиксить если у тебя будет работать? По моему это и была изначальная цель, разве нет? </I><br>Вот уж действительно петросян отдыхает. Учи матчасть чем SF Basic от Pro отличается, не только импортом
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294542&amp;user=30561&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=2" class="addthx" data-post="294542"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Psalmopoeus Pulcher[/b]','')">Psalmopoeus Pulcher</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.8 (посетитель), 23thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 18:13 <br><script type="text/javascript">QU('Psalmopoeus Pulcher','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Psalmopoeus Pulcher" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#3');return false;">#3</a> </span><div align=left><br>
<I>Calypso пишет:<br>В статье чувака,который ломал King Bounty написано что надо поставить бряку на секцию .text и поставить EIP на начало ВМ, т.е. на адрес 02071FE2. Затем пустить трассировку и увидим на какой адрес petka.exe выйдет отладчик. И его надо подменить в нашем джампе. Я так это понял  </I><br>К стару 4.70 это <b>НЕ</b> относится. Это статья годна для бэйсик версий 5.5+. Новый стар ворует условные\безусловные переходы и вызовы функций. Это и антидамп и триггеры (проверка целостности кода приложения, валидности рег. данных и проч.). На 4.7 этого не было. Все прыжки в ВМ - <b>только</b> виртуализированый код приложения!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294545&amp;user=18297&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=3" class="addthx" data-post="294545"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Calypso[/b]','')">Calypso</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30561">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 18:21 &middot; Поправил: Calypso <br><script type="text/javascript">QU('Calypso','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Calypso" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#4');return false;">#4</a> </span><div align=left><br>
Тогда объясните ещё раз,что делать с прыжками:<br>004036E0  -E9 FDE8C601      JMP 02071FE2<br>004036E6  -E9 B3E7C601      JMP 02071E9E<br>0044A8A0  -E9 0D77C201      JMP 02071FB2<br>00496C80  -E9 39B3BD01      JMP 02071FBE<br>00496C99  -E9 30B2BD01      JMP 02071ECE<br>00496CA5  -E9 6CB2BD01      JMP 02071F16<br>00496CB2  -E9 3BB2BD01      JMP 02071EF2<br>00496CC0  -E9 39B2BD01      JMP 02071EFE<br>00496CEA  -E9 33B2BD01      JMP 02071F22<br>004A9130  -E9 818DBC01      JMP 02071EB6<br>ну и так далее.<br>Я чего то никак не соображу,на какой адрес теперь будет передаваться управление<br>Адреса 020... бла бла - виртуальные,их генерирует движок Старфорса рандомно. Если сделать фиксированный дамп - ничего работать не будет
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294546&amp;user=30561&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=4" class="addthx" data-post="294546"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Nightshade[/b]','')">Nightshade</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/4618.gif" alt=""><br><span class=txtSm>Ранг: 241.9 (наставник), 107thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.19'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4618">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 18:39 <br><script type="text/javascript">QU('Nightshade','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Nightshade" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#5');return false;">#5</a> </span><div align=left><br>
В фиксированном дампе ничего генерится не будет. Все прыжки будут в одно и тоже место.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294549&amp;user=4618&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=5" class="addthx" data-post="294549"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ThugboyZ[/b]','')">ThugboyZ</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.9 (новичок), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.65'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=23175">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 18:50 <br><script type="text/javascript">QU('ThugboyZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ThugboyZ" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#6');return false;">#6</a> </span><div align=left><br>
5.5+ дампить надо отдельно protect.dll, тогда джампы можно не трогать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294550&amp;user=23175&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=6" class="addthx" data-post="294550"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Calypso[/b]','')">Calypso</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30561">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 19:10 &middot; Поправил: Calypso <br><script type="text/javascript">QU('Calypso','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Calypso" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#7');return false;">#7</a> </span><div align=left><br>
Да там какая-то защита от дампа стоит похоже,наблюдайте что происходит по адресу 0053248c<br>По-крайней мере ,сдампленный файл с пришитыми ВМ+ память + фиксенный импорт сыпется при попытке записать по этому адресу, там то есть код то нету.<br>Тут вылетает<br>MSVCR71.__set_app_type<br>004E71E5   59               POP ECX<br><b>004E71E6   830D 8C245300 FF OR DWORD PTR DS:[53248C],FFFFFFFF</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294553&amp;user=30561&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=7" class="addthx" data-post="294553"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 20:49 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#8');return false;">#8</a> </span><div align=left><br>
<I>Calypso пишет:<br>Тут вылетает </I><br>Выставь у второй,третьей и четвертой секций права на запись в petools.<br><br>Склеил себе тоже exe с восстановленным IAT и прикрученной VM - валится на обращении к памяти 0x02***** так что найти внешние прыжки не составит труда. Знать бы куда только ведут.<br>Если не сложно глняь сюда<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004036E0</span>&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;E9&nbsp;CDE8CC01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JMP</b></span>&nbsp;<span class="hl_number">020D1FB2</span></li>        </ol>
    </div>
</div></div>
<br>И сдампь всю секцию куда ведет jmp
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294569&amp;user=3136&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=8" class="addthx" data-post="294569"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Calypso[/b]','')">Calypso</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30561">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 20:52 <br><script type="text/javascript">QU('Calypso','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Calypso" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#9');return false;">#9</a> </span><div align=left><br>
Я сдампил всю память ВМ и прилепил даже к дампу, только с адресами секций запутался<br><br><img src="img/attach.gif" alt=""> <a href="./files/c73c_03.11.2011_EXELAB.rU.tgz">c73c_03.11.2011_EXELAB.rU.tgz</a> - Dump_020D0000_00040000.bin
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294573&amp;user=30561&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=9" class="addthx" data-post="294573"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Calypso[/b]','')">Calypso</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30561">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 22:57 &middot; Поправил: Calypso <br><script type="text/javascript">QU('Calypso','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Calypso" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#10');return false;">#10</a> </span><div align=left><br>
Итак детишки,у нас для вас плохие новости. Помимо всех прочих пакостей ,на десерт Петька приготовил нам вызов API функций из виртуальной машины. Так что обычный дамп не прокатит<br><br>И ещё проблема с PE Tools ,после добавления секции если адрес её вводить руками, вылазит ошибка что &quot;файл не запускается\не является приложением win32&quot;<br>Все размеры секций высчитаны правильно, Optional Header и Size of Image подправлены<br>Флаги writeable установлены<br>http://s2.ipicture.ru/uploads/20111103/t4IEINBW.png<br>http://s1.ipicture.ru/uploads/20111103/jRtNi4WI.png
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294600&amp;user=30561&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=10" class="addthx" data-post="294600"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Psalmopoeus Pulcher[/b]','')">Psalmopoeus Pulcher</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.8 (посетитель), 23thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 23:27 <br><script type="text/javascript">QU('Psalmopoeus Pulcher','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Psalmopoeus Pulcher" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#11');return false;">#11</a> </span><div align=left><br>
Да неужели?! Я, кажется, про вызов апи из ВМ ясно написал, что они есть. Ты вообще читаешь что тебе пишут или тупо на флуд жалуешься?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294602&amp;user=18297&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=11" class="addthx" data-post="294602"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4579" title="03-11-2011 19:52, ранг:109.9" target="_blank">BoOMBoX</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 23:46 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#12');return false;">#12</a> </span><div align=left><br>
Ну есть вызовы и есть, прекрасно. Для дампа, который используется на той же машине, где был сделан - это не проблема.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294604&amp;user=6336&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=12" class="addthx" data-post="294604"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 ноября 2011 23:53 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#13');return false;">#13</a> </span><div align=left><br>
<I>Calypso пишет:<br>Если у вас есть конкретные факты,то покажите их. Смех без причины признак сами знаете чего </I><br><br><I>Calypso пишет:<br>Могу посоветовать тоже самое вашим &quot;спецам&quot;, 90% которых сразу заткнулись как только разговор пошёл о технической стороне вопроса </I><br><br><I>Calypso пишет:<br>О да,это невероятное огорчение. Особенно судя по тому, что на форуме только 1 человек знает как снять SF 4.70  </I><br><br>Ты не внял моему совету. Отдохни.<br><img src="img/smilies/s26.gif" alt=""><br><br><br><b>Wally</b><br>см. ЛС
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294605&amp;user=1379&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=13" class="addthx" data-post="294605"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3230" title="03-11-2011 20:02, ранг:54.8" target="_blank">Bronco</a>, <a href="action=userinfo&user=22828" title="04-11-2011 12:09, ранг:31.7" target="_blank">Dart Sergius</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]BoOMBoX[/b]','')">BoOMBoX</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 116.1 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4579">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2011 00:44 <br><script type="text/javascript">QU('BoOMBoX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoOMBoX" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#14');return false;">#14</a> </span><div align=left><br>
<I>Calypso пишет:<br>Итак детишки,у нас для вас плохие новости. Помимо всех прочих пакостей ,на десерт Петька приготовил нам вызов API функций из виртуальной машины. Так что обычный дамп не прокатит </I><br><br>М лять, нет слов просто, две страницы назад:<br><br><I>BoOMBoX пишет:<br>да и внутри ВМ выполняется эмуляция кусков(процедур) оригинального кода, <b>причем еще и с вызвовом win API функций, адреса которых не лежат в табличке импорта основного экзешника.</b> </I><br><br>интересно, какое открытие ТС сделает далее...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294611&amp;user=4579&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=14" class="addthx" data-post="294611"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2011 00:57 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#15');return false;">#15</a> </span><div align=left><br>
<I>BoOMBoX пишет:<br>интересно, какое открытие ТС сделает далее </I><br>У него есть время подумать над открытием. Но экстенсивный метод обучения ему не очень подошёл.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294614&amp;user=1379&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=15" class="addthx" data-post="294614"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]ThugboyZ[/b]','')">ThugboyZ</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.9 (новичок), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.65'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=23175">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2011 02:20 &middot; Поправил: ThugboyZ <br><script type="text/javascript">QU('ThugboyZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ThugboyZ" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#16');return false;">#16</a> </span><div align=left><br>
<b>Jupiter</b><br>Может стоить закрыть топик? Что-то мне подсказывает, что после разбана, тут будет ещё страниц 8 такого же флуда, и опять он ничего не распакует<img src="img/smilies/s16.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294618&amp;user=23175&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=16" class="addthx" data-post="294618"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2011 02:53 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#17');return false;">#17</a> </span><div align=left><br>
<b>ThugboyZ</b><br>Ну пусть копает, если ему действительно интересно в большей степени, чем препираться с модератором и заниматься самомодерацией.<br>Топик интересен тем, что тут реально весело идёт обсуждение собственно протектора.<br>Пока что обсуждение не загнулось, и топик интересен отнюдь не ТС ))<br>Всё. Далее по теме, плз.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294619&amp;user=1379&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=17" class="addthx" data-post="294619"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2011 14:22 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#18');return false;">#18</a> </span><div align=left><br>
<I>Calypso пишет:<br>Вот нафлудили то,прям форум школяров какой-то. </I><br><br><I>Calypso пишет:<br>Если тему закроют,то юные читателя Кряклаба никогда не узнают на них ответы </I><br><br><I>Calypso пишет:<br>Итак детишки,у нас для вас плохие новости. </I><br><br>Такое ощущение, что ТС в детском саду нянечкой работает.<br><br><I>Calypso пишет:<br>остальные пусть идут дрочат в кулачок </I><br><br>Вот этим в бане и займись, а потом в бой с новыми силами!
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294654&amp;user=3232&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=18" class="addthx" data-post="294654"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Olenevod[/b]','')">Olenevod</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 48.8 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.1'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5086">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2011 14:38 <br><script type="text/javascript">QU('Olenevod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Olenevod" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#19');return false;">#19</a> </span><div align=left><br>
Пока наш весельчак в бане, поговорим о серьезных вещах. Снять рабочий дамп ВМ под свою систему может любой реверсер среднего уровня, при желании, есстественно. Заставить его работать на всех ОС немногим меньше, но тоже многие. В подполье уже выложен мануал как это делать. Здесь я вкратце приведу основные идеи.<br>Итак, для того чтобы получить рабочий дамп ВМ под свою систему, как уже отмечалось, достаточно сдампить всю память, выделенную виртуальной машиной, и саму ВМ, а затем правильно прикрутить все это к .exe файлу, т.е. чтобы в памяти все оказалось по старым адресам. Как правило, между .exe, выделенной памятью и секцией ВМ довольно большой промежуток, и, в результате, при этом методе дампа, полученный .exe файл расползется в памяти на пару сотен мегабайт. Такой расклад мне лично не нравится. Выделение большого региона памяти с последующим перехватом VitualAlloc тоже меня не удовлетворил, поэтому был выбран довольно извращенный способ размещения всех страниц памяти стара как можно ближе к .exe:<br> 1) К оригинальному .exe прикручивалась пустая секция с гигантским значением VirtualSize;<br> 2) Перед началом инициализации ВМ (первый прыжок в нее) в процесс инжектилась либа, которая:<br>  а) Копировала ВМ в новую секцию и все последющие обращения к ВМ переадресовывала к копии;<br>  б) Ставила хуки на все экспортируемые по именам апи из сист. библиотек (обычно kernel32.dll, user32.dll и advapi32.dll).<br>     Хуки ставились следующим образом. В добавленной к .exe секции генерировались jmp ds:[Buf], где Buf массив оригинальных адресов апи, тоже расположенный в пустой секции, а затем патчилась таблица экспорта так, чтобы она указывала на наши джампы. Список имен всех перехваченных апи писался в файл для использования в будущем;<br>  в) Затирала в памяти в PE хидере информацию о новой секции и правила SizeOfImage на оригинальный;<br>  г) &quot;Помогала&quot; стару получить кусочек памяти в новой секции.<br> 3) Продолжалось выполнение программы до OEP;<br> 4) Восстанавливались таблицы экспорта, чтобы ImpRec мог нормально определить имена апи (Стар не сможет спереть ничего кроме нашего jmp ds:[Buf], поэтому такой перехват позволяет легко восстановить импорт);<br> 5) Снимался дамп .exe. В дамп вносились необходимые правки, типа обрезания ненужного пространства пустой секции и прикручивания секции с импортом;<br> 6) К дампу .exe цеплялась либа, которая при запуске из списка имен апи, сохраненного ранее, получала адреса этих апи и записывала их в память .exe, подменяла в ВМ функцию из кодосекции оригинальной protect.dll (через нее выделялась память под нужды ВМ) и вычисляла значения cpuid для обхода антидампа.<br><br>P.S. Об антидампе, возможно, тоже напишу, но позднее. Мне интересно не просто слить инфу, а чему то научить и передать опыт, убедится, что наработки кому то реально пригодились. Если будут рабочие дампы ВМ под одну систему, то будут и подробности создания полностью работоспособного дампа ВМ.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294661&amp;user=5086&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=19" class="addthx" data-post="294661"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3136" title="04-11-2011 10:03, ранг:141.9" target="_blank">Veliant</a>, <a href="action=userinfo&user=30561" title="04-11-2011 10:04, ранг:4.7" target="_blank">Calypso</a>, <a href="action=userinfo&user=1379" title="04-11-2011 12:09, ранг:466.9" target="_blank">Jupiter</a>, <a href="action=userinfo&user=8545" title="04-11-2011 12:09, ранг:25.8" target="_blank">obfuskator</a>, <a href="action=userinfo&user=22828" title="04-11-2011 12:13, ранг:31.7" target="_blank">Dart Sergius</a>, <a href="action=userinfo&user=2585" title="04-11-2011 13:40, ранг:793.0" target="_blank">Gideon Vi</a>, <a href="action=userinfo&user=21589" title="04-11-2011 22:55, ранг:103.0" target="_blank">_ruzmaz_</a>, <a href="action=userinfo&user=30679" title="30-11-2011 20:24, ранг:6.2" target="_blank">GoldenJoe</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2011 16:58 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#20');return false;">#20</a> </span><div align=left><br>
Полагаю вот этот склееный ехе должен работать у ТС<br>http://rghost.ru/28506081<br><br>Ну а у меня вопрос к тем, кто ковырял ВМ стара:<br>У меня например есть лог эмулируемых команд, и естественно циклы получаются развернутыми. Относительно чего можно адресовываться, чтоб сократить лог если идет повторное выполнение?<br>Ленты постоянно переключаются, поэтому не думаю что вариант, да и вручную не хочется сокращать код
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294672&amp;user=3136&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=20" class="addthx" data-post="294672"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]V0ldemAr[/b]','')">V0ldemAr</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 65.4 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=68">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 ноября 2011 17:48 <br><script type="text/javascript">QU('V0ldemAr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=V0ldemAr" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#21');return false;">#21</a> </span><div align=left><br>
Вставлю своих 5коп.<br><br><I>Olenevod пишет:<br>б) Ставила хуки на все экспортируемые по именам апи из сист. библиотек (обычно kernel32.dll, user32.dll и advapi32.dll). </I><br><br>Также зависит если игра в краденых функциях использует АПИ или нет, например хуки в ws2_32 надо делать по ординалу если нету имени функции.<br><br>Также чтобы восстановить импорт можно обойтись без хуков всех экспортируемых функций если идет речь о бейсик версии, можно захучить обработчики mov [r1], r2 и смотреть куда записывается r2 если в ИАТ то в контексте вм ( в каком регистре не помню ) будет оригинальная функция.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294675&amp;user=68&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=21" class="addthx" data-post="294675"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Calypso[/b]','')">Calypso</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30561">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 00:25 <br><script type="text/javascript">QU('Calypso','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Calypso" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#22');return false;">#22</a> </span><div align=left><br>
Модератор со школотроллями жгут - прямо великое одолжение для нас читать ваши бредни.<br>Оленевод конечно вовремя пришел - тема уже превратилась в песочницу клоунов-членомеров вроде <b>PE_Kill</b> который за всю тему написал лишь 1 кажется полезное сообщение,не считая килобайтов тупого школьного бреда.<br>Продолжайте в том же духе и форум впору будет переименовать в durdomlab :lol:<br>По теме- могу обломать тех,кто серьезно думает что для снятия SF 4.70 достаточно тупо сдампить ВМ и всю память. Надежда на Оленевода,в личку ему описана суть проблемы мною и ещё некоторыми вменяемыми крекерами. Возможно дамп всех секций ВМ решит проблему,неизвестно.<br>Здесь началась уже политика ,Оленевод крекер со сцены,у него есть некий софт который он не даст мне и другим участникам форума, понятно его нежелание распространять приватные мануалы.<br>Придется делать выбор- или топик сливается в унитаз со всеми наработками,или же сцена будет открывать приватную информацию о снятии SF
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294687&amp;user=30561&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=22" class="addthx" data-post="294687"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29629" title="05-11-2011 05:16, ранг:31.0" target="_blank">bowrouco</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Calypso[/b]','')">Calypso</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30561">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 00:27 <br><script type="text/javascript">QU('Calypso','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Calypso" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#23');return false;">#23</a> </span><div align=left><br>
<I>Olenevod пишет:<br>Об антидампе, возможно, тоже напишу, но позднее. Мне интересно не просто слить инфу, а чему то научить и передать опыт, убедится, что наработки кому то реально пригодились. Если будут рабочие дампы ВМ под одну систему, то будут и подробности создания полностью работоспособного дампа ВМ.  </I><br>Да нам бы хоть под одну систему сделать рабочий дамп,а в том чтоб кряк попал на говнофорумы мы и сами как бэ не заинтересованы. Разработчики Петьки - парни из Воронежа,можно сказать земляки мои
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294688&amp;user=30561&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=23" class="addthx" data-post="294688"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 00:37 &middot; Поправил: tihiy_grom <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#24');return false;">#24</a> </span><div align=left><br>
<I>Calypso пишет:<br>Придется делать выбор- или топик сливается в унитаз со всеми наработками,или же сцена будет открывать приватную информацию о снятии SF </I><br>сам-то видать не догадываешься какой в итоге будет сделан выбор?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294691&amp;user=10534&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=24" class="addthx" data-post="294691"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Calypso[/b]','')">Calypso</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 6.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.71'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=30561">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 00:40 <br><script type="text/javascript">QU('Calypso','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Calypso" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#25');return false;">#25</a> </span><div align=left><br>
<I>Olenevod пишет:<br>Итак, для того чтобы получить рабочий дамп ВМ под свою систему, как уже отмечалось, достаточно сдампить всю память, выделенную виртуальной машиной, и саму ВМ, а затем правильно прикрутить все это к .exe файлу, т.е. чтобы в памяти все оказалось по старым адресам. </I><br>Увы,это сделано здесь:<br><I>Veliant пишет:<br>Полагаю вот этот склееный ехе должен работать у ТС<br>http://rghost.ru/28506081<br> </I><br>но как каждый может сам убедиться,игра с этим дампом не работает.<br>Вообщем ждем трезвых идей. Я сделал ещё дамп всей памяти,начиная с 00A11000 ,всего 20 с лишним мегабайт. Сможете прикрутить чтобы всё работало - снимаю шляпу<br><noindex><a href="http://depositfiles.com/files/iueuiethg" rel="nofollow" target="_blank">http://depositfiles.com/files/iueuiethg</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294693&amp;user=30561&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=25" class="addthx" data-post="294693"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 01:53 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#26');return false;">#26</a> </span><div align=left><br>
<b>Calypso</b><br><img src="img/smilies/s25.gif" alt="">
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294705&amp;user=1379&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=26" class="addthx" data-post="294705"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=16624" title="04-11-2011 21:30, ранг:180.6" target="_blank">MasterSoft</a>, <a href="action=userinfo&user=30561" title="04-11-2011 21:44, ранг:4.9" target="_blank">Calypso</a>, <a href="action=userinfo&user=18316" title="04-11-2011 22:55, ранг:73.1" target="_blank">SReg</a>, <a href="action=userinfo&user=28862" title="06-11-2011 17:35, ранг:2.4" target="_blank">Kylak</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Dart Sergius[/b]','')">Dart Sergius</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/22828.jpg" alt=""><br><span class=txtSm>Ранг: 105.6 (ветеран), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 02:12 <br><script type="text/javascript">QU('Dart Sergius','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dart Sergius" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#27');return false;">#27</a> </span><div align=left><br>
<I>Calypso пишет:<br>Разработчики Петьки - парни из Воронежа,можно сказать земляки мои  </I><br>Земляк, сочувствую твоему горю - а именно нежеланию читать советы людей, и копать вм, в надежде на лучшее - не лучшее времяпровождение. Практически на любую игру есть no-dvd. Можно эмулировать диск. Но тебе приспичило копать всё самому. Похвально, но стоило правильно оценить свои возможности. Попробуй обойти антидамп в Armadillo, а потом смотри виртуальные машины.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294710&amp;user=22828&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=27" class="addthx" data-post="294710"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 03:36 &middot; Поправил: MasterSoft <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#28');return false;">#28</a> </span><div align=left><br>
<I>Calypso пишет:<br>В статье чувака,который ломал King Bounty написано что надо поставить бряку на секцию .text и поставить EIP на начало ВМ, т.е. на адрес 02071FE2. Затем пустить трассировку и увидим на какой адрес petka.exe выйдет отладчик </I><br>такого там не написанно, пробовал трейсить вм? попробуй, скок у тя интересно займёт времени это <img src="img/smilies/s2.gif" alt=""><br>если так интерессно почитай ещё вторую часть, она малость не про анпак, но для общего образования полезно, она ниже в каментах лежит. и ваще хватит ужО, я скоро икать начну <img src="img/smilies/s5.gif" alt=""> четвёртая версия у тя есть, терь возьми ради интересса пятую и зацени отличия <img src="img/smilies/s2.gif" alt=""> и по-аккуратней ты бы с выражениями, над тобой стебуться, а ты вместо того чтоб прислушиваться к критике, гнёшь пальцы. запомни, что тебе никто ничего не должен и не загорами уже тот час когда в этом топе останешься только ты и топ сдохнет) вообще я удивлён, что его ещё не закрыли.<br><br>теперь всё что по делу. инфы которая тут есть достаточно чтобы сдампить вм. не знаю как версия 4.7 (не интересует ибо не актуально для мну) но 5.7 успешно сдампилось, (помимо самой вм дампил ещё одну страницу с данными) правда взял таргет где пикода нет, а одни переходники всё эт для наглядности так сказать)) с cpuid не вкурил чёта ибо пробовал на разных машинах - дамп воркает. написал бы статью, но это глупо ибо писать нечего тут итак уже всё написали)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294716&amp;user=16624&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=28" class="addthx" data-post="294716"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 05:55 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#29');return false;">#29</a> </span><div align=left><br>
Самое смешное, что всё, что расписал оленевод, прокручивал когда то давно Syd с ASProtect 1.23, чтобы не деморфить украденый OEP, наверное стоило бы проделать это и самому с ASProtect, т.к. там в разы проще, набить руку что ли.<br><br><I>Calypso пишет:<br> тема уже превратилась в песочницу клоунов-членомеров вроде PE_Kill который за всю тему написал лишь 1 кажется полезное сообщение,не считая килобайтов тупого школьного бреда. </I><br><img src="img/smilies/s1.gif" alt=""> Я может и обиделся бы, если бы так не заканчивались все темы про SF. Никогда не будет флуда там, где задаются конкретные вопросы, а если вдруг будет, то модеры наведут порядок, а тут просто все смеются над тобой, в надежде, что ты внемлишь хоть одному совету, но тщетно.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294719&amp;user=3232&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=29" class="addthx" data-post="294719"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Olenevod[/b]','')">Olenevod</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 48.8 (посетитель), 17thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.1'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5086">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 11:21 <br><script type="text/javascript">QU('Olenevod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Olenevod" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#30');return false;">#30</a> </span><div align=left><br>
Во-первых, ув. <b>Calypso</b> и <i class=x>ещё некоторые вменяемые крекеры</i>, не нужно захламлять мне личку теми же глупыми вопросами, что и ветку форума, иначе вы можете принять меня за грубого, плохо воспитанного человека, игнорирующего ваши сообщения.<br>Во-вторых, за тебя тут никто ничего делать не будет.<br>В-третьих, уважай других участников форума.<br>В-четвертых, читая твои посты, почему то вспоминается видос с парнем, который &quot;просто танцует&quot;. Ты не усваиваешь то, что тебе пишут, жалуешься на то, что тебе никто не помогает, все только флудят и мешают продвижению привата в массы. Ты идиот?<br><I>Calypso пишет:<br>Здесь началась уже политика ,Оленевод крекер со сцены,у него есть некий софт который он не даст мне и другим участникам форума, понятно его нежелание распространять приватные мануалы.</I><br>Бред чуть более чем полностью.<br><I>Calypso пишет:<br>каждый может сам убедиться,игра с этим дампом не работает. </I><br>К <b>Veliant</b>&#039;у нареканий нет, все сделано правильно. Для тебя я специально повторю и, даже, выделю жирным ключевую фразу: <b>всю память, выделенную виртуальной машиной</b>. К дампу прикручены только те страницы памяти, которые были выделены при распаковке .exe старом, т.е. буфер под переходы в ВМ и спертые апи. Где память, выделенная в процессе инициализации ВМ?<br><I>V0ldemAr пишет:<br>Также зависит если игра в краденых функциях использует АПИ или нет, например хуки в ws2_32 надо делать по ординалу если нету имени функции.</I><br>Ты прав, спасибо за дополнение. При распаковке это стоит учитывать, но для снятия дампа ВМ это необязательно.<br><I>PE_Kill пишет:<br>всё, что расписал оленевод, прокручивал когда то давно Syd с ASProtect 1.23 </I><br>Все описанное - давно изобретенная и описанная методика. Странно, что мало кто этим пользуется.<br><br>P.S. Терпеть не могу Воронеж.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=294725&amp;user=5086&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=30" class="addthx" data-post="294725"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 ноября 2011 13:33 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=19176&amp;page=7#31');return false;">#31</a> </span><div align=left><br>
<I>Olenevod пишет:<br>Все описанное - давно изобретенная и описанная методика. Странно, что мало кто этим пользуется. </I><br>Так а для чего пользоваться то? То, что автоматизировано - без дампа всей памяти работает. Я в распаковщике ASProtect сначала дампил всю память, но потом прикрутил дизасм и стал собирать всю в одну секцию, правя адреса. Такая методика подходит для получения рабочего дампа неизвестной защиты, или без вникания в устройство этой защиты. А такое бывает не часто.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=294731&amp;user=3232&amp;forum_n=5&amp;topic=19176&amp;page=7&amp;anchor=31" class="addthx" data-post="294731"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=6.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=6.html">7</a> . <b>8</b> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=9.html">10</a> . <a href="action=vthread&amp;forum=5&amp;topic=19176&amp;page=8.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка StarForce 4.70 - Пьеса в нескольких действиях</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19176" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
