<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Отправить письмо на Delphi - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="потскажите, как можно отправить письмо, не прибегая всякие модули (в нете этого полно - но это не нужно), чисто апи. Пробовал отправлять через telnet, но почта еще не пришла . Может кто-нибуть исходником поделиться?">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=39467'>hgdagon</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Отправить письмо на Delphi</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]GAMe ovER[/b]','')">GAMe ovER</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 45.5 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.61'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3176">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2006 17:57 <br><script type="text/javascript">QU('GAMe ovER','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GAMe ovER" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
потскажите, как можно отправить письмо, не прибегая всякие модули (в нете этого полно - но это не нужно), чисто апи. Пробовал отправлять через telnet, но почта еще не пришла <img src="img/smilies/s1.gif" alt="">. Может кто-нибуть исходником поделиться?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=84335&amp;user=3176&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=1" class="addthx" data-post="84335"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2006 18:01 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Если чисто на АПИ, дык можно хоть с васма пример взять на асме и переправить на Дельфи или также и сделать асмовую вставку.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=84336&amp;user=1556&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=2" class="addthx" data-post="84336"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Z0oMiK[/b]','')">Z0oMiK</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2299.gif" alt=""><br><span class=txtSm>Ранг: 299.6 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.95'>Активность: 0.3<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2299">Участник</a><br><font color=blue>Armadillo Killer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2006 18:07 <br><script type="text/javascript">QU('Z0oMiK','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Z0oMiK" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Отправка и прием почты реализуются при помощи Delphi довольно просто. Для отправки почты нам понадобится компонент idSMTP со страницы Indy Clients палитры компонентов Delphi. 
<br>
<br>Этот компонент реализует все необходимое для отправки электронной почты по протоколу SMTP (Simple Mail Transfer Protocol - простой протокол передачи почты), использующий 25 порт, по которому посылаются команды и текст письма. Этапы отправки электронной почты следующие: 
<br>
<br>1) соединение с SMTP сервером по 25 порту; 
<br>2) подготовка тела письма, определение отправителя и получателя письма; 
<br>3) отправка письма на SMTP сервер; 
<br>
<br>Разместив на форме компонент idSMTP, займёмся его настройкой. Настройку порта можно произвести в инспекторе объектов, установив свойство Port в значение 25, или в коде программы сделать то же самое: 
<br>
<br>IdSMTP1.Port:=25; 
<br>
<br>Соединение с сервером 
<br>
<br>Для соединения с SMTP сервером, который будет осуществлять отправку нашей почты, нужно указать его URL, для сервера mail.ru это производится следующим образом : 
<br>
<br>IdSMTP1.Host := &#8242;smtp.mail.ru&#8242;; 
<br>
<br>Соединение с сервером производится методом Connect: 
<br>
<br>procedure Connect(const ATimeout: Integer); override; 
<br>где ATimeout - необязательный параметр, задает максимальное время в миллисекундах ожидания ответа с SMTP сервера, по истечении которого попытка установить соединение прекращается. 
<br>
<br>Например, 
<br>
<br>IdSMTP1.Connect(5000); 
<br>
<br>Если при соединении с сервером требуется авторизация, то значение свойства AuthenticationType нужно установить в atLogin, при этом в инспекторе объектов также нужно определить свойства Username(имя пользователя. К примеру, Username почтового ящика delphi@mail.ru - delphi) и Password(пароль на ящик), или сделать то же программно: 
<br>
<br>IdSMTP1.AuthenticationType:=atLogin; 
<br>IdSMTP1.Username:=&#8242;delphi&#8242;; 
<br>IdSMTP1.Password:=&#8242;something&#8242;; 
<br>
<br>Если авторизация не требуется, то свойство AuthenticationType в инспекторе объектов нужно установить в atNone, либо сделать это программно: 
<br>
<br>IdSMTP1.AuthenticationType:=atNone; 
<br>
<br>После применения метода Connect, нужно анализировать логическое свойство Connected, которое в случае удачного соединения устанавливается в True. После этого при помощи метода Send можно отправлять сообщение: 
<br>
<br>if Connected=True then IdSMTP1.Send(Msg); 
<br>
<br>Структура письма 
<br>
<br>Метод Send отправляет тело сообщения, представляющего собой структуру типа TIdMessage; 
<br>
<br>Структура письма реализуется в Delphi отдельным компонентом TIdMessage, расположенным на палитре компонентов Indy Misc и выглядит следующим образом 
<br>
<br>TidMessage Структура TIdMessage определяется следующим образом:
<br>
<br>var 
<br>Msg: TIdMessage; 
<br>begin 
<br>Msg.Subject:=&#8242;тема сообщения&#8242;; //текст темы сообщения 
<br>Msg.Recipients.EMailAddresses:=&#8242;bogdanwe@mail.ru&#8242;; 
<br>//указываем адрес получателя 
<br>Msg.From.Adress:=&#8242;delphi@mail.ru&#8242;; //указываем автора письма 
<br>Msg.Body.Text:=&#8242;текст сообщения&#8242;; //размещаем текст сообщения 
<br>Msg.Date:=StrToDate(&#8242;01.12.2004&#8242;);//дата отправки письма может быть любой 
<br>end;
<br>
<br>С темой сообщения, я думаю, все понятно. Свойство 
<br>
<br>property Recipients: TIdEmailAddressList; 
<br>определяет получателя или получателей электронного письма. Свойством EMailAddresses, имеющего синтаксис: 
<br>
<br>property EMailAddresses: String; 
<br>конкретно определяются названия электронных учетных записей, которым адресуется письмо. Названия должны указываться через разделитель вида &quot;,&quot; то есть через запятую. Например: 
<br>
<br>Msg.Recipients.EMailAddresses:=&#8242;bogdanwe@mail.ru,delphi7@mail.ru&#8242;; 
<br>Свойство From представляет собой объект типа TIdEmailAddressItem и содержит информацию о отправителе письма и в свою очередь включает в себя три свойства - Name, Address, Text. 
<br>
<br>Свойство Address содержит информацию о электронном ящике отправителя: 
<br>
<br>property Address: string; 
<br>например, 
<br>
<br>Msg.From.Address:=&#8242;delphi@mail.ru&#8242;; 
<br>Свойство Name представляет собой имя отправителя: 
<br>
<br>property Name: string; 
<br>например, 
<br>
<br>Msg.From.Name:=&#8242;Антон Камолов&#8242;; 
<br>Свойство Text содержит информацию обоих свойств. Тело письма представляет собой объект типа TStrings: 
<br>
<br>property Body: TStrings; 
<br>Присоединяем к письму аттачмент 
<br>
<br>Если вам нужно отправить с письмом файл, т.е. аттачмент, то для этого нужно создать объект класса TidAttachment. Для этого применяется следующий конструктор: 
<br>
<br>constructor Create(Collection: TIdMessageParts; const AFileName: TFileName = &#8242;&#8242;); reintroduce; 
<br>где Collection - объект класса TIdMessageParts, представляющее собой коллекцию приложений к электронному письму. 
<br>контстанта AFileName типа TFileName - представляет собой обычную текстовую строку с указанием правильного пути к файлу, например &quot;C:file.zip&quot;, по умолчанию имеет значение &#8242;&#8242;. 
<br>
<br>Таким образом, продолжая наш пример, строкой вида 
<br>
<br>TIdAttachment.Create(Msg.MessageParts,&#8242;c:file.zip&#8242;); 
<br>мы заполняем свойство MessageParts объекта Msg информацией о аттачменте. 
<br>
<br>Теперь наша структура письма содержит информацию о аттачменте. После отправки сообщения нужно разорвать соединение с сервером, чтобы оно не &quot;висело&quot;. Это производится методом Disconnect: 
<br>
<br>IdSMTP1.Disconnect;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=84337&amp;user=2299&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=3" class="addthx" data-post="84337"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]GAMe ovER[/b]','')">GAMe ovER</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 45.5 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.61'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3176">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2006 18:16 <br><script type="text/javascript">QU('GAMe ovER','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GAMe ovER" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Z0oMiK</b> как ни странно, эта страница у меня ща в опере открыто svdpro.info/page.php?id=32, но там же <I>Z0oMiK пишет:
<br>Для отправки почты нам понадобится компонент idSMTP со страницы Indy Clients палитры компонентов Delphi. </I>
<br>а мне надо, <I>GAMe ovER пишет:
<br> не прибегая всякие модули </I>
<br><b>Archer</b> С этим ща я и парюсь <img src="img/smilies/s1.gif" alt="">, но лучше на делфях. Говорят, через телнет отправить можно, но у меня почему-то он не отправляет,хотя вс окей
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=84340&amp;user=3176&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=4" class="addthx" data-post="84340"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]-= ALEX =-[/b]','')">-= ALEX =-</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/220.jpg" alt=""><br><span class=txtSm>Ранг: 260.3 (наставник), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=220">Участник</a><br><font color=blue>PPC-PROTECT author</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2006 18:18 <br><script type="text/javascript">QU('-= ALEX =-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-= ALEX =-" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
ну все ж просто ))) возьми на любом другом языке, асм/си и перепиши на дельфи, там немного то... минут 10 работы
<br><br><font size="1"><i>-----<br>Пиво, сиськи, транс</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=84342&amp;user=220&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=5" class="addthx" data-post="84342"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]GAMe ovER[/b]','')">GAMe ovER</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 45.5 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.61'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3176">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2006 18:24 <br><script type="text/javascript">QU('GAMe ovER','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GAMe ovER" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
так дайте хоть си, только на апи.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=84346&amp;user=3176&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=6" class="addthx" data-post="84346"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Cigan[/b]','')">Cigan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=208">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2006 19:12 <br><script type="text/javascript">QU('Cigan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Cigan" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Ну допустим вот пример трояна на асм, когда был взят с васма<br><br><img src="img/attach.gif" alt=""> <a href="./files/2f78_20.07.2006_CRACKLAB.rU.tgz">2f78_20.07.2006_CRACKLAB.rU.tgz</a> - trojan.asm
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=84357&amp;user=208&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=7" class="addthx" data-post="84357"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]NIKOLA[/b]','')">NIKOLA</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/247.jpg" alt=""><br><span class=txtSm>Ранг: 500.6 (<b>!</b>), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.26<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=247">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2006 19:12 <br><script type="text/javascript">QU('NIKOLA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NIKOLA" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>GAMe ovER</b>
<br>
<br>Это подойдёт?
<br>
<br>{
<br>smtp - ip адрес smtp сервера
<br>port - порт smtp сервера, по умолчанию 25
<br>from - адрес отправителя
<br>dest - адрес получателя
<br>subject - тема письма
<br>body - текст писма
<br>Возвращает True если письмо было успешно отправленно...
<br>}
<br>
<br>function mail(smtp: string; port: integer; from, dest, subject,
<br>  body: string): bool;
<br>const
<br>  cl = #13#10;
<br>var
<br>WSAData: TWSAData;
<br>  Host: TSockAddrIn;
<br>  Sock: TSocket;
<br>  res: Integer;
<br>  buff: array[1..255] of Char;
<br>
<br>  { отправляем данные через сокет }
<br>  procedure senddata(str: string);
<br>  var
<br>    i: integer;
<br>  begin
<br>    for i := 1 to Length(str) do
<br>      if send(Sock, str[i], 1, 0) = SOCKET_ERROR then
<br>        exit;
<br>  end;
<br>
<br>  { получаем ответ от команды }
<br>  function recvdata(accept: string): bool;
<br>  var
<br>    buff: array[1..255] of Char;
<br>  begin
<br>    res := recv(Sock, buff, SizeOf(buff), 0);
<br>    Result := (Res = SOCKET_ERROR) or (Copy(buff, 1, 3) = accept);
<br>  end;
<br>
<br>begin
<br>  try
<br>    result := false;
<br>    { инициализация сокета }
<br>    WSAStartUp(257, WSAData);
<br>    Sock := socket(AF_INET, SOCK_STREAM, IPPROTO_IP);
<br>    if Sock = INVALID_SOCKET then
<br>      Exit;
<br>
<br>    { устанавливаем хост и порт сервера }
<br>    res := inet_addr(PChar(smtp));
<br>    if res &lt;= 0 then
<br>      exit;
<br>
<br>    Host.sin_family := AF_INET;
<br>    Host.sin_port := htons(port);
<br>    Host.sin_addr.S_addr := res;
<br>
<br>    { подключаемся к серверу }
<br>    if connect(Sock, Host, SizeOf(Host)) &gt; 0 then
<br>      Exit;
<br>
<br>    { приветствие сервера }
<br>    if not recvdata(&#039;220&#039;) then
<br>      Exit;
<br>
<br>    { EHLO }
<br>    senddata(&#039;EHLO&#039; + cl);
<br>    if not recvdata(&#039;250&#039;) then
<br>      Exit;
<br>
<br>    { MAIL FROM: }
<br>    senddata(&#039;MAIL FROM:&#039; + from + cl);
<br>    if not recvdata(&#039;250&#039;) then
<br>      Exit;
<br>
<br>    { RCPT TO: }
<br>    senddata(&#039;RCPT TO:&#039; + dest + cl);
<br>    if not recvdata(&#039;250&#039;) then
<br>      Exit;
<br>
<br>    { DATA }
<br>    senddata(&#039;DATA&#039; + cl);
<br>    if not recvdata(&#039;354&#039;) then
<br>      Exit;
<br>
<br>    { отправляем текст сообщения }
<br>    senddata(&#039;Subject:&#039; + subject + cl + cl + body + cl + &#039;.&#039;);
<br>    if not recvdata(&#039;250&#039;) then
<br>      Exit;
<br>
<br>    { отключаемся от сервера }
<br>    senddata(&#039;QUIT&#039; + cl);
<br>
<br>    result := true;
<br>  finally
<br>    { убиваем сокет }
<br>    closesocket(sock);
<br>    WSACleanup;
<br>  end;
<br>end;
<br>
<br>{
<br>mail(&#039;127.0.0.1&#039;,25,&#039;bboy-ne@yandex.ru&#039; ,&#039;admin@company.mail&#039;, &#039;subj&#039;, &#039;body text&#039;);
<br>
<br>p.s.: Тестировалась на e-mail сервере Alt-N Daemond Pro for Windows v6.5.1...
<br>Функция делалась на основе статьи &quot;Простой протокол передачи почты (SMTP)&quot;
<br>}
<br>
<br>Взято с delphiworld.narod.ru/
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=84358&amp;user=247&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=8" class="addthx" data-post="84358"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]GAMe ovER[/b]','')">GAMe ovER</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 45.5 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.61'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3176">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2006 19:52 <br><script type="text/javascript">QU('GAMe ovER','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GAMe ovER" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
наверно
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=84364&amp;user=3176&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=9" class="addthx" data-post="84364"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]NEOx[/b]','')">NEOx</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.01'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2154">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 июля 2006 22:35 <br><script type="text/javascript">QU('NEOx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NEOx" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Вот тебе сишный пример:
<br>neox.iatp.by/files/dnsquery.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=84388&amp;user=2154&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=10" class="addthx" data-post="84388"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2006 09:00 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Процедура только создает письмо, кнопку отправить юзверь жмет сам, но если пошаманить с флагами, все будет на автомате.
<br>
<br><code>
<br>procedure SendEmail(Subject, Body, Attachment: string);
<br>var MapiMessage: TMapiMessage;
<br>    MapiFileDesc: TMapiFileDesc;
<br>begin
<br>   with MapiFileDesc do begin
<br>      ulReserved:= 0;
<br>      flFlags:= 0;
<br>      nPosition:= 0;
<br>      lpszPathName:= PChar(Attachment);
<br>      lpszFileName:= nil;
<br>      lpFileType:= nil;
<br>   end;
<br>   with MapiMessage do begin
<br>      ulReserved := 0;
<br>      lpszSubject := PChar(Subject);
<br>      lpszNoteText := PChar(Body);
<br>      lpszMessageType := nil;
<br>      lpszDateReceived := nil;
<br>      lpszConversationID := nil;
<br>      flFlags := 0;
<br>      lpOriginator := nil;
<br>      nRecipCount := 0;
<br>      lpRecips := nil;
<br>      nFileCount:= 1;
<br>      lpFiles := @MapiFileDesc;
<br>   end;
<br>   MapiSendMail(0, 0, MapiMessage, MAPI_DIALOG or MAPI_LOGON_UI or MAPI_NEW_SESSION, 0);
<br>end;
<br></code>
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=84451&amp;user=2775&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=11" class="addthx" data-post="84451"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]darkeagle[/b]','')">darkeagle</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 48.8 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.11'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5013">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 июля 2006 11:00 <br><script type="text/javascript">QU('darkeagle','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=darkeagle" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=5719.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
дык банально учишь протокол smtp и реализуешь все через winsock 2.0, чего тут заморачиваться?
<br>если нада приатачить файл, то кодируешь его в base64 и шлешь заголовком.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=84466&amp;user=5013&amp;forum_n=6&amp;topic=5719.html&amp;page=0&amp;anchor=12" class="addthx" data-post="84466"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Отправить письмо на Delphi</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#13" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="5719">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=5719" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
