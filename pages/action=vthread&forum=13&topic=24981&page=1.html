<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Статическая трассировка кода - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет, Изучаю x86 драйвер, он защищен с помощью vmp Случай достаточно простой, только некоторые функции мутированы (обфусцированы?), даже нет внешней упаковки Для того чтобы посмотреть обфускацию целиком, нужна трасса от и">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Статическая трассировка кода</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 декабря 2017 18:39 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Всем привет,<br>Изучаю x86 драйвер, он защищен с помощью vmp<br>Случай достаточно простой, только некоторые функции мутированы (обфусцированы?), даже нет внешней упаковки<br>Для того чтобы посмотреть обфускацию целиком, нужна трасса от и до<br>Дебажить его у меня нет возможности, да и вообще хочу попробовать сделать это статически<br>Возможно идея глупая, но что если написать упрощенный процессор с обработкой нужных инструкций (операции стека, прыжки, вызовы), который бы &quot;выполнял&quot; код до тех пор пока не встретиться выход из функции<br>Правда не ясно что делать c вызовами API, stdcall мы же очищаем стек, но вот с другими соглашениями?<br>Дело даже не в проте, а вообще в целом<br>Я пыталась делать парсер конкретных команд под конкретный прот, но дело в том, что это не возможно реализовать, ибо число нелогичных приемов может быть очень большое, поэтому нужно спуститься на самый нижний уровень, для того чтобы выполнять код как сам процессор это делает<br>Возможно кто-то даст дельный совет, может кто-то уже делал подобное?<br>Так же я пыталась найти псевдо-код, как процессор выполняет команды, т.к. вмпрот любит использовать редкие команды, может у кого то есть линки?<br>Спасибо
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380866&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=1" class="addthx" data-post="380866"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]bizkitlimp[/b]','')">bizkitlimp</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 15.8 (новичок), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.16'>Активность: 0.03<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=42543">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2017 06:19 <br><script type="text/javascript">QU('bizkitlimp','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bizkitlimp" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
&quot;Эмуляция программного кода&quot;. Там есть аттач emu.zip на исполнение инструкций.<br>https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19688&amp;page=0<br><br>Я не знаю как там, там C. У меня же асм и касатка (64), недоделанная. Выглядит так:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">procedure&nbsp;<span class="hl_function"><b>Test</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;procedure&nbsp;Message<span class="hl_char">(</span><span class="hl_function"><b>const</b></span>&nbsp;Value<span class="hl_char">:</span>Int64<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;MessageBox<span class="hl_char">(</span>GetDesktopWindow<span class="hl_char">,</span>PWideChar<span class="hl_char">(</span>IntToHex<span class="hl_char">(</span>Value<span class="hl_char">,</span><span class="hl_number">16</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">,</span>PWideChar<span class="hl_char">(</span><span class="hl_quote">'CPU'</span><span class="hl_char">)</span><span class="hl_char">,</span>MB_ICONINFORMATION<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">var</li><li class="hl_l0">cpu&nbsp;<span class="hl_char">:</span>&nbsp;TCPU<span class="hl_comment">;</span></li><li class="hl_l1">begin</li><li class="hl_l0">cpu&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;TCPU<span class="hl_char">.</span>Create<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">rax</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">rax</span><span class="hl_char">+</span><span class="hl_registr">rbx</span><span class="hl_char">*</span><span class="hl_number">8</span><span class="hl_char">-</span><span class="hl_char">$</span><span class="hl_number">50</span><span class="hl_char">]</span></li><li class="hl_l1">cpu<span class="hl_char">[</span><span class="hl_registr">RCX</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">25</span><span class="hl_comment">;</span></li><li class="hl_l0">cpu<span class="hl_char">[</span><span class="hl_registr">RDX</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">25</span><span class="hl_comment">;</span></li><li class="hl_l1">cpu<span class="hl_char">.</span>Elea<span class="hl_char">(</span><span class="hl_registr">RAX</span><span class="hl_char">,</span>QWORD_PTR<span class="hl_char">(</span><span class="hl_registr">RAX</span><span class="hl_char">,</span><span class="hl_registr">RBX</span><span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_char">$</span><span class="hl_number">50</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">Message<span class="hl_char">(</span>cpu<span class="hl_char">[</span><span class="hl_registr">RAX</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_function">Xchg</span></li><li class="hl_l1">cpu<span class="hl_char">[</span><span class="hl_registr">RCX</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span>AA0064<span class="hl_comment">;</span></li><li class="hl_l0">cpu<span class="hl_char">[</span><span class="hl_registr">RDX</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span><span class="hl_number">00FFFF</span><span class="hl_comment">;</span></li><li class="hl_l1">cpu<span class="hl_char">.</span>Exchg<span class="hl_char">(</span><span class="hl_registr">cx</span><span class="hl_char">,</span><span class="hl_registr">dx</span><span class="hl_char">)</span><span class="hl_comment">;                       //xchg cx,dx</span></li><li class="hl_l0">Message<span class="hl_char">(</span>cpu<span class="hl_char">[</span><span class="hl_registr">RCX</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">Message<span class="hl_char">(</span>cpu<span class="hl_char">[</span><span class="hl_registr">RDX</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span><span class="hl_function">Add</span></li><li class="hl_l0">cpu<span class="hl_char">.</span>Eadd<span class="hl_char">(</span><span class="hl_registr">CX</span><span class="hl_char">,</span>IMM8<span class="hl_char">(</span><span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;                   //OK</span></li><li class="hl_l1">cpu<span class="hl_char">.</span>Eadd<span class="hl_char">(</span><span class="hl_registr">CX</span><span class="hl_char">,</span>IMM16<span class="hl_char">(</span><span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;                  //OK</span></li><li class="hl_l0">cpu<span class="hl_char">.</span>Eadd<span class="hl_char">(</span><span class="hl_registr">CX</span><span class="hl_char">,</span>IMM32<span class="hl_char">(</span><span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;                  //N.E.</span></li><li class="hl_l1">cpu<span class="hl_char">.</span>Eadd<span class="hl_char">(</span><span class="hl_registr">CX</span><span class="hl_char">,</span>IMM64<span class="hl_char">(</span><span class="hl_number">5</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;                  //N.E.</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>Register&nbsp;Memory&nbsp;Value&nbsp;<span class="hl_char">(</span>The&nbsp;actual&nbsp;value&nbsp;a&nbsp;pointer&nbsp;looks&nbsp;at<span class="hl_char">.</span>&nbsp;Single&nbsp;slot<span class="hl_char">.</span>&nbsp;<span class="hl_char">)</span></li><li class="hl_l0">cpu<span class="hl_char">.</span>Rmv<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">$</span>FFFFFFFFFFFFFFFF<span class="hl_comment">;        //[rax] &lt;= $FFFFFFFFFFFFFFFF</span></li><li class="hl_l1">cpu<span class="hl_char">.</span>Emov<span class="hl_char">(</span><span class="hl_registr">EAX</span><span class="hl_char">,</span>DWORD_PTR<span class="hl_char">(</span><span class="hl_registr">RAX</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;           //mov   eax,[rax]</span></li><li class="hl_l0">Message<span class="hl_char">(</span>cpu<span class="hl_char">[</span><span class="hl_registr">RAX</span><span class="hl_char">]</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">cpu<span class="hl_char">.</span>Free<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Т.е. с цензурой сразу: esp/rsp с множителем нелегальны прям как на процессоре, все множители кроме 1/2/4/8 тоже. Всякие movzx al,qword ptr [rax], xchg rcx,cl, rex префиксы в 32-режиме не проходят. Всё фильтруется инструкциями pcmpistri из SSE4.2. Не завершенное, бросил, как работает едва помню да и дыра нашлась проверял: push al проходит.<br><br>Короче, кому бы не понадобился эмулятор - он будет делать свой, всегда. Я лишь заттачу то, как сделал я, больше референса будет. Но декодинг и эмуляция памяти/стека нет (было всё, но всё забыто и в архивах, с нуля если только, мне неинтересно пока).<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/5ae7_13.12.2017_EXELAB.rU.tgz">5ae7_13.12.2017_EXELAB.rU.tgz</a> - cpu.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380935&amp;user=42543&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=2" class="addthx" data-post="380935"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=40448" title="13-12-2017 08:51, ранг:17.4" target="_blank">Boostyq</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2017 13:16 <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<I>bizkitlimp пишет:<br>Я не знаю как там, там C. У меня же асм и касатка (64), недоделанная. Выглядит так: </I><br>Спасибо, очень полезно, тот что на си очень чистый по коду<br>Хотя я пишу на питоне, самый простой способ для меня, т.к. хочу сохранить интерактивность с идой<br>Пока что перешла на capstone, вместо стандартного апи иды<br>Кстати, задам вопрос пока тут, встретила инструкцию <b>bswap dx</b> в секции вмпрота, я так понимаю, что ее исполнять не нужно? В доках описано, что операнд должен быть 32-битный, а при 16-битном результат неопределен?
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380945&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=3" class="addthx" data-post="380945"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2017 13:50 &middot; Поправил: cppasm <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
Что значит исполнять не надо?<br>Всё там определено, просто недокументировано.<br>Попробуй под отладчиком исполни посмотри на результат.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380946&amp;user=6859&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=4" class="addthx" data-post="380946"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3230" title="13-12-2017 10:50, ранг:198.2" target="_blank">Bronco</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2017 13:58 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<I>cppasm пишет:<br>Что значит исполнять не надо?<br>Всё там определено, просто недокументировано.<br>Попробуй под отладчиком исполни посмотри на результат.  </I><br>main+158 - BA 78563412           - mov edx,12345678 ; EDX 12345678<br>main+15D - 66 0FCA               - bswap dx ; EDX 12340000<br>Не очень то логично == mov dx, 0000?
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380947&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=5" class="addthx" data-post="380947"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]cppasm[/b]','')">cppasm</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 251.3 (наставник), 81thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.14<span style='color:red'>&searr;</span>0.11</span><br>Статус: <a href="action=userinfo&amp;user=6859">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2017 14:43 &middot; Поправил: cppasm <br><script type="text/javascript">QU('cppasm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=cppasm" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
На старых процах мог быть не 0.<br>Поведение неопределено.<br>Современные все в reg16 заносят 0 и всё.<br>На процессорах постарее (когда-то на древнем 486 проверялось, но на пентиумах вроди так же) в младшие 16 бит регистра заносится старшая часть с перевёрнутыми байтами.<br>Т.е. после<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span><span class="hl_number">12345678</span></li><li class="hl_l1"><span class="hl_function"><b>bswap</b></span>&nbsp;<span class="hl_registr">dx</span></li>        </ol>
    </div>
</div></div>
<br>может быть 12340000, а может быть 12343412.<br>А вообще может быть что угодно <img src="img/smilies/s3.gif" alt=""><br>Это скорее всего мусорный код, и результат команды в итоге не важен.<br>Просто его вычистить надо правильно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380948&amp;user=6859&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=6" class="addthx" data-post="380948"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]r0lka[/b]','')">r0lka</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.12'>Активность: 0.02<span style='color:green'>&nearr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=42610">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2017 19:10 <br><script type="text/javascript">QU('r0lka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r0lka" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
unicorn попробуйте, эмулятор на основе qemu. есть биндинг на питона<br><br>примеры эмуляции тут можно посмотреть <br>https://github.com/unicorn-engine/unicorn/blob/master/bindings/python/sample_x86.py<br><br>примерчик<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;</li><li class="hl_l1">def&nbsp;test_i386_context_save<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;Save/restore CPU context in opaque blob&quot;</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;address&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>code</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">b'\x40'</span>&nbsp;&nbsp;#&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">try</span><span class="hl_char">:</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Initialize&nbsp;emulator</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu&nbsp;<span class="hl_char">=</span>&nbsp;Uc<span class="hl_char">(</span>UC_ARCH_X86<span class="hl_char">,</span>&nbsp;UC_MODE_32<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;map&nbsp;8KB&nbsp;memory&nbsp;for&nbsp;<span class="hl_function"><b>this</b></span>&nbsp;emulation</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu<span class="hl_char">.</span>mem_map<span class="hl_char">(</span>address<span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span>&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_number">1024</span><span class="hl_char">,</span>&nbsp;UC_PROT_ALL<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;write&nbsp;machine&nbsp;<span class="hl_function"><b>code</b></span>&nbsp;to&nbsp;be&nbsp;emulated&nbsp;to&nbsp;memory</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu<span class="hl_char">.</span>mem_write<span class="hl_char">(</span>address<span class="hl_char">,</span>&nbsp;<span class="hl_function">code</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;set&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;to&nbsp;<span class="hl_number">1</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu<span class="hl_char">.</span>reg_write<span class="hl_char">(</span>UC_X86_REG_EAX<span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;&gt;&gt;&gt; Running emulation for the first time&quot;</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu<span class="hl_char">.</span>emu_start<span class="hl_char">(</span>address<span class="hl_char">,</span>&nbsp;address<span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;&gt;&gt;&gt; Emulation done. Below is the CPU context&quot;</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;&gt;&gt;&gt; EAX = 0x%x&quot;</span>&nbsp;<span class="hl_char">%</span><span class="hl_char">(</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_X86_REG_EAX<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;&gt;&gt;&gt; Saving CPU context&quot;</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saved_context&nbsp;<span class="hl_char">=</span>&nbsp;mu<span class="hl_char">.</span>context_save<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;&gt;&gt;&gt; Running emulation for the second time&quot;</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu<span class="hl_char">.</span>emu_start<span class="hl_char">(</span>address<span class="hl_char">,</span>&nbsp;address<span class="hl_char">+</span><span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;&gt;&gt;&gt; Emulation done. Below is the CPU context&quot;</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;&gt;&gt;&gt; EAX = 0x%x&quot;</span>&nbsp;<span class="hl_char">%</span><span class="hl_char">(</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_X86_REG_EAX<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;&gt;&gt;&gt; CPU context restored. Below is the CPU context&quot;</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mu<span class="hl_char">.</span>context_restore<span class="hl_char">(</span>saved_context<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print<span class="hl_char">(</span><span class="hl_quote">&quot;&gt;&gt;&gt; EAX = 0x%x&quot;</span>&nbsp;<span class="hl_char">%</span><span class="hl_char">(</span>mu<span class="hl_char">.</span>reg_read<span class="hl_char">(</span>UC_X86_REG_EAX<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>хз правда что вы будете делать с системными вызовами
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380953&amp;user=42610&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=7" class="addthx" data-post="380953"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2017 19:32 <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<I>r0lka пишет:<br>хз правда что вы будете делать с системными вызовами  </I><br>Привет, спасибо за рекомендации<br>Сейчас уже тоже перешла на Capstone, все пока устраивает<br>Так же ворую код из того эмулятора на си <img src="img/smilies/s5.gif" alt=""><br>Пока есть два класса контекст и фрейм <br>Каждый фрейм содержит регистры (пока основные) и копию стека<br>Контекст же виртуальное расположение стека, уже обработанные ветви и конечный адрес слежения<br>При условной инструкции создается доп. фрейм и идет ответвление<br>Системных вызовов в моем случае нет, а там посмотрим
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380955&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=8" class="addthx" data-post="380955"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]deniskore[/b]','')">deniskore</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 53.9 (постоянный), 33thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.22'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=34639">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 декабря 2017 21:15 &middot; Поправил: deniskore <br><script type="text/javascript">QU('deniskore','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=deniskore" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<I>r0lka пишет:<br>unicorn попробуйте, эмулятор на основе qemu. есть биндинг на питона </I><br>Юник еще очень сырой, для продакшена пока не годится, ошибок в нем много, ничего не исправляют, можете посмотреть на гитхабе количество нерешенных вопросов.<br>У меня на первом  семпле с &quot;нестандартным кодом&quot; всё взорвалось и посыпались эксепшены.<br>Функционала unicorn-а  не хватит для решения поставленной задачи.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380958&amp;user=34639&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=9" class="addthx" data-post="380958"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2017 13:08 <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
<I>deniskore пишет:<br>Юник еще очень сырой, для продакшена пока не годится, ошибок в нем много, ничего не исправляют, можете посмотреть на гитхабе количество нерешенных вопросов.<br>У меня на первом семпле с &quot;нестандартным кодом&quot; всё взорвалось и посыпались эксепшены.<br>Функционала unicorn-а не хватит для решения поставленной задачи.  </I><br>Ну, мой велосипед точно не лучше<br>Просто мне гораздо проще писать свой код, чем править чужой или переписывать чужой<br>Все таки пришлось добавить работу с EFLAGS, до этого я не планировала, т.к. думала, что они нужны только для условных прыжков/мувов, а оказалось, что есть инструкции которые, так же используют их<br>Так же обнаружилась проблема с API вызовами, при stdcall мне нужно выравнивать стек, т.е. придется эмулировать каждую используемую (фиктивно конечно), в моем случае их не много
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380968&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=10" class="addthx" data-post="380968"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]r0lka[/b]','')">r0lka</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.12'>Активность: 0.02<span style='color:green'>&nearr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=42610">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2017 17:56 <br><script type="text/javascript">QU('r0lka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r0lka" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<b>deniskore</b><br><br>хз натравливать не пробовал на vmprot, но для моих задач он даже не падал прожевав приличное количество кода, гонял по коду x86 и arm
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380976&amp;user=42610&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=11" class="addthx" data-post="380976"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 декабря 2017 19:46 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
Так, вот первые результаты<br>Все очень сыро, команд добавила больше, чем есть в логе, но многое не тестировала<br>Лог трассировки простой функции, нужно очень многое исправлять<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Python<span class="hl_char">&gt;</span>traceBegin<span class="hl_char">(</span>0x00010656<span class="hl_char">,</span>&nbsp;0x0001065C<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">[</span>loc_00010656<span class="hl_char">]</span></li><li class="hl_l1">0x00010656<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0x0<span class="hl_comment">; ESP&lt;=0xEFE01FFC; S32(0xEFE01FFC)&lt;=0x0; </span></li><li class="hl_l0">0x00010657<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>call</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x10486&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">&lt;</span><span class="hl_char">=</span>0xEFE01FF8<span class="hl_comment">; S32(0xEFE01FF8)&lt;=0x1065C; EIP&lt;=0x10486; </span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">[</span>loc_00010486<span class="hl_char">]</span></li><li class="hl_l1">0x00010486<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>edi</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_registr">EDI</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0x0<span class="hl_comment">; EDI&lt;=0x0; </span></li><li class="hl_l0">0x00010488<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ebp</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0x0<span class="hl_comment">; ESP&lt;=0xEFE01FF4; S32(0xEFE01FF4)&lt;=0x0; </span></li><li class="hl_l1">0x00010489<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>esp</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0xEFE01FF4<span class="hl_comment">; EBP&lt;=0xEFE01FF4; </span></li><li class="hl_l0">0x0001048b<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>movzx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0xEFE01FF4<span class="hl_comment">; S8(0xEFE01FFC)=&gt;0x0; EAX&lt;=0x0; </span></li><li class="hl_l1">0x0001048f<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>eax</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0x0<span class="hl_comment">; EAX=&gt;0x0; EAX&lt;=0x0; </span></li><li class="hl_l0">0x00010491<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;0x80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0xEFE01FF4<span class="hl_comment">; S8(0xEFE01FFC)=&gt;0x0; CF&lt;=0; AF&lt;=0; OF&lt;=0; SF&lt;=0; ZF&lt;=1; PF&lt;=1; </span></li><li class="hl_l1">0x00010495<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>je</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x1049a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;ZF<span class="hl_char">=</span><span class="hl_char">&gt;</span><span class="hl_number">1</span><span class="hl_comment">; EIP&lt;=0x10497; </span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">[</span>loc_00010497<span class="hl_char">]</span></li><li class="hl_l0">0x00010497<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span style="word-break: break-all">&nbsp;0x1b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0x0<span class="hl_comment">; EAX&lt;=0x1B; CF&lt;=0; AF&lt;=0; OF&lt;=0; SF&lt;=0; ZF&lt;=0; PF&lt;=1; </span></li><li class="hl_l1">0x0001049a<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ebp</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;S32<span class="hl_char">(</span>0xEFE01FF4<span class="hl_char">)</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0x0<span class="hl_comment">; ESP&lt;=0xEFE01FF8; EBP&lt;=0x0; </span></li><li class="hl_l0">0x0001049b<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ret</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;S32<span class="hl_char">(</span>0xEFE01FF8<span class="hl_char">)</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0x1065C<span class="hl_comment">; ESP&lt;=0xEFE02000; EIP&lt;=0x1065C; </span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_char">[</span>loc_0001049a<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;0x0001049a<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ebp</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;S32<span class="hl_char">(</span>0xEFE01FF4<span class="hl_char">)</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0x0<span class="hl_comment">; ESP&lt;=0xEFE01FF8; EBP&lt;=0x0; </span></li><li class="hl_l0">&nbsp;0x0001049b<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>ret</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">4</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;S32<span class="hl_char">(</span>0xEFE01FF8<span class="hl_char">)</span><span class="hl_char">=</span><span class="hl_char">&gt;</span>0x1065C<span class="hl_comment">; ESP&lt;=0xEFE02000; EIP&lt;=0x1065C;</span></li>        </ol>
    </div>
</div></div>
<br>Есть функционал для угадывания прыжков, но все равно трассирует все ветви
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380980&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=12" class="addthx" data-post="380980"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 18:02 &middot; Поправил: Boostyq <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
Доделала все инструкции, которые встречаются в моем случае, а именно:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">jmp</span><span class="hl_char">,</span>&nbsp;jcc<span class="hl_char">,</span>&nbsp;<span class="hl_function">call</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">ret</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">mov</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">movzx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">movsx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">xchg</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">lea</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">cmp</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">cmpxchg</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">add</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">xadd</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">adc</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">sub</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">sbb</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">inc</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">dec</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">neg</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">div</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">idiv</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">mul</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">imul</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">cwde</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">cdq</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">xor</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">not</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">or</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">and</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">test</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">aaa</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">aad</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">aam</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">aas</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">daa</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">das</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">push</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">pop</span><span class="hl_char">,</span>&nbsp;pushal<span class="hl_char">,</span>&nbsp;popal<span class="hl_char">,</span>&nbsp;<span class="hl_function">leave</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">rol</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">ror</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">rcl</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">rcr</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">sal</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">shl</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">sar</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">shr</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">shld</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">shrd</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">pushfd</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">popfd</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">clc</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">stc</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">cmc</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">cld</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">std</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">cli</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">sti</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">sahf</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">lahf</span><span class="hl_char">,</span>&nbsp;salc<span class="hl_char">,</span>&nbsp;<span class="hl_function">bsf</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">bsr</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">bt</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">btc</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">btr</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">bts</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">bswap</span></li>        </ol>
    </div>
</div></div>
<br>Эмуляцию апи вызовов я тоже сделала через колбэки на чтение памяти таблицы импорта выдается псевдо-адрес вызываемой функции (т.к. изначально там ?? ?? ?? ??), затем если бряк на один из этих псевдо-адресов срабатывает то выполняется фальшивый обработчик, который выравнивает стек, и возвращает нулевой результат<br><br>Теперь не очень ясно как обрабатывать ветки, изначально ветки обрабатывались лишь однажды, но если рассматривать call как прыжок, то не знаю как определить функция это или нет, иначе трассировка остановится т.к. уже якобы была сделана, если уже встречалась
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381010&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=13" class="addthx" data-post="381010"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 18:12 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
<b>Boostyq</b><br><br>Покажу вам пример, я линк показывал, не знаю доступны ли аттачи на рох без авторизации.<br><br>Это цикл эмуляции ветвлений и исполнения(ядро визора, цикл динамической эмуляции(dye&quot;)).<br><br>При таком подходе отпадает необходимость в раскодировке-трансляции-эмуляции. Это обычно трудно реализуемо, так как нужно ровно обработать очень много инструкций, что вводит ошибки.<br><br>Во первых эмуляция куда медленнее прямого исполнения. Во вторых не может быть выполнена пакетная эмуляция, где линейный блок отправляется на выполнение в cpu.<br><br>В случае дин эмуляции нужен только дизасм длин и простой декодер MRM <img src="img/smilies/s1.gif" alt=""><br><br><img src="img/attach.gif" alt=""> <a href="./files/15e5_16.12.2017_EXELAB.rU.tgz">15e5_16.12.2017_EXELAB.rU.tgz</a> - vsr.zip
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381011&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=14" class="addthx" data-post="381011"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 18:22 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<b>Boostyq</b><br>зачем свой велосипед с нуля писать, если уже полно написанных?<br><b>difexacaw</b><br>зачем нужно это дрочево если есть DBI? их гоняют тысячи людей и там все отлажено в отличие от твоих постоянно глохнущих моторов?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381012&amp;user=29820&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=15" class="addthx" data-post="381012"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 18:30 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
<b>SegFault</b><br><br>Стандарт дби не предназначено для <u>реалтайм</u> задач(по этой причине и все эти сложности и вопросы), это отладочные инструменты. Они не позволяют к примеру реализовать визор, работа которого будет не заметна и стабильна, таким образом создать продвинутую защиту или использовать это в викс целях. Поэтому и пишется обычно своё с нуля, как и в случае тс.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381013&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=16" class="addthx" data-post="381013"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 18:40 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<I>difexacaw пишет: Стандарт дби не предназначено для реалтайм задач </I><br><br>Позволяет, да и у DBI нет стандарта, это всего лишь класс инструментов, а их реализация дело десятое. В данном случае не вижу ничего плохого в том, что ТС делает велосипед, это поможет понять, как работают подобные инструменты, а такие практические знания пригодятся в будущем, будь то написание своего тула или модификация чужого, на одной теории далеко не уедешь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381014&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=17" class="addthx" data-post="381014"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 18:44 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
<b>difexacaw</b><br>это чушь собачья, до тебя просто медленно всё доходит, лет 5 назад ты нес дичь что гипервизоры это хрень,  а сейчас свой написал. Сейчас до тебя не доходит, что давно есть аппаратная трассировка в процессорах интел, для реал тайм задач, но тебя походу в гугле забанили поэтому ты про это не знаешь. А ТС херней мается, убить столько времени вместо того, чтобы заюзать готовый инструмент.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381015&amp;user=29820&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=18" class="addthx" data-post="381015"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 18:45 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Нет, не позволяют. Оно всё построено на диких костылях и не имеет архитектуры. Даже речь про км идти не может. DynamoRIO к примеру это забавное чтиво и дичайший ппц по количеству извратов и состоянию разума его автора <img src="img/smilies/s1.gif" alt=""><br><br>Нормальная реализация должна быть максимально простой и нэйтивной. Вы говорите про инструменты, я же говорю про реалтайм применение, поймите разницу.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381016&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=19" class="addthx" data-post="381016"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Boostyq[/b]','')">Boostyq</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/40448.png" alt=""><br><span class=txtSm>Ранг: 90.1 (постоянный), 89thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.32'>Активность: 0.29<span style='color:green'>&nearr;</span>0.56</span><br>Статус: <a href="action=userinfo&amp;user=40448">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 18:47 <br><script type="text/javascript">QU('Boostyq','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Boostyq" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<I>SegFault пишет:<br>зачем свой велосипед с нуля писать, если уже полно написанных? </I><br>Мотивация в повышении собственных навыков<br>На данный момент, когда я лучше знаю команды асмы, вижу какие инструкции имеют смысл, а какие мусор, и что если исключить их влияние на флаги, то их можно убирать<br>В то же время, я не представляю как сделать это автоматически, даже забыв про автоматику, для того чтобы это сделать руками мне нужна полная трасса функции, т.е. грубо говоря есть обфусцированная функция, и весь код который там может выполнится нужно вытащить оттуда, чтобы например скормить иде и она уже нормально проанализировала<br>Между делом спрошу людей которые шарят в вмпроте, как так получилось, что лишь некоторые функции обфусцированы? У меня есть 3 версия вмп и там есть опция мутация, но как я понимаю, это совсем другое. При том другие файлы защищены по полной программе<br>Но вы, SegFault, убедили меня, если есть какой то инструмент, который позволит мне выполнить это легко и статически, то я буду очень рада
<br><br><font size="1"><i>-----<br>В облачке многоточия</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381017&amp;user=40448&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=20" class="addthx" data-post="381017"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 18:49 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
<b>SegFault</b><br><br>Я не писал гипервизоры и вообще их не обсуждаю, да вы просто в понятиях путаетесь из за не знания и не понимания.<br><br>Я хорошо знаю про железячные отладочные механизмы. Так вот там проблемы две - нет железячного декодера длин, машинная трассировка допустима в км, в юм профайл падает до не приемлемых величин.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381018&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=21" class="addthx" data-post="381018"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 18:51 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
<b>difexacaw</b><br>это у тебя путаница в терминах потому что не юзаешь устоявшиеся, а придумываешь свои. И про трассировку я не имею ввиду трейс флаг или бранч трейсинг, я про новую фичу интеловских процов, там реалтайм хоть ядро хоть юзермод логируется без проблем.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381019&amp;user=29820&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=22" class="addthx" data-post="381019"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 19:02 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
<b>SegFault</b><br><br>Во первых мало у кого есть новые камни. А во вторых какой бы новый и мощный дебаг механизм не был бы реализован, всё равно профайл просядет в сотни раз. Причина этому - межкольцевое переключение, смена мода. При этом выполняется куча железячных проверок безопасности(помимо софтверных), любой системщик понимает что нормальное апп должно минимально выполнять такие смены мода. По этой причине и гуй вынесен по возможности из км в юм.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381020&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=23" class="addthx" data-post="381020"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 19:07 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Во первых мало у кого есть новые камни </I><br>единственный дельный коммент, но рано или поздно будут у всех<br>По остальному - эта хардварная срань как раз и была придумана для риал тайма, так что ей похер на межкольцевые переключиния. Ну чтобы более понятно было - sysenter/syscall это хардварное ускорение int 2e, в три раза быстрее прерывания стало. То же самое с хардварной трассировкой.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381021&amp;user=29820&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=24" class="addthx" data-post="381021"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 19:09 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
<I>difexacaw пишет: всё равно профайл просядет в сотни раз </I><br><br>Сам не пользовался еще, но интел обещает среднее проседание исполнения на 15%
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381022&amp;user=41575&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=25" class="addthx" data-post="381022"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 19:14 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Без смены мода <img src="img/smilies/s15.gif" alt=""><br><br><b>SegFault</b><br><br>Ну возьми блокнот потрассируй, сними профайл. Зачем вы лезете в тему где ничего не понимаете, просто что бы нагадить.. тогда придётся обратиться к модерам.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381023&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=26" class="addthx" data-post="381023"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 19:20 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
<b>difexacaw</b><br>наркоман чтоле? блокнот трассируется на бранчтрейсинге легко, обнови свой пентиум2!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381024&amp;user=29820&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=27" class="addthx" data-post="381024"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 19:58 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
<b>SegFault</b><br><br>Какой бы механизм не вызывался, всё равно интерфейс требует смену мода, а это как я говорил большая просадка в профайле. Кернел евент доставляется в юм через двойную смену мода, да причём с кучей транзитных функций. Я не говорил что блокнот не трассируется, я говорил про снятие профайла. Включите наконец мозги, если они есть <img src="img/smilies/s15.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381026&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=28" class="addthx" data-post="381026"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 20:06 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
<b>difexacaw</b><br>я удивляюсь твоей бесконечной тупости, какая смена мода? нахера она, открой уже гугл и пойми что трасса сохраняется без перехода в UM в новых процах, причем делается это максимально оптимальным способом, хули ты тут из себя строишь перца умнее чем интеловские инженеры? тебя туда пол мыть не возьмут с твоим упертым мозгом и зашкаливающим самомнением
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381027&amp;user=29820&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=29" class="addthx" data-post="381027"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 20:09 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#30');return false;">#30</a> </span><div align=left><br>
<b>SegFault</b><br><br>Вас удалят за спам, я уже написал в соотв. тему. Твою дикость ты покажи где то есчо, но тут это не уместно. Таких ка ты нужно лечить, в сети это невозможно. Поэтому вас можно только удалять, как заразу.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=381028&amp;user=40990&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=30" class="addthx" data-post="381028"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 декабря 2017 20:11 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=24981&amp;page=1#31');return false;">#31</a> </span><div align=left><br>
<b>difexacaw</b><br>слился даун, побежал стучать модерам, правильно, аргументировать то нечем! Вышло, что ты пилил свое гуано  ввиде очередного мотора, а всё это в железе давно есть. Обидно, понимаю.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=381029&amp;user=29820&amp;forum_n=13&amp;topic=24981&amp;page=1&amp;anchor=31" class="addthx" data-post="381029"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=24981&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Статическая трассировка кода</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="24981">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24981" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
