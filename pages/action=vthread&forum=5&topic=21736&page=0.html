<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Поиск вызова библиотечной функции в двоичном коде - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте. Имеется задача прочитать ЕХЕ-шник и начти в нем вызовы библиотечных функций (например, scrcopy). Дизассемблеры типа IDA спокойно разпознают вызовы бибилиотечных функций, но я так и не понял, как они это делают. С">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=41144'>Adler</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Поиск вызова библиотечной функции в двоичном коде</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Alex071[/b]','')">Alex071</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34776">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 17:23 <br><script type="text/javascript">QU('Alex071','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alex071" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте. Имеется задача прочитать ЕХЕ-шник и начти в нем вызовы библиотечных функций (например, scrcopy).<br>Дизассемблеры типа IDA спокойно разпознают вызовы бибилиотечных функций, но я так и не понял, как они это делают.<br>С помощью гугла отрыл, что IDA использует технологию FLIRT (http://www.idapro.ru/description/flirt/). Но как искать в файле по сигнатуре, если самого кода функции там не нету, не понял..<br>Похоже, нужно использовать таблицу импорта, искать импортируемые dll-ки и их функции и использовать примерно такой алгоритм:<br>1. Смотрим в таблицу импорта и сопоставляем адрес вызова с функцией<br>2. Ищем в ЕХЕ-шнике в разделе кода call &lt;адрес нужной функции&gt;<br>Но вот вопрос, существует ли возможность определить адреса вызова футкций до загрузки программы в память? Напримет, в случае непривязанного импорта, если я все правильно понял, адреса импортируемых функций записывваются в время загрузки программы.. но тогда как можно заранее определить, какие инструкции искать?<br><br>Вот, например, как выглядит код вызова функции strcpy в дизассемблере:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">strcpy<span class="hl_char">(</span>s2<span class="hl_char">,</span>&nbsp;s1<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_number">003B378A</span>&nbsp;<span class="hl_number">8D</span>&nbsp;<span class="hl_number">45</span>&nbsp;D8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">-</span><span class="hl_number">28h</span><span class="hl_char">]</span>&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">003B378D</span>&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_number">003B378E</span>&nbsp;<span class="hl_number">8B</span>&nbsp;<span class="hl_number">4D</span>&nbsp;CC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">-</span><span class="hl_number">34h</span><span class="hl_char">]</span>&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">003B3791</span>&nbsp;<span class="hl_number">51</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_number">003B3792</span>&nbsp;E8&nbsp;<span class="hl_number">49</span>&nbsp;DA&nbsp;FF&nbsp;FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ILT<span class="hl_char">+</span><span class="hl_number">475</span><span class="hl_char">(</span>_strcpy<span class="hl_char">)</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">3B11E0h</span><span class="hl_char">)</span>&nbsp;</li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1">@ILT<span class="hl_char">+</span><span class="hl_number">475</span><span class="hl_char">(</span>_strcpy<span class="hl_char">)</span><span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_number">003B11E0</span>&nbsp;E9&nbsp;<span class="hl_number">0D</span>&nbsp;<span class="hl_number">02</span>&nbsp;<span class="hl_number">00</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcpy&nbsp;<span class="hl_char">(</span><span class="hl_number">3B13F2h</span><span class="hl_char">)</span>&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0">strcpy<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">003B13F2</span>&nbsp;FF&nbsp;<span class="hl_number">25</span>&nbsp;DC&nbsp;<span class="hl_number">82</span>&nbsp;<span class="hl_number">3B</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span>__imp__strcpy&nbsp;<span class="hl_char">(</span><span class="hl_number">3B82DCh</span><span class="hl_char">)</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>Получается, что все вызовы strcpy перенаправляются на метку &quot;@ILT+475(_strcpy)&quot;, а оттуда уже на метку &quot;strcpy&quot;.<br><br> По идее, получается, что в программе мне нужно искать все команды &quot;call @ILT+475(_strcpy)&quot;. Но как узнать, что я должен искать именно такую команду, ведь в таблице импорта нет никакой информации об этой метке. Я там нашел только RVA строк, которые хранят названия функций. Скрин с таблицей приаттачил..<br><br><img src="img/attach.gif" alt=""> <a href="./files/ed84_07.05.2013_EXELAB.rU.tgz">ed84_07.05.2013_EXELAB.rU.tgz</a> - import table.png
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324377&amp;user=34776&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=1" class="addthx" data-post="324377"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 18:11 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Берешь из таблицы импорта имя функции, GetProcAddress(LoadLibrary(..),..) получаешь адрес функции. Вызывается оно обычно call [strcpy] либо call m1/m1: jmp [strcpy]<br><br>А то что ида нашла в коде - это рантайм библиотека, которая может реализовать тот же strcpy сама или дергнуть для этого API
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324382&amp;user=3136&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=2" class="addthx" data-post="324382"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Alex071[/b]','')">Alex071</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34776">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 18:52 <br><script type="text/javascript">QU('Alex071','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alex071" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Спасибо за ответ! Но ведь после вызова GetProcAddress(LoadLibrary(..),..), я получу виртуальный адрес функции в адресном пространстве программы, которая сканирует ЕХЕ-шник. Этот адрес, по идее, никак не связан с теми адресами, что зашиты в самом ЕХЕ файле. Если так, то как можно будет сравнивать эти адреса?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324385&amp;user=34776&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=3" class="addthx" data-post="324385"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 19:16 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
В ехе никакие адреса не зашиты, в том и прелесть. Винда их подставляет в момент загрузки.<br>Не понятно что вы хотите.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324386&amp;user=3136&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=4" class="addthx" data-post="324386"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Alex071[/b]','')">Alex071</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34776">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 19:46 <br><script type="text/javascript">QU('Alex071','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alex071" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Извините, наверно, не очень понятно пишу... Задача такая: программа на вход получает ЕХЕ-шник и должна определить, в каких местах вызввалась определенная библиотченая функция (например, scrcopy).<br><br>Я подумал, что мне поможет анализ таблицы импорта ехе файла для того, чтобы получить адрес нужной функции и потом в коде ехе-шника найти инструкцию вроде call &lt;адрес&gt; или jmp &lt;адрес&gt;, чтобы определить, что из этого места была вызвана нужная мне функция.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324388&amp;user=34776&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=5" class="addthx" data-post="324388"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 19:46 <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>Veliant пишет:<br>Не понятно что вы хотите.</I><br>Похоже, что в секции кода нужно найти все вызовы API или CRT. Так для этого смотрим таблицу перекрёстных ссылок. Или цель написать свой дизассемблер?
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=324389&amp;user=24900&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=6" class="addthx" data-post="324389"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Alex071[/b]','')">Alex071</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34776">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 20:07 <br><script type="text/javascript">QU('Alex071','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alex071" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Да, цель именно та )) Дизассемблер не пишу, но нужно &quot;научить&quot; свою прогу разпознавать эти вызовы автоматически )
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324391&amp;user=34776&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=7" class="addthx" data-post="324391"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 20:28 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
без дизассемблера плохо будет. совсем топорный способ - искать байты FF25 или FF15 в секции кода, и сравнивать следующий dword указывает на адрес из IAT(а не на саму api) или нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324395&amp;user=3136&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=8" class="addthx" data-post="324395"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=34776" title="07-05-2013 18:10, ранг:0.4" target="_blank">Alex071</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Alex071[/b]','')">Alex071</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34776">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 20:39 &middot; Поправил: Alex071 <br><script type="text/javascript">QU('Alex071','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alex071" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Я, честно говоря, как раз вынашивал этот топорный метод )) <br><br>Но ведь пока программа не загружена в память, IAT не заполнена, там находятся только имена импортируемых функций (это я из <noindex><a href="http://exelab.ru/faq/Таблица_импорта_PE_файла" rel="nofollow" target="_blank">--&gt; Таблица импорта PE файла &lt;--</a></noindex> <img src="img/smilies/s1.gif" alt=""> вычитал). Тогда как вести сравнение?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324397&amp;user=34776&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=9" class="addthx" data-post="324397"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]neomant[/b]','')">neomant</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/24900.jpg" alt=""><br><span class=txtSm>Ранг: 164.6 (ветеран), 65thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.27'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=24900">Участник</a><br><font color=blue>Волшебник</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 20:56 <br><script type="text/javascript">QU('neomant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neomant" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>Alex071 пишет:<br>там находятся только имена импортируемых функций</I><br>По именам и вести. Только что-то мне подсказывает, это это очередной велосипед и ваши &#039;реальные&#039; задачи решаются иными, гораздо легчеми путями.
<br><br><font size="1"><i>-----<br>Следуй за белым кроликом</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=324400&amp;user=24900&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=10" class="addthx" data-post="324400"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=34776" title="07-05-2013 18:10, ранг:0.4" target="_blank">Alex071</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 21:19 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Alex071 пишет:<br>Но ведь пока программа не загружена в память, IAT не заполнена, там находятся только имена импортируемых функций </I><br>а каким образом пользовательский код вдруг получит управление в тот момент, когда IAT не заполнена?<br><br>если цель - чисто статический анализ, тогда либо читаем/анализируем модули, прописанные в таблице импорта, либо просто запоминаем диапазон адресов, где находится IAT и, при обращении к ним, подставляем соответствующее имя функции.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324402&amp;user=26242&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=11" class="addthx" data-post="324402"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Alex071[/b]','')">Alex071</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34776">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 21:44 &middot; Поправил: Alex071 <br><script type="text/javascript">QU('Alex071','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alex071" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Получается, код<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">FF&nbsp;<span class="hl_number">25</span>&nbsp;DC&nbsp;<span class="hl_number">82</span>&nbsp;<span class="hl_number">3B</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span>__imp__strcpy&nbsp;<span class="hl_char">(</span><span class="hl_number">3B82DCh</span><span class="hl_char">)</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br>уже заранее есть в ЕХЕ-файле? <br>Попробовал поискать &quot;FF 25 DC 82 3B 00&quot; в Hex-редакторе, но без успеха..<br><br>Или же в ЕХЕ-шнике есть код типа &quot;дальний переход на адрес, что записан в IDT&quot;, но в &quot;FF 25 DC 82 3B 00&quot; он превращается уже после загрузки программы в память?<br><br><br>Например, если строка в IAT имеет такой вид:<br><br>pFile    |        Data     |       Value<br><br>000060DC | 0001873E | 063B strcpy<br><br><br>То какой должна быть строка поиска? FF 25...<br><br>Извините за глупые вопросы, мне очень стыдно ))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324405&amp;user=34776&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=12" class="addthx" data-post="324405"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 21:52 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Alex071 пишет:<br>Получается, код<br>Code:<br>   1. FF 25 DC 82 3B 00    jmp         dword ptr [__imp__strcpy (3B82DCh)]<br>уже заранее есть в ЕХЕ-файле?  </I><br><br>советую перечитать доку по секции импорта PE-файла<br>если функция принадлежит к секции импорта, то там есть только<br>где-то:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;сall&nbsp;strcpy</li>        </ol>
    </div>
</div></div>
<br><br>переходники_сгенеренные_компилятором:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_char">[</span>strcpy<span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>и, наконец, в директории импорта:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">strcpy&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;rva&nbsp;_strcpy</li><li class="hl_l1"><span class="hl_char">&lt;</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">&gt;</span></li><li class="hl_l0">_strcpy&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;strcpy&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li>        </ol>
    </div>
</div></div>
<br><br>rva _strcpy - относительное смещение на имя импортируемой функции<br>загрузчик, при загрузке модуля, заменяет его на реальный адрес функции в адресном пространстве процесса<br><br>/ADD:<br>но! переходников может и не быть:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">offset</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;d<span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>или, например:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_function">offset</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_registr">eax</span></li>        </ol>
    </div>
</div></div>
<br><br>поэтому, если нужно найти вызов функции статически, лучше следить за всякими константами, такими как адрес или рва функции в таблице импорта
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324407&amp;user=26242&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=13" class="addthx" data-post="324407"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=34776" title="07-05-2013 18:11, ранг:0.4" target="_blank">Alex071</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Alex071[/b]','')">Alex071</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34776">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 22:09 &middot; Поправил: Alex071 <br><script type="text/javascript">QU('Alex071','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alex071" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Черт, спасибо огроменное, я, кажется, все понял )) Т.е. мне нужно искать в секции кода &quot;jmp [rva _strcpy]&quot; ?<br>//ADD:<br>Следить за RVA функции это всмысле проверять, где в секции кода есть поаледовательность байт равная RVA в таблице импорта?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324408&amp;user=34776&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=14" class="addthx" data-post="324408"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]reversecode[/b]','')">reversecode</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/15381.gif" alt=""><br><span class=txtSm>Ранг: 1053.6 <b><u>(!!!!)</u></b>, 1078thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.43'>Активность: 1.06<span style='color:red'>&searr;</span>0.81</span><br>Статус: <a href="action=userinfo&amp;user=15381">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 22:20 <br><script type="text/javascript">QU('reversecode','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=reversecode" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>Alex071 пишет:<br>я, кажется, все понял  </I><br>и<br><I>Alex071 пишет:<br>Т.е. мне нужно искать в секции кода &quot;jmp [rva _strcpy]&quot; ? </I><br><br>можно сделать вывод что ничего не поняли)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324409&amp;user=15381&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=15" class="addthx" data-post="324409"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Alex071[/b]','')">Alex071</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34776">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 22:31 &middot; Поправил: Alex071 <br><script type="text/javascript">QU('Alex071','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alex071" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
черт) Вот мое понимание, поправьте пожалуйста, что не так:<br>1.В IAT до загрузки программы хранятся RVA строк, содержащих имена импортируемых функций. <br>2.Далее загрузчик подменяет эти RVA на адреса точек входа в функции.<br>3.В ЕХЕ-шнике уже есть код, который берет адрес, записанный в IAT и делает jmp на этот адрес (если есть переходник)<br><br>Поэтому задача в простейшем случае сводится к нахождению кода из пункта 3
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324410&amp;user=34776&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=16" class="addthx" data-post="324410"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 мая 2013 22:44 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>Alex071 пишет:<br>3.В ЕХЕ-шнике уже есть код, который берет адрес, записанный в IAT и делает jmp на этот адрес (если есть переходник) </I><br><br>обращения к записи в IAT будут по-любому, иначе в ней бы не было смысла<br>но! опять подчёркиваю - адрес записи в таблице импорта может помещаться в регистр или переменную перед использованием, поэтому искать нужно константу (ImageBase+rva ImportedFunc)<br><br>ТС, перед поиском решения, не помешало бы изложить суть задачи - возможно, метод решения окажется проще... <img src="img/smilies/s3.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324412&amp;user=26242&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=17" class="addthx" data-post="324412"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Alex071[/b]','')">Alex071</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.18'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34776">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 мая 2013 14:22 &middot; Поправил: Alex071 <br><script type="text/javascript">QU('Alex071','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Alex071" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=21736.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Сэнкью всем вэри-вэри мач! Теперь все осозналось и получилось )) Наверно, уже нет смысла запаривать народ сутью своей (довольно глупой <img src="img/smilies/s1.gif" alt=""> ) задачи. Еще раз спасибо!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=324430&amp;user=34776&amp;forum_n=5&amp;topic=21736.html&amp;page=0&amp;anchor=18" class="addthx" data-post="324430"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Поиск вызова библиотечной функции в двоичном коде</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=21736" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
