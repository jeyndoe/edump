<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Получить RSize директории в PE формате - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброе утро всем!Возможно мой вопрос для вас покажеться глупым,или кто-то уже такой вопрос задавал,на форуме я подобного не нашел.(((( В некоторых exe собраных в Visual Studio,а также запакованых ехе,например Upx-сом в одной">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=7823'>ManHunter</a>, <a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a> (+10 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Получить RSize директории в PE формате</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Sawyer[/b]','')">Sawyer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31551">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 07:55 <br><script type="text/javascript">QU('Sawyer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sawyer" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброе утро всем!Возможно мой вопрос для вас покажеться глупым,или кто-то уже такой вопрос задавал,на форуме я подобного не нашел.((((<br><br>В некоторых exe собраных в Visual Studio,а также запакованых ехе,например Upx-сом в одной секции содержитться несколько секций,например в ехе упакованом Upx в секции .rsrc содержиться секция инициализированых данны,а также секция имопрта и ресурсов.Чтобы найти адреса этих секций,нужно посмотреть адреса их директорий через структуру DataDirectory,в которой только два параметра это VOffset и VSize,для code директории нет,для определения ее местоположения юзаються два поля из опционального заголовка-Base of Code и Size of Code.Мне нужно узнать ROffset и RSize.С ROffset-ом все понятно,там по формуле вычисляеться,а какая формула для RSize,как его вычислить?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302771&amp;user=31551&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=1" class="addthx" data-post="302771"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Vovan666[/b]','')">Vovan666</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 617.3 (<b>!</b>), 677thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.06'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5291">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 08:25 <br><script type="text/javascript">QU('Vovan666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vovan666" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Вроде была такая тема, только давно. Кажись сошлись что только примерно и сигнатурно можно определить некоторые секции.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302772&amp;user=5291&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=2" class="addthx" data-post="302772"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 09:00 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
не совсем воткнул в вопрос, чем Size of Code не устраивает? ну или как вариант, смотреть какой секции принадлежит Base of Code и считать её кодовой?
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302773&amp;user=72&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=3" class="addthx" data-post="302773"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Sawyer[/b]','')">Sawyer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31551">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 09:29 <br><script type="text/javascript">QU('Sawyer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sawyer" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Hellspawn,мне перед тем как работать с секциями,нужно кое что проверить:<br>1)Есть ли в секции оверлей if(RSize&gt;VSize) или в ней содержаться неинициализированые данные if(RSize&lt;VSize),или же RSize==VSize<br><br>2)Мне секцию шифровать нужно только в пределах ROffset~ROffset+RSize;<br><br>Короче,как не крути а нужно знать RSize((
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302774&amp;user=31551&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=4" class="addthx" data-post="302774"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 09:50 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Sawyer</b><br>в секции оверлей? оверлей идет после всех секций и им не принадлежит. обычно в кодовой секции находится только код.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302777&amp;user=72&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=5" class="addthx" data-post="302777"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Sawyer[/b]','')">Sawyer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31551">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 09:58 <br><script type="text/javascript">QU('Sawyer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sawyer" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Ну я кодовую секцию так для примера привел.<br>Читал статью zOmbie,он там привел примеры  ситуаций,которые я выше описал. <br>Вобщем суть в том чтобы зашифровать содержимое секции на диске,а так как я незнаю ее реального размера,то могу выйти за ее пределы,и покоцать следующую секцию.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302779&amp;user=31551&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=6" class="addthx" data-post="302779"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 10:03 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Sawyer</b> ну в таблице секций же есть размер секции (виртуальный и реальный)
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302780&amp;user=72&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=7" class="addthx" data-post="302780"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Sawyer[/b]','')">Sawyer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31551">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 10:13 <br><script type="text/javascript">QU('Sawyer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sawyer" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Hellspawn так и есть<img src="img/smilies/s1.gif" alt="">.Ты меня немного не понял.Я же привел пример с Upx.<br><I><br>например Upx-сом в одной секции содержитться несколько секций,например в ехе упакованом Upx в секции .rsrc содержиться секция инициализированых данны,а также секция имопрта и ресурсов </I><br><br>Например мне нужно зашифровать секцию инициализированых данны,а ее реального размера я незнаю.Может быть покоцана секция импорта,если ROffset+VOffset секции с данными будет больше чем ROffset секци импорта.Я понимаю конечто,что можна проверять долго и уныло не выходит ли каждая директория за границу следующей,но может есть более нормальный способ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302782&amp;user=31551&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=8" class="addthx" data-post="302782"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]vnekrilov[/b]','')">vnekrilov</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 329.6 (мудрец), 192thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.08'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=5173">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 10:18 &middot; Поправил: vnekrilov <br><script type="text/javascript">QU('vnekrilov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vnekrilov" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Мне, при распаковке программ, упакованных PEP, Themida и т.п., часто приходится восстанавливать оригинальные секции файлов. Для этих целей, я определяю, на каком языке была написана программа, нахожу неупакованные программы, написанные на этом языке, и путем тупого сравнения, нахожу нужные секции с их размерами. Для этих целей, я даже написал скрипт, который, перед дампированием памяти программы, корректирует PE-заголовок файла. Правда, в этот скрипт, начало каждой секции я ввожу вручную, а дальше скрипт сам вычисляет размеры секций, и корректирует PE-заголовок.<br><br><img src="img/attach.gif" alt=""> <a href="./files/b6d1_30.03.2012_EXELAB.rU.tgz">b6d1_30.03.2012_EXELAB.rU.tgz</a> - Themida - Корректировка PE-заголовка и дампирование распакованного файла.osc
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302783&amp;user=5173&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=9" class="addthx" data-post="302783"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31551" title="30-03-2012 06:18, ранг:1.0" target="_blank">Sawyer</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Sawyer[/b]','')">Sawyer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31551">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 10:32 <br><script type="text/javascript">QU('Sawyer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sawyer" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
vnekrilov спасибо,но это все не то.Я начал писать свой протектор,так что он должен быть универсальным для всех PE файлов,реальный размер нужно автоматически определить.Просто думал что есть какой то документированый способ,формула что ли.(((((
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302788&amp;user=31551&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=10" class="addthx" data-post="302788"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 11:00 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>Sawyer</b>, тебе лень проверить что тебе <b>Hellspawn</b> сказал?<br>на примере блокнота под upx<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Size&nbsp;of&nbsp;<span class="hl_function"><b>code</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">00005000</span></li><li class="hl_l1">Size&nbsp;of&nbsp;init&nbsp;<span class="hl_function"><b>data</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00008000</span></li><li class="hl_l0">Size&nbsp;of&nbsp;uninit&nbsp;<span class="hl_function"><b>data</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00010000</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Base&nbsp;of&nbsp;<span class="hl_function"><b>code</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">00011000</span></li><li class="hl_l1">Base&nbsp;of&nbsp;<span class="hl_function"><b>data</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">00016000</span></li><li class="hl_l0"><span style="word-break: break-all">Image&nbsp;base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">01000000</span></li>        </ol>
    </div>
</div></div>
<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">1</span>&nbsp;UPX0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00010000</span>&nbsp;<span class="hl_number">00001000</span>&nbsp;<span class="hl_number">00000000</span>&nbsp;<span class="hl_number">00000400</span>&nbsp;E0000080</li><li class="hl_l1"><span class="hl_number">2</span>&nbsp;UPX1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00005000</span>&nbsp;<span class="hl_number">00011000</span>&nbsp;<span class="hl_number">00004600</span>&nbsp;<span class="hl_number">00000400</span>&nbsp;E0000040</li><li class="hl_l0"><span class="hl_number">3</span>&nbsp;<span class="hl_char">.</span>rsrc&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00008000</span>&nbsp;<span class="hl_number">00016000</span>&nbsp;<span class="hl_number">00007200</span>&nbsp;<span class="hl_number">00004A00</span>&nbsp;C0000040</li>        </ol>
    </div>
</div></div>
<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>Import</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0001CE24</span>&nbsp;<span class="hl_number">0000024C</span></li><li class="hl_l1"><span class="hl_function"><b>Resource</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">00016000</span>&nbsp;<span class="hl_number">00006E24</span></li>        </ol>
    </div>
</div></div>
<br>Что мы видим? Base of code = VAddr UPX1, Size of code = VSize UPX1. <br>Отсюда RAddr= RAddr UPX1, RSize = min(Size of code, RSize UPX1)<br>Импорт и ресурсы лежат уже в следующей секции, и не попадают в Base of code+Size of code
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302790&amp;user=3136&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=11" class="addthx" data-post="302790"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Sawyer[/b]','')">Sawyer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31551">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 11:19 &middot; Поправил: Sawyer <br><script type="text/javascript">QU('Sawyer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sawyer" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Veliant ну а например как бысть с WinSpy++,собран в Visual C++ 6.0<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00400000</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00001000</span>&nbsp;&nbsp;&nbsp;WinSpy<span class="hl_char">+</span><span class="hl_char">+</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PE&nbsp;header&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00401000</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00002000</span>&nbsp;&nbsp;&nbsp;WinSpy<span class="hl_char">+</span><span class="hl_char">+</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>rdata&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">code</span><span class="hl_char">,</span><span style="word-break: break-all">imports&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">00403000</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00015000</span>&nbsp;&nbsp;&nbsp;WinSpy<span class="hl_char">+</span><span class="hl_char">+</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function"><b>data</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SFX<span class="hl_char">,</span><span class="hl_function"><b>data</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00418000</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">00007000</span>&nbsp;&nbsp;&nbsp;WinSpy<span class="hl_char">+</span><span class="hl_char">+</span>&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>rsrc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resources&nbsp;</li>        </ol>
    </div>
</div></div>
<br><br>BaseOfCode RVA=00001000;VA=4000001000;ROffset=400;<br><br>SizeOfCode вобще равен 0,и что теперь делалать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302791&amp;user=31551&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=12" class="addthx" data-post="302791"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 11:26 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>Sawyer пишет:<br>SizeOfCode вобще равен 0,и что теперь делалать?  </I><br>Пробежаться по всем секциям и посмотреть, у которых стоят IMAGE_SCN_MEM_EXECUTE и IMAGE_SCN_CNT_CODE<br><br>Если боишься нарваться на  импорт, ресурс и прочее, то почему бы не посмотреть их адреса, и не лезть за них<br><br>Не спорю, есть exe у которых и эти биты затерты. Получается нужно смотреть размер секции на которую указывает baseofcode и пропускать в ней все остальные данные при шифровании
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302793&amp;user=3136&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=13" class="addthx" data-post="302793"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31551" title="30-03-2012 07:31, ранг:2.0" target="_blank">Sawyer</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Sawyer[/b]','')">Sawyer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31551">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 11:41 &middot; Поправил: Sawyer <br><script type="text/javascript">QU('Sawyer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sawyer" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Veliant все я суть уловил.Благодарю<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302795&amp;user=31551&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=14" class="addthx" data-post="302795"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 13:35 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Sawyer</b><br>А вот я не уловил. Получается, я при компиляции собираю свой софт с указанием линкеру слить всё в одну секцию (опция /merge), потом выставляю всем секциям одинаковые атрибуты, и затираю неиспользуемые Base of Code/Data, и чё - протектор такой файл не упакует? Хреновый какой-то у вас протектор получается.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302798&amp;user=6336&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=15" class="addthx" data-post="302798"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 13:41 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>ARCHANGEL</b> кстати верная мысль, посмотреть как поступают другие пакеры/проты,<br>например тот же упх <img src="img/smilies/s1.gif" alt=""><br><br>з.ы. антивирус на такой файл будут верещать будь здоров <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302799&amp;user=72&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=16" class="addthx" data-post="302799"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 465thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 15:29 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>А вот я не уловил. Получается, я при компиляции собираю свой софт с указанием линкеру слить всё в одну секцию (опция /merge), потом выставляю всем секциям одинаковые атрибуты, и затираю неиспользуемые Base of Code/Data, и чё - протектор такой файл не упакует? Хреновый какой-то у вас протектор получается. </I><br>Да тут ненадо ничего изобретать  после расскриптовки-расспаковки файла в памяти поставит атрибуты c помощью VirtualProtect  на чтение,запись,исполнение и всё будет воркать <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=302802&amp;user=17432&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=17" class="addthx" data-post="302802"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Sawyer[/b]','')">Sawyer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31551">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 20:57 <br><script type="text/javascript">QU('Sawyer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sawyer" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>А вот я не уловил. Получается, я при компиляции собираю свой софт с указанием линкеру слить всё в одну секцию (опция /merge), потом выставляю всем секциям одинаковые атрибуты, и затираю неиспользуемые Base of Code/Data, и чё - протектор такой файл не упакует? Хреновый какой-то у вас протектор получается.  </I><br><br>ARCHANGEL я пока алгоримт  общий подбираю,чтоб для всех ехе работал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302820&amp;user=31551&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=18" class="addthx" data-post="302820"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 марта 2012 23:20 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Нет такого алгоритма. Лучше ответь на вопрос, для чего нужно принциально обрабатывать только код?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302823&amp;user=1556&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=19" class="addthx" data-post="302823"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Sawyer[/b]','')">Sawyer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31551">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2012 01:18 <br><script type="text/javascript">QU('Sawyer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sawyer" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Archer пишет:<br>Лучше ответь на вопрос, для чего нужно принциально обрабатывать только код?  </I><br><br>Несовсем понял вопрос.Ты в плане зачем нужно шифровать секцию с кодом?Или что ты имееш в виду?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302828&amp;user=31551&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=20" class="addthx" data-post="302828"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 марта 2012 10:05 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Зачем шифровать ТОЛЬКО код и закидывать ногу за ухо, пытаюсь отделить его секции. Почему бы не зашифровать весь образ, размеры которого вполне фиксированы, как это все делают.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=302840&amp;user=1556&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=21" class="addthx" data-post="302840"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Sawyer[/b]','')">Sawyer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31551">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 апреля 2012 22:42 <br><script type="text/javascript">QU('Sawyer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sawyer" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Разобрался с данным вопросом.Спасибо всем кто принимал участие!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=303146&amp;user=31551&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=22" class="addthx" data-post="303146"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 апреля 2012 22:56 <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
К чему в итоге пришел? Шифровать все и восстанавливать образ полностью? Или все таки шифровать только часть как задумывалось?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=303147&amp;user=3136&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=23" class="addthx" data-post="303147"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Sawyer[/b]','')">Sawyer</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.9 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.36'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31551">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2012 19:31 &middot; Поправил: Sawyer <br><script type="text/javascript">QU('Sawyer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sawyer" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19722.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>Veliant пишет:<br>К чему в итоге пришел? Шифровать все и восстанавливать образ полностью? Или все таки шифровать только часть как задумывалось? </I><br><br>шифровать только часть как задумывалось.Все-таки коректный алгоритм подобрал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=303171&amp;user=31551&amp;forum_n=6&amp;topic=19722.html&amp;page=0&amp;anchor=24" class="addthx" data-post="303171"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Получить RSize директории в PE формате</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#25" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="19722">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19722" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
