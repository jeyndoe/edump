<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Распаковка AsProtect &gt;1.23 - от А до Я. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Эта тема по распаковке AsProtect&#039;a последних версий, для надругательств выбрана программа: AlfaClock 1.82 сайт программы: www.alfasoftweb.com/rus/ прямая ссылка: www.alfasoftweb.com/rus/AlfaClock_rus.exe В этот раздел можно">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect &gt;1.23 - от А до Я.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 августа 2005 11:56 &middot; Поправил: nice <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Эта тема по распаковке AsProtect&#039;a последних версий, для надругательств выбрана программа: AlfaClock 1.82
<br>сайт программы: www.alfasoftweb.com/rus/
<br>прямая ссылка: www.alfasoftweb.com/rus/AlfaClock_rus.exe
<br>
<br>В этот раздел можно постить всё что касается защиты в этой программе, а также скрипты для распаковки, утилиты для снятия, ссылки на статьи.
<br>
<br>За флейм будем наказывать!
<br>
<br>Нашел ОЕР <b>inferno_mteam</b>
<br>004C5444 55 PUSH EBP
<br>004C5445 8BEC MOV EBP,ESP
<br>004C5447 83C4 C0 ADD ESP,-40
<br>004C544A 53 PUSH EBX
<br>004C544B 33C0 XOR EAX,EAX
<br>004C544D 8945 D4 MOV DWORD PTR SS:[EBP-2C],EAX
<br>004C5450 8945 D0 MOV DWORD PTR SS:[EBP-30],EAX
<br>В Ольке можно быстро попасть на ОЕР сл. образом, открываем программу, жмем Ctrl+G (перейти на строку) вбиваем туда ОЕР=04С5444, правой кнопкой мыши: Breakpoint-&gt;Hardware, on execution
<br>после чего отключаем все Exceptions: menu-&gt;Options-&gt;Exceptions и ставим все галочки, .теперь нажите F9 и вы на ОЕР
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=33131&amp;user=29&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=1" class="addthx" data-post="33131"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 августа 2005 13:15 &middot; Поправил: nice <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Когда сдампил программу, востановил импорт (без проблем*)
<br>то программа упала тут:
<br>00406B8F     90             NOP
<br>00406B90   &#036; E8 6B948E00    CALL 00CF0000
<br>00406B95     2A             DB 2A                                    ;  CHAR &#039;*&#039;
<br>00406B96     8BC0           MOV EAX,EAX
<br>00406B98   &#036;-FF25 08505800  JMP [DWORD DS:&lt;&amp;kernel32.LocalAlloc&gt;]    ;  kernel32.LocalAlloc
<br>00406B90   - это и есть видимо новая защита импорта про которую говорил Марио, переход идет в секцию аспра, где наша прога благополучно падает.
<br>
<br>а вот что мы видим после первой расшифровки секции:
<br>00406B8F   90             NOP
<br>00406B90   E8 946A0C2B    CALL 2B4CD629 
<br>00406B95   2A8B C0FF2580  SUB CL,[BYTE DS:EBX+8025FF&gt;
<br>00406B9B   B2 4C          MOV DL,4C
<br>00406B9D   008B C0FF257C  ADD [BYTE DS:EBX+7C25FFC0]&gt;
<br>Тут уже изначально всё изгажено, но как аспр определяет какую ф-ию использовать? Сейчас и посмотрим...
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=33141&amp;user=29&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=2" class="addthx" data-post="33141"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 августа 2005 13:33 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
А я нахожу ОЕР так.
<br>1. Сначало отключанию все игноры и запускаю прогу (так быстрее). Смотрю адрес последнего исключения.
<br>2. Включаю (возвращаю обратно) все Exceptions.
<br>3. Пишу простой скрипт, в который вношу адрес последнего исключения
<br>
<br>var last
<br>mov last,00F19BF7    //  адрес последнего исключения
<br>eob L1
<br>eoe L1
<br>run            // до первого исключения
<br>L1:
<br>cmp eip, last
<br>je L2
<br>esto
<br>jmp L1
<br>L2:
<br>cmt eip,&quot;Last Exception&quot;
<br>ret
<br>
<br>4. Скртпт отработал и находимся на последнем исключении. Ниже по коду ищу строку  ADD ESP,4  (она как правило присутствует) и ставлю бряк (по F2). Так же можно ставить бряк на адрес [esp+4]
<br>5. Далее Shift-F9 и мы на строке  ADD ESP,4
<br>6. Убираем бряк, открываем &quot;Memory map&quot; и новый бряк на доступ к области кода 401000 (size С5000)
<br>7. Далее RUN и прерываемся на ОЕР (004C5444 55 PUSH EBP)
<br>
<br>Не смог все это объединить в один скрипт. Почему-то после команды esto не срабатывает даже команда pause. Прога просто далее запускается.  Может это только у меня на Win2000.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33142&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=3" class="addthx" data-post="33142"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 августа 2005 19:11 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
reversing.net/viewtopic.php?t=3&amp;start=45 - читайте, хотя ссылка уже и давалась когда-то =)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33177&amp;user=15&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=4" class="addthx" data-post="33177"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2005 07:55 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Первую функцию я восстановил вручную так:
<br>Вместо
<br>00406C60  CALL dumpnew_.00406B90        
<br>заменил на
<br>00406C60  CALL dumpnew_.004C5FE0                   ;  Переход в свободное место в конце файла
<br>а там 
<br>004C5FE0   ADD ESP,4
<br>004C5FE3   CALL kernel32.GetModuleHandleA           ; &quot;Забраннная&quot; аспром функция
<br>004C5FE8   MOV [DWORD SS:ESP],dumpnew_.00400000     ;  корректировка стека
<br>004C5FEF   PUSH dumpnew_.00406C65                   ;  адрес возврата
<br>004C5FF4   RETN                                     ;  RET used as a jump to 00406C65
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33231&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=5" class="addthx" data-post="33231"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2005 10:47 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Getoric[b][/b]
<br>А ты трассировал функцию по адресу 00406C60 ?
<br>Я делал так.
<br>00406B90    CALL 01160000  // поставить бряк по F2
<br>далее F8 (или F9)
<br>00406B90    E8 6F94F600     CALL 01370004  // вызов изменился
<br>теперь трассируем по F7
<br>...
<br>01360007    68 0DAB3A79     PUSH 793AAB0D   //в стек заносится адрес API-функции
<br>0136000C    C3              RETN            //переход на 793AAB0D   
<br> переходим в модуль Kenrel32.dll на адрес 793AAB0D   
<br>Выше этого адреса можно учидить 3 команды, начиная с
<br>793AAB06    PUSH EBP                      ; это начало функции 
<br>курсор на нее и &quot;View call tree&quot; и видишь название функции.
<br>Что касается корректировки стека, то ее можно и не делать, но надо правильно
<br>обратиться к этой функции (часть выполнения кода этой функции аспр забирает на себя). После ее выполнения в оригинале ЕАХ=400000 и в вершине стека то же значение. Корректировкой я просто подогнал значения.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33248&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=6" class="addthx" data-post="33248"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 августа 2005 14:32 <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Ремэйк минитутора от <b>SergSh</b>, за что ему отдельное спасибо!
<br>на примере AlfaClock
<br>1. Стоя на ОЕР:004C5444  делал в ОЛЛИ поиск всех call-ов.
<br>2. Ставил New origin here на интересующий меня калл (CALL 00CF0000) у вас могут быть другие адреса, точно  вы можете посмотреть, например, тут: 00406B90  
<br>3. При этом был установлен бряк ret в VirtualAlloc (Ctrl+G, вводим VirtualAlloc и на первом RET жмем F2) и бряк на доступ к секции кода в AlfaClock.exe (нажимаем Alt+M и перейдя на секцию Address=00401000  Size=000C5000 (806912.) нажимаем F2)
<br>4. Далее Shft+F9, останавливаемся на ret в VirtualAlloc в стеке по ESP+40 нужная нам функция. Записываем её на бумажку. (На самом деле остаточно нажать F4 или F9 находясь на строке 00406B90)
<br>5. Далее Shft+F9 и ещё Shft+F9 и ещё Shft+F9 срабатывает бряк на секции кода в AlfaClock.exe, смотрим call 00CF0000 стал call 00CF31000(приблизительно, у вас адреса будут другими)
<br>6. В IAT ищем нашу библиотеку и вбиваем адрес из ESP+40 (предварительно записанный на бумажке)
<br>7. call 00CF0000 изменяем на jmp на вбитый в IAT адрес (при этом необходимо в ОЛЛИ снять галочку о занопливании инструкций)
<br>8. И &quot;New origin here&quot; на другой call 00CF0000 и т.д.
<br>9. После замены всех call 00CF0000 в ImportREC. Вбиваем ОЕР, IAT вбваем из выскакиваемой мессаги RVA: 000b6000 size 00003000. Далее Get Imports, Show Invalid и обязательно Plugin Tracers c ASProtect 1,22. Затем Cut thunt(s) и привинчиваем к дампу.
<br>10.Всё. Осталось пара косяков но они легко исправляются. Распакованная прога работоспособна на всех системах. Удачи.
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=33273&amp;user=29&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=7" class="addthx" data-post="33273"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2005 15:49 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Я делал так:
<br>1. В ОЛЛЕ делал Search for, binary string, FF25, до нужной мне dll.
<br>2. Показать в дампе. Поск по номеру. Если поиск не принёс результатов то смотрю неверные значения AIP
<br>    в dll и вбиваю адрес из ESP+40.
<br>3. В данной прге необходимо произвести искустванное разделение dll нулями.
<br>4. После на место Сall 00CF0000 пишем jmp [ наш адресс в IAT].
<br>5. В данной проге есть ещё несколько Call 00f90004. Там Jmp на код в котором уже спёрта часть AIP.
<br>    Просто на этапе загрузке проги бряк на ret в VirtualAlloc и когда начнется выделение памяти по 1000  байт смотрим в стек и видим интересующую нас функцию, записывая адрес выделенной помяти и AIP на бумажку.
<br>6. Затем вместо Call 00f90004 вбиваем известный нам JMP  IAT
<br>7. Да при востановлении импорта одной dll в IAt нет я над IAT нопил и создавал её искуственно. Там всего 2 или 3 функции.
<br>8. Ещё при восстановлении иморта ранее предложенным способом в ESP+40 будет что вроде 00B????? , так это аспровский аналог GetProcAddress.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33338&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=8" class="addthx" data-post="33338"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 20 августа 2005 16:13 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Просто на этапе загрузке проги бряк на ret в VirtualAlloc и когда начнется выделение памяти по 1000 байт смотрим в стек и видим интересующую нас функцию, записывая адрес выделенной помяти и AIP на бумажку. 
<br>[b][/b]
<br>Следует понимать на этапе прохода до OEP......
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33340&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=9" class="addthx" data-post="33340"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Cigan[/b]','')">Cigan</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 160.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.89'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=208">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 августа 2005 02:52 &middot; Поправил: Cigan <br><script type="text/javascript">QU('Cigan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Cigan" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Вот тут происходит генерация API для определенного адреса
<br><pre>/*B9480B*/  MOV     CX, WORD PTR [EBP-14]
<br>/*B9480F*/  MOV     DX, WORD PTR [EBP-18]
<br>/*B94813*/  MOV     EAX, DWORD PTR [EBP-C]
<br>/*B94816*/  CALL    00B93EE4
<br>/*B9481B*/  MOV     DWORD PTR [EBP-4], EAX - Some API
<br></pre>
<br>Адресс Call&#039;a откуда происзошел вызов Some API находиться в EBP+0B8. Вот в принципе и все с альфаклоком пишем не большую обработку чтоб в место <pre>/*406EB4*/  CALL    00D60000 Был 
<br>/*406EB4*/  CALL    Some API</pre> и востанавливаем импорт.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33364&amp;user=208&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=10" class="addthx" data-post="33364"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Mario555[/b]','')">Mario555</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/15.jpg" alt=""><br><span class=txtSm>Ранг: 332.0 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.97'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15">Участник</a><br><font color=blue>•Pr0tEcToRs KiLLeR•</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 августа 2005 10:33 <br><script type="text/javascript">QU('Mario555','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Mario555" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<i>Bit-hack пишет:
<br>А может кто поможет мне найти место, где виден адрес импортируемой функции </i>
<br>тоже по ссылке не ходил ? =)) там вообще-то дана сигнатура места вызова функции определяющей адрес апи (причём как раз от той версии аспра которая на альфаклоке). 
<br>
<br><i>Cigan пишет:
<br>/*406EB4*/  CALL    Some API </i>
<br>а я то думал что
<br><pre> JMP DWORD PTR [addr_api_in_iat] </pre>
<br>;)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33376&amp;user=15&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=11" class="addthx" data-post="33376"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 августа 2005 09:43 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Мне кажется метод, описанный SergSh [/i] не всегда дает правильные результаты. Например, прога второй раз &quot;падает&quot; в адресе:
<br>00406B23   CALL d_pe_too.004012F4
<br>и далее 
<br>004012F4  Call 00f90004 ( у каждого по разному)
<br>Находясь здесь, ставим бряк на выходе из VirtualAlloc и бряк в памяти на доступ к секции кода (как описано выше). Запускаем и прерываемся на Retn (VirtualAlloc). 
<br>Смотрим стек, там
<br>ESP+40   &gt; 793B49DF  kernel32.GetStartupInfoA
<br>Но на самом деле здесь эмулируется 
<br>004012F4   JMP NEAR [DWORD kernel32.GetCommandLineA]
<br>Ее можно увидеть, только когда вручную протрассируешь Call 00f90004.
<br>Кто-нибудь сумел автоматизировать этот процесс?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33735&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=12" class="addthx" data-post="33735"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2005 10:00 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<i>nice пишет:
<br>10.Всё. Осталось пара косяков но они легко исправляются. </i>
<br>Эти косяки не связаны с ошибкой обращения к несуществующим участкам памяти? Как обошли эти проблемы? Созданием (дублированием) этих участков или иначе? Или все только восстановили импорт
<br>и прога заработала.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33847&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=13" class="addthx" data-post="33847"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2005 12:17 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Я делал так:
<br>На этапе прохода к ОЕР смотрел, что ложится в выделенную память. Меня привлекло название библиотеки TreyClock.dll. При повторном проходе я изменил адрес после VirtualAlloc для этого участка на адрес последней секции в exeшнике. Провда немного пришлось повазиться. Но эта запись оказалась у меня в  exeшнике. Затем стоя на ОЕР я посмотрел то место куда ссылается протектор при дальнейшей своей распаковке (кажется 4с?????). Там несколько ссылок на память, я просто периориентировал их на свободный участок последней секции exeшника, а там набил то что бало в памяти. 
<br>Да действительно при прходе по Call EAX падает где-то на А5 и появляются новые  Call 00f90004 просто при повторном проходе я это учёл.
<br>Распаковал. Наг всплывает. Но после нажатия кнопки &quot;Попробовать&quot; просто закрывается. Ошибку не выбивает. Вроде химичит с размером файла, но где надо пропатчить не могу найти. Подскажите пожалуста.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33860&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=14" class="addthx" data-post="33860"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2005 13:28 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<i>SergSh пишет:
<br> Меня привлекло название библиотеки TreyClock.dll.  </i>
<br>Я до этого места еще не дошел. С восстановлением импорта вроде разобрался. Трассирую с помощью скрипта по ходу выполнения проги и где она &quot;падает&quot; из-за отсутствия апи-функции,  восстанавливаю ее
<br>в таблице импорта.
<br>
<br><i>SergSh пишет:
<br>там несколько ссылок на память, я просто периориентировал их на свободный участок последней секции exeшника, а там набил то что бало в памяти. </i>
<br>Я не понял этой записи. Например, у меня возникает ошибка при обращении к участку памяти по адресу 13С000 (пример). У меня его нет,  есть только 130000-138000. Вижу, что в запакованном файле этот участок памяти эмулируется аспром (у меня 138000-13F000).  Находясь на ОЕР, я дамплю этого участок (регион) и добавляю его как новую секцию в свой файл.  Затем в конце своего файла пишу патч, который создает область 138000-13F000 и  переносит данные из новой секции в эту область памяти. Ты это имел ввиду или нет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33865&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=15" class="addthx" data-post="33865"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2005 15:46 &middot; Поправил: SergSh <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Посмотри стоя на ОЕР на адрес 4с9620. Там несколькоадресов из памяти (у меня было 13 на 159с80 и рядом). В своём дампе с восстановленным импортом я изменил их на 584000 (конечно для каждого свой), а по адресу 584000 вбил то, что было по адресу 159с80. Там были адреса из проги. А там где был переход на этот же участок памяти я прсто занулил. Там же была ссылка на dll.
<br>Я восстанавливал импорт стоя на ОЕР, а не походу выполнения программы.
<br>А про dll может тебе и не понадобится. Но благодаря этому не упал на call eax №9. Кстати ты прошёл call eax?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33879&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=16" class="addthx" data-post="33879"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Arleno[/b]','')">Arleno</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.88'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=2467">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 августа 2005 16:45 <br><script type="text/javascript">QU('Arleno','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Arleno" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Здарова мужики!
<br>Руки так и чешутся написать <img src="img/smilies/s1.gif" alt=""> Сорри что не по проге в топике, но вопрос тоже относится как ни странно к АСПРу <img src="img/smilies/s1.gif" alt="">
<br>Возникла такая трабла - прохожу до ОЕР, но код немного странноват <img src="img/smilies/s1.gif" alt=""> 
<br>
<br>Этот якобы ОЕР идет сразу после последнего ехсер. на бряке к CODE
<br>
<br><pre>0048AFE8   XOR EAX, EAX
0048AFEA   PUSH 0
0048AFEC   CMP DWORD PTR SS:[ESP+8], EAX
0048AFF0   PUSH 1000
0048AFF5   SETE AL
0048AFF8   PUSH EAX
0048AFF9   CALL DWORD PTR DS:[49D130]               ; kernel32.HeapCreate
0048AFFF   TEST EAX, EAX
...
0048B001  PUSH DWORD PTR DS:[4B9B60]
0048B038  CALL DWORD PTR DS:[49D134]               ; kernel32.HeapDestroy
0048B03E  XOR EAX, EAX
0048B040  RETN                                       &lt;---------- return to 00c71290</pre>
<br>
<br>Ну а с7**** соответственно код аспра.
<br>
<br><pre>/*C71290*/  POP ECX
/*C71291*/  TEST EAX, EAX
/*C71293*/  CALL 00CD0000
/*C71298*/  LEA EAX, DWORD PTR DS:[EDI*4+4]
/*C7129F*/  PUSH EAX
/*C712A0*/  PUSH 0C7081E
/*C712A5*/  CALL 00CD0000
.......</pre>
<br>
<br>Дальше выходит из аспра на 48d07с
<br>
<br><pre>/*48D07C*/  PUSH ESI
/*48D07D*/  CALL test.0048C259
/*48D082*/  CALL DWORD PTR DS:[49D118]
/*48D088*/  CMP EAX, -1
/*48D08B*/  MOV DWORD PTR DS:[4B6770], EAX
/*48D090*/  JE SHORT test.0048D0CC
...
/*48D0BA*/  POP ECX
/*48D0BB*/  CALL 00C90000
/*48D0C0*/  ADD DWORD PTR DS:[EBX+6AFF044E], 58068901
/*48D0CA*/  POP ESI
/*48D0CB*/  RETN                            &lt;------- снова в код аспра</pre>
<br>Это хваленая VM или подставная ОЕР? Создается впечатление что программа выполняется по кускам, после каждого куска прыгает в аспр, занимается фигнёй, а потом снова на след. прыжок. Удалось найти в аспре функции создания адреса возврата, т.е. после выполнения кода аспра можно найти куда возвращает он управление, может руками править каждый такой RET сразу на код проги? Надо будет попробовать <img src="img/smilies/s1.gif" alt=""> Фигня в том что во течении всего этого процесса прога выполняется, а найти ОЕР не получается :&#92; У меня вообще проблемы с поиском ОЕР, как определить что это и есть ОЕР, а не подставная лафа или вообще не ОЕР? Допустим первые команды выполняющиеся в секции кода не обязаны быть точкой входа? Хотя слишком я много размышляю, еще до ответа додумаюсь ненароком <img src="img/smilies/s1.gif" alt=""> 
<br>Так вот, по дороге встречаются всякие прыжки на переходники аспра, их восстановить можно, а вот что делать с этими RETами? :&#92; Кстати вопрос по существу - а как можно определить что вообще есть краденые байты? Тоесть они спокойно могут выполнятся в коде аспра и о них даже ничего известно не будет. Млин, уже 4 свои проги распаковал аспр2.12 на макс. защите, а тут лажа какаято :&#92; Вот.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33888&amp;user=2467&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=17" class="addthx" data-post="33888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2005 13:42 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<i>SergSh пишет:
<br>Кстати ты прошёл call eax? </i>
<br>Прохожу 7-й call eax. как-то быстро не получается. Кстати я долго разбирался с адресом [4с9620]. Там действительно проходит 13 обращений.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=33987&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=18" class="addthx" data-post="33987"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2005 17:50 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Странно, но у меня в Сall eax были проблемы только на 9 и на А5(там как раз всплывала функция Call 00f90004 и ещё несколько, невидимых с ОЕР)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=34029&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=19" class="addthx" data-post="34029"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 августа 2005 12:14 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<i>SergSh пишет:
<br>Странно, но у меня в Сall eax были проблемы только на 9 и на А5(там как раз всплывала функция Call 00f90004 и ещё несколько, невидимых с ОЕР) </i>
<br>Мы, наверное, разное имеем ввиду.
<br>Я устал в ручную восстанавливать апи-функции и пытаюсь сейчас написать скрипт. Только почему-то
<br>возникают ошибки там, где их не должно быть. И Олли сразу вылетает. Например, написал простой кусок скрипта, который перебирал значения в области (.data). Где-то в середине возникала ошибка  присвоения, типа mov tmp,[add_iat]. Решил проверить и сделал log [add_iat] и то же ошибка. В переменной add_iat перечисляются реальные адреса, в чем можент быть дело?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=34559&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=20" class="addthx" data-post="34559"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2005 06:11 <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
1. Запускаем Ollydbg. Открываем AlfaClock.exe. Доходим до ОЕР аналогично предыдущим версиям Аспра. Делаем поиск всех подпрограмм: Search for-All intermodular call. Поднимаемся вверх и видим много CALL 00CD0000 и один CALL 00F10004. Скажу сразу, что CALL 00F10004 на самом деле является CALL 00CD0000, отработанным один раз. Поэтому наша задача состоит в том, чтобы прервать выполненее программы до первого его срабатывания. Поэтому записывае адрес этой подпрограммы на бумажку. Он у меня 0040130С.
<br>2. Перезапускаем программу. В окне дампа вбиваем &quot;D 0040130С&quot; и жмём Shift+9 до тех пор пока по этому адресу не станет CALL 00CD0000. Теперь проходим ещё 5 исключений по Shift+9 запоминая или записывая адреса ивключений. Идём пока CALL 00CD0000 не станет CALL 00F10004. Запомнили адрес предыдущего исключения и перезапускаем программу. У меня этот адрес был 00В8В4АС. Останавливаемся на этом исключении. И переходим на известное нам ОЕР. Делаем поис всех подпрограмм и видим, что все подпрограммы имеют вид CALL 00CD0000.
<br>3. Вообщем-то программа уже распакована, необходимо только восстановить таблицу импорта и снять дамп. Стоя на ОЕР запускаем скрипт от BiT-H@ckа. Скрипт успешно отработал. Но снимать дамр не спешим. Сначало делаем поис команд в Ollydbg: &quot;Search for-Сommand-CALL 00CD0000&quot;. Видим, что скрипт невосстановил две подпрограммы по адресам 00401264 и 00406Е6С. Восстановим их ручками. О востановлении импорта я уже писал. Дампим.
<br>6. Осталось пара косяков, которые будем устранять трассируя наш дамп. Загружаем исправленный дамп в Ollydbg и трассируем его по F8. Дамп упадёт на CALL 004BD5E8, там по адресу 004BD608 команда MOV EAV,[004C7D6C]. Ниже CALL LoadLibraryA, не трудно догадаться, что по адресе 004C7D6C должно быть название dll. Закрываем дамп, запускаем оригинальную программу, доходим до ОЕР, устанавливаем F2 на 004BD608 и запускаем программу на выполнение. Программа выдала НАГ и затем остановилась на 004BD608, смотрим в 004C7D6C лежит 00Е00000, а в нём TrayClock.dll. Копируем TrayClock.dll в наш дамп на адрес 00584000. Вместо MOV EAV,[004C7D6C] пишем MOV EAV,00584000. Сохраняем изменения. Но дамп всё равно не работает. Скорее всего эта уже защита самой программы, а не Аспра. Здесь всё оказалось до смешного просто. Программа вызывает функцию GetFileSize и на оснавании полученного значения в EAX производит дальнейшую распаковку. GetFileSize находится по адресу 004DВFF0. Следовательно по адресу 004DВFF0 вбиваем MOV EAX,0EFC00 и нопим предыдущиеся два пуша. Значение 0EFC00 подсмотрели в оригинальной программе. 
<br>6. Запускаем наш дамп всё работает. Спасибо ВСЕМ
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=34940&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=21" class="addthx" data-post="34940"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 05:44 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
SergSh [/i]
<br>Молодец, хватило терпения закончить эту прогу.  А я, разобравшись с восстановлением импорта, бросил
<br>ее. Появилась новая задача и снова в виде 2-го аспра. Притом в нем все значительней сложнее.
<br>Там есть и спертые байты и похоже VM. И пока я даже не пойму, где лучше дампить. Не хочешь помочь мне определить спертые байты, а то я не уверен, что все их нашел.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35090&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=22" class="addthx" data-post="35090"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 06:17 <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>SergSh</b>
<br>Молодец!
<br>Парни вы не против, если я эту тему переделаю в некий тутор по снятию?
<br>
<br>
<br><b>tar4</b>
<br>Создавай новую тему, т.к. виртуальная машина это отдельная песня
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35091&amp;user=29&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=23" class="addthx" data-post="35091"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 07:46 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
www.webfile.ru/513652. Там самое необходимое, в минимальной конфигурации.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35094&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=24" class="addthx" data-post="35094"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]SergSh[/b]','')">SergSh</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 115.3 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.9'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2420">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2005 14:41 &middot; Поправил: SergSh <br><script type="text/javascript">QU('SergSh','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergSh" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Спасибо Друзья! Я был бы очень признателен если бы NICE написал хороший тотоур.  Давайте продолжим.
<br>Предлагайте жертву. Хотя Icolover.exe из одного из топиков подходит. Я мельком глянул. VM на лицо. И спёртые байты вроде есть. Предыдущий скрипт не рулит. Но ручная методика работает прекрасно. Так-что имеет смысл перейти на тот топик.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35133&amp;user=2420&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=25" class="addthx" data-post="35133"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 08:10 <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>tar4</b>
<br>Последнее исключение:
<br>01009B4A   53              PUSH EBX
<br>
<br>Выход на VM:
<br>01009D55   E8 16&gt;CALL 01007170
<br>
<br>Частичное востановление ОЕР:
<br>011F02A9   55    PUSH EBP
<br>....
<br>011F02DA   8D6C2&gt;LEA EBP,[DWORD SS:EBP-29] // PUSH EBP,ESP
<br>011F02DE   6A FF PUSH -1
<br>011F1C3A   51    PUSH ECX
<br>011F1C5E   50    PUSH EAX
<br>011F1A9E   52    PUSH EDX
<br>011F1ABF   64:A1&gt;MOV EAX,[DWORD FS:0]
<br>011F1AC5   50    PUSH EAX
<br>011F1AC6   64:89&gt;MOV [DWORD FS:0],ESP
<br>011F1ACD   83EC &gt;SUB ESP,58
<br>судя по всему программа сишная
<br>011F1AD0   53    PUSH EBX
<br>011F1AD1   56    PUSH ESI
<br>011F1AD2   57    PUSH EDI
<br>011F1AD3   8965 &gt;MOV [DWORD SS:EBP-18],ESP
<br>011F1AD6   FF15 &gt;CALL [DWORD DS:7832A8]         ; kernel32.GetVersion
<br>ну и так далее, пока времени не хватает
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35185&amp;user=29&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=26" class="addthx" data-post="35185"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 08:35 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<i>nice пишет:
<br>nice </i>
<br>Спасибо за то, что посмотрел. То, что ты написал, я все это прошел. Но не был уверен, что правильно определил спертые байты. Например, между командами
<br>011F02DE 6A FF PUSH -1 
<br>011F1C3A 51 PUSH ECX
<br>мне казалось, что я пропустил что-то.
<br>Но что мне до сих пор непонятно, а далее за kernel32.GetVersion это чей код: проги или аспра. И где лучше дампить, на 
<br>011F1ABF 64:A1&gt;MOV EAX,[DWORD FS:0]
<br>а потом дописывать спертые байты?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35186&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=27" class="addthx" data-post="35186"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 08:56 &middot; Поправил: nice <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>tar4</b>
<br>я бы сдампил тут:
<br>011F02A9 55 PUSH EBP 
<br>
<br><i>tar4 пишет:
<br>Но что мне до сих пор непонятно, а далее за kernel32.GetVersion это чей код: проги или аспра </i>
<br>это код аспра, и если ты видел, Стиппер прикрепляет секцию с крадеными байтами прям к дампу и запускает выполнение с неё <img src="img/smilies/s1.gif" alt="">
<br>Меня другой вопрос мучает, если не привязывать секцию, то как найти где располагалось старое ОЕР?
<br>ведь аспр записал на место краденых команд мусор...
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35187&amp;user=29&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=28" class="addthx" data-post="35187"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]tar4[/b]','')">tar4</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 136.5 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1631">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 09:28 &middot; Поправил: tar4 <br><script type="text/javascript">QU('tar4','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tar4" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
nice 
<br>Не понимаю, зачем за собой тянуть весь мусор аспра между адресами 011F02A9 и 011F1ABF. Разве не проще, дампить  например на  011F1ABF, а затем дописать спертые байты и соотвественно поменять точку входа в прогу. Или я что-то упускаю?[b][/b]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=35191&amp;user=1631&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=29" class="addthx" data-post="35191"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 сентября 2005 10:21 <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=2707&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>inferno_mteam</b>
<br>Представь, что сразу на ОЕР программа ХОRит группу байт и ты после этого дампишь
<br>думаю тебе не нужно рассказывать что будет при повторном проходе
<br>так что лучше дампить прямо на ОЕР, зачем создавать себе головняки???
<br>
<br><i>tar4 пишет:
<br>Не понимаю, зачем за собой тянуть весь мусор аспра между адресами 011F02A9 и 011F1ABF. </i>
<br>я не предлагаю тебе тянуть, я сказал, что стриппер так делает
<br>
<br><i>tar4 пишет:
<br>а затем дописать спертые байты и соотвественно поменять точку входа в прогу </i>
<br>Как ты найдешь место куда их вписывать?
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=35195&amp;user=29&amp;forum_n=13&amp;topic=2707&amp;page=0&amp;anchor=30" class="addthx" data-post="35195"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=2707&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Распаковка AsProtect &gt;1.23 - от А до Я.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="2707">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=2707" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
