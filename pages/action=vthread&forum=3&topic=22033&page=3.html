<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>SIDE. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="o x86, KM, MI, KDR; откат на 5.1, 6.1; недетект всяким аверским говном. Пиздатый мотор для дебага всякой юзермодной погани. Теперь не нужно юзать ядерный дебаг, чтобы всякая хуита не вышла из под отладки. Возможность выбора">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=242'>Alf</a>, <a target='_blank' href='?action=userinfo&amp;user=41144'>Adler</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=42623'>site-pro</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> SIDE.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=2.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=2.html">3</a> . <b>4</b> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=7.html">8</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=13.html">14</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=4.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2013 16:29 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#1');return false;">#1</a> </span><div align=left><br>
o x86, KM, MI, KDR; откат на 5.1, 6.1; недетект всяким аверским говном.<br><br>Пиздатый мотор для дебага всякой юзермодной погани. Теперь не нужно юзать ядерный дебаг, чтобы всякая хуита не вышла из под отладки. Возможность выбора сервисной таблицы.<br><br>Отлавливаются все сисколы в системе, редирект в юзермод, там наш фильтр их обрабатывает и вертает управленье в юзермод.<br><br>Возврат из ядра на адрес PEB[0xFFC], флаг по тому же смещенью в TEB запрещает обработку(по дефолту сброшен, тоесть пропускается).<br><br>При возврате имеем в rEax номер сервиса, на стеке:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">FSTATE&nbsp;struct</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PVOID&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Args&nbsp;&nbsp;&nbsp;&nbsp;PVOID&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">FSTATE&nbsp;<span class="hl_function">ends</span></li>        </ol>
    </div>
</div></div>
<br><br>Прожект с vx.security-portal.cz<br><br><img src="img/attach.gif" alt=""> <a href="./files/3ab6_03.08.2013_EXELAB.rU.tgz">3ab6_03.08.2013_EXELAB.rU.tgz</a> - SIDE.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=328694&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=1" class="addthx" data-post="328694"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31056" title="03-08-2013 14:46, ранг:63.8" target="_blank">hors</a>, <a href="action=userinfo&user=2777" title="03-08-2013 18:44, ранг:438.3" target="_blank">daFix</a>, <a href="action=userinfo&user=15331" title="19-08-2013 11:16, ранг:6.8" target="_blank">Lacoste</a>, <a href="action=userinfo&user=11667" title="31-08-2013 19:54, ранг:0.3" target="_blank">Paranoid Koneko</a>, <a href="action=userinfo&user=33253" title="20-10-2013 20:18, ранг:16.5" target="_blank">Abraham</a>, <a href="action=userinfo&user=36024" title="19-11-2013 18:08, ранг:0.6" target="_blank">JKornev</a>, <a href="action=userinfo&user=24257" title="22-11-2013 23:43, ранг:167.9" target="_blank">DenCoder</a>, <a href="action=userinfo&user=35473" title="23-11-2013 08:01, ранг:25.0" target="_blank">dosprog</a>, <a href="action=userinfo&user=16383" title="02-12-2013 13:43, ранг:337.9" target="_blank">Coderess</a>, <a href="action=userinfo&user=131" title="03-12-2013 16:04, ранг:56.3" target="_blank">Tolkin</a>, <a href="action=userinfo&user=31506" title="09-04-2017 20:55, ранг:8.6" target="_blank">VanHelsing</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]SegFault[/b]','')">SegFault</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 44.8 (посетитель), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.95'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29820">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2013 16:49 <br><script type="text/javascript">QU('SegFault','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SegFault" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#2');return false;">#2</a> </span><div align=left><br>
фантом в ольке можно юзать, а это нечто как например к олли подрубить??
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334085&amp;user=29820&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=2" class="addthx" data-post="334085"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2013 17:38 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#3');return false;">#3</a> </span><div align=left><br>
<b>SegFault</b><br><br>Регается как верифер. <strike>Фантом гавно.</strike>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334087&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=3" class="addthx" data-post="334087"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2013 18:31 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#4');return false;">#4</a> </span><div align=left><br>
<I>Dr0p пишет:<br>Регается как верифер. </I><br><br>не обессудь, но тебе бы взять и разок нормально документировать, как и для чего это делается. Может народ бы пользовать стал, да багрепорты бы пошли.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334088&amp;user=2585&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=4" class="addthx" data-post="334088"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 ноября 2013 02:30 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#5');return false;">#5</a> </span><div align=left><br>
<b>Gideon Vi</b><br><br>Вся необходимая инфа есть. На счёт багрепортов - это реально только имея сурсы сабжа. Там весьма сложный код, довольно сложно отлаживается(мотор изначально не предназначен дляработы с отладчиком, более того, сам механизм отладчик не поддерживает(KDR под портом не вызывается), фильтр для скрытия ольки всего лишь код, основанный на моторе. В мотор была введена только обработка тск, основная же его цель - скрытый мониторинг сервисов ядра(это руткит)). Они полупривад, так как очень мощный механизм получился. И некоторым(аверам в частности) не нужно в них копаться.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334109&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=5" class="addthx" data-post="334109"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 ноября 2013 16:00 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#6');return false;">#6</a> </span><div align=left><br>
Вот наваял описание.<br><br><img src="img/attach.gif" alt=""> <a href="./files/1e72_26.11.2013_EXELAB.rU.tgz">1e72_26.11.2013_EXELAB.rU.tgz</a> - SIDE.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334365&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=6" class="addthx" data-post="334365"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=29820" title="26-11-2013 12:01, ранг:5.4" target="_blank">SegFault</a>, <a href="action=userinfo&user=14476" title="26-11-2013 12:10, ранг:99.4" target="_blank">Oott</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]priag[/b]','')">priag</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34106">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 ноября 2013 14:57 <br><script type="text/javascript">QU('priag','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=priag" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#7');return false;">#7</a> </span><div align=left><br>
Может что не так делаю или чего иного ждал от софтины, но дела обстоят так:<br><br>1. Качнул какую-то из последних версий (с яндекс.диска) <br>2. Использую вмварю, хпсп3. Инсталлю дров (тупо запуск nthdrv.exe проходит без ошибок)<br>3. Затем использую содержимое архива api.zip - там запускаю батник TEST.EXE &gt;&gt; log.txt. Моментально создается чуть больше 100 кб лога, консолька висит, мессаджбокс с надписью &quot;psapi.dll&quot; тоже висит. <br>4. Запускаю хелловорлд Инди (на первой странице взял), делаю еще в системе некие манипуляции (терминейт пары процессов, добавление\удаление пары ключей в реестр)<br>5. Нажимаю в мессаджбоксе с надписью &quot;psapi.dll&quot; ОК и после чего открываю получившийся лог... и не вижу там никаких проделанных манипуляций <br><br>Особо в тему не вчитывался (много ругани), но выцепил следующее:<br><I>Dr0p пишет:<br>Точнее мониторятся нтапи на уровне ядра.  </I><br>т.е я ожидал увидеть в логе некий результат мониторинга апи. помню, что шадов не перехватывается тулзой, ну, а все остальное? операции с процессами и т.д<br><br>Либо я что-то не правильно делаю, либо не понял для чего инструмент <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334469&amp;user=34106&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=7" class="addthx" data-post="334469"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=33727" title="28-11-2013 11:43, ранг:44.0" target="_blank">Dr0p</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 ноября 2013 23:44 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#8');return false;">#8</a> </span><div align=left><br>
<b>priag</b><br><br>Шадов тоже отслеживается. Это не инструмент, а мотор. Чтоб его юзать надо немного покодить <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334509&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=8" class="addthx" data-post="334509"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 01:59 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#9');return false;">#9</a> </span><div align=left><br>
3. Это был тестовый семпл:<br><br><img src="http://s020.radikal.ru/i716/1308/2b/14a7e88cbf56.png" border="0" align="" alt=""><br><br>Загрузочный лог снимался, прототипы доставались из базы, подставлялись аргументы и выводилось в консоль/файл.<br><br>4. Не могу ничего сказать, так как хз что вы запускали. Было очень много тестов, семплов и билдов.<br><br>&gt; я ожидал увидеть в логе некий результат мониторинга апи<br><br>Не ведётся никакой лог. Кодес для скрытия дебаггера, который на этом моторе основам мониторит кучу сервисов, для некоторых выводится лог(нп waiters&quot;, счётчики). Не составляет вообще никакого труда реализовать монитор каких то действий. Оно элементарно на коленке пилится, вот например:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">_ZwQuerySystemTime&nbsp;struct</li><li class="hl_l1">SystemTime&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PLARGE_INTEGER&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">_ZwQuerySystemTime&nbsp;<span class="hl_function">ends</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_comment">; +</span></li><li class="hl_l1"><span class="hl_comment">;</span></li><li class="hl_l0">pZwQuerySystemTime&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;C</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">:</span><span class="hl_function"><b>ptr</b></span>&nbsp;_ZwQuerySystemTime</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;g_nNtQuerySystemTime</li><li class="hl_l1">ifdef&nbsp;OPT_SUSPEND_SYSTEMTIME</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;ZwQuerySystemTime<span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">Ebx</span><span class="hl_char">]</span><span class="hl_char">.</span>SystemTime&nbsp;&nbsp;<span class="hl_comment">; Валидация ссылки.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">!</span><span class="hl_registr">Eax</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">%</span>RANDOM</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;D<span class="hl_char">[</span>g_SysTime<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>adc</b></span>&nbsp;D<span class="hl_char">[</span>g_SysTime&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span><span class="hl_char">.</span>SystemTime</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>D<span class="hl_char">[</span>g_SysTime<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>D<span class="hl_char">[</span>g_SysTime&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;D<span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;D<span class="hl_char">[</span><span class="hl_registr"><b>ecx</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">edx</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;FleaveOk</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function">endif</span></li><li class="hl_l0"><span class="hl_function">endif</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">ret</span></li><li class="hl_l0">pZwQuerySystemTime&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div>
<br><br>Не знаю что может быть не понятно, я же всё подробнейшим образом разжевал.<br><br>Единственная проблема может возникнуть со слепками, это когда сервис вызывается из процедуры, которая вызывается из другой процедуры етц и нужно идентифицировать вызов из нужной процедуры. В этом случае весь код процедуры нужной описавыется слепком(массив описателей блоков, составляющих процедуру). В неё находится адрес возврата и выполняется маршрутизация. Иногда многократная, бывает весьма сложным запутанным образом<img src="img/smilies/s13.gif" alt=""><br><br>Про щадов мало сказано, потому что в отличие от сервисов базовых, для этих нет конкретных стабов, чтобы можно было номер сервиса получить. Лишь для некоторых. Вот например скрывается окно отладчика:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">_NtUserBuildHwndList&nbsp;struct</li><li class="hl_l1">hdesk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">hwndNext&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HWND&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">fEnumChildren&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BOOLEAN&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">idThread&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">cHwndMax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UINT&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">phwndFirst&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PVOID&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">pcHwndNeeded&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PULONG&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">_NtUserBuildHwndList&nbsp;<span class="hl_function">ends</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">pNtUserBuildHwndList&nbsp;<span class="hl_function">proc</span></li><li class="hl_l1"><span class="hl_function"><b>Local</b></span>&nbsp;N<span class="hl_char">:</span>ULONG</li><li class="hl_l0"><span class="hl_function"><b>Local</b></span>&nbsp;Pid<span class="hl_char">:</span>HANDLE</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>assume</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">:</span><span class="hl_function"><b>ptr</b></span>&nbsp;_NtUserBuildHwndList</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span><span class="hl_registr">ebx</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">%</span>NTCALL&nbsp;NTSTATE<span class="hl_char">.</span>Cpu<span class="hl_char">.</span>R<span class="hl_char">.</span>rEax<span class="hl_char">[</span><span class="hl_registr">Edi</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">Ebx</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">cld</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span><span class="hl_char">.</span>pcHwndNeeded&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; N</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">!</span>Zero<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">leave</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;Fleave</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function">endif</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>D<span class="hl_char">[</span><span class="hl_registr">edi</span><span class="hl_char">]</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;N<span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_registr">Edi</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span><span class="hl_char">.</span>phwndFirst</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>repeat</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">lodsd</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>Pid</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>Call</b></span>&nbsp;g_UserApi<span class="hl_char">.</span>pGetWindowThreadProcessId</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_registr">Eax</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;IsProtectedProcess<span class="hl_char">,</span>&nbsp;Pid</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>test</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>jnz</b></span>&nbsp;@f</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;IsDebugProcess<span class="hl_char">,</span>&nbsp;Pid</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_registr">Eax</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@</span><span class="hl_char">:</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; Удаляем описатель из массива.</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_registr">edi</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_registr">edi</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span><span class="hl_registr">esi</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr"><b>esi</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>rep</b></span>&nbsp;<span class="hl_function">movsd</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr"><b>edx</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>inc</b></span>&nbsp;N</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function">endif</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function">endif</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>dec</b></span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>until&nbsp;Zero<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>N</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">ebx</span><span class="hl_char">]</span><span class="hl_char">.</span>pcHwndNeeded</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;D<span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function">endif</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">leave</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;FleaveOk</li><li class="hl_l1">pNtUserBuildHwndList&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div>
<br><br>Можно конечно таблицами эти сервисы запилить, но это весьма не труъ. Их можно получить иначе, для примера выше - обёртка EnumWindows(). Значит при инициализации мы дёргаем эту апи, а в процедуре фильтрации сохраняем ID.<br><br>Ещё одна проблема есть с шадовом, это стартап кода, до загрузки юзер32. Например из верифера или при инжекте в процессы. Если поток не GUI, тоесть вызывает теневой сервис в первый раз, а как следствие и апи user/gdi, то это приведёт к крэшу - ядро вызовет колбек в юзермод(apfnDispatch[]), а так как юзер не проинициализирован и массив векторов не загружен, всё отвалится.<br>Посему шадов можно дёргать только после инициализации user32. И это событие нужно отловить, если есть необходимость свой код выполнять раньше например инициализации статики. Решается просто - описывается слепком UserClientDllInitialize(), она же дллмейн; фильтр для всякого теневого сервиса раскручивает стек и находит вызов из этой процедуры. Если это обнаружено, то выполняется маршрутизация - это ожидание возврата из процедуры. Когда тред вернётся в загрузчик, он покинет дллмейн юзер32, то только тогда можно юзать шадов.<br><br>В целом в этом сложного ничего нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334519&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=9" class="addthx" data-post="334519"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 02:19 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#10');return false;">#10</a> </span><div align=left><br>
<I>Dr0p пишет:<br>Кодес для скрытия дебаггера<br>...<br>Не знаю что может быть не понятно, я же всё подробнейшим образом разжевал. </I><br>Запили готовый плагин к ольке и 99,9% вопросов отпадут сами собой, в том же стронге тыкают себе флажки и большинству пох, как оно работает.<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334521&amp;user=6&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=10" class="addthx" data-post="334521"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=22011" title="29-11-2013 17:48, ранг:4.1" target="_blank">bizdon</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 02:23 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#11');return false;">#11</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br><br>Плаг не заведётся в контексте процесса да есчо и до старта кернел. Более того, весь запуск сводится к копированию дллки в сис32 и созданию ключа в реестре. Да и плаги я хз как собирать, никада это не изучал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334522&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=11" class="addthx" data-post="334522"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 02:32 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#12');return false;">#12</a> </span><div align=left><br>
<I>Dr0p пишет: Плаг не заведётся в контексте процесса да есчо и до старта кернел </I><br>Дык никто не говорит, что код нужно засунуть в dll, туда впихнуть установку драйвера с конфигурацией.<br>Примеров плагинов куча на том же масме, если нужно могу у себя глянуть исходники.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334523&amp;user=6&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=12" class="addthx" data-post="334523"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 02:33 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#13');return false;">#13</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br><br>Так а зачем плаг ваще тогда нужен, если он к отладчику никакого отношения не имеет.. да и дебаггер же не обязательно олли.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334524&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=13" class="addthx" data-post="334524"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 02:39 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#14');return false;">#14</a> </span><div align=left><br>
<I>Dr0p пишет: Так а зачем плаг ваще тогда нужен, если он к отладчику никакого отношения не имеет </I><br>Установщик с луна-парком, что бы избавит себя от вопросов, как установить и как использовать.<img src="img/smilies/s1.gif" alt=""><br>Олли не обязательно, но в основном ее то используют.<br>Хз, сам смотри.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334525&amp;user=6&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=14" class="addthx" data-post="334525"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 02:45 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#15');return false;">#15</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br><br>Лишнее это имхо. Имя поменять в реестре не проблема <img src="img/smilies/s1.gif" alt=""><br><br>Я вообще плаги не юзаю никогда. У меня конпилер все задачи быстро решает <img src="img/smilies/s3.gif" alt=""><br><br>Наверно самый не проработанный нюанс это опции. Тоесть их много:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">RANDOM_DELTA_MASK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_number">11B</span>&nbsp;<span class="hl_comment">; [1 % 4], Max. dTSC</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_STACK_ALIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_number">4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Выравнивание стека.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_comment">; Обязательная опция!</span></li><li class="hl_l1"><span class="hl_comment">; Корректировка смещения для отладочного билда.</span></li><li class="hl_l0">OPT_DEBUG_BUILD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function">TRUE</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_ENABLE_RF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Разрешает установку RF(инструкция скипается) при возврате из сисколов.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_ENABLE_SEP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;<span class="hl_comment">; Коррекция rEcx &amp; rEdx для фастколов.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_FAST_SNAPSHOT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Отключает рефреш буфера в GetSnapObjects().</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_SUSPEND_SYSTEMTIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Эмуляция SystemTimeOfDayInformation.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_ENABLE_DBG_LOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Разрешает отладочный вывод.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_LOG_SETTIMER&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;<span class="hl_comment">; Лог NtSetTimer.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_LOG_WAITERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;<span class="hl_comment">; Лог сервисов, выполняющих задержку.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_BREAK_STARTUP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Останов в DLL_PROCESS_VERIFIER.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_CLEAR_DBG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Очистка PEB.BeingDebugged при вызове фильтра.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_LOCAL_BREAK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;<span class="hl_comment">; Останов посредством Int3, а не DbgBreakPoint(eg Obsidium 1.4).</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_comment">;OPT_ENABLE_RWL		equ TRUE	; Разрешает использовать RWL синхронизаю.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_HIDE_THREAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;<span class="hl_comment">; Скрытие удалённого потока(DbgUiRemoteBreakin()).</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_ENABLE_DIALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Разрешает вывод диалога.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_comment">;OPT_DISABLE_BREAKS		equ TRUE	; Запрещает останов по Int3.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OPT_THREAD_LIST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_function"><b>TRUE</b></span>&nbsp;&nbsp;<span class="hl_comment">; Аллокация тлс при старте потоков.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_comment">;OPT_FAST_TSC			equ TRUE	; Замена rdtsc на эмулирующий код.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">FAST_TSC_LIMIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_number">8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Лимит rdtsc, после которого выполняется замена ^</span></li><li class="hl_l1">TROUTE_DELAY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_number">128</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; Лимит циклов NtYieldExecution при захвате контекстов.</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_comment">;OPT_NO_TRACE			equ TRUE	; Сброс TF, вне зависимости от причины останова.</span></li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br>И нужно ребилдить при изменении каждой, что есно не имея сурсов сделать не получится. Наверно нужно будет их динамическими сделать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334526&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=15" class="addthx" data-post="334526"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 02:56 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#16');return false;">#16</a> </span><div align=left><br>
<I>Dr0p пишет: У меня конпилер все задачи быстро решает </I><br>Python не многим медленнее.<img src="img/smilies/s1.gif" alt=""><br><br><I>Dr0p пишет: Наверно нужно будет их динамическими сделать.  </I><br>Дык, а в чем сложность запилить if ( OPT_ENABLE_DBG_LOG == TRUE ) { write_dbg_log(); } ?<br>ну кроме лени конечно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334528&amp;user=6&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=16" class="addthx" data-post="334528"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 03:08 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#17');return false;">#17</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br><br>&gt; Python не многим медленнее.<br><br>У него не системная область юзания, это же скрипт.)<br><br>&gt; Дык, а в чем сложность запилить if ( OPT_ENABLE_DBG_LOG == TRUE ) { write_dbg_log(); } ?<br><br>Не совсем просто. Некоторые опции весьма сильно изменяют обработку, что в статике гораздо проще сделать на макро.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334530&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=17" class="addthx" data-post="334530"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35473" title="29-11-2013 01:05, ранг:27.6" target="_blank">dosprog</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]priag[/b]','')">priag</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34106">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 13:13 <br><script type="text/javascript">QU('priag','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=priag" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#18');return false;">#18</a> </span><div align=left><br>
т.е в текущей реализации нельзя дернуть какую-нибудь flt.dll и от определённого приложения (или даже от всей системы) залогировать апи в файл? нужно все самому закодить используя основой уже готовую дровину?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334544&amp;user=34106&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=18" class="addthx" data-post="334544"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]priag[/b]','')">priag</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34106">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 13:20 <br><script type="text/javascript">QU('priag','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=priag" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#19');return false;">#19</a> </span><div align=left><br>
лично мне данный инструмент будет полезен, т.к достаточно часто приходится реверсить нечто, использующее sysenter и вызовы ntdll - на это уходит много времени (даже до понимания того в каком порядке какие функи юзаются может до пары часов уйти)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334546&amp;user=34106&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=19" class="addthx" data-post="334546"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 13:56 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#20');return false;">#20</a> </span><div align=left><br>
<b>priag</b><br><br>Flt.dll это тулза для анти анти дебага. В принципе ничего не мешает добавить необходимую апи/сервис, но для этого нужно иметь сурсы её. Вы можите собрать свой фильтр, конпилите длл, в процедуре фильтрации определяете нужный вам сервис. Закончу разбирать аверскую дровину, сделаю вам шаблон.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334548&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=20" class="addthx" data-post="334548"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 15:39 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#21');return false;">#21</a> </span><div align=left><br>
Вот шаблон.<br><br><noindex><a href="http://radikal.ru/fp/87c55a526291455c9424bd61dbd1cbd0" rel="nofollow" target="_blank"> <img src="http://s57.radikal.ru/i157/1311/bf/81c8d9ee40fa.png" border="0" align="" alt=""></a></noindex><br><br><img src="img/attach.gif" alt=""> <a href="./files/4c41_29.11.2013_EXELAB.rU.tgz">4c41_29.11.2013_EXELAB.rU.tgz</a> - Model.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334555&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=21" class="addthx" data-post="334555"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 16:00 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#22');return false;">#22</a> </span><div align=left><br>
Загрузочный лог(OPT_CHECK_BUILD) блокнота:<br><br><noindex><a href="http://pastebin.com/pRHcDr5B" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>          Debug string: Filter(NTID{Rva: 0xDE8E, Id: 0x103, Name: ZwTestAlert}<br>          Debug string: Fret): 0x103<br>          Debug string: Filter(NTID{Rva: 0xD05E, Id: 0x20, Name: ZwContinue}<br>          Debug string: Fret): 0x20<br><br>- поток покинул стартап апк.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334558&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=22" class="addthx" data-post="334558"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Rainbow[/b]','')">Rainbow</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/13190.jpg" alt=""><br><span class=txtSm>Ранг: 110.8 (ветеран), 104thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.83'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=13190">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 ноября 2013 21:01 &middot; Поправил: Rainbow <br><script type="text/javascript">QU('Rainbow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rainbow" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#23');return false;">#23</a> </span><div align=left><br>
Я просто в осадке с этой темы ))) Dr0p иди пойди в автомастерской моторы пособирай )) может хоть там от тебя польза будет ))))<br><br>P.S. <I>Dr0p пишет:<br>Плаг не заведётся в контексте процесса да есчо и до старта кернел. </I><br><br>А почему бы из плага-длл не загрузиться в ядро ?<br><br><I>Dr0p пишет:<br>Более того, весь запуск сводится к копированию дллки в сис32 и созданию ключа в реестре.</I><br><br>Нахера ей там делать в сис32 че она там забыла ?<br><br><I>Да и плаги я хз как собирать, никада это не изучал. </I><br><br>...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334581&amp;user=13190&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=23" class="addthx" data-post="334581"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 ноября 2013 02:09 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#24');return false;">#24</a> </span><div align=left><br>
<I>Rainbow пишет: Dr0p иди пойди в автомастерской моторы пособирай ))  </I><br>Да нормальный Инде мужик, зря так травите его, покрайне мере, в отличии от школяров если он где то не прав, то 99,9% прочитает матчасть, за что ему респект. <img src="img/smilies/s13.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334597&amp;user=6&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=24" class="addthx" data-post="334597"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 ноября 2013 02:17 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#25');return false;">#25</a> </span><div align=left><br>
<I>Dr0p пишет: У него не системная область юзания, это же скрипт.) </I><br>Дык это понятно, никто и не говорит, что нужно собирать на нем дрова, просто удобный ( для меня ) способ автоматизации рутины.<br>Раньше не перле говнокодил, но сцуко со своими &#036; @ неудобен что звездец и располагает к говнокоду, а так никто не говорит о замене с\с++ асму, хотя иногда дрова загружаю из скрипта.)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334599&amp;user=6&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=25" class="addthx" data-post="334599"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 ноября 2013 03:46 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#26');return false;">#26</a> </span><div align=left><br>
<b>Rainbow</b><br><br>&gt; А почему бы из плага-длл не загрузиться в ядро ?<br><br>И что дальше делать ?<br><br>Сабж создан для того, чтобы перенести обработку в юзермод.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334605&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=26" class="addthx" data-post="334605"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 ноября 2013 07:25 <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#27');return false;">#27</a> </span><div align=left><br>
) Ну, в автомастерскую ещё поди не устроишься, там нездоровая конкуренция. Дело-то не особо хитрое.<br>Обойдутся там без Dr0p&#039;a. Пускай всё остаётся, как есть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334609&amp;user=35473&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=27" class="addthx" data-post="334609"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]priag[/b]','')">priag</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34106">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 ноября 2013 15:53 <br><script type="text/javascript">QU('priag','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=priag" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#28');return false;">#28</a> </span><div align=left><br>
<b>Dr0p</b>, спасибо за шаблон, но что-то завести его у меня не получилось. Сорри за нубство, но как юзать? Допустим, есть у меня тушка, которая через сисентер получает список процессов и через тот же сисентер сохраняет в файл. Хочу отмониторить с помощью мотора эти действия. Как?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334615&amp;user=34106&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=28" class="addthx" data-post="334615"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 ноября 2013 20:50 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#29');return false;">#29</a> </span><div align=left><br>
<I>priag пишет:<br>но что-то завести его у меня не получилось </I><br>так с этом и соль. <I>Dr0p пишет: Чтоб его юзать надо немного покодить</I> это типа я написал gui - на дельфи например, компанентов бы накидал на форму мышкой, но функционал к гую пилите сами <img src="img/smilies/s1.gif" alt="">. <br>как в старые добрые времена клерк пилилт что-то пилит, а запиленного - так чтоб юзать - ничего небыло и нет
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334627&amp;user=18316&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=29" class="addthx" data-post="334627"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 декабря 2013 02:02 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#30');return false;">#30</a> </span><div align=left><br>
<b>priag</b><br><br>Что именно не получилось. Таким же образом, как вы выше заводили <img src="img/smilies/s1.gif" alt=""><br><br>&gt; Хочу отмониторить с помощью мотора эти действия. Как? <br><br>Добавляете ссылку в массив нтапи(ZwList[]) на имя и хэш от имени. В батник дописываете свой обьектник(.obj) и дефейните прототип(public/extern blabla). Потом билдите. Если код на масме, то не вижу никаких проблем.<br><br>&gt; а запиленного - так чтоб юзать - ничего небыло и нет <br><br>Тонны готового кода есть. Если ты про гуй, где мыщем по кнопкам тыкать, то да, такого у меня нет. Я последний раз гуй собирал пару лет назад.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334635&amp;user=33727&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=30" class="addthx" data-post="334635"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]priag[/b]','')">priag</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.2 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.39'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=34106">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 декабря 2013 15:33 &middot; Поправил: priag <br><script type="text/javascript">QU('priag','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=priag" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=22033&amp;page=3#31');return false;">#31</a> </span><div align=left><br>
Получилось завести только в отладчике (flt в АП процесса для исследования, а его в отладчик, тогда сыпятся дбг-алерты и пишется лог), а вот если взять из второго сообщения темы CUI версию и поменять flt на шаблон (последнее сообщение), то будет ошибка:<br>The procedure entry point g_Init could not be located in the dynamic link library Flt.dll.<br><br>Глянь в Личные сообщения <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=334654&amp;user=34106&amp;forum_n=3&amp;topic=22033&amp;page=3&amp;anchor=31" class="addthx" data-post="334654"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=2.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=2.html">3</a> . <b>4</b> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=7.html">8</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=12.html">13</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=13.html">14</a> . <a href="action=vthread&amp;forum=3&amp;topic=22033&amp;page=4.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> SIDE.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22033" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
