<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Пытаюсь распаковать, но что-то не получается :( - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всё началось вот тут: http://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15227&amp;page=-1#22 По намёку модератора переехал сюда. Краткое содержание предыдущих серий: Пытаюсь распаковать _deleted_ дабы изучить как">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Пытаюсь распаковать, но что-то не получается :(</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=16300&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=16300&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2010 23:08 &middot; Поправил: Semenov <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всё началось вот тут: <a href="http://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15227&amp;page=-1#22" target="_blank">http://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=15227&amp;page=-1#22</a><br>По намёку модератора переехал сюда.<br>Краткое содержание предыдущих серий:<br>Пытаюсь распаковать _deleted_ дабы изучить как это и что это.<br>По наводке людей было выяснено, что OEP -- 406874.  Но на это стадии приложение ещё не выглядит окончательно распаковыванным  и сдампить её не получилось.<br>Вот прошу помощи у гуру в доведении дела до конца.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258872&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=1" class="addthx" data-post="258872"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]izl3sa[/b]','')">izl3sa</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.12'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=25499">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 07:02 <br><script type="text/javascript">QU('izl3sa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=izl3sa" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
В деле распаковки говнокрипторов главное не зарыватся очень глубоко )<br>Наиболее распространены два варианта, каждый из которых использует второй слой декриптора. В первом случае данные во втором декрипторе фигачатся в выделенную область и там запускаются (полегче) и во втором случае освобождается память по ImageBase. Существуют ещё несколько способов работы крипторов по типу запуска дочернего процесса в суспенженном состоянии и внедрению туда нового образа или подмены длл в памяти, но они намного более редкие чем первые два.<br>Главный подход - найти ключевые переходы без пошагового выполенения кода. В данном деле очень помогают апи шпионы - главное следить за резкими перепадами адреса возврата - они указывают на эти самые ключевые переходы. В первом распространенном варианте достаточно поставить бряк на VirtualAlloc/HeapAlloc/ZwAllocateVirtualMemory в зависимости от того что используется в крипторе и немного потрейсить на втором (возможно больше) срабатывании (можно сделать бряк на ешё одной апи после - смотреть в шпионе, тогда не придется трейсить) - и в буфере у нас окажется распакованный образ, возможно  уже промапленный и с релоками - тогда придется править образ вручную или с помощью разных полезных тулз.<br>Во втором случае всё немного сложнее. Но обычно переходы видны невооруженным глазом. Если же нет опять же апи шпион в помощь. Впрочем код второго слоя декриптора обычно приметивен и быстро анализируется, но я ленивый и обычно этого не делаю )) хотя зря, порою бывают закопаны неочевидные фичи ))<br>В данном конкретном случае я делал следующее: <br><br>bp VirtualAlloc<br>прокрутил вниз в поисках возможного перехода<br>увидел call edx, интуиция подсказала, что это оно самое, брякнулся там и перешел на второй слой<br>Покрутил вниз, увидел два ret`a и после нули. Интуиция опять посказала, что это возможно наше. Поставил там бряки. Первый ret - просто возврат. Второй ret - переход к выравниванию стека и jmp edx который очевидно приводит нас к oep. Далее ollydump и рабочий образ.<br><br>Как видишь, опыт решает, но пока его нет, пользуйся апи шпионами ))<br><br>&gt;&gt;Но на это стадии приложение ещё не выглядит окончательно распаковыванным<br>дык это зевс, там нету стаба. Сразу код идет выполняющий инициализацию и тд. Так что все нормально.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258880&amp;user=25499&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=2" class="addthx" data-post="258880"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 10:21 <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
т.е. вы хотите сказть, что при нахождении отладчика в позиции 0х406874 я могу содрать дамп с процесса и получу распакованного зевса?<br>Делал так, результат дампа чем-то мне не нравится. <br>Можно из запакованного зевса получить работающую копию распакованного?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258888&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=3" class="addthx" data-post="258888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]izl3sa[/b]','')">izl3sa</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.12'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=25499">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 11:01 <br><script type="text/javascript">QU('izl3sa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=izl3sa" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
2Semenov<br><br>да и да ) Дамп вам не нравился отсутствием привычного стаба )
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258890&amp;user=25499&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=4" class="addthx" data-post="258890"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 11:15 &middot; Поправил: Semenov <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Вот сейчас закрыл глаза на отсутствие стаба. Перекинул получившийся дамп в ещё один Olly и пошёл его отлаживать. <br>По адресу 0x40764D отладчик тупо зацикливается, с ошибкой Access denied и в следствии процесс &quot;терминатед&quot;.<br>Если это дамп запустить просто так, то он падает с ошибкой.<br>В этом месте как я понял сохранение результата работы (Module Handle) функции LoadLibrary() в адрес 414D0C<br>А адреса нет? <img src="img/smilies/s1.gif" alt=""><br><br>В другом отладчике у меня исходный объект который я так же пытаюсь пройти пошагово, он же в этом месте замечательно проходит.<br>Что такое?<br><br>Там дальше GetprocAddress() и видать будет тоже самое.<br><br>ЗЫ. Кстати, в 0x407647 стоит PUSH EBX - это вроде как тот самый параметр для функции, но тут какая-то своя обёртка для функций как я понял? Так да?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258891&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=5" class="addthx" data-post="258891"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]izl3sa[/b]','')">izl3sa</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.12'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=25499">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 11:24 <br><script type="text/javascript">QU('izl3sa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=izl3sa" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
говорил же, необходимо ещё править дамп в случае необходимости. В общем случае дамп смотрят статически, а уточняют некоторые моменты в отладчике на исходном сэмпле.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258892&amp;user=25499&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=6" class="addthx" data-post="258892"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 11:26 &middot; Поправил: Semenov <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
А как это править? <img src="img/smilies/s4.gif" alt=""><br><br>Как я понял с адреса 0x407626 по 0x40763C идёт расчёт адреса библиотеки kernel32.dll<br>затем по 4 строчки на выколупывание из нё адресов функций LoadLibraryA() и GetProcAddress() с последующим сохранением их адресов впамяти по адресам 0x414D0C и 0x414CA4 соответственно. <br>Если в оригинале всё гладко, то тут падение с access violation. Причём я не понимаю пока почему. Если в Olly открыть View-&gt;Memmory то видно, что участок от 0x413000 размером 0x5000, куда попадают наши указатели выше, принадлежит к .rdata и с флагом только для чтения.<br>Что нужно править чтобы ошибки не было? Флаг секции или адреса куда сохранять?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258893&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=7" class="addthx" data-post="258893"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 12:29 <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
В общем эту ошибку пока обошёл по простому - поставив на секцию .rdata флаг RWE, и эти строки прошли. Теперь запор в следующей функции. Там будет call 0x412BFD где в оригинале находится некий КОД, а в сдампленом бинарники куча нолей. т.е. сдампилось не всё?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258898&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=8" class="addthx" data-post="258898"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 12:37 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
а чтоб импорт востановить, никому не приходило это в голову... и получается полностью валидный работоспособный трой
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=258899&amp;user=15500&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=9" class="addthx" data-post="258899"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 12:50 <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Дык а разве OllyDmp не восстанавливает импорт?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258900&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=10" class="addthx" data-post="258900"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 12:59 &middot; Поправил: BoRoV <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
эм... сразу после оеп идут две ф-ии подряд вот они и заполняют табличку импорта... дампишь на оеп, делаешь выполнение тех ф-ий, ищешь начало таблички импорта и конец(чтоб посчитать её размер), потом идешь в импрек вбиваешь там оеп, адресс начала импорта и размер какой там у тя уже вышол, жмешь гет импортб потом авто трейс(он находит невалидные), удаляешь невалидные, и ещё одну с всок, и прикручиваешь к дампу, а вообще почитай о анпаке простых пакеров.
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=258901&amp;user=15500&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=11" class="addthx" data-post="258901"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 13:02 <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
опираюсь на информацию из вот этой статьи: <a href="http://exelab.ru/art/?action=view&amp;id=271" target="_new">http://exelab.ru/art/?action=view&amp;id=271</a><br>а как найти начало и размер?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258902&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=12" class="addthx" data-post="258902"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 13:10 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
после ГетПроцАдрес этот адрес должен ложится в ячейку памяти, отображаешь её в дампе, делаешь там вид отображение адреса, и там потом должен соринтироватся... я уже удалил файл и влом его снова качать, чтоб всё точно объяснить... поищи и посмотри мувики по распаковке, в некоторых я видел этот приём
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=258903&amp;user=15500&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=13" class="addthx" data-post="258903"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 13:36 <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Ага! Получается адрес 0x14CA4 (уже без ImageBase), по дампу возвращаюсь аж до 0х14A44, ставлю размер 0x100 и получаю список функций. Но в промежутках попадаются просто адреса без функций.<br>Если нажать AutoTrace то ImpREC тупо зависает...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258905&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=14" class="addthx" data-post="258905"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 14:03 &middot; Поправил: Semenov <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Нашёл мануал как правильно рабоать с Таблице импорта и ImpREC но вот беда. После того как делаю Fix Dump, ошибка что дамп кривой. Дамп заранее сделан из OllyDmp с убраной галочкой Rebuild Imports.<br><br>Всё. Вроде как получилась таблица импорта. Много читал и пробовал в итоге при помощи ImpREC и OllyDMP получилось сделать PE с таблицей импорта. Когда его подгружаю в дебагер сразу видны вызовы функций и даже ничего не падает по началу. <br>Но вот по адресу 0x412BFD по прежнему ноли. А в оригинале туда распаковывается код. Получается что после дампа он не сдампился. Можно это как-то исправить?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258907&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=15" class="addthx" data-post="258907"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 14:26 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
эм, размер у меня был где-то 4D0
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=258909&amp;user=15500&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=16" class="addthx" data-post="258909"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 14:36 &middot; Поправил: Semenov <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
4С0 у меня в итоге получилось, а начало в 14А40, но вот куска .text не хватает <img src="img/smilies/s9.gif" alt=""><br><br>Ещё при перестроении таблицы импорта функция WSAConnect почему-то Invalid...<br><br>ААААА!!! УРА!!!! LordPE как-то это сделал иначе и получилось! Теперь у меня есть dump.exe с пофиксеной таблицей и который отлаживается уже довольно далеко. Теперь он зараза переходит на ExitProcess().<br>Предварительно прошерстив список процессов. Подозреваю он ищет какой-нить отладчик или ещё кого... Буду ковырять дальше.<br>ОГРОМНОЕ спасибо за помощь!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258910&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=17" class="addthx" data-post="258910"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 20:19 &middot; Поправил: Semenov <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Ребят, а почему в результате распаковки первая инструкция CC = INT3 в результате чего при запуске приложение падает в Exception. Это я чего-то не то сделал или так и задумано?<br><br>Заменил эту бяку на NOP, но вот в какой-то момент после запуска приложение начинает жрать 100% и всё тут.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258925&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=18" class="addthx" data-post="258925"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 21:01 &middot; Поправил: BoRoV <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
то наверное антидебаг, может там ещё кое-чего  напихали, это нужно трейсить и смотреть
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=258931&amp;user=15500&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=19" class="addthx" data-post="258931"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 21:38 <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Вводит в ступор исполнение RtlCreateUserThread из адреса 407DEF причём как распакованный так и оригинальный под отладкой дают такой эффект. Эффект сохраняется при после перезагрузки, когда эта зараза загружается установившись в систему.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258935&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=20" class="addthx" data-post="258935"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 21:48 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Сдаётся мне, что int3 оттого, что ты дампишь софт со стоящим там бряком.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258936&amp;user=1556&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=21" class="addthx" data-post="258936"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 22:12 <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
аааа, спасибо <img src="img/smilies/s1.gif" alt=""><br>Пока очень напрягает 100% загрузка проца...<br>Причём что самое интересное, я думал что это может быть из-за того что оно распаковано или под дебагером, но ведь если взять оригинал, запустить его из под дебага, он себя инсталит в систему и после перезагрузки системы снова жрёт 100%, но ведь он уже без всякой отладки и из оригинального образа...<br>Вот же фигня какая.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258939&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=22" class="addthx" data-post="258939"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 22:19 <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
аааа, спасибо <img src="img/smilies/s1.gif" alt=""><br>Пока очень напрягает 100% загрузка проца...<br>Причём что самое интересное, я думал что это может быть из-за того что оно распаковано или под дебагером, но ведь если взять оригинал, запустить его из под дебага, он себя инсталит в систему и после перезагрузки системы снова жрёт 100%, но ведь он уже без всякой отладки и из оригинального образа...<br>Вот же фигня какая.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258940&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=23" class="addthx" data-post="258940"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]BoRoV[/b]','')">BoRoV</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/15500.jpg" alt=""><br><span class=txtSm>Ранг: 533.6 (<b>!</b>), 232thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.41'>Активность: 0.45<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=15500">Uploader</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 22:41 <br><script type="text/javascript">QU('BoRoV','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoRoV" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
это нормально, он активно работает, делает свои пакости, я конечно хз, что он делает, то что инсталится и куда я увидел, но я потом его снес нах... соответствено я не могу понять, зачем ты его запускал, чтоб он прописывался, ладно ещё дебаг, хотя и это не пойму, чё ты так на нем зациклился, хочешь рипнуть алго и собрать своего конька??
<br><br><font size="1"><i>-----<br>Лучше быть одиноким, но свободным © $me</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=258941&amp;user=15500&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=24" class="addthx" data-post="258941"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 22:53 <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Ну мне как бы не жалко, пусть ставится - делаю я это всё на виртуалке, специально для этого созданой.<br>У меня отпуск и мне очень интересно как работают такие пакости, заодно изучу искуство диазссемблинга и как всё работает. А то всё Си да Си++.<br><br>Это не нормально. Если его запустить просто как он есть после билдера, то он тихо мирно запускается. Если же вот так, то беда. <br>Сижу сейчас изучаю параметры RtlCreateUserThread() и оказывается она не документирована. Но нашёл кое что на CodeProject. А неё передаётся куча параметров, мой подопытный прежде чем зависнуть передаёт в неё всего 2 весомых параметра, это ProcessHandle и StartAddress, всё остальное ноли. Так вот StartAddress величина где-то нигде, например BD7038, Олли при попытке перейти на этот адрес грит unknown identifer. <br>Что это за адрес такой? И что должен исполнять этот поток если в этом адресе нет никого?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258943&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=25" class="addthx" data-post="258943"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 мая 2010 23:23 <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Разобрался, BD7038 это 0xBD0000 как ImageBase нашего тела в результате инжекта в чужой процесс в адресном пространстве чужого процесса. 7038 это адрес функции треда. Стал вникать по глубже выяснил, что проц жрёт тот процесс куда инжектились, получается чтобы узнать почему жрёт надо до запуска нити войти в отладку жертвы и добраться до тела нити и посмотреть что же так жрёт проц... <br>Завтра продолжу свои поиски с отчётом что получилось.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258948&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=26" class="addthx" data-post="258948"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2010 08:26 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
Создай левый процесс сразу под олькой типа блокнота да подмени пид при открытие процесса, чтобы инжект шёл сразу в твой отлаживаемый левый процесс.<br>И кнопку Правка освой, не стоит несколько постов подряд конопатить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258988&amp;user=1556&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=27" class="addthx" data-post="258988"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]GMax[/b]','')">GMax</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.2 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6843">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2010 09:46 <br><script type="text/javascript">QU('GMax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GMax" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>Archer пишет:<br>Создай левый процесс сразу под олькой типа блокнота да подмени пид при открытие процесса, чтобы инжект шёл сразу в твой отлаживаемый левый процесс. </I><br><br>можно еще проще, при инжекте ставить пид отлаживаемого процесса (зевса), а при запуске нового потока пропускать эту API и просто переходить на StartAddress создаваемого потока. <br>Можно также при выделении памяти возвращать адресс заранее специально созданной дополнительной секции в файле, тогда и сдампить расшифрованный инжектируемый код можно продолжив его изучение <br>уже в IDA
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=258992&amp;user=6843&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=28" class="addthx" data-post="258992"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 мая 2010 18:30 &middot; Поправил: Semenov <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
Инжектируется бинарник целиком. т.е. как есть пишеться в память чужого процесса, а там уже исполняется. Как рекомендовали подменяю пид на блокнот и внутри блокнота смотрю что оно там делает.<br><br>Разобрался с загрузкой проца. После инжекта себя в чужой процесс, заразка внутри userThread опять строит таблицу импорта. Так вот первый же вызов LoadLibraryA() CALL указывает на адресное пространство внутри оригинального пройесса 0x040xxxxx когда в оригинале должен указывать на ижектрированное, к примеру 0x0EAxxxx.<br>У оригинального ЕХЕ всё так и есть, а вот у распакованного всё плохо. Что влияет на это? Куда смотреть?<br><br>Ну подтолкните на что-нить... Плииз <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=259020&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=29" class="addthx" data-post="259020"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Semenov[/b]','')">Semenov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.13'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25485">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 июня 2010 15:34 <br><script type="text/javascript">QU('Semenov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Semenov" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=16300&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
В общем суть такая. Ни с каким Import Table заморачиваться не надо, толку от этого ноль (ну может и не ноль но я пока не нашёл в чём толк).<br>Эта зараза не изспольщует таблицу инмпорта на той стадии на которой я. У первых строках своего кода она пользуется двумя функциями LoadLibrary() и GetProcAddress() для построения в памяти своей собственной таблицы импорта путём  GetProcAddress(LoadLibrary(&quot;filename.dll&quot;),&quot;functionname&quot;); Видать чтобы не светить используемые им функции. <br>Адреса к LoadLibrary и GetProcAddress получаются вот из этого:<br>Примерно так: <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_number">4011EC</span><span class="hl_char">]</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Arg2&nbsp;<span class="hl_char">=</span>&nbsp;ASCII&nbsp;<span class="hl_quote">&quot;LoadLibraryA&quot;</span></li><li class="hl_l1"><span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EBX</b></span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>Arg1</li><li class="hl_l0"><span class="hl_function"><b>CALL</b></span>&nbsp;update<span class="hl_char">.</span><span class="hl_number">004075BB</span></li>        </ol>
    </div>
</div></div>
<br>Так вот проблема у меня сейчас в следующем: После распаковки exe предложеным выше методом, значение 0x4011EC, указывающее в памяти на строку &quot;LoadLibraryA&quot;, из кода выше, уже установлено и является константой. Но зараза в ходе свой работы копирует своё тело внутрь чужих процессов как то winlogon.exe и остлаьные, и там снова исполняется с позичии указанной в CreateUserThread. И там она снова начинает строить свою таблицу импорта и снова обращается к строке &quot;LoadLibraryA&quot; вот тут то и происходит Access violation потому как новый ImageBase уже не 0x400000, а некий другой относительно процесса-жертвы. А мы всё ещё пытаемся обратиться в 4011EC. <br>Какой механизм меняет эти смещения?<br>Кто такие &quot;Relocation Table&quot; и &quot;Import Address table&quot;? Могут они влиять на это? Когда бинарник в памяти у него есть ещё одна секция .rsrc с непонятным мне содержимым, и предыдущие Директории указывают именно на её адресное пространство.<br><br>ЗЫ. Огромное спасибо всем помогающим. За это время что я ковыряю PE, я уже разобрался с кучей всего.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=259818&amp;user=25485&amp;forum_n=5&amp;topic=16300&amp;page=0&amp;anchor=30" class="addthx" data-post="259818"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=16300&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=16300&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Пытаюсь распаковать, но что-то не получается :(</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="16300">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=16300" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
