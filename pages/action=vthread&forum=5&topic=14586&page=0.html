<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Разбор распостраненной защиты - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте. В последнее время часто попадаются проги с похожим типом регистрации (часто написанные на делфи), т. е. есть код оборудования, нужно ввести имя и серийник (прога не запакована или можно распаковать). Вроде бы">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Разбор распостраненной защиты</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]vladipirogov[/b]','')">vladipirogov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.41'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19865">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2009 09:51 <br><script type="text/javascript">QU('vladipirogov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vladipirogov" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте. В последнее время часто попадаются проги с похожим типом регистрации (часто написанные на делфи), т. е. есть код оборудования, нужно ввести имя и серийник (прога не запакована или можно распаковать). Вроде бы тривиальная проблемма, однако не понятно, где собака зарыта. Запускаю прогу под отладчиком, открываю окно регистрации, ввожу имя, серийный номер, ставлю бряк на хендл TEdit отправку различных сообщений срабатывает только на Window creation and destruction; GetDlgItemText, GetWindowText - не срабатывают, на SendMessage - вызывается напостой (с условием не срабатывает). Бряк на память на введенный серийник или на имя также срабатывает очень часто еще до нажатия кнопки зарегистрировать. Мне кажется, что здесь алгоритмы проверки регистрации чем то напоминают описание статьи &quot;Крутая защита или CRACKL@B CrackMe #1&quot; из архива. Вот ссылка на одну из прог: rapidshare.com/files/245437211/Beam_211108.rar.html<br>P. S. Прошу строго не судить, если подобные статьи уже есть, я просто не нашел
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234059&amp;user=19865&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=1" class="addthx" data-post="234059"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2009 12:13 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Такой тип реализации защиты очень распространен и может реализоваться совершенно по разному в каждом отдельном случае. Поэтому универсальных решений быть в принципе не может. Функции,на которые ставились прерывания  не помогут при исследовании Делфи программ. Советую начать изучение программы,написаной на Делфи, с декомпиляции, если не запакована. Декомпилятор - DeDe.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234068&amp;user=7008&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=2" class="addthx" data-post="234068"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]vladipirogov[/b]','')">vladipirogov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.41'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19865">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2009 12:22 <br><script type="text/javascript">QU('vladipirogov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vladipirogov" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Я про это в курсе. Пользовался DeDe. Нашел окошко с регистрацией: Tregistrationform. В процедурах также видно без проблемм registration, а также ее составляющие. Пробовал ставить бряки на разное - останавливался, но бестолку
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234069&amp;user=19865&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=3" class="addthx" data-post="234069"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2009 12:57 <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Нужно определить место,где считывается серийник и имя, и &quot;следить&quot; за ними в отладчике, анализируя все действия,которые программа с ними делает.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234071&amp;user=7008&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=4" class="addthx" data-post="234071"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]vladipirogov[/b]','')">vladipirogov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.41'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19865">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2009 13:08 <br><script type="text/javascript">QU('vladipirogov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vladipirogov" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Я понимаю. Это наподобие, как у прог на С++: поставил бряк на GetDlgItemText, GetWindowtext или на сообщение, ввел регистационные данные, нажал на кнопку и сразу попал на место проверки. Ну тут (в данной проге)таким образом получилось только, как указано выше, при постановке бряка на на хендл TEdit Window creation and destruction. Че еще может быть, пока не знаю. Некоторые рекомендуют пользоваться softice. Пользовался все тоже плюс сайс еще и глючит, в Оле удобнее.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234072&amp;user=19865&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=5" class="addthx" data-post="234072"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]tempread[/b]','')">tempread</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 159.1 (ветеран), 7thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0.13<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=7008">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2009 14:29 &middot; Поправил: tempread <br><script type="text/javascript">QU('tempread','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tempread" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Не могу понять в чем проблема... Есть результат от DeDe, там все адреса есть.  Ставишь брекпоинт на нужный(выбранный в исходнике ,который дал DeDe) адрес и начинаешь исследовать.  Часто программа только проверяет на внешнюю &quot;правильность&quot;  введеных данных , а реальная проверка осуществляется после ее перезагрузки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234076&amp;user=7008&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=6" class="addthx" data-post="234076"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]vladipirogov[/b]','')">vladipirogov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.41'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19865">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2009 14:51 <br><script type="text/javascript">QU('vladipirogov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vladipirogov" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Да вот и весь прикол - на какой адрес нужно ставить брекпоинт? Я конечно еще помучаюсь. Но хотелось бы какой нибудь пример наподобие или чтобы  на данном примере тыкнули носом, где искать зарытую собаку. Но все равно спасибо за напутствие. <br>    Буду очень благодарен, если данный пример быдет исследован вживую, чтобы я разобрался с агоритом подобных защит.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234077&amp;user=19865&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=7" class="addthx" data-post="234077"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]3ton[/b]','')">3ton</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 26.2 (посетитель), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.28'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4267">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2009 14:56 <br><script type="text/javascript">QU('3ton','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=3ton" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Код регистрации можно подсмотреть.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">004C4023</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B55</span>&nbsp;FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">4</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; любой введеный код регистрации</span></li><li class="hl_l1"><span class="hl_number">004C4026</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B45</span>&nbsp;F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">EBP</span><span class="hl_char">-</span><span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_comment">; правильный код регистрации</span></li><li class="hl_l0"><span class="hl_number">004C4029</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;<span class="hl_number">1257F4FF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00409740</span>&nbsp;<span class="hl_comment">; проверка</span></li><li class="hl_l1"><span class="hl_number">004C402E</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">85C0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_registr">EAX</span></li><li class="hl_l0"><span class="hl_number">004C4030</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0F94C3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>SETE</b></span>&nbsp;<span class="hl_registr">BL</span></li><li class="hl_l1"><span class="hl_number">004C4033</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">84DB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>TEST</b></span>&nbsp;<span class="hl_registr">BL</span><span class="hl_char">,</span><span class="hl_registr">BL</span></li><li class="hl_l0"><span class="hl_number">004C4035</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">75</span>&nbsp;<span class="hl_number">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>JNZ</b></span>&nbsp;<span class="hl_function"><b>SHORT</b></span>&nbsp;<span class="hl_number">004C404F</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=234078&amp;user=4267&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=8" class="addthx" data-post="234078"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]vladipirogov[/b]','')">vladipirogov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.41'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19865">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2009 15:04 <br><script type="text/javascript">QU('vladipirogov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vladipirogov" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
А как именно ты сюда попал?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234080&amp;user=19865&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=9" class="addthx" data-post="234080"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]3ton[/b]','')">3ton</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 26.2 (посетитель), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.28'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4267">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2009 15:30 <br><script type="text/javascript">QU('3ton','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=3ton" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Запустил Source Rescuer. Можно DeDe, разницы нет.<br>Нашел Registration.pas -&gt; <b>procedure</b> TRegistrationForm.btn_RegisterClick(Sender: Tobject);<br><b>begin</b><br>//Address &#036;4CD40C<br><b>end; </b><br>Поставил bp на адрес 4CD40C в OllyDBG<br>Ввел рег. данные, жмякунл ок, брякнулся на этом адресе. <br>Немного потрассировал, и увидел процедуру проверки.<br><br>Пожалуй тебе следует почитать статьи для новичков.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234081&amp;user=4267&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=10" class="addthx" data-post="234081"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]vladipirogov[/b]','')">vladipirogov</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.41'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=19865">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2009 15:39 <br><script type="text/javascript">QU('vladipirogov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vladipirogov" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Спасибо. Не поверишь. Я так делал, но только почти не трассировал после срабатывании на бряке. Да, нужно быть повнимательней
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234082&amp;user=19865&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=11" class="addthx" data-post="234082"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]vnekrilov[/b]','')">vnekrilov</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 329.6 (мудрец), 192thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.08'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=5173">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2009 08:05 <br><script type="text/javascript">QU('vnekrilov','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vnekrilov" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Для программ, написанных на Delphi, я использую следующий метод:<br>1. Нахожу инструкцию MOV EAX, DWORD PTR DS: [ESI+2], которая читает в программе адреса разных событий;<br>2. Устанавливаю на этой инструкции bp;<br>3. Запускаем программу, и когда она останавливается на bp, смотрим в окно регистров. Там, в одном из регистров (обычно EDX), указывается имя события, например, btnGenerateClick, а по адресу [ESI+2] указан адрес обработчика этого события, например, 0045B4B8<br>4. Устанавливаем на этом адресе bp, вводим регистрационные данные, нажимаем кнопку ОК, и программа останавливается на начале процедуры чтения регистрационных данных.<br>5. Трассируем эту подпрограмму, и исследуем процессы, выполняемые с регистрационным кодом.<br><br>Вообще, по этому методу имеется хорошая статья marciano, но она написана на испанском языке.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234121&amp;user=5173&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=12" class="addthx" data-post="234121"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2009 09:01 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>vnekrilov</b>Есть плаг для оллли <b>Point Events in Delphi Executables </b> сним намного проще ;)
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=234124&amp;user=17432&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=13" class="addthx" data-post="234124"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2009 09:25 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>ClockMan пишет:<br>Есть плаг для оллли Point Events in Delphi Executables </I><br>Выложи куда нить, чет не смог нагуглить
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234125&amp;user=423&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=14" class="addthx" data-post="234125"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2009 09:28 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>crc1 пишет:<br>Выложи куда нить, чет не смог нагуглить </I><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/eff3_17.06.2009_CRACKLAB.rU.tgz">eff3_17.06.2009_CRACKLAB.rU.tgz</a> - Point Events in Delphi Executables v1.0.rar
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=234126&amp;user=17432&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=15" class="addthx" data-post="234126"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2009 12:16 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14586.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>crc1</b><br>На tuts4you куча разных плагов, этот в том числе.<br><br>Делал перевод статейки Marciano, идущей вместе с плагином:<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/6220_18.06.2009_CRACKLAB.rU.tgz">6220_18.06.2009_CRACKLAB.rU.tgz</a> - pointE_tut_ru.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=234135&amp;user=4026&amp;forum_n=5&amp;topic=14586.html&amp;page=0&amp;anchor=16" class="addthx" data-post="234135"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Разбор распостраненной защиты</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#17" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="14586">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=14586" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
