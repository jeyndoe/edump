<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>ScyllaHide - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Плаг теперь на github&#039;е https://github.com/x64dbg/ScyllaHide/releases Релиз свежий от 24.06.2017. Добавлено спустя 24 минуты Нуждающимся добавил x64 плаг под иду (sdk 6.95)  e7e9_27.06.2017_EXELAB.rU.tgz); -">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=26261'>bartolomeo</a>, <a target='_blank' href='?action=userinfo&amp;user=28512'>-Sanchez-</a>, <a target='_blank' href='?action=userinfo&amp;user=33192'>morgot</a>, <a target='_blank' href='?action=userinfo&amp;user=54646'>sashalogout</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> ScyllaHide</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.4 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 июня 2017 14:43 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
Плаг теперь на github&#039;е<br>https://github.com/x64dbg/ScyllaHide/releases<br><br>Релиз свежий от 24.06.2017.<br><br><b>Добавлено спустя 24 минуты</b><br>Нуждающимся добавил x64 плаг под иду (sdk 6.95)<br><br><img src="img/attach.gif" alt=""> <a href="./files/e7e9_27.06.2017_EXELAB.rU.tgz">e7e9_27.06.2017_EXELAB.rU.tgz</a> - ScyllaHideIDAProPlugin-x64.zip
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=377057&amp;user=11966&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=1" class="addthx" data-post="377057"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31325" title="27-06-2017 12:23, ранг:12.1" target="_blank">zNob</a>, <a href="action=userinfo&user=41518" title="27-06-2017 12:55, ранг:8.7" target="_blank">parfetka</a>, <a href="action=userinfo&user=3520" title="27-06-2017 13:04, ранг:590.3" target="_blank">mak</a>, <a href="action=userinfo&user=18733" title="27-06-2017 13:17, ранг:32.3" target="_blank">neprovad</a>, <a href="action=userinfo&user=5846" title="27-06-2017 13:24, ранг:36.4" target="_blank">VOLKOFF</a>, <a href="action=userinfo&user=4773" title="27-06-2017 14:38, ранг:244.5" target="_blank">plutos</a>, <a href="action=userinfo&user=29" title="29-06-2017 10:06, ранг:384.1" target="_blank">nice</a>, <a href="action=userinfo&user=17319" title="30-07-2017 05:34, ранг:473.3" target="_blank">VodoleY</a>, <a href="action=userinfo&user=45478" title="29-09-2019 21:38, ранг:2.4" target="_blank">dzikar</a></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2017 09:08 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>Я заметил выше знакомую константу 0x1E: ProcessDebugObjectHandle и подумал что не следует юзать какой то инструмент, не понимая сути.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380013&amp;user=40990&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=2" class="addthx" data-post="380013"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2017 00:17 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
<noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=0#28" rel="nofollow" target="_blank">--&gt; отредачил &lt;--</a></noindex><br>в посте есть вызовы не документированные виндой, пока рою чего за беда.<br>кто в теме по этим функам , жду коментов<img src="img/smilies/s12.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380049&amp;user=3230&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=3" class="addthx" data-post="380049"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Psalmopoeus Pulcher[/b]','')">Psalmopoeus Pulcher</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.8 (посетитель), 23thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2017 07:09 <br><script type="text/javascript">QU('Psalmopoeus Pulcher','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Psalmopoeus Pulcher" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
Может спросонья не понял сути, но в user32.dll GetProcessWindowStation и GetUserObjectInformation. Первая сразу дергает теневой сервис, вторая обертка побольше. Обе функи документированы + в реактОС нашлись совпадения по ядерным именам.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380053&amp;user=18297&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=4" class="addthx" data-post="380053"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2017 13:58 &middot; Поправил: Bronco <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
<I>Psalmopoeus Pulcher пишет:<br>но в user32.dll GetProcessWindowStation и GetUserObjectInformation </I><br>user32.dll в памяти процесса нет, её подгружают позже  для мсг. обёртка для вызова ядерных в win32u.dll.<br>родительский процесс отладчик, это  скрыто,  но для системы окно то уже есть. на этом видно и палят. плюс дескриптор дебаг_объект в переменной после сискола NtQueryInformationProcess , плюс как то палят сцилкины хуки. если хука нет, то и на сискол не идут.<br><I>Psalmopoeus Pulcher пишет:<br>в реактОС нашлись совпадения по ядерным именам </I><br>ок. брал <noindex><a href="https://doxygen.reactos.org/d0/d38/ntuser_2winsta_8c_source.html" rel="nofollow" target="_blank">--&gt; отсюда &lt;--</a></noindex><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">HWINSTA&nbsp;FASTCALL</li><li class="hl_l1">UserGetProcessWindowStation<span class="hl_char">(</span><span class="hl_function">VOID</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">PPROCESSINFO&nbsp;ppi&nbsp;<span class="hl_char">=</span>&nbsp;PsGetCurrentProcessWin32Process<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">return&nbsp;ppi<span class="hl_char">-</span><span class="hl_char">&gt;</span>hwinsta<span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;</li><li class="hl_l1">NtUserGetProcessWindowStation</li><li class="hl_l0">&nbsp;Returns&nbsp;a&nbsp;handle&nbsp;to&nbsp;the&nbsp;current&nbsp;process&nbsp;window&nbsp;station<span class="hl_char">.</span>&nbsp;Return&nbsp;Value&nbsp;<span class="hl_function"><b>If</b></span>&nbsp;the&nbsp;function&nbsp;succeeds<span class="hl_char">,</span><span style="word-break: break-all">&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;handle&nbsp;to&nbsp;the&nbsp;window&nbsp;station&nbsp;assigned&nbsp;to&nbsp;the&nbsp;current&nbsp;process</span><span class="hl_char">.</span>&nbsp;<span class="hl_function"><b>If</b></span>&nbsp;the&nbsp;function&nbsp;fails<span class="hl_char">,</span>&nbsp;the&nbsp;return&nbsp;value&nbsp;is&nbsp;<span class="hl_function">NULL</span><span class="hl_char">.</span></li><li class="hl_l1">&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;HWINSTA&nbsp;APIENTRY</li><li class="hl_l1">NtUserGetProcessWindowStation<span class="hl_char">(</span><span class="hl_function">VOID</span><span class="hl_char">)</span></li><li class="hl_l0">{</li><li class="hl_l1">return&nbsp;UserGetProcessWindowStation<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br>-----<br>походу  сцилке  свой  дров нужен, как в фантике или стронге.<img src="img/smilies/s13.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380056&amp;user=3230&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=5" class="addthx" data-post="380056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]sendersu[/b]','')">sendersu</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 512.7 (<b>!</b>), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.56'>Активность: 0.27<span style='color:red'>&searr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=14629">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2017 17:54 <br><script type="text/javascript">QU('sendersu','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sendersu" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
зачем сразу дров, там где дров жди беду <img src="img/smilies/s1.gif" alt=""><br>захучить и отфильтровать (ИМХО)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380058&amp;user=14629&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=6" class="addthx" data-post="380058"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 ноября 2017 22:00 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<noindex><a href="https://github.com/x64dbg/ScyllaHide/releases/tag/snapshot" rel="nofollow" target="_blank">ScyllaHide_2017-11-08_19-45<br>ScyllaHide_2017-11-08_19-51</a></noindex><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">-</span><span class="hl_function"><b>Add</b></span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;for&nbsp;NtQuerySystemInformation<span class="hl_char">,</span>&nbsp;NtQueryInformationProcess&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;NtQueryObject&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;which&nbsp;the&nbsp;buffer&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;the&nbsp;return&nbsp;length&nbsp;pointers&nbsp;overlap<span class="hl_char">.</span>&nbsp;<span class="hl_function"><b>This</b></span><span style="word-break: break-all">&nbsp;currently&nbsp;detects&nbsp;all&nbsp;three&nbsp;ScyllaHide&nbsp;hooks&nbsp;because&nbsp;they&nbsp;overwrite&nbsp;the&nbsp;return&nbsp;length&nbsp;</span><span class="hl_char">(</span>#47<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">-</span>NtQueryInformationProcess&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;NtQueryObject&nbsp;hooks<span class="hl_char">:</span>&nbsp;check&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;the&nbsp;ProcessInformationClass&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;ObjectInformationClass&nbsp;is&nbsp;relevant&nbsp;prior&nbsp;to&nbsp;doing&nbsp;anything<span class="hl_char">,</span>&nbsp;similar&nbsp;to&nbsp;how&nbsp;the&nbsp;NtQuerySystemInformation&nbsp;hook&nbsp;already&nbsp;works</li><li class="hl_l1"><span class="hl_function"><b>This</b></span>&nbsp;is&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;preparation&nbsp;for&nbsp;the&nbsp;next&nbsp;commit&nbsp;which&nbsp;will&nbsp;be&nbsp;quite&nbsp;gruesome</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">-</span>NtQueryInformationProcess<span class="hl_char">/</span>NtQuerySystemInformation<span class="hl_char">/</span>NtQueryObject&nbsp;hooks<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;a&nbsp;return&nbsp;length&nbsp;is&nbsp;present&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;overlaps&nbsp;<span class="hl_char">(</span>is&nbsp;part&nbsp;of<span class="hl_char">)</span>&nbsp;the&nbsp;output&nbsp;buffer<span class="hl_char">,</span>&nbsp;store&nbsp;a&nbsp;backup&nbsp;of&nbsp;the&nbsp;return&nbsp;length&nbsp;prior&nbsp;to&nbsp;hooking<span class="hl_char">,</span>&nbsp;then&nbsp;restore&nbsp;the&nbsp;original&nbsp;return&nbsp;length&nbsp;afterwards<span class="hl_char">.</span>&nbsp;Fixes&nbsp;#47&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;makes&nbsp;NtQuery_OverlappingReturnLength&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;succeed&nbsp;with&nbsp;hooks&nbsp;enabled</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380064&amp;user=5846&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=7" class="addthx" data-post="380064"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3230" title="08-11-2017 21:08, ранг:190.8" target="_blank">Bronco</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 00:05 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<I>sendersu пишет:<br>захучить и отфильтровать (ИМХО)  </I><br>чтобы перехватить syscall из мяса аппа,  придётся хучить отладочное ядро дебагера, а для него апи в сдк нет..<img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380067&amp;user=3230&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=8" class="addthx" data-post="380067"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Psalmopoeus Pulcher[/b]','')">Psalmopoeus Pulcher</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.8 (посетитель), 23thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 07:03 &middot; Поправил: Psalmopoeus Pulcher <br><script type="text/javascript">QU('Psalmopoeus Pulcher','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Psalmopoeus Pulcher" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
Соглашусь с Bronco - в общем случае необходим перехват syscall&#039;а, т.к. используется &quot;прямой&quot; вызов ядерных функций. А на WOW64 еще и переключение режима на х64 через call far 33:XXXXXXXX, что совсем не добавляет удобств в х32 дебугере. Я сам то давно в ядро не лазил и могу ошибаться, но вроде раньше с перехватом сискола были какие то трудности. Кто знает?<br><br>В общем, гугл по запросу wow64 syscall hook предлагает прописать хук в fs:[0xC0]. Я не долго думая впихал туда 0 перед сменой режима и таки словил эксепшн. Дальше разбираться пока некогда, но, думаю, дело перспективное.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380072&amp;user=18297&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=9" class="addthx" data-post="380072"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 12:47 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
На WOW64 похукать можно через x64 переходник, в том числе и в юзермоде. Если натив х64 или натив х86 и вызов идёт напрямую, только драйвер. Который надо будет в х64 подписывать+он не понравится патчгарду.<br>Что касается 2 юзерских функций, их более стандартные варианты GetProcessWindowStation и GetUserObjectInformation вполне экспортируются и документированы. Другой вопрос, я не думаю, что по ним можно отследить отладчик, скорее всего где-то ошибся.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380076&amp;user=1556&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=10" class="addthx" data-post="380076"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 15:03 &middot; Поправил: Bronco <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
Хз...я не проверял обход в лоб, пока решаю по другому, тут просто любопытно было, почему сцилка не перекрывает. Выложил то что попалось при трассировке, может что-то и пропустил (там же мясо).<br>тогда типо встречный вопрос, зачем на тлц, загрузчику вмп нужен дескриптор окна, через обёртку win32u.dll.?<img src="img/smilies/s12.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380079&amp;user=3230&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=11" class="addthx" data-post="380079"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 15:55 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
<I>Bronco пишет:<br>зачем на тлц, загрузчику вмп нужен дескриптор окна, через обёртку win32u.dll.? </I><br>ну можно узнать в каком окне работает пользователь и по HWID получить PID запущенной программы,класс окна,название окна,если даже процесс скрыт от глаз, я где-то в своём блоге приводил пример
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380087&amp;user=17432&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=12" class="addthx" data-post="380087"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 18:11 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<I>Bronco пишет:<br>нужен дескриптор окна, через обёртку win32u.dll </I><br>Если разговор про всё те же GetProcessWindowStation и GetUserObjectInformation, то это не дескриптор окна, это Window Station, оно с окнами связано мало.<br>Если разговор про другое, то таки да, можно искать окна отладчика.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380097&amp;user=1556&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=13" class="addthx" data-post="380097"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 19:37 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
<b>Archer</b><br><br>Вы понимаете задачу и вообще о чём идёт обсуждение ?<br><br>Тогда опишите задачу кратко и чётко; и какие проблемы с этими апи; и зачем тут фильтровать ядерные события. У <b>Bronco</b> своеобразный стиль описания, не логичный и что бы понять его ход мыслей нужно перечитать стопицот раз топик и десяток тех, что рядом <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380100&amp;user=40990&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=14" class="addthx" data-post="380100"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 19:48 &middot; Поправил: shellstorm <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<I>difexacaw пишет: Вы понимаете задачу и вообще о чём идёт обсуждение ? </I><br><br>Не арчер, но осилил. Говнопрот детектит отладку в tls, сабж это не фильтрует, если там сисколы совсем все плохо, суть вопроса в том, как этот засранец отлавливает факт отладки, зачем ему дескриптор окна и как жить дальше, пилить дров, не пилить и вообще как это работает, то есть нужен подробный лог вызовов, желательно отфильтрованный от всякого неинтересного шлака, после запилить фильтр для обхода детектов. Как то так.<br>Я может почесал бы мозг, но нет жертв, нужно несколько анпакми накрытых по максимуму и с умом, а в идеале сам говнопрот, возиться с играми или малваркой нет желания.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380101&amp;user=41575&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=15" class="addthx" data-post="380101"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 20:01 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Ну а почему тогда не описали суть, сделать ясным и понятным понимание, а обсуждать какие то мутные и не понятные вещи..<br><br>Тоесть происходит обычный юзер детект, фильтр не правильно работает. То что он не учёл какой то сервисный вызов - недостаток, ошибка, её пофиксят. Огромное число методов есть, можно снять полную активность фильтра, в данном случае это мотор реализующий антидебаг. Не зависимо от мода, при этом накопить все адреса к которым он обращается. Элементарная выборка данных, например через монитор рабочего набора, это уже вроде обсуждалось.<br><br>Какие проблемы с сервисами, базовый набор есть в врк.<br><br>Для чего нужно было(начали обсуждать) ядреные фильтры ?<br><br>Есть множество методов и реализаций, которые отлично проработаны и решают задачу.<br><br>По мойму как обычно проблемы из за некоррект описания. Странно что это пишут люди, которые знакомы со всей этой системой.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380103&amp;user=40990&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=16" class="addthx" data-post="380103"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 20:12 <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
<I>difexacaw пишет: Ну а почему тогда не описали суть, сделать ясным и понятным понимание, а обсуждать какие то мутные и не понятные вещи.. </I><br><br>Наверное потому что выше нет уверенности в том, как именно все детектится, поэтому и нужен очищенный лог вызовов, дабы выделить проблему, а после уже думать, как ее решить, вот как раз годный тест для визора, снять лог и отфильтровать от мусора. Вот это собственно и обсуждается, сталкивался ли кто то с подобной проблемой. У меня нет файлов которые можно изучать, а ковыряться в многомегабайтном софте нет особого желания.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380104&amp;user=41575&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=17" class="addthx" data-post="380104"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 20:31 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
<b>shellstorm</b><br><br>Не вижу никаких не знакомых сервисов и есчо каких то вещей. Пусть сформулируют свой вопрос нормально. Упомянули какие то апи не ясно зачем, куда и зачем смотреть на их имплементацию, если нет задачи ?)<br><br>А ядерную фильтрацию - забудьте про это, не тот уровень задачи, что бы лезть в ядро и небыло бы решения в юм.<br><br>Короче учиться формулировать свои мысли.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380107&amp;user=40990&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=18" class="addthx" data-post="380107"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 20:38 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
<I>difexacaw пишет:<br>какие то мутные и не понятные вещи...мотор... есть <u>множество методов</u> и <u>реализаций</u>, которые отлично проработаны и <u>решают задачу</u>!</I><br>Обычный четверг, обычный пост Инди строго по шаблону...<br>Помог бы &quot;знающим&quot; товарищам, кинул бы парочку конкретных из этих &quot;множества методов&quot;, а лучше сразу &quot;реализаций&quot;. И себе лойсов заработаешь и людям приятно, по быстрому заштопаем Scyll-ку и пойдем по домам ;)<br>Если тут все начнут одними туманными неопределенностями изъяснятся, будет вообще край, итак хрустальные шары далеко не уберешь, еще и ваши &quot;сущности в виде гномика&quot; там высматривать xD<br><br>Про трассы и в часности сисколы мы тут буквально недавно же общались (не помню где, помню что оффтопом), там и упоминания инструментов есть, емнип вмпрот особо не сопротивлялся (без доп оберток вокруг себя), все системные вызовы писались.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380108&amp;user=5846&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=19" class="addthx" data-post="380108"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Psalmopoeus Pulcher[/b]','')">Psalmopoeus Pulcher</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.8 (посетитель), 23thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 20:45 <br><script type="text/javascript">QU('Psalmopoeus Pulcher','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Psalmopoeus Pulcher" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<b>shellstorm</b>, на прошлой странице Jaa привел <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=0#27" rel="nofollow" target="_blank">пример</a></noindex>.<br>Конкретно, детекты не покрываемые сциллой:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00C01157</span>&nbsp;&nbsp;<span class="hl_function"><b>SYSENTER</b></span>&nbsp;<span class="hl_comment">;для х32</span></li>        </ol>
    </div>
</div></div>
<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00D5891F</span>&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_function"><b>FAR</b></span>&nbsp;<span class="hl_number">0033</span><span class="hl_char">:</span><span class="hl_number">00D2B073</span>&nbsp;<span class="hl_comment">;смена режима для WOW64</span></li>        </ol>
    </div>
</div></div>
<br><br>х64 код тоже под вм, его я не смотрел, но по всем признакам - дальше syscall. Про GetProcessWindowStation и GetUserObjectInformation пока забудьте, как они используются, похоже, никто еще видел из-за невозможности это нормально отладить.<br><br><I>difexacaw пишет:<br>Не вижу никаких не знакомых сервисов и есчо каких то вещей. </I><br>Нигде не вижу ни слова о чем то необычном, речь все о том же CheckRemoteDebuggerPresent, только вызов ядерного сервиса идет минуя прослойку винапи, исполнением syscall где то в недрах аппликухи со скрытого в вм места, без возможности быстро его перехватить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380110&amp;user=18297&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=20" class="addthx" data-post="380110"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 20:45 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>Я ведь уточнил суть вопроса, для того, чтобы на него ответить. Вы же мне обьясняете про туманность&quot;, я это понимаю и сказал выше.<br><br>Так просто между делом - вы никак меня не переубедите; человек должен иметь мотивацию и проходить путь решения от меньшего знания к большему и не нужно трогать большие методы/знания не понимая меньших.<br><br><b>Добавлено спустя 11 минут</b><br><b>Psalmopoeus Pulcher</b><br><br>Давайте углубимся в тех детали.<br><br>Вы приводите два сервисных шлюза для разных юм архитектур, без указания сервисного номера. Какой в этом смысл, ну есть шлюз и что дальше ?<br><br>GetProcessWindowStation() обычный сервис гуя, не понимаю о чём вы говорите.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380111&amp;user=40990&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=21" class="addthx" data-post="380111"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 20:56 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#22');return false;">#22</a> </span><div align=left><br>
<I>Psalmopoeus Pulcher пишет:<br>Конкретно, детекты не покрываемые сциллой</I><br>так и дровины не помогают, в частности стронг, всё равно детект \
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380113&amp;user=18316&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=22" class="addthx" data-post="380113"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 20:58 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#23');return false;">#23</a> </span><div align=left><br>
<b>difexacaw</b><br>Бесспорно, но слишком много методологизма тоже не всегда нужно, если задача доехать в другой район, конечно можно начать с изучения принципа работы двигателя внутреннего сгорания и всех остальных агрегатов авто, но для решения задачи достаточно просто уметь водить... избыточность такая избыточность. <br><I>Соломон пишет:<br>От многой мудрости много скорби, и умножающий знание умножает печаль </I><br>зачем нам лишние печальки? <img src="img/smilies/s1.gif" alt=""> <br><br><I>SReg пишет:<br>в частности стронг </I><br>он же не охватывает все новые фичи, может в связке смогет?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380114&amp;user=5846&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=23" class="addthx" data-post="380114"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 21:08 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#24');return false;">#24</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>Я мог бы привести пример, но данный форумный двиг не может показать мой лог по аттачам. Это уже обсуждалось, критерий поиска я не могу составить. Это недостаток скрипта, давно нужно было обновить. Так что ищите сами, проще наверное гуглом будет.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380116&amp;user=40990&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=24" class="addthx" data-post="380116"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]shellstorm[/b]','')">shellstorm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: -0.7 (гость), 170thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.68'>Активность: 0.54<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41575">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 21:22 &middot; Поправил: shellstorm <br><script type="text/javascript">QU('shellstorm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=shellstorm" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#25');return false;">#25</a> </span><div align=left><br>
<I>Psalmopoeus Pulcher пишет: х64 код тоже под вм, его я не смотрел, но по всем признакам - дальше syscall </I><br><br>Без файла и особых раздумий самый простой вариант это собрать вызовы сисколов в dbi (pin,dmr, практически готовый тул есть в сеплах), запилить небольшой плагин в который собственно загружать этот лог в отладчик и обрабатывать вызовы, вариант конечно дубовый, но для использования &quot;от случая к случаю&quot; вполне рабочий.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380117&amp;user=41575&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=25" class="addthx" data-post="380117"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 ноября 2017 21:53 &middot; Поправил: VOLKOFF <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#26');return false;">#26</a> </span><div align=left><br>
Вот кстати <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=17835&amp;page=3#14" rel="nofollow" target="_blank">--&gt; про dbi &lt;--</a></noindex><br><br>Трейсеры от Dr. Memory готовые бинари кстати под обе архитектуры. Я в &quot;простых случаях&quot; их все время юзаю слету так - в папке bin лежит батник (если сами положите <img src="img/smilies/s1.gif" alt=""> ):<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">@cd&nbsp;<span class="hl_char">/</span>d&nbsp;<span class="hl_quote">&quot;%~dp1&quot;</span></li><li class="hl_l1"><span class="hl_quote">@&quot;%~dp0drstrace.exe&quot;</span>&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;<span class="hl_quote">&quot;%~1&quot;</span></li>        </ol>
    </div>
</div></div>
<br>Дропаешь на него ехе и... собственно все <img src="img/smilies/s6.gif" alt=""><br>Лог сохраняется рядом с файлом.<br><br>Для Code Coverage соответственно:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">cd&nbsp;<span class="hl_char">/</span>d&nbsp;<span class="hl_quote">&quot;%~dp1&quot;</span></li><li class="hl_l1"><span class="hl_quote">@&quot;%~dp0drrun.exe&quot;</span>&nbsp;<span class="hl_char">-</span>t&nbsp;drcov&nbsp;<span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;<span class="hl_quote">&quot;%~1&quot;</span></li>        </ol>
    </div>
</div></div>
<br>сырой файл кормим иде, или конвертим в читаемый вид для разбора ручками.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380118&amp;user=5846&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=26" class="addthx" data-post="380118"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2017 03:13 &middot; Поправил: Bronco <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#27');return false;">#27</a> </span><div align=left><br>
<I>shellstorm пишет:<br>потому что выше нет уверенности в том, как именно все детектится </I><br>+1.<br>погружение в контекст вм дерьмопрота, оставлю великим. пока довольствуюсь малым - передачей управления.<br>Последовательность вызовов, аргументы для них, и что возвращают, выложил. текста не много, хз где товариЩь, алогизмы увидел. Хуки на месте, воркают корректно, но пока сцилка в ауте.<br><I>Psalmopoeus Pulcher пишет:<br>Про GetProcessWindowStation и GetUserObjectInformation пока забудьте </I><br>согласен, тут я поспешил, указатель на строку &quot;бла-бла&quot; в стеке и декриптовка текста для мсг, идёт после сискола  NtQueryInformationProcess( вызов из кода вм)
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380119&amp;user=3230&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=27" class="addthx" data-post="380119"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 ноября 2017 05:34 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#28');return false;">#28</a> </span><div align=left><br>
<noindex><a href="https://github.com/x64dbg/ScyllaHide/releases/tag/snapshot" rel="nofollow" target="_blank">--&gt; ScyllaHide_2017-11-09_21-00 &lt;--</a></noindex><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">HookHelper&nbsp;fixes<span class="hl_char">/</span>cleanup<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;Remove&nbsp;_wcslen<span class="hl_char">,</span>&nbsp;_strlen&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;_wcscat&nbsp;which&nbsp;are&nbsp;already&nbsp;provided&nbsp;as&nbsp;compiler&nbsp;intrinsics&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;as&nbsp;ntdll&nbsp;exports</li><li class="hl_l0"><span class="hl_char">-</span>&nbsp;wcsistr&nbsp;<span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_char">:</span>&nbsp;fix&nbsp;off<span class="hl_char">-</span>by<span class="hl_char">-</span>one&nbsp;error&nbsp;by&nbsp;changing&nbsp;<span class="hl_char">&lt;</span>&nbsp;to&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">=</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;remove&nbsp;<span class="hl_quote">'if (l1 == l2)'</span>&nbsp;check&nbsp;because&nbsp;the&nbsp;for&nbsp;<span class="hl_function"><b>loop</b></span>&nbsp;already&nbsp;does&nbsp;the&nbsp;same&nbsp;thing</li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;wcsistr&nbsp;<span class="hl_char">(</span><span class="hl_number">2</span><span class="hl_char">)</span><span class="hl_char">:</span>&nbsp;fix&nbsp;bug&nbsp;introduced&nbsp;by&nbsp;me&nbsp;causing&nbsp;wcsistr<span class="hl_char">(</span><span class="hl_quote">L&quot;asdf&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">L&quot;asd&quot;</span><span class="hl_char">)</span>&nbsp;to&nbsp;return&nbsp;<span class="hl_function">false</span><span class="hl_char">.</span>&nbsp;Now&nbsp;we're back to using _wcsicmp and _wcsnicmp together</li><li class="hl_l0"><span class="hl_char">-</span>&nbsp;Misc&nbsp;dead&nbsp;<span class="hl_function"><b>code</b></span>&nbsp;removal<span class="hl_char">/</span>variable&nbsp;naming</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">IsProcessBad<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">:</span>&nbsp;we&nbsp;already&nbsp;have&nbsp;a&nbsp;length&nbsp;counted&nbsp;string<span class="hl_char">.</span>&nbsp;No&nbsp;need&nbsp;to&nbsp;throw&nbsp;away&nbsp;the&nbsp;length<span class="hl_char">,</span>&nbsp;allocate&nbsp;<span class="hl_number">800</span>&nbsp;bytes<span class="hl_char">,</span>&nbsp;zero&nbsp;them<span class="hl_char">,</span>&nbsp;copy&nbsp;the&nbsp;string<span class="hl_char">,</span>&nbsp;then&nbsp;do&nbsp;an&nbsp;equality&nbsp;comparison&nbsp;which&nbsp;requires&nbsp;length&nbsp;counting&nbsp;anyway<span class="hl_char">.</span>&nbsp;Instead&nbsp;just&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;RtlEqualUnicodeString</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">IsWindowClassBad&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;IsWindowNameBad&nbsp;still&nbsp;require&nbsp;<span class="hl_quote">'wcsistr'</span><span class="hl_char">.</span>&nbsp;Added&nbsp;TODO&nbsp;note&nbsp;to&nbsp;wcsistr&nbsp;to&nbsp;rename&nbsp;it&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;make&nbsp;it&nbsp;take&nbsp;a&nbsp;PUNICODE_STRING&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;order&nbsp;to&nbsp;increase&nbsp;sanity&nbsp;levels</li><li class="hl_l1">ScyllaTest<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;FreeConsole&nbsp;before&nbsp;exiting</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>Add</b></span>&nbsp;IDA&nbsp;<span class="hl_number">7</span><span class="hl_char">.</span><span class="hl_number">0</span>&nbsp;process&nbsp;names<span class="hl_char">.</span>&nbsp;You're welcome Hex-Rays SA</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380121&amp;user=5846&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=28" class="addthx" data-post="380121"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]just_simple[/b]','')">just_simple</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.69'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41557">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2017 21:11 &middot; Поправил: just_simple <br><script type="text/javascript">QU('just_simple','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=just_simple" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#29');return false;">#29</a> </span><div align=left><br>
<I>shellstorm пишет:<br>суть вопроса в том, как этот засранец отлавливает факт отладки </I><br>Выбирать особо не из чего, ZwQueryInformationProcess(ProcessDebugObjectHandle/ProcessDebugPort) + ZwClose + флаги в пебе
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=380135&amp;user=41557&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=29" class="addthx" data-post="380135"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 ноября 2017 21:52 &middot; Поправил: Bronco <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#30');return false;">#30</a> </span><div align=left><br>
<I>just_simple пишет:<br>Выбирать особо не из чего </I><br>хз хз...указатель в стеке, на переменную строки мсгбокс (сама стр, ещё отсутствует), появляется после вызова GetModuleHandleA. Функу, юзают 2 раза, с указателями на стр библ kernel32.dll и ntdll.dll. После каждого вызова GetModuleHandleA, стандартная проверка хидера (этот участок слегка обфусцирован), и....дальше после этой проверки,  нудно_цикличное сравнение адресов стека, с переходом на мясцо по примитивам.<br>С диска библы не грузит, значит checksum не проверяют, но правку прологов в библах, на предмет хуков, скорее всего палят  <br>отдельно ProcessDebugPort не проверяют, для этого юзают CheckRemoteDebuggerPresent.(стоит хук сцилки)<br>ProcessDebugObjectHandle проверяют при вызове NtQueryInformationProcess напрямую,  ретурн тут поправить ручками можно, но эффекта от этого нет.<br>Остаётся только снять все хуки, и шагать в &quot;ручном режиме&quot;.<img src="img/smilies/s13.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380136&amp;user=3230&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=30" class="addthx" data-post="380136"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 ноября 2017 02:28 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=24789&amp;page=1#31');return false;">#31</a> </span><div align=left><br>
<b>ScyllaHide_2017-11-11_23-29</b><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Change&nbsp;wcsistr&nbsp;to&nbsp;RtlUnicodeStringContains&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;make&nbsp;IsWindow<span class="hl_char">[</span>Class<span class="hl_char">]</span>NameBad&nbsp;use&nbsp;<span class="hl_function"><b>this</b></span>&nbsp;to&nbsp;save&nbsp;pointless&nbsp;string&nbsp;copying</li><li class="hl_l1">GetExplorerProcessId<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;really&nbsp;only&nbsp;has&nbsp;to&nbsp;exist&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;one&nbsp;place</li><li class="hl_l0">The&nbsp;<span class="hl_function"><b>code</b></span>&nbsp;was&nbsp;dead</li>        </ol>
    </div>
</div></div>
<br><br><b>ScyllaHide_2017-11-12_03-05</b><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">NtQuerySystemInformation<span class="hl_char">(</span>SystemHandleInformation<span class="hl_char">/</span>SystemExtendedHandleInformation<span class="hl_char">)</span><span class="hl_char">:</span>&nbsp;more&nbsp;return&nbsp;length&nbsp;bookkeeping</li><li class="hl_l1">NtQueryObject&nbsp;hook<span class="hl_char">:</span>&nbsp;only&nbsp;set&nbsp;the&nbsp;total&nbsp;object&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;handle&nbsp;counts&nbsp;to&nbsp;<span class="hl_number">0</span>&nbsp;for&nbsp;ObjectTypesInformation<span class="hl_char">,</span>&nbsp;decrement&nbsp;by&nbsp;<span class="hl_number">1</span>&nbsp;for&nbsp;ObjectTypeInformation</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>This</b></span>&nbsp;prevents&nbsp;the&nbsp;debuggee&nbsp;from&nbsp;doing</li><li class="hl_l0">NtCreateDebugObject<span class="hl_char">(</span><span class="hl_char">&amp;</span>h<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">NtQueryObject<span class="hl_char">(</span>h<span class="hl_char">,</span>&nbsp;ObjectTypeInformation<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>TotalNumberOfObjects&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;{&nbsp;<span class="hl_char">/</span><span class="hl_char">*</span>&nbsp;something&nbsp;is&nbsp;wrong&nbsp;since&nbsp;we&nbsp;just&nbsp;made&nbsp;a&nbsp;debug&nbsp;object&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span>&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Found&nbsp;by&nbsp;<span class="hl_registr">Al</span><span class="hl_char">-</span>Khaser&nbsp;<span class="hl_char">(</span>https<span class="hl_char">:</span><span class="hl_char">/</span><span class="hl_char">/</span>github<span class="hl_char">.</span>com<span class="hl_char">/</span>LordNoteworthy<span class="hl_char">/</span><span class="hl_registr">al</span><span class="hl_char">-</span>khaser<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=380141&amp;user=5846&amp;forum_n=3&amp;topic=24789&amp;page=1&amp;anchor=31" class="addthx" data-post="380141"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=0.html">1</a> . <b>2</b> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=3&amp;topic=24789&amp;page=2.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/default.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=3&sortBy=0&page=0.html"><b>Софт, инструменты</b></a> <b class=bulletHead>&#8212;&#8250;</b> ScyllaHide</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="3">
<input type="hidden" name="topic" value="24789">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24789" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
