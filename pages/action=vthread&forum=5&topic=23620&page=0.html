<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как работают прослойки для системных библиотек - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Приветствую. Поясните, пожалуйста, один момент. Я отлаживаю приложение в OllyDbg на Windows 8. Предположим, мне захотелось поставить бряк на WinAPI-функциях HeapAlloc и HeapFree, которые, согласно документации на MSDN, лежат в">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=42860'>igorcauret</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как работают прослойки для системных библиотек</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2015 16:39 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Приветствую.<br><br>Поясните, пожалуйста, один момент.<br><br>Я отлаживаю приложение в OllyDbg на Windows 8. Предположим, мне захотелось поставить бряк на WinAPI-функциях HeapAlloc и HeapFree, которые, согласно документации на MSDN, лежат в kernel32.dll. Я переключаюсь на этот модуль в OllyDbg, нажимаю Ctrl-N, пишу HeapFree и вижу:<br><br>Names in KERNEL32, item 1188<br> Address=75FF502E<br> Section=.text<br> Type=Export  (Known)<br> Name=HeapFree<br><br>Names in KERNEL32, item 1189<br> Address=76050484<br> Section=.rdata<br> Type=Import<br> Name=api-ms-win-core-heap-l1-2-0.HeapFree<br><br>Функция импортируется из &quot;api-ms-win-core-heap-l1-2-0&quot; и разрешает экспортировать себя, ссылаясь на адрес 0x75FF502E. Насколько я понял из статьи на MSDN (https://msdn.microsoft.com/en-us/library/windows/desktop/dn505783(v=vs.85).aspx), kernel32.dll и другие системные библиотеки на современных версиях Windows -- это всего лишь прослойка, которая только импортирует необходимые функции из &quot;реальной&quot; DLL и позволяет экспортировать их, верно? Если это действительно так, то у меня возникают сразу несколько вопросов:<br><br>- Почему некоторые WinAPI-функции (например, HeapAlloc в моём случае), если верить тому, что показывает OllyDbg, импортируются из &quot;реальной&quot; DLL (&quot;api-ms-win-core-heap-l1-2-0&quot;), но не позволяют себя экспортировать, т.е. строчки с экспортом этой функции в kernel32.dll просто нет:<br><br>Names in KERNEL32, item 1181<br> Address=76050480<br> Section=.rdata<br> Type=Import<br> Name=api-ms-win-core-heap-l1-2-0.HeapAlloc<br><br>- Почему эти &quot;реальные&quot; DLL не загружаются в адресное пространство исследуемого процесса? Об этом я сужу из-за отсутствия в списке Executable Modules (Alt-E) той же &quot;api-ms-win-core-heap-l1-2-0&quot;<br>- Для чего вообще это всё было сделано? На MSDN сказано, что &quot;The decoupling between implementation and interface contracts provided by API Sets offers many engineering advantages, but can also potentially reduce the number of DLLs loaded in a process&quot;, но я, честно говоря, не понимаю, как это может уменьшить кол-во DLL, загружаемых в процесс, ведь некоторые функции, реализации которых раньше находилась в одной и той же DLL, теперь находятся в совершенно разных библиотеках (например, Beep и HeapAlloc, обе из которых раньше находились в kernel32.dll, теперь находятся в api-ms-win-core-util-l1-1-0.dll и api-ms-win-core-heap-l1-2-0.dll соответственно). Или, может, имелся ввиду меньший объём загружаемых DLL, если нужна лишь часть функционала какой-то из них? Но ведь это же системные библиотеки, так что говорить об этом как-то глупо, по-моему.<br><br>В общем, зачем это было сделано? Как это работает и какую проблему это решает? Почему та же HeapAlloc не экспортируется из kernel32.dll в моём случае и как мне в итоге поставить бряк на эту функцию?<br><br>Заранее благодарю за возможные ответы.<br><br><b>Добавлено спустя 22 минуты</b><br>По поводу того, почему эти библиотеки не отображаются в списке Executable Modules в OllyDbg, сказано вот тут -- http://www.nirsoft.net/articles/windows_7_kernel_architecture_changes.html<br><br>By looking in dependency walker utility, we can see that advapi32.dll, kernel32.dll, and other system dll files, are now <b>statically</b> linked to these empty api-ms-win-core files<br><br>А вот в связи с этой фразой из той же статьи, я окончательно запутался, зачем это нужно:<br><br>So here&#039;s our RegDeleteValueW example again: when loading a program into WinDbg, we can see that the jmp call now points to kernel32!RegDeleteValueW function. That&#039;s because during the loading of advapi32.dll, Windows automatically replace the import entry of API-MS-Win-Core-LocalRegistry-L1-1-0.RegDeleteValueW to the function address of RegDeleteValueW in kernel32<br><br>Получается, что вызов HeapFree из kernel32.dll, который был JMP&#039;ом на функцию HeapFree, импортируемую из api-ms-win-core-heap-l1-2-0.dll, заменится в итоге вызовом той же самой функции из той же kernel32.dll? Что-то я не понял.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356206&amp;user=37421&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=1" class="addthx" data-post="356206"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2015 18:59 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
просто смените OS для дебага и не парьтесь. или читайте много мануалов <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356252&amp;user=8830&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=2" class="addthx" data-post="356252"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2015 19:05 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Современный софт уже далеко не всегда поддерживает старые версии Windows, так что разбираться всё же придётся. Может, посоветуете что-нибудь ещё или подскажете, в какую сторону копать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356253&amp;user=37421&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=3" class="addthx" data-post="356253"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2015 22:42 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>b0r3d0m</b> подумайте об обратной совместимости... винда уже разбухла в попытке усидеть на даже не на 2ух.. на всех стульях. либы становятся прослойками для совместимости раз.. и от части, что в мелкософте уже нет людей которые знают как работает сама их ось, поэтому крайне осторожно трогают кернельные либы
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356260&amp;user=17319&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=4" class="addthx" data-post="356260"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2015 22:56 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>VodoleY пишет:<br>подумайте об обратной совместимости </I><br>Обратной совместимости чего и с чем? Функций из kernel32.dll с другими версиями ОС? Если да, то что мешает, как и раньше, просто редактировать их код, не создавая никаких дополнительных прослоек?<br><br><I>VodoleY пишет:<br>и от части, что в мелкософте уже нет людей которые знают как работает сама их ось, поэтому крайне осторожно трогают кернельные либы  </I><br>Они лишь увеличили кол-во абстракций, но в случае необходимости изменить поведение той или иной функции они всё равно будут вынуждены залезть в недра той или иной библиотеки, а там уже какая разница, что именно это будет -- kernel32.dll, kernelbase.dll или какая-то api-ms-win-core-* библиотека?<br><br>И да, сможете ответить на остальные вопросы, пожалуйста?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356264&amp;user=37421&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=5" class="addthx" data-post="356264"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]hello[/b]','')">hello</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 20.4 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.25'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37163">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2015 23:06 <br><script type="text/javascript">QU('hello','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hello" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>b0r3d0m</b><br>Помоему, самое простое обьяснение: Microsoft занимается откровенной фигней. Чем больше библиотек - тем создается видимость мощного и профессионального продукта. Эдак антивирус Бабушкина.<img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356266&amp;user=37163&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=6" class="addthx" data-post="356266"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2015 23:06 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>И да, сможете ответить на остальные вопросы, пожалуйста?  </I><br><br>Вероятно, пытаются оптимизирвать совместное использовавние библиотек<br><br><I>hello пишет:<br>Помоему, самое простое обьяснение: Microsoft занимается откровенной фигней. </I><br><br>Тоже вариант<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356267&amp;user=35473&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=7" class="addthx" data-post="356267"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июня 2015 23:10 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>dosprog пишет:<br>Вероятно, пытаются оптимизирвать совместное использовавние библиотек  </I><br>Каким образом? Что так они мапились, что так -- не вижу разницы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356269&amp;user=37421&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=8" class="addthx" data-post="356269"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 05:50 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>b0r3d0m</b> ну вот смотрите.. допустим.. есть вин2к с отлтаженным кернел32.. отладка и выкусывание глюков длилось лет 5... обьем кода в нем немалый.. вы выпускаете новую версию ОС.. и вам нужны новые фишки. у вас есть 2 варианта либо добавить в старый кернел новые функи (тогда есть шанс добавить глюков, а изза все увеличивающегося обьема тестить ее все сложнее и сложнее.. типа.. убираем старые глюки добавляем новые) или вариант 2. сделать враперную либу, которая будет иметь только новые функи, а остальные вызывать из уже стабильной либы.
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356298&amp;user=17319&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=9" class="addthx" data-post="356298"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 09:18 &middot; Поправил: b0r3d0m <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>VodoleY пишет:<br>а изза все увеличивающегося обьема тестить ее все сложнее и сложнее </I><br>Почему? Тестируются же конкретные функции, которые доступны через отдельные точки входа. Какая разница, какой суммарный объём у DLL?<br><br><I>VodoleY пишет:<br>сделать враперную либу, которая будет иметь только новые функи, а остальные вызывать из уже стабильной либы </I><br>Тут вообще всё очень не просто как-то. Та же CreateFileA изначально экспортируется наружу их kernel32.dll, однако если посмотреть на её реализацию, то мы увидим JMP на api-ms-win-core-*, который ОС автоматически заменила на прыжок в kernelbase.dll. Зачем <b>такие</b> сложности? Почему, допустим, не прыгать сразу в kernelbase.dll? К чему вот это всё:<br><br>&gt; So here&#039;s our RegDeleteValueW example again: when loading a program into WinDbg, we can see that the jmp call now points to kernel32!RegDeleteValueW function. That&#039;s because during the loading of advapi32.dll, Windows automatically replace the import entry of API-MS-Win-Core-LocalRegistry-L1-1-0.RegDeleteValueW to the function address of RegDeleteValueW in kernel32
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356304&amp;user=37421&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=10" class="addthx" data-post="356304"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 10:43 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Старые либы оставили для совместимости. А новую прослойку ввели для унификации работы на других платформах, в той же 10 они через пень-колоду пришли к максимальному использованию общего кода на разных платформах.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356307&amp;user=1556&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=11" class="addthx" data-post="356307"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=37421" title="18-06-2015 08:15, ранг:7.1" target="_blank">b0r3d0m</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 11:15 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Archer пишет:<br>Старые либы оставили для совместимости. А новую прослойку ввели для унификации работы на других платформах, в той же 10 они через пень-колоду пришли к максимальному использованию общего кода на разных платформах.  </I><br>Хорошо, спасибо.<br><br>А что по поводу вот этого вопроса:<br>&gt; Почему некоторые WinAPI-функции (например, HeapAlloc в моём случае), если верить тому, что показывает OllyDbg, импортируются из &quot;реальной&quot; DLL (&quot;api-ms-win-core-heap-l1-2-0&quot;), но не позволяют себя экспортировать, т.е. строчки с экспортом этой функции в kernel32.dll просто нет:<br><br>Names in KERNEL32, item 1181<br>Address=76050480<br>Section=.rdata<br>Type=Import<br>Name=api-ms-win-core-heap-l1-2-0.HeapAlloc
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356310&amp;user=37421&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=12" class="addthx" data-post="356310"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 12:05 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Во-первых, она есть в экспорте kernel32.dll, а во-вторых, там форвардинг в NTDLL.RtlAllocateHeap.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356315&amp;user=1556&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=13" class="addthx" data-post="356315"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 12:12 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>Archer пишет:<br>Во-первых, она есть в экспорте kernel32.dll, а во-вторых, там форвардинг в NTDLL.RtlAllocateHeap.  </I><br><img src="http://i.imgur.com/dfTLd3t.png" border="0" align="" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356318&amp;user=37421&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=14" class="addthx" data-post="356318"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 12:29 &middot; Поправил: ClockMan <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>b0r3d0m</b>Во первых разберитесь что такое таблица экспорта и как она работает, и что такое форвардинг,зайдите в таблицу экспорта kernel32.dll и по поиску найдите NTDLL.RtlAllocateHeap......
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356319&amp;user=17432&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=15" class="addthx" data-post="356319"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 16:18 &middot; Поправил: b0r3d0m <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>ClockMan пишет:<br>Во первых разберитесь что такое таблица экспорта и как она работает, и что такое форвардинг,зайдите в таблицу экспорта kernel32.dll и по поиску найдите NTDLL.RtlAllocateHeap......  </I><br>Таблица экспорта -- это раздел PE-файла, который содержит информацию о функциях, которые экспортируются из данного модуля.<br>Форвардинг -- это перенаправление экспорта в другую DLL.<br>Выполнил dumpbin /exports kernel32.dll и увидел, помимо всего прочего, следующее:<br><br>847  34D          HeapAlloc (forwarded to NTDLL.RtlAllocateHeap)<br><br>Но как я мог это увидеть в OllyDbg? И что в итоге делать с бряком? Просто поставить его на RtlAllocateHeap?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356337&amp;user=37421&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=16" class="addthx" data-post="356337"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]kid[/b]','')">kid</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.2 (посетитель), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=27711">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 16:38 <br><script type="text/javascript">QU('kid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kid" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>И что в итоге делать с бряком? </I><br>что мешает бряк на джамп поставить ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356338&amp;user=27711&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=17" class="addthx" data-post="356338"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 17:01 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>kid пишет:<br>что мешает бряк на джамп поставить ?  </I><br>На какой JMP? Я вообще не вижу никакой информации об экспорте HeapAlloc в OllyDbg (см. скриншот, приведённый ранее).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356341&amp;user=37421&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=18" class="addthx" data-post="356341"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]kid[/b]','')">kid</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.2 (посетитель), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.46'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=27711">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 17:10 &middot; Поправил: kid <br><script type="text/javascript">QU('kid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kid" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Ctrl+G -&gt; HeapAlloc<br><br><br>ЗЫ: Это попытка отладить kernel32.dll ? <br>тогда читайте форвардинг как сказали выше.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356342&amp;user=27711&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=19" class="addthx" data-post="356342"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 17:18 &middot; Поправил: ClockMan <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>b0r3d0m пишет:<br>Но как я мог это увидеть в OllyDbg? </I><br>Ни как, только ида покажет это<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">LPVOID&nbsp;__stdcall&nbsp;HeapAlloc<span class="hl_char">(</span>HANDLE&nbsp;hHeap<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwFlags<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;dwBytes<span class="hl_char">)</span></li><li class="hl_l1">HeapAlloc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_quote">'NTDLL.RtlAllocateHeap'</span><span class="hl_char">,</span><span class="hl_number">0</span>&nbsp;<span class="hl_comment">; DATA XREF: .text:off_7C802654o</span></li>        </ol>
    </div>
</div></div>
<br><I>b0r3d0m пишет:<br>И что в итоге делать с бряком? Просто поставить его на RtlAllocateHeap </I><br>да
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=356343&amp;user=17432&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=20" class="addthx" data-post="356343"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]b0r3d0m[/b]','')">b0r3d0m</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.7 (новичок), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.14'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=37421">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2015 17:34 <br><script type="text/javascript">QU('b0r3d0m','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=b0r3d0m" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23620.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>kid пишет:<br>Ctrl+G -&gt; HeapAlloc </I><br>В kernel32.dll? &quot;Unknown identifier&quot;.<br><br><I>kid пишет:<br>Это попытка отладить kernel32.dll ?  </I><br>Нет, я пытался поставить бряки на вызовах HeapAlloc в исследуемом приложении, однако в процессе обнаружил, что данной функции нет в списке &quot;Intermodular calls&quot;. В связи с этим я решил поставить бряк на саму реализацию функции HeapAlloc и не обнаружил экспорта в kernel32.dll, из-за чего и возник данный вопрос.<br><br><I>ClockMan пишет:<br>да  </I><br>Хорошо, спасибо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=356344&amp;user=37421&amp;forum_n=5&amp;topic=23620.html&amp;page=0&amp;anchor=21" class="addthx" data-post="356344"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как работают прослойки для системных библиотек</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#22" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="23620">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23620" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
