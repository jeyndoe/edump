<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Декомпилятор ВМ - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Вашему вниманию предлагаются наработки по декомпиляции ВМ. Проект на сегодняшний день для меня завершен, но жаль если результат &quot;ляжет на полку&quot;, может кому-нибудь и пригодится. Предлагаю сначала ознакомиться с обзором,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Декомпилятор ВМ</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=2.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=2.html">3</a> . <b>4</b> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=7.html">8</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=22.html">23</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=23.html">24</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=4.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 12:33 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#1');return false;">#1</a> </span><div align=left><br>
Вашему вниманию предлагаются наработки по декомпиляции ВМ.<br>Проект на сегодняшний день для меня завершен, но жаль если результат &quot;ляжет на полку&quot;, может кому-нибудь и пригодится. Предлагаю сначала ознакомиться с обзором, и если будет интерес то могу выложить и сам плагин, или здесь или в личку заинтересованным лицам, каким образом, пока ещё не решил...<br>Но если кто-либо ожидает увидеть &quot;автоматическое чудо&quot;, то сразу скажу - его нет. Для того чтобы получить результат нужна ручная предварительная работа:<br>- с исследуемой программы должна быть снята упаковка<br>- точки входа в ВМ находятся вручную<br>- возможно неоднократное &quot;жамкание&quot; клавиш в OllyDbg, а возможно и модификация кода, чтобы попасть в нужное место, в зависимости от защищенной функции<br>- необходимо вручную прицепить к программе требуемый секцию<br>- запись результатов в файл это тоже ручная работа, но уже более приятная<br><br>Не всё гладко обстоит с определением реализаций ВМ, на сегодняшний день примерно каждая третья реализация автоматом не определяется, приходится под неё модернизировать плагин, т.к. не могу сразу предусмотреть все случаи &quot;издевательств&quot; ВМ с кодом примитивов. Лучше дела с восстановлением &quot;исходного&quot; кода защищенных функций - 70% нормально восстанавливается, хотя во многом это зависит от самой структуры функции. Таким образом, если будет заинтересованность и помощь в нахождении подобных ситуаций, то проект может быть доведен до релизной стадии.<br><br>ЗЫ: Речь идет об <i class=x>Ореановских</i> машинах. Нигде специально не упоминал.<br><br><img src="img/attach.gif" alt=""> <a href="./files/9c41_03.03.2010_CRACKLAB.rU.tgz">9c41_03.03.2010_CRACKLAB.rU.tgz</a> - VMSweeperLst.rar
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253056&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=1" class="addthx" data-post="253056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]V0ldemAr[/b]','')">V0ldemAr</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 65.4 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=68">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2010 20:58 &middot; Поправил: V0ldemAr <br><script type="text/javascript">QU('V0ldemAr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=V0ldemAr" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#2');return false;">#2</a> </span><div align=left><br>
<I>progopis пишет:<br>Обрадую вас, в вмпротект нет условных переходов, вообще. </I><br><strike>А как тогда обрабатываются jcc?</strike><br>Извиняюсь херню написал плохо прочитал уставшый с работы...<br><br>Вопрос к тем кто следует вмпротект как часто изменяются обработчики от версии к версии?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255741&amp;user=68&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=2" class="addthx" data-post="255741"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 апреля 2010 21:08 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#3');return false;">#3</a> </span><div align=left><br>
Обработчики почти не меняются. Возможно добавляются новые, но я не слежу. Меняется довольно сильно CRC (или как некоторые называют его HASH), хотя общий смысл этой виртуальной инструкции ловится эвристикой. Также меняется обфускация, но она меняется с каждой новой компиляцией. Обфускация обработчиков довольно легко устраняется.<br><br>Jcc я пока не разбирал детально, но вроде анализ флагов через NOR и последующий JMP VM_ESP (mov     esi, [ebp+0], add     ebp, 4). Сейчас гляну и уточню, давно хотел.<br><br><I>V0ldemAr пишет:<br>Извиняюсь херню написал </I><br>Почему это? В обсиде, например, есть выделенная инструкция Jcc, она работает от параметра. В вмпротекте выделенной инструкции нет, поэтому вопрос вполне корректный.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255746&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=3" class="addthx" data-post="255746"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 апреля 2010 10:21 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#4');return false;">#4</a> </span><div align=left><br>
<I>progopis пишет:<br>Обрадую вас, в вмпротект нет условных переходов, вообще. Что будете делать? </I><br>Уважаемый <b>progopis</b>, всё что я писал в своем обзоре относится только к Ореановским ВМ (CodeVirtualizer в частности), на тот момент внутренности VMProtect&#039;а я и в глаза не видел, поэтому, когда увижу, тогда и скажу что делать и в каком случае. К сведению, в CV тоже нет условных переходов как таковых, но они есть в любом случае в защищаемой функции, и &quot;ветвление&quot; пикода будет и в ВМ. Всё, что есть обзоре - истина, если можете опровергнуть, то пожалуйста, аргументируйте, но не таким образом -  <I>Неверно </I>.<br><br><I>progopis пишет:<br>Вывод: с мат. частью проблемы. Хорошие идеи есть и их очень много, но не уверен, что идеи авторские. </I><br>Понимайте как хотите, но всё что сказано и сделано - это только моё, &quot;умных&quot; мат. книжек примерно лет 20 уже не читал, отсюда и вывод у вас может быть такой, я же скажу проще - мы говорим об одном и том же на разных языках, я на &quot;русском&quot;, вы на &quot;английском&quot;, суть от этого не меняется - меняется только понимание самой сути, но кто захочет понять - тому не важен язык на каком она изложена, если это ещё и подкреплено практическим исполнением. А идея декомпиляции ВМ появилась <noindex><a href="http://www.wasm.ru/forum/viewtopic.php?id=27828" rel="nofollow" target="_blank">отсюда</a></noindex>, если интересно, можете взглянуть, когда потребовалась практическая реализация устранения ВМ.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255768&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=4" class="addthx" data-post="255768"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 апреля 2010 12:13 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#5');return false;">#5</a> </span><div align=left><br>
Позвольте уточню. В вашей документации вы даёте чуть ли не определения понятий, при этом рассматривая их под призмой конкретной ВМ. Также вы пытаетесь сделать продукт универсальный сразу для всех широко применяемых типов ВМ, <b>отталкиваясь</b> от наработок по конкретной ВМ. И вот тут могут быть проблемы. Я тоже занимался сначала одной ВМ (и работу эту мы сделали до конца), рассчитывая создать базу для других ВМ. Но вот только зубы обломал. Движок оказался настолько не универсальным, что его пришлось переписывать чуть ли не с нуля. А всё потому, что сначала надо было ознакомиться с проблемой, изучить разные типы ВМ, а уже потом решать задачу.<br><br>&quot;ключом хэширования является адрес размещения пикода в памяти&quot; - вообще говоря ключом может быть всё, что угодно, а может и вообще ключ есть только на операнды<br>&quot;с созданием <b>сигнатурного</b> шаблона каждого примитива&quot; - либо проблема с определением, либо проблема с представлением о задаче, которая стоит, откройте Obsidium и поймёте о чём я говорю. Вы никогда не составите шаблоны для его КОПов ни в статике, ни в динамике. Если нужны подробности - в ЛС. Если вам вдруг потребуется работать с ВМ в ASProtect, StarForce, то там вы познакомитесь с работой настоящих профессионалов. И все методы сложите в коробочку.<br><br><I>Vamit пишет:<br>мы говорим об одном и том же </I><br>Не соглашусь с вами. Я не вижу причин делать динамику, вы же утверждаете что без этого вообще нельзя.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255772&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=5" class="addthx" data-post="255772"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]V0ldemAr[/b]','')">V0ldemAr</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 65.4 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=68">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 апреля 2010 15:24 <br><script type="text/javascript">QU('V0ldemAr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=V0ldemAr" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#6');return false;">#6</a> </span><div align=left><br>
Хм, а что ключь не меняется от обработчика к обработчику? т.е один ключ на всю таблицу? В нормальных ВМ(на примере солидшилда обработчиков там &gt;10тис) ключь изменяется и каждый опкод дешифруется уже с новым ключем... + алгоритмы дешифровки на каждый обработчик свои и они изменяются при каждой компиляции.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255790&amp;user=68&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=6" class="addthx" data-post="255790"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 апреля 2010 15:25 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#7');return false;">#7</a> </span><div align=left><br>
Весьма знакомые слова ))) Понятия некоторые самопальные, но это не призма ... Вамит прав , термины не играют особой роли , если понятно о чем речь. Нужную базу вамит тоже сделал , но в данном случае не все , из за нацеленности на определенный код, и это особо не проблема и код самодостаточен , что автор тоже указал. Дело не в ключе хэширования) ... это все хлам , ключи легко отсеять. Сигнатура понятие широкое .. и это комплекс методов ... а деление на блоки есть почти везде , это легло в основу еще в 60 ых ...<br><br>Как професионально снимать ВМ в ASProtect, StarForce ??? )))) Очень интересно! Главное чтоб после профессионалов все работало. Все эти методы нацелены только под конкретную цель и методы действительно другие , но тем не менее сравнивать нет смысла, по охвату на разные вм , методы предложенные от &quot;профессионалов&quot; не подойдут. Поэтому динамик нужен при 0 информации практически, а статик уже при имении чегонибудь, тем самым комбинируется методы. Пройдет время и это станет ясно как и с анализом всех вм , проанализировать которые весьма большая задача для одного человека , смотря для кого правда. О чем речь вообще ? Делает декомпиль и пусть делает , постоянно кто то отговаривает или какой то шлак ... Хотите помочь помогите ... Пол страницы о том что было весьма хорошо описано и зная это автор даже указал что во избежании флуда , код нацелен на то-то , то-то.<br><br>//И не надо опять говорить, что это лично моя к вам неприязнь. <br>Никогда не говорил так)) <br>//И вообще мои посты направлены автору, а не вам.<br>ок))
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255791&amp;user=3520&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=7" class="addthx" data-post="255791"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]progopis[/b]','')">progopis</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 апреля 2010 15:51 <br><script type="text/javascript">QU('progopis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=progopis" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#8');return false;">#8</a> </span><div align=left><br>
<I>V0ldemAr пишет:<br>а что ключь не меняется от обработчика к обработчику? </I><br>В вмпроте - да, в обсиде - нет, про продукты ореанс не знаю<br><br><I>V0ldemAr пишет:<br>ключ изменяется и каждый опкод дешифруется уже с новым ключем </I><br>не сказал чтобы это сильно крутая защита; в обсиде есть другая дурость - NOP-хендлеры, наверно специально на помощь тем, кто будет делать инлайн.<br><br><I>mak пишет:<br>Как професионально снимать ВМ в ASProtect, StarForce ??? </I><br>А вы хоть как-нибудь снимите, желательно чтобы работало. И читать вы не умеете, я лишь сказал, что сама ВМ делалась профессионалами (в отличие от того же вмпрота, старовцы не стремятся отгородиться от школьников), и тем не менее атаки уже на них есть, принцип &quot;взломать можно всё&quot; ещё никто не отменял. И вообще мои посты направлены автору, а не вам. Он уже что-то сделал, что-то работающее. От вас же только форум страдает бесполезными постами, такими как предыдущий. И не надо опять говорить, что это лично моя к вам неприязнь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255794&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=8" class="addthx" data-post="255794"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 апреля 2010 16:13 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#9');return false;">#9</a> </span><div align=left><br>
<I>V0ldemAr пишет:<br>В нормальных ВМ(на примере солидшилда обработчиков там &gt;10тис) ключь изменяется и каждый опкод дешифруется уже с новым ключем... + алгоритмы дешифровки на каждый обработчик свои и они изменяются при каждой компиляции.  </I><br>100% согласен, у Ореана аналогично, моя же фраза &quot;ключом хэширования является адрес размещения пикода в памяти&quot; означала, что <b>начальным ключом</b> или <b>инициализацией ключа</b> хэширования является адрес размещения пикода в памяти.<br><br><b>mak</b> и <b>progopis</b> Ребята, не надо ссориться, давайте жить дружно...  <img src="img/smilies/s1.gif" alt=""> Задача по декомпиляции ВМ нужная и не такая уж простая, поэтому для пользы дела не нужно нездоровой критики, типа кто и как в школе учился. Главное результат, а кто и как к нему пришел - в данном случае неважно.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255796&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=9" class="addthx" data-post="255796"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]V0ldemAr[/b]','')">V0ldemAr</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 65.4 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=68">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 апреля 2010 16:16 <br><script type="text/javascript">QU('V0ldemAr','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=V0ldemAr" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#10');return false;">#10</a> </span><div align=left><br>
<I>progopis пишет:<br>не сказал чтобы это сильно крутая защита; в обсиде есть другая дурость - NOP-хендлеры, наверно специально на помощь тем, кто будет делать инлайн. </I><br>Всеравно до конца ее еще никто пока не сломал... хотя обфускация там и слабая но вм думаю в вмпротекте слабее исходя из того что я прочитал на форуме... В солидшилде тоже есть НОП обработчики, думаю они просто как часть обфускации... но и без них можно заинлайнить...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255797&amp;user=68&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=10" class="addthx" data-post="255797"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 апреля 2010 17:03 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#11');return false;">#11</a> </span><div align=left><br>
<I>mak пишет:<br> Понятия некоторые самопальные </I><br>нормальные понятия, для понимания вполне доступные и во многом я бы отдал предпочтения им.<br>Потому, что понятия у других слишком ёмкие и обобщающие.
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255801&amp;user=3230&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=11" class="addthx" data-post="255801"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]kioresk[/b]','')">kioresk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/10650.gif" alt=""><br><span class=txtSm>Ранг: 154.2 (ветеран), 66thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10650">Участник</a><br><font color=blue>REVENGE Crew</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 апреля 2010 15:01 <br><script type="text/javascript">QU('kioresk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kioresk" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#12');return false;">#12</a> </span><div align=left><br>
<b>Vamit</b>,<br><br>поправь баг в «Analyze all VM references» — диалог не закрывается крестом.<br><br>Еще я бы добавил:<br><br>1. ограничение в адресах на 8 символов (тут все просто SendMessage c EM_LIMITTEXT)<br>2. ограничение в адресах на ввод только шестнадцатиричных значений (тут чуть положнее — либо 4 раза сабклассинг, либо 1 раз суперклассинг)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255835&amp;user=10650&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=12" class="addthx" data-post="255835"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 апреля 2010 16:38 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#13');return false;">#13</a> </span><div align=left><br>
<I>kioresk пишет:<br>поправь баг в «Analyze all VM references» — диалог не закрывается крестом. </I><br>Если это окошки для ввода адресов, то это не баг, а специально так сделал - чтобы можно было искать эти адреса в Ольке, а окно для ввода всегда под рукой, закрывается только после нажатия ОК и проверки правильности ввода.<br><br>Про добавления я знаю, хотел сделать, да времени жалко, для общей задачи это пока непринципиально, причем проверка на ошибки ввода присутствует.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255837&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=13" class="addthx" data-post="255837"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 апреля 2010 13:23 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#14');return false;">#14</a> </span><div align=left><br>
Реальные шаблоны интерпретаторов ВМ полученные декомпилятором для двух типов конкретных реализаций ВМ:<br>1. VMProtect<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">01AB3C83</span><span class="hl_char">:</span>&nbsp;cmd&nbsp;<span class="hl_char">=</span>&nbsp;picode<span class="hl_char">[</span>0xFFFFFFFF<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">01AB3C8B</span><span class="hl_char">:</span>&nbsp;cmd&nbsp;^<span class="hl_char">=</span>&nbsp;hash</li><li class="hl_l0"><span class="hl_number">01AB3C91</span><span class="hl_char">:</span>&nbsp;cmd&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;0x9F</li><li class="hl_l1"><span class="hl_number">01AB3C96</span><span class="hl_char">:</span>&nbsp;cmd&nbsp;<span class="hl_char">=</span>&nbsp;~cmd</li><li class="hl_l0"><span class="hl_number">01AB3C9A</span><span class="hl_char">:</span>&nbsp;cmd&nbsp;<span class="hl_char">-</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">01AB3CA4</span><span class="hl_char">:</span>&nbsp;cmd&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">4</span></li><li class="hl_l0"><span class="hl_number">01AB3CB9</span><span class="hl_char">:</span>&nbsp;hash&nbsp;^<span class="hl_char">=</span>&nbsp;cmd</li><li class="hl_l1"><span class="hl_number">01AB3CCB</span><span class="hl_char">:</span>&nbsp;handle&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">[</span>cmd&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_number">4</span>&nbsp;<span class="hl_char">+</span>&nbsp;0x01AB3D9A<span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">01AB3CD3</span><span class="hl_char">:</span>&nbsp;handle&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span>handle</li><li class="hl_l1"><span class="hl_number">01AB434B</span><span class="hl_char">:</span>&nbsp;handle&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">01AB434C</span><span class="hl_char">:</span>&nbsp;handle&nbsp;^<span class="hl_char">=</span>&nbsp;0x32FAD637</li><li class="hl_l1"><span class="hl_number">01AB435A</span><span class="hl_char">:</span>&nbsp;handle&nbsp;<span class="hl_char">-</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">01AB3813</span><span class="hl_char">:</span>&nbsp;handle&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">8</span></li><li class="hl_l1"><span class="hl_number">01AB3CE5</span><span class="hl_char">:</span>&nbsp;handle&nbsp;<span class="hl_char">-</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">01AB3CE6</span><span class="hl_char">:</span>&nbsp;handle&nbsp;^<span class="hl_char">=</span>&nbsp;0x3BC43F70</li>        </ol>
    </div>
</div></div>
<br>2. Ореановские ВМ<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0119C34E</span><span class="hl_char">:</span>&nbsp;cmd&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">[</span>picode<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">0119C355</span><span class="hl_char">:</span>&nbsp;cmd&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;hash</li><li class="hl_l0"><span class="hl_number">0119D666</span><span class="hl_char">:</span>&nbsp;cmd&nbsp;^<span class="hl_char">=</span>&nbsp;0xD2</li><li class="hl_l1"><span class="hl_number">0119EF60</span><span class="hl_char">:</span>&nbsp;cmd&nbsp;<span class="hl_char">-</span><span class="hl_char">=</span>&nbsp;0xF1</li><li class="hl_l0"><span class="hl_number">0119EF93</span><span class="hl_char">:</span>&nbsp;hash&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;cmd</li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255940&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=14" class="addthx" data-post="255940"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 апреля 2010 13:31 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#15');return false;">#15</a> </span><div align=left><br>
<b>Vamit</b><br>Не могли бы вы дать тот файл с вмпротом, для которого в предыдущем посте получен шаблон? Действия до обращения к таблице вроде стандартные, потом начинается что-то странное.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255941&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=15" class="addthx" data-post="255941"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 апреля 2010 16:44 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#16');return false;">#16</a> </span><div align=left><br>
<I>int пишет:<br>Не могли бы вы дать тот файл с вмпротом, для которого в предыдущем посте получен шаблон?  </I><br>Вот <noindex><a href="http://rapidshare.com/files/374643328/VWTester.rar.html" rel="nofollow" target="_blank">здесь</a></noindex> повторю.<br>handle - декодирование адреса примитива
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255946&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=16" class="addthx" data-post="255946"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 апреля 2010 17:23 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#17');return false;">#17</a> </span><div align=left><br>
Потому и спросил файл, ибо ваш листинг - бред:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">bl</span></li><li class="hl_l0"><span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">9Fh</span></li><li class="hl_l1"><span class="hl_function"><b>not</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span></li><li class="hl_l0"><span class="hl_function"><b>dec</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span></li><li class="hl_l1"><span class="hl_function"><b>rol</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4</span>&nbsp;<span class="hl_comment">; это типа очень похоже на &quot;cmd &lt;&lt;= 4&quot; ???</span></li><li class="hl_l0"><span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">bl</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l1"><span class="hl_function"><b>movzx</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">al</span></li><li class="hl_l0"><span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>dword_1AB3D9A<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; адрес этой инструкции 0x1AB3CCC, но не 0x1AB3CCB</span></li><li class="hl_l1"><span class="hl_function"><b>neg</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;<span class="hl_comment">; </span></li><li class="hl_l0"><span class="hl_function"><b>inc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; VM_EIP++</span></li><li class="hl_l0"><span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">32FAD637h</span></li><li class="hl_l1"><span class="hl_function"><b>dec</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_function"><b>rol</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8</span>&nbsp;<span class="hl_comment">; тоже самое - &quot;handle &lt;&lt;= 8&quot; - неверно</span></li><li class="hl_l1"><span class="hl_function"><b>dec</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">3BC43F70h</span></li><li class="hl_l1"><span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_comment">;stack obfuscation</span></li><li class="hl_l0"><span class="hl_function"><b>retn</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0Ch</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255948&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=17" class="addthx" data-post="255948"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 апреля 2010 20:29 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#18');return false;">#18</a> </span><div align=left><br>
<I>int пишет:<br>Потому и спросил файл, ибо ваш листинг - бред </I><br>И чем же я вам так не нравлюсь, а кто сказал, что &lt;&lt;= равно shl, это общая мнемоника операторов сдвига влево, под которой сидит то, что нужно, в данном случае rol. Неужели вы меня совсем за дурака считаете? Это шаблон и в нем есть условности в представлении, на самом деле это набор структур со вполне реальным содержимым, который работает так как нужно... Хотя наверно, можно было найти более адекватное представление для rol и других операторов сдвига, например, rol=
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255959&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=18" class="addthx" data-post="255959"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2010 08:50 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#19');return false;">#19</a> </span><div align=left><br>
<I>int пишет:<br>А зачем вы тогда эти шаблоны делаете? Смысли в них, если они &quot;общие&quot;? </I><br>Только для контроля за декомпилятором, назначение тоже что и у всех логов.<br><I>Это Керниган и Ритчи придумали, я ничего не говорил </I><br>Это в С они придумали, но к сожалению в С отсутствуют понятия циклических сдвигов и много чего другого, что есть в ассемблере.<br><br><I>теперь сдвиги пытаетесь обобщить. Я не понимаю стремления переписать всю номенклатуру. </I><br>Предложите для пользы дела своё видение мнемоники операторов сдвига в едином стиле:<br>lvalue operate rvalue
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255983&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=19" class="addthx" data-post="255983"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2010 09:51 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#20');return false;">#20</a> </span><div align=left><br>
<b>Vamit</b><br>ASM: rol eax,4<br>lvalue = eax, rvalue = 4<br>C: lvalue = (lvalue &lt;&lt; rvalue) | (lvalue &gt;&gt; sizeof(lvalue) * 8 - rvalue)<br>Если же цель сделать именно <I>lvalue operate rvalue </I>, то я бы предложил &lt;&lt;&gt;= и &gt;&gt;&lt;=. Есть ещё RotateLeft(lvalue, rvalue) и RotateRight(lvalue, rvalue) из состава WinNT.h. Но я бы предпочёл первый предложенный мной вариант, чтобы можно было сделать скрипт расшифровки таблицы в IDA, например такой:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">auto&nbsp;i<span class="hl_char">,</span>&nbsp;j<span class="hl_char">,</span>&nbsp;val<span class="hl_char">,</span>&nbsp;mask<span class="hl_char">,</span>&nbsp;table_addr<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">table_addr&nbsp;<span class="hl_char">=</span>&nbsp;0x1AB3D9A<span class="hl_comment">;</span></li><li class="hl_l1">val&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">8</span><span class="hl_comment">;</span></li><li class="hl_l0">for&nbsp;<span class="hl_char">(</span>i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; i &lt; 256; i++)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;j&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">Dword</span><span class="hl_char">(</span>table_addr&nbsp;<span class="hl_char">+</span>&nbsp;i<span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;j&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>j&nbsp;^&nbsp;0xFFFFFFFF<span class="hl_char">)</span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">; // NEG</span></li><li class="hl_l0">&nbsp;&nbsp;j<span class="hl_char">+</span><span class="hl_char">+</span><span class="hl_comment">; // INC</span></li><li class="hl_l1">&nbsp;&nbsp;j&nbsp;<span class="hl_char">=</span>&nbsp;j&nbsp;^&nbsp;0x32FAD637<span class="hl_comment">; // XOR 32FAD637h</span></li><li class="hl_l0">&nbsp;&nbsp;j<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_comment">; // DEC</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;в&nbsp;IDA&nbsp;не&nbsp;совсем&nbsp;обычные&nbsp;сдвиги<span class="hl_char">,</span>&nbsp;поэтому&nbsp;надо&nbsp;делать&nbsp;модификацию</li><li class="hl_l0">&nbsp;&nbsp;mask&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">-</span><span class="hl_number">1</span>&nbsp;^&nbsp;<span class="hl_char">(</span><span class="hl_char">-</span><span class="hl_number">1</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;val<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;j&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>j&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&lt;</span>&nbsp;val<span class="hl_char">)</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>j&nbsp;<span class="hl_char">&gt;</span><span class="hl_char">&gt;</span>&nbsp;<span class="hl_char">(</span><span class="hl_number">32</span>&nbsp;<span class="hl_char">-</span>&nbsp;val<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span>&nbsp;mask<span class="hl_char">)</span><span class="hl_comment">; // ROL 8</span></li><li class="hl_l0">&nbsp;&nbsp;j<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_comment">; // DEC</span></li><li class="hl_l1">&nbsp;&nbsp;j&nbsp;<span class="hl_char">=</span>&nbsp;j&nbsp;^&nbsp;0x3BC43F70<span class="hl_comment">; // XOR 3BC43F70h</span></li><li class="hl_l0">&nbsp;&nbsp;PatchDword&nbsp;<span class="hl_char">(</span>table_addr&nbsp;<span class="hl_char">+</span>&nbsp;i<span class="hl_char">*</span><span class="hl_number">4</span><span class="hl_char">,</span>&nbsp;j<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br>Вот это уже польза. Взял скрипт и проверил работу декомпиля <img src="img/smilies/s3.gif" alt=""><br><br><b>Av0id</b><br>При чём здесь оптимизация? Что я должен проверить? То про что я точно знаю, что оно неверно? Нет слов. <img src="img/smilies/s15.gif" alt=""><br>P.S. Специально для вас подарок в атаче. Зубков тоже допустил не мало ошибок при создании своего справочника, но в данном случае всё верно.<br><br><img src="img/attach.gif" alt=""> <a href="./files/e95c_12.04.2010_CRACKLAB.rU.tgz">e95c_12.04.2010_CRACKLAB.rU.tgz</a> - ch02_03e.htm
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255986&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=20" class="addthx" data-post="255986"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2010 10:19 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#21');return false;">#21</a> </span><div align=left><br>
В догонку шаблоны для скриптов IDA:<br><br>ROR j, val<br>mask = -1 ^ (-1 &lt;&lt; (32 - val));<br>j = ((j &gt;&gt; val) &amp; mask) | (j &lt;&lt; (32 - val)); <br>ROL j,val<br>mask = -1 ^ (-1 &lt;&lt; val);<br>j = (j &lt;&lt; val) | ((j &gt;&gt; (32 - val)) &amp; mask);<br>NOT j<br>j = j ^ 0xFFFFFFFF;<br>NEG j<br>j = (j ^ 0xFFFFFFFF) + 1;<br>XOR j,val<br>j = j ^ val;<br>ADD j,val<br>j = j + val;<br>SUB j,val<br>j = j - val;<br>INC j<br>j++;<br>DEC j<br>j--;<br><br>SHL/SAL/SHR/SAR там вроде не бывает, ибо это необратимые операции, но я думаю вам не составит труда сделать и их в случае чего.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=255988&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=21" class="addthx" data-post="255988"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2010 12:39 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#22');return false;">#22</a> </span><div align=left><br>
<I>int пишет:<br>C: lvalue = (lvalue &lt;&lt; rvalue) | (lvalue &gt;&gt; sizeof(lvalue) * 8 - rvalue)<br>Если же цель сделать именно lvalue operate rvalue , то я бы предложил &lt;&lt;&gt;= и &gt;&gt;&lt;=....Но я бы предпочёл первый предложенный мной вариант, чтобы можно было сделать скрипт расшифровки таблицы в IDA </I><br>Это выражение правильно для С, но я делаю не декомпилятор С, поэтому такая транскрипция одной операции мне не нужна, &lt;&lt;&gt;= и &gt;&gt;&lt;= - это ближе к делу, но учитывает не все варианты операторов сдвига, как здесь отличить rol от rcl? Ида со своими скриптами отношения к ВМ не имеет, как и полторы страницы написанных постов, т.ч. остановлюсь на своём варианте - rol=, rcl=, &lt;&lt;= (shl, sal), ror=, rcr=, sar=, &gt;&gt;= (shr)
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=255997&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=22" class="addthx" data-post="255997"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 апреля 2010 13:03 &middot; Поправил: <a href="action=stats#mods">Модератор</a> <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#23');return false;">#23</a> </span><div align=left><br>
<b>Vamit</b><br>Я окончательно не понял, что вы хотите. RCL это операция от трёх операндов, или вы не согласны?<br><br><I>Vamit пишет:<br>я делаю не декомпилятор С </I><br>А зачем же вы давали ссылку на тему про декомпилятор? Шаблон который вы делаете, скажите пожалуйста, зачем он вам? Я привёл пример - сделать скрипт IDA и проверить работу декомпиля. Не нравится IDA, можно для OllyDbg. Но смысла в &quot;rol=&quot; я не вижу. В общем делайте как хотите, я просто думал что тема создана не в духе &quot;смотрите что у меня есть&quot;, а с целью обсуждения инструмента, баг-репортов и предложений.<br><br>P.S. Тему почистил, если ещё какие посты считаете флудом - без проблем, стучите в ЛС, поскипаю <img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=256002&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=23" class="addthx" data-post="256002"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 апреля 2010 15:02 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#24');return false;">#24</a> </span><div align=left><br>
Прога накрытая Темидой под Олькой ведет себя нормально (стоят плагины Phantom 1.54, StrongOD upk 2010). Но при потытке запустить этот пакет из под дебагера VS 2008 для отладки декомпилятора (плагин под Ольку), Темида просыпается и посылает на свой саппорт, но иногда, раза с 3-4 всё срабатывает нормально и можно дебажить, но при нажатии в VS кнопки StopDebugging всё падает вместе с Виндой.<br>Вопрос: можно ли победить эту хрень и как?
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=256049&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=24" class="addthx" data-post="256049"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]kioresk[/b]','')">kioresk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/10650.gif" alt=""><br><span class=txtSm>Ранг: 154.2 (ветеран), 66thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10650">Участник</a><br><font color=blue>REVENGE Crew</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 апреля 2010 15:21 <br><script type="text/javascript">QU('kioresk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kioresk" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#25');return false;">#25</a> </span><div align=left><br>
Конечно можно, надо только антиотладку отключить. Но имхо в в твоем случае проще защитить файл фемидой без опций антиотладки/антипатча/обнаружения мониторов и исследовать на здоровье.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=256053&amp;user=10650&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=25" class="addthx" data-post="256053"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2010 08:29 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#26');return false;">#26</a> </span><div align=left><br>
<I>kioresk пишет:<br>надо только антиотладку отключить. </I><br>А поподробнее можно?<br><I>проще защитить файл фемидой без опций антиотладки/антипатча/обнаружения мониторов и исследовать на здоровье. </I><br>Да, для декомпиляции ВМ, это, наверное, правильный способ, но мне нужно сделать анализ только всех вхождений в ВМ именно на этом файле, т.к. здесь декомпилятор падает с исключениями.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=256126&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=26" class="addthx" data-post="256126"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2010 09:38 &middot; Поправил: OKOB <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#27');return false;">#27</a> </span><div align=left><br>
<I>Vamit пишет:<br>мне нужно сделать анализ только всех вхождений в ВМ именно на этом файле </I><br><br>Да какие проблемы? Дампим жертву из ольки не обязательно на ОЕР и без восстановления импорта.<br>Скармливаем дамп ИДА и напускаем скриптец (в атаче). И усе...<br><br>В срипте нужно задать только свои границы кодовой секции и границы хвоста фимы (пример границ из самой Фимы 2110)<br>   beg_main = 0x05EF7AC; <br>   end_main = 0x07F1000;<br>   beg_wl   = 0x093B000; <br>   end_wl   = 0x1443000;<br><br>Кому нужно тот перелудит скрипт для вывода в файл.<br><br>CODEREPLACE входы однозначно, а для остальных могут быть ошибочные <img src="img/smilies/s4.gif" alt=""><br><br><img src="img/attach.gif" alt=""> <a href="./files/d5da_13.04.2010_CRACKLAB.rU.tgz">d5da_13.04.2010_CRACKLAB.rU.tgz</a> - FindVMEntry.idc
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=256127&amp;user=6801&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=27" class="addthx" data-post="256127"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2010 10:55 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#28');return false;">#28</a> </span><div align=left><br>
<I>OKOB пишет:<br>Да какие проблемы? </I><br>Со скриптом, да и с ручным поиском, конечно, проблем нет, но я указал на декомпилятор, т.к. хочу его <b>отладить</b> для поиска и анализа всех вхождений в ВМ.<br>Через дамп, конечно, входы в саму ВМ найти можно, т.к. она находится в стат. секции файла, но вся криптовка импорта будет пропущена, т.к. она сидит в динамических секциях...
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=256128&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=28" class="addthx" data-post="256128"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]kioresk[/b]','')">kioresk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/10650.gif" alt=""><br><span class=txtSm>Ранг: 154.2 (ветеран), 66thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.31'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10650">Участник</a><br><font color=blue>REVENGE Crew</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 апреля 2010 12:04 <br><script type="text/javascript">QU('kioresk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kioresk" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#29');return false;">#29</a> </span><div align=left><br>
<b>Vamit</b>,<br><br>выложи файл или скинь в личку.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=256130&amp;user=10650&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=29" class="addthx" data-post="256130"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 апреля 2010 10:13 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#30');return false;">#30</a> </span><div align=left><br>
Небольшое подведение итогов по декомпиляции. Так как программа на сегодняшний день выполняет три функции для нескольких ВМ, то изложение буду давать пофункционально в разрезе типов ВМ и состояния дел.<br><br><b>1. Нахождение и анализ точек входа в ВМ.</b><br>Эта функция использует алгоритмы, которые не зависят от типов ВМ, сам тип ВМ она не определяет, но анализирует и распознает следующие параметры точек входа в ВМ:<br>- Error - ошибка при определении точки входа, тип ошибки в лог файле.<br>- Not recognized - точка есть, но её функционал не распознан.<br>- Done - точка обработана и устранена (в этой функции устраняется только кодированный импорт).<br>- Cancelled - ошибочная точка, выводится только для проверки анализатора.<br>- Processing - точка находится в состоянии обработки.<br>- Postponed - отложенная точка, для обработки требуется определение типа ВМ, которое выполняет другая функция декомпилятора.<br>Состояние дел:<br>Реализовано (v1.2) и проверено на VMProtect, CodeVirtualizer.<br>Реализовано (v1.3) и проверяется на Themida.<br>В принципе, сложностей здесь нет, если декомпилятор не берет какой либо файл, то можете его выслать (в исходном виде (нераспакованный) мне, желательно указать ОЕП или что-нибудь близкое к нему) и декомпилятор будет доработан.<br><br><b>2. Восстановление импорта.</b><br>Эта функция встроена в анализатор точек входа в ВМ. В процессе работы определяется адрес конкретной АПИ функции, после завершения анализа всех точек восстанавливается IAT и коды вызова АПИ функций в теле программы.<br>Состояние дел:<br>Реализовано (v1.2) и проверено на VMProtect. В CodeVirtualizer кодированного импорта не найдено.<br>Есть вопрос по Themidе: Имеется ли в ней кодированный ВМ импорт? Если да, то желательно дать с ним файлик. Замену/эмуляцию нескольких стандартных библиотек я не рассматриваю, на это дело есть скрипты и данную функцию по воссстановлению этого импорта я не планирую добавлять в декомпилятор.<br><br><b>3. Восстановление тела функции (декомпиляция ВМ).</b><br>Про эту функцию уже было много сказано, здесь только добавлю и поделю её на 3 шага, т.к. в v1.3 добавлен определитель типа ВМ:<br>1. Обработчики инициализации ВМ (до цикла интерпретатора) и цикла интерпретатора ВМ определяют тип ВМ и получают настройку окружения/среды ВМ.<br>2. Определение конкретной реализации ВМ.<br>3. Построение промежуточного кода и декодирование тела функции.<br>Реализовано (v1.2) и проверено на CodeVirtualizer (шаги 2 и 3).<br>Реализовано (v1.3) и проверено на CodeVirtualizer (шаги 1 - 3).<br>Реализовано (v1.3) и проверено на VMProtect (шаг 1).<br>В стадии реализации для VMProtect шаг 2, здесь для ускорения процесса может кто-нибудь поделится чистыми/значимыми телами обработчиков примитивов. Вообще-то это &quot;скучная&quot; работа разбора примитивов, для CV мне на разбор 168 примитивов потребовался почти месяц, здесь (VMProtect) времени нужно ещё больше, желательна помощь.<br>В стадии реализации для Themida шаг 1, вопросов пока нет...
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=256257&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=30" class="addthx" data-post="256257"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 апреля 2010 10:48 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=3#31');return false;">#31</a> </span><div align=left><br>
<I>Vamit пишет:<br>Имеется ли в ней кодированный ВМ импорт?  </I><br>В фиме нет
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=256263&amp;user=293&amp;forum_n=13&amp;topic=15906&amp;page=3&amp;anchor=31" class="addthx" data-post="256263"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=2.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=2.html">3</a> . <b>4</b> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=7.html">8</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=8.html">9</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=22.html">23</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=23.html">24</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=4.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Декомпилятор ВМ</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="15906">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15906" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
