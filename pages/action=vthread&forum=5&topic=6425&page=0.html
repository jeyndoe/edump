<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>DDeM в X2-Угроза или NoCD своими руками - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Нашол у себя игру X2-Угроза (Новый диск) и решил для интереса склепать NoCd. Кинул EXE в PEiD - Nothing found *, но в EP Section стоит .DDeMCod. &quot;Ладно&quot; - подумал я, запихал диск, кинул exe в Olly и стал смотреть какие">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=5602'>ut2004</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+8 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> DDeM в X2-Угроза или NoCD своими руками</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Sn00pY[/b]','')">Sn00pY</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.8 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6866">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 октября 2006 03:08 &middot; Поправил: Sn00pY <br><script type="text/javascript">QU('Sn00pY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn00pY" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6425.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Нашол у себя игру X2-Угроза (Новый диск) и решил для интереса склепать NoCd. Кинул EXE в PEiD - Nothing found *, но в EP Section стоит .DDeMCod.  &quot;Ладно&quot; - подумал я, запихал диск, кинул exe в Olly и стал смотреть какие Jump&#039;ы выполняются при его наличии в CDRom&#039;e. После подправил код чтобы пропускались функции типа GetDriveTypeA, GetVolumeInformationA, CreateFileA, GetFileSize. Вынул диск и стал трассировать. Вроде всё идёт также как и шло с диском, те же call&#039;ы, те же jump&#039;ы, только при переходе на адрес 00435E1F вылетает - Debugged program set single step flag (bit T in EFL).... и т.д. После долгих мучений выяснил, что когда диск в CDRom&#039;e то по адресу 00435E1F стоит строка xor esi, esi и далее всё идёт пучком, без диска же с пропущенными функциями проверки GetDriveTypeA, GetVolumeInformationA и т.д в этом же адресе (00435E1F) вместо xor помещается lea и появляется ошибка с последующим Terminated. &quot;Хорошо&quot; - опять подумал я, а что мне мешает lea на xor переправить? Так и сделал.... тока после безошибочного прохождения этого адреса (00435E1F) и пару других всё равно вываливается в Terminated. Ну раз так, то попробую найти OEP и сдампить сначала.... Хм...Попробовал... Адрес который както был похож на OEP оказался 0653726E jmp eax, сдампил...и получил exe размером в 97,3Mb(ну и <img src="img/smilies/s16.gif" alt=""> ) - нерабочий.<br>Итого: фонтан моих мыслей иссяк и что делать я уже незнаю. Кому интересно или кто както может помочь в моих злоключенях - поделитесь мыслями на эту тему.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=97487&amp;user=6866&amp;forum_n=5&amp;topic=6425.html&amp;page=0&amp;anchor=1" class="addthx" data-post="97487"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 октября 2006 04:14 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6425.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<I>Sn00pY пишет:<br>стоит .DDeMCod.  </I><br> Сделай поиск и почитай. Защита это такая и &quot;в лоб&quot; не возьмешь.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=97508&amp;user=4072&amp;forum_n=5&amp;topic=6425.html&amp;page=0&amp;anchor=2" class="addthx" data-post="97508"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]sliderZ[/b]','')">sliderZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.9'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6080">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 октября 2006 14:03 <br><script type="text/javascript">QU('sliderZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sliderZ" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6425.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Sn00pY</b><br>OEP ты вроде правильно нашел,а дамп похоже не пофиксил. Таблицу импорта случаем не забыл восстановить ?<br>p.s чтобы размер файла пофиксить запусти rebuildPE в petools.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=97648&amp;user=6080&amp;forum_n=5&amp;topic=6425.html&amp;page=0&amp;anchor=3" class="addthx" data-post="97648"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Sn00pY[/b]','')">Sn00pY</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.8 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6866">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 октября 2006 06:26 <br><script type="text/javascript">QU('Sn00pY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn00pY" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6425.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>sliderZ пишет:<br>Таблицу импорта случаем не забыл восстановить ? </I><br>...<img src="img/smilies/s14.gif" alt=""> как не страшно это осознавать - но ЗАБЫЛ.... 3 дня коту под хвост из-за того что именно импорт и не восстановил... мда, бывает же такое<img src="img/smilies/s16.gif" alt=""><br>В общем теперь всё пашет без диска и тему можно было бы закрыть, но пара вопросов осталась. Конечный EXE&#039;шник весил 97,2Мб. <I>а дамп похоже не пофиксил</I> - почему-то не фиксился...Через rebuildPE в petools вместо 97,3Мб ребилдил на 97,1Мб. Короче сделал так:<br>1. Сдампил этого 97 метрового мутанта (кстати оригинальный exe весит 3,6Мб !!!)<br>2. Через PeTools отрезал ему секции .DDeMCod и .DDeMImp<br>3. Прикрутил импорт<br>4. Запустил rebuildPE в PeTools<br>Результат - 3,5Мб (сдулся до размера оригинального EXE <img src="img/smilies/s7.gif" alt=""> )<br>А вопросы собственно такие (не в тему, но не открывать же новый топик?) :<br>1. Неужели дамп может <b>настолько</b> отличаться от оригинала или у мя неправильные настройки в OllyDump (всегда снимаю галку с Rebuild Import)<br>2. Правильно ли поступил кастрировав секции .DDeMCod и .DDeMImp, и можно было бы ещё чего нить оттяпать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=97730&amp;user=6866&amp;forum_n=5&amp;topic=6425.html&amp;page=0&amp;anchor=4" class="addthx" data-post="97730"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]sliderZ[/b]','')">sliderZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 33.6 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.9'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6080">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 октября 2006 15:20 <br><script type="text/javascript">QU('sliderZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sliderZ" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6425.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>Sn00pY</b><br><br>1. Я не уверен, но похоже в этом случае это ddem зачем-то раздувает виртуальный размер секции data до 90 мегов. Видимо какая-то спицифика протектора, фиг знает зачем ему это нужно.<br>2. Да наверное в случае такого простого протектора правильно, я сам секции никогда не отрезаю, на всякий случай кто знает какой глюк потом может возникнуть. В более сложных протекторах типа аспра или армы на сколько я знаю к делу отрезания секций с умом надо подходить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=97782&amp;user=6080&amp;forum_n=5&amp;topic=6425.html&amp;page=0&amp;anchor=5" class="addthx" data-post="97782"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 октября 2006 22:11 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6425.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>Sn00pY пишет:<br>Неужели дамп может настолько отличаться от оригинала  </I><br> Все нормально. Это прикол программистов. Вместо динамического заказа памяти сразу создается секция нужного размера. Часть памяти ничем не заполняется и не занимает места в экзе. Дамперы дампят по размеру секции в памяти - на всякий случай <img src="img/smilies/s5.gif" alt=""> Один из простых способов - упаковать файл простым паковщиком.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=97794&amp;user=4072&amp;forum_n=5&amp;topic=6425.html&amp;page=0&amp;anchor=6" class="addthx" data-post="97794"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Sn00pY[/b]','')">Sn00pY</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 31.8 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6866">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2006 06:24 <br><script type="text/javascript">QU('Sn00pY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sn00pY" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6425.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>tundra37</b>,<b>sliderZ</b><br>Пасиб ребята за то что нашли время помочь мне<img src="img/smilies/s1.gif" alt=""><br><br>Поскольку IMHO тема себя исчерпала прошу товарищей модераторов её прикрыть.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=97866&amp;user=6866&amp;forum_n=5&amp;topic=6425.html&amp;page=0&amp;anchor=7" class="addthx" data-post="97866"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]huckfuck[/b]','')">huckfuck</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 49.6 (посетитель), 9thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6947">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2006 06:48 <br><script type="text/javascript">QU('huckfuck','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=huckfuck" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=6425.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Нашёл на компе 2 проги для запатчивания DDeM Protector&#039;a, залил на рапиду rapidshare.de/files/35951698/DDeM_Unpack.rar.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=97873&amp;user=6947&amp;forum_n=5&amp;topic=6425.html&amp;page=0&amp;anchor=8" class="addthx" data-post="97873"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> DDeM в X2-Угроза или NoCD своими руками</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=6425" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
