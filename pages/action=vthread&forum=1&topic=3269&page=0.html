<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>HASP Envelope - распаковка без ключа - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Тип защиты: PE Hardlock / HASP Envelope Казалось бы, многократно описанная тема, и здесь в том числе. Ставишь брэйк на конец зашифрованной секции и вылетаешь в отладчик с уже расшифрованным кодом основной программы. Далее по">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a>, <a target='_blank' href='?action=userinfo&amp;user=41556'>subword</a>, <a target='_blank' href='?action=userinfo&amp;user=55853'>rtsgreg1989</a> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> HASP Envelope - распаковка без ключа</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]alm[/b]','')">alm</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.06'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=2026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2005 15:15 <br><script type="text/javascript">QU('alm','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=alm" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Тип защиты: PE Hardlock / HASP Envelope
<br>
<br>Казалось бы, многократно описанная тема, и здесь в том числе. 
<br>Ставишь брэйк на конец зашифрованной секции и вылетаешь в отладчик с уже расшифрованным кодом основной программы. Далее по описанию...
<br>
<br>Но вот в чём вопрос: наверняка расшифровка идет уже после проверки ключа и с учётом информации, прочитанной из него. Так что же делать при отсутствии ключа ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42553&amp;user=2026&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=1" class="addthx" data-post="42553"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]doctor Ice[/b]','')">doctor Ice</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 79.6 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.32'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1457">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 ноября 2005 15:39 <br><script type="text/javascript">QU('doctor Ice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=doctor Ice" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
вариант есть. смори алгоритм расшифровки там усложнено тем что в расшифровке участвуют ранее расшифрованые байты. но если ты знаеш каким должен быть первый д-ворд расшифрованных данных твои шансы на успех повышаются. я не оч вникал в алгоритм расшифровки и не пытался расшифровывать без ключа но теоретически это возможно. я просто когдато рар запароленный распаковывал там в архиве был экзешник а значит MZ <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>power and the money money and the power</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=42558&amp;user=1457&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=2" class="addthx" data-post="42558"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Satanael[/b]','')">Satanael</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3049.jpg" alt=""><br><span class=txtSm>Ранг: 110.0 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.64'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3049">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2005 05:46 <br><script type="text/javascript">QU('Satanael','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Satanael" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
У меня была такая проблема при взломе программы Бизнес-Курс: Корпорация Плюс, защищенной аппаратными ключами от фирмы Guardant (Novex). Была неделя Ада!!!
<br>
<br>Из ключа считывается 32 бита которые использовались для расшифровки блока данны байт так в 500
<br>в котором в свою очередь находился ключ (данные) 32 бита для расшифровки первой секции (.CODE) в программе.
<br>Соответственно без ключа секция расшифровавалась не правильно и управление не передавалась на OEP.
<br>
<br>Изучил полностью алгоритм шифровки, был достаточно сложен (алгоритм дешифровки сделать не смог) с использованием операции циклического cдвига (_lrotl), XOR&#039;a ну и более простых математических операций.
<br>
<br>При изучении шифровок можно также использовать дифференициальный и статистический анализ (выпердрился <img src="img/smilies/s1.gif" alt="">)). Например мой шифр был потоковый, а значит что к ниму нельзя применить статистический анализ, а деффиренциальный анализ - темка довольно сложная. Я решил эту проблему
<br>методом полного перебора, всего то 2^32=4.294.967.296 комбинаций перебрать пришлось <img src="img/smilies/s1.gif" alt="">))))).
<br>
<br>Главная проблема заключалась в том что весь код был размазан (разработчbки назвали это &quot;технологией безумного кода&quot;) и почти после каждой команды стоял jmp.
<br>Я решил эту проблему так:
<br>1) Локализовал место где происходит запись расшифрованых байтов на место зашифрованных. 
<br>2) Вырезая по команде из Olly в ставлял их в doc-файл, так постепенно разобрал весь алгоритм.
<br>
<br>Состряпал алгоритм на Delphi. Пароль находился за 2 минуты  на моем Celeron 1000.
<br>Так взломал все версии программы (индивидуальную, инд.сетевую, коллективную). 
<br>
<br>При создании алгоритма перебора не маловажной проблемой является определения когда пароль правелен. Я конечно мог пробегать например по всей 1,5 мегабайтной  расшифрованной секции и искать какие-нибудь русские или английские слова, но такой алгоритм вряд ли эффективен. Лучше узнать первый 4 байта как подметил Доктор Холод.
<br>
<br>Как я узнал эти байты? 
<br>Мне конечно немного повезло в этом плане.
<br>1)Была демо-версия этой же программыкоторая использовала защитные механизмы, но не требовала ключа, поэтому отвязка от защиты (novex32.dll) прошла успешно. 
<br>2)Предположил что написано на Delphi (в папке программы валялись файлы для BDE).
<br>3)Запихнул прогу в DeDe, предположил правильно, написана на Delphi 3.
<br>
<br>Короче говоря первые байты получились 04 10 40 00.
<br>Уверяю тебя что эти байты будут у всех программ написанных на Delphi3-7.
<br>
<br>Блин загрузился сам!
<br>Короче говоря вот что могу посоветовать:
<br>1) Локализуй место/места где все расшифровывается.
<br>2) Изучи и составь алгоритм на своем любимом языке программирования.
<br>3) Реши проблему поиска ключа (данных для дешифровки) методом brute-force (перебора).
<br>4) Обязательно оптимизируй перебор, найди первые 4-ре байта, если програ написана на Delphi то
<br>это  04 10 40 00 (если не переворачивать). Если найдешь свои байты значит можно будет дешифровывать всего 4 байта, а не все данные, а значит перебор будет идти быстро.
<br>
<br>Однако, после успешной расшифровки мне еще прислось самостоятельно найти OEP, подправить указатель на таблицу импорта и её размер. И еще кучу проблем решить пришлось!!!
<br>
<br>Все! Успеха тебе...
<br><br><font size="1"><i>-----<br>Никто не знает  столько, сколько не знаю я</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=42898&amp;user=3049&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=3" class="addthx" data-post="42898"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ssx[/b]','')">ssx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 352.4 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33">Участник</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2005 12:14 <br><script type="text/javascript">QU('ssx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ssx" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Satanael</b>
<br>только почему ты это в топике про хасп написал <img src="img/smilies/s1.gif" alt="">
<br>
<br><I>Главная проблема заключалась в том что весь код был размазан (разработчbки назвали это &quot;технологией безумного кода&quot;) и почти после каждой команды стоял jmp.  </I>
<br>можно было в ida эту проблему решить проще - обфускатор у них не сложный
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=42929&amp;user=33&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=4" class="addthx" data-post="42929"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Satanael[/b]','')">Satanael</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3049.jpg" alt=""><br><span class=txtSm>Ранг: 110.0 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.64'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3049">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2005 16:59 <br><script type="text/javascript">QU('Satanael','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Satanael" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>К ssx&#039;y</b>
<br>можно было в ida эту проблему решить проще - обфускатор у них не сложный
<br>
<br>Интересно, а как эту проблему можно решить в IDA. Нельзя ли поподробней!
<br>
<br>Почему я это в топике про хасп написал?Незнаю <img src="img/smilies/s1.gif" alt="">
<br>А вобще я сначала говорю(пишу), а потом думаю <img src="img/smilies/s15.gif" alt="">
<br><br><font size="1"><i>-----<br>Никто не знает  столько, сколько не знаю я</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=42972&amp;user=3049&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=5" class="addthx" data-post="42972"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ssx[/b]','')">ssx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 352.4 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33">Участник</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2005 22:05 <br><script type="text/javascript">QU('ssx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ssx" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Satanael</b>
<br>ну как - ходит по рукам скрипт для восстановления jmp-вермишели (с) Dim0n
<br>хотя и самому написать можно
<br>
<br>и еще:
<br>оеп, iat rva - все лежит в секции SAAT
<br>infern0 на ренг.ру выкладывал кажется ее формат
<br>зы: она тоже шифрована
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43007&amp;user=33&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=6" class="addthx" data-post="43007"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Satanael[/b]','')">Satanael</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3049.jpg" alt=""><br><span class=txtSm>Ранг: 110.0 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.64'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3049">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 ноября 2005 23:07 <br><script type="text/javascript">QU('Satanael','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Satanael" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>К ssx&#039;y</b>
<br>Ну про скприпт всё понятно, буду пользоваться стырым добрым вордом и клавишами Ctrl+C, Ctrl+V. <img src="img/smilies/s7.gif" alt="">
<br>
<br>и еще:
<br>у меня iat находился в секции .idata, невооруженым глазом было видно
<br>да и OEP проше самому найти, чем в секции saat ковырятся <img src="img/smilies/s12.gif" alt="">
<br><br><font size="1"><i>-----<br>Никто не знает  столько, сколько не знаю я</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=43013&amp;user=3049&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=7" class="addthx" data-post="43013"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]ssx[/b]','')">ssx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 352.4 (мудрец), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33">Участник</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 ноября 2005 10:34 <br><script type="text/javascript">QU('ssx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ssx" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
ну, у дельфи оеп найти и правда легко. но лучше все же стремиться к автоматизации процесса <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=43052&amp;user=33&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=8" class="addthx" data-post="43052"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]evgbog[/b]','')">evgbog</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.69'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=13900">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 ноября 2007 23:02 &middot; Поправил: evgbog <br><script type="text/javascript">QU('evgbog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=evgbog" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
кто-нибудь в курсе, какой алгоритм шифровки используется в HASP HL конверте? как расшифровать перебором, если знаем первые байты искомого кода?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=166700&amp;user=13900&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=9" class="addthx" data-post="166700"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]AlexVel[/b]','')">AlexVel</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 43.2 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.82'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2596">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 ноября 2007 09:27 <br><script type="text/javascript">QU('AlexVel','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexVel" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>кто-нибудь в курсе, какой алгоритм шифровки используется в HASP HL конверте? как расшифровать перебором, если знаем первые байты искомого кода?</I><br>Никак. Конверты HASP HL без ключа (логов одного запуска на ключе) не расшифровать. На каждый блок длиной 0x1000 байт необходимо подбирать ключ размером 32 байта (256 бит).<br>Причем блоков может быть достаточно много. Для каждого блока ключ разный.<br>Так что мой тебе совет - забудь
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=166734&amp;user=2596&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=10" class="addthx" data-post="166734"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]AlexZander[/b]','')">AlexZander</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.82'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=349">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 июля 2008 18:00 <br><script type="text/javascript">QU('AlexZander','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=AlexZander" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Странно, а у меня до распаковки с ключем и после распаковки в зашифрованной секции в самом конце с адреса 4С6000 по 4С6FFF - (посл. байт зашифрованной секции кода) данные одинаковые -т.е. без изменения до и после распаковки, значит ли это что они не трогаются протектором-конвертом при распаковке ? Я просто после 4C6200 записал свой код - там уже нули начинаются ... я внедрил свой код, и из основной ветки (когда там появляются нужные байты при распаковке - нормальный код) сделал прыжок сюда ... на свой код с 46C200 - сработает такая штука, я надеюcь ?! Т.е. я хотел спросить конверт hasp только один раз расшифровывает код, не получится такого , что он несколько раз один и тот же код расшифровывает для подстраховки ... !!!? или может он чек-сумму сверяет оригинального кода который в памяти находится ... ?<br>Шурик
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=194687&amp;user=349&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=11" class="addthx" data-post="194687"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 июля 2008 17:08 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=3269.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
В некоторых энвелопах часть последних байт в секции не трогается. Расшифровывает 1 раз.
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=194767&amp;user=8830&amp;forum_n=1&amp;topic=3269.html&amp;page=0&amp;anchor=12" class="addthx" data-post="194767"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> HASP Envelope - распаковка без ключа</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#13" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="1">
<input type="hidden" name="topic" value="3269">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=3269" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
