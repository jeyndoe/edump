<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Синий экран под отладчиком. - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Пробую этот эксплоит https://github.com/Re4son/KiTrapOD/blob/master/vdmexploit.c на виндовс хп для повышения прав. Скачал уже собранный, на хп работает, все окей. Решил из тех исходников собрать экзешник и либу, экзешник">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=6859'>cppasm</a>, <a target='_blank' href='?action=userinfo&amp;user=55996'>dutyfree</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Синий экран под отладчиком.</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]mazaxaker[/b]','')">mazaxaker</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 82.5 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.51'>Активность: 0.13<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=41862">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 января 2017 23:37 <br><script type="text/javascript">QU('mazaxaker','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mazaxaker" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Пробую этот эксплоит https://github.com/Re4son/KiTrapOD/blob/master/vdmexploit.c на виндовс хп для повышения прав.<br>Скачал уже собранный, на хп работает, все окей.<br>Решил из тех исходников собрать экзешник и либу, экзешник нормально собрал, а либу криво.<br>Хочу в ollydbg сравнить ту либу и которую собирал, чтобы найти ошибку.<br>Но почему-то при отладке этой либы под ollydbg в момент входа в ядро тут:<br>NtVdmControl(VdmStartExecution, NULL); в дебагере sysenter вываливается в синий экран, но без отладчика все норм.<br>А после она выходит из ядра и выполняет функцию VOID FirstStage()<br>Я хотел ее отлаживать, саму функцию нашел в отладчике, но из-за синего экрана до нее дойти не могу.<br><br><br>Пробовал в начало FirstStage() прописать MessageBoxA чтобы приаттачиться уже после выхода из ядра, но в этом случае она начинает и вне отладчика в синий экран кидать. <br>Может кто подскажет как обойти синий экран в отладчике.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370874&amp;user=41862&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=1" class="addthx" data-post="370874"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 января 2017 23:40 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
&gt;  в дебагере sysenter вываливается в синий экран, но без отладчика все норм.<br><br>А если под отладчиком запустить не крэшит ?
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=370875&amp;user=40990&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=2" class="addthx" data-post="370875"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]mazaxaker[/b]','')">mazaxaker</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 82.5 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.51'>Активность: 0.13<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=41862">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 января 2017 23:55 &middot; Поправил: mazaxaker <br><script type="text/javascript">QU('mazaxaker','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mazaxaker" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>difexacaw пишет:<br>А если под отладчиком запустить не крэшит ? </I><br>Если запустить под отладчиком экзешник то не крашит.<br>Но я отлаживаю либу, которую сплоит пихает удаленным потоком в процесс ntvdm.exe из system32, в начало либы messageboxa поставил, чтобы аттачиться к этому ntvdm.exe пока висит сообщение.<br>Вот в этом случае хоть по шагам, хоть запустить падает в синий экран.<br>На вин хп сп2 х86 на виртуалке пробую.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370876&amp;user=41862&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=3" class="addthx" data-post="370876"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 января 2017 23:58 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>mazaxaker</b><br><br>Не понятно. То вы говорите что крэшит на сервисе, то процесс какой то левый и крэшит. Опишите понятно и крэшдамп тоже покажите.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=370877&amp;user=40990&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=4" class="addthx" data-post="370877"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]mazaxaker[/b]','')">mazaxaker</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 82.5 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.51'>Активность: 0.13<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=41862">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2017 00:03 <br><script type="text/javascript">QU('mazaxaker','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mazaxaker" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>difexacaw</b>, про сервис не говорил ведь. Экзешник через удаленный поток подсовывает либу в системный процесс винды ntvdm.exe и в нем ее запускает, я аттачусь к этому процессу и при отладке крешит в синий экран.<br><br><img src="img/attach.gif" alt=""> <a href="./files/1200_05.01.2017_EXELAB.rU.tgz">1200_05.01.2017_EXELAB.rU.tgz</a> - Mini010517-14.dmp
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370878&amp;user=41862&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=5" class="addthx" data-post="370878"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2017 00:21 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>mazaxaker</b><br><br>Судя по виндбг крэшит fxsave в ядре, что не есть гуд, без отладки суть крэша узнать не получится. Впрочем не удивительно - LPE не отлаживается обычно через юзер дебаггер, юзайте виндбг.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=370881&amp;user=40990&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=6" class="addthx" data-post="370881"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]mazaxaker[/b]','')">mazaxaker</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 82.5 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.51'>Активность: 0.13<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=41862">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2017 00:41 <br><script type="text/javascript">QU('mazaxaker','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mazaxaker" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>difexacaw</b>, виндбг можно конечно, но мне по сути интересна функция юзермодная, в которую прога выходит из ядра.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370887&amp;user=41862&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=7" class="addthx" data-post="370887"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Rainbow[/b]','')">Rainbow</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/13190.jpg" alt=""><br><span class=txtSm>Ранг: 110.8 (ветеран), 104thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.83'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=13190">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2017 00:48 <br><script type="text/javascript">QU('Rainbow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rainbow" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>mazaxaker пишет:<br>по сути интересна функция юзермодная, в которую прога выходит из ядра </I><br><br>В юзермоде система синяки не показывает <img src="img/smilies/s3.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370888&amp;user=13190&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=8" class="addthx" data-post="370888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2017 00:48 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>mazaxaker</b><br><br>Если бы оно крэшило как вы сразу сказали - при трассировке сервиса, то суть была бы ясна, отличие в обработке известно. Но оно крэшит в зависимости от фазы луны, так как отладчик воздействует на огромное число механизмов, может существовать совсем не очевидная цепочка причин в конце концов приводящая к крэшу, так как LPE которые робят через смещение стека - как этот являются анстаб и любой внешний фактор делает его не рабочим. По нормальному нужно или отлаживать или полностью разбирать дамп, для этого нужно много времени и ваше ядро.<br>Можно было бы что то предположить по вменяемому описанию, к примеру в какой именно момент происходит крэш, то что при отладки крэшит&quot; это никакая не инфа.)<br>Да и семпл этот кривой, его весь ядерный кодес выполняется при замаскированных прерываниях, юзая при этом рандом - подкачиваемую памяти и даже сервисы, отдавая управление вникуда. Так что возможно крэшит сам семпл из за изменений рабочего набора отладчиком.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=370889&amp;user=40990&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=9" class="addthx" data-post="370889"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]mazaxaker[/b]','')">mazaxaker</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 82.5 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.51'>Активность: 0.13<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=41862">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2017 00:49 <br><script type="text/javascript">QU('mazaxaker','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mazaxaker" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>difexacaw</b>, вот добавил jmp на себя в ту функцию, которая после ядра идет. Теперь такой бсод вылетает, но после добавления jmp в нее теперь и без отладчика крешится. <br>Не пойму почему добавления jmp в ту функцию, которая уже юзермодная ее теперь крешит даже без отладчика.<br><br><img src="img/attach.gif" alt=""> <a href="./files/cb64_05.01.2017_EXELAB.rU.tgz">cb64_05.01.2017_EXELAB.rU.tgz</a> - Mini010517-17.dmp
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370890&amp;user=41862&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=10" class="addthx" data-post="370890"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2017 00:57 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>mazaxaker</b><br><br>На этот раз падение драйвера гуя(win32k). Говорю же это рандом события, семпл не рабочий.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=370891&amp;user=40990&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=11" class="addthx" data-post="370891"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]mazaxaker[/b]','')">mazaxaker</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 82.5 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.51'>Активность: 0.13<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=41862">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2017 01:03 <br><script type="text/javascript">QU('mazaxaker','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mazaxaker" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>difexacaw пишет:<br>это рандом события </I><br>Да понимаю, но вот не пойму, почему начинает крешить, если либу патчу джампом на себя, чтобы ее зациклить и приаттачиться к ней. Именно падает без отладчика даже в этом случае. <br>По идее то на джампе должна зависнуть и ждать, но почему-то крешится.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370892&amp;user=41862&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=12" class="addthx" data-post="370892"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2017 01:05 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>mazaxaker</b><br><br>Там обращение к выгружаемой памяти из под самого высокого IRQL, такая манипуляция - бсодогенератор на рандоме. Память непрерывно свопается, а это обращается к памяти, состояние которой в прямом смысле рандомно. Результат очевиден.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=370893&amp;user=40990&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=13" class="addthx" data-post="370893"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]mazaxaker[/b]','')">mazaxaker</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 82.5 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.51'>Активность: 0.13<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=41862">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 января 2017 01:45 &middot; Поправил: mazaxaker <br><script type="text/javascript">QU('mazaxaker','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mazaxaker" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>difexacaw</b>, да понял. Сейчас пробую либу собрать из сорцов. Саму либу собрал, но что-то в коде видать в сорцах ошибки, сейчас хочу ее скомпиленную сравнить через отладчик с той, которая собраная была и рабочая. Моя из сорцов чет не дает привелегии. Походу с указателями где-то напутал при сборке.<br><br><b>Добавлено спустя 5 минут</b><br><b>difexacaw</b>, в аттаче мой исходник, собирал в студии 2010, а это оригинальные https://github.com/Re4son/KiTrapOD/blob/master/vdmexploit.c<br><br>В оригинальных сорцах прога не попадает на Exitthread этот. Это хорошо. А в моих сорцах попадает туда.<br>306	    ExitThread(&#039;VTIB&#039;);<br><br>Оригинальная прога на выходе сюда попадает. Это хорошо. <br>ZwTerminateProcess(GetCurrentProcess(), &#039;w00t&#039;);<br>А моя на том экзите с параметром VTIB выходит, что плохо.<br><br>Можете глянуть так может увидете где косяк.<br><br><img src="img/attach.gif" alt=""> <a href="./files/6f39_06.01.2017_EXELAB.rU.tgz">6f39_06.01.2017_EXELAB.rU.tgz</a> - main.cpp
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370896&amp;user=41862&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=14" class="addthx" data-post="370896"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]mazaxaker[/b]','')">mazaxaker</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 82.5 (постоянный), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.51'>Активность: 0.13<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=41862">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 января 2017 02:15 <br><script type="text/javascript">QU('mazaxaker','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mazaxaker" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Я еще заметил, что функция, в которую прога из ядра выходит, на эту функцию накинута пара cli/sti.<br>Вот пробую jmp пихнуть внутри там, но при остановке на jmp в этом блоке виснет комп намертво. А если ставлю jmp на себя до cli, то синий экран.<br>Как бы остановить прогу в этой функции без креша и приаттачиться туда ?<br><br>Кстати прога в этой функции для вывода текста в консоль использует DbgPrint, а ее адрес получает без помощи getprocaddress, а через таблицы по имени ищет. Если там ее имя подменить на MessageBox, такая идея, как думаете не крешнится ли она после такого или точнее найдет ли она в той таблице эту функцию.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370929&amp;user=41862&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=15" class="addthx" data-post="370929"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]neprovad[/b]','')">neprovad</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.4 (посетитель), 15thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.7'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18733">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 января 2017 08:59 <br><script type="text/javascript">QU('neprovad','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=neprovad" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Запускайте пример в vmware с xp нужной версии, подключайтесь к vmware через связку windbg+ida (например) и спокойно отлаживайте ядро в любом месте
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370946&amp;user=18733&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=16" class="addthx" data-post="370946"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]_Researcher_[/b]','')">_Researcher_</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.96'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=35460">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 января 2017 20:02 <br><script type="text/javascript">QU('_Researcher_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=_Researcher_" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>mazaxaker пишет:<br>Пробовал в начало FirstStage() прописать MessageBoxA чтобы приаттачиться уже после выхода из ядра, но в этом случае она начинает и вне отладчика в синий экран кидать.  </I><br><br>Прошу прощения, но вы чушь какую-то делаете. Посмотрел ваш исходник, какие-то MessageBox&#039;ы в режиме ядра. Понятно, что крэшить все будет. И никакого выхода из ядра нету внутри FirstStage, это все код режима ядра. Кстати, сообщения в этом коде лучше выводить через DbgPrint, как в оригинальном исходнике. И если уж так хочется этот код отлаживать можно попробовать в начало этих функций вместо MessageBox поставить int 3, по идее, отладчик должен всплыть. Кроме того, вы видимо пытаетесь отлаживать локально (через Syser), а такие вещи лучше делать удаленно, подключаясь к виртуалке через тот же windbg, как в предыдущем посте написали.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=370950&amp;user=35460&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=17" class="addthx" data-post="370950"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 января 2017 01:05 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24513.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>mazaxaker</b><br><br>&gt; Я еще заметил, что функция, в которую прога из ядра выходит, на эту функцию накинута пара cli/sti.<br>Вот пробую jmp пихнуть внутри там, но при остановке на jmp в этом блоке виснет комп намертво.<br><br>Я это выше несколько раз вам повторил, но вы же не слушаете. cli там быть не должно, упоротый автор его туда вставил вообще не понимая зачем. Вообще же такие вещи методом тыка не делаются, если код это POC, то добиваться его работоспособности бессмысленно, он не для того нужен.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=371058&amp;user=40990&amp;forum_n=5&amp;topic=24513.html&amp;page=0&amp;anchor=18" class="addthx" data-post="371058"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Синий экран под отладчиком.</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#19" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="24513">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24513" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
