<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Декомпилятор ВМ - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Вашему вниманию предлагаются наработки по декомпиляции ВМ. Проект на сегодняшний день для меня завершен, но жаль если результат &quot;ляжет на полку&quot;, может кому-нибудь и пригодится. Предлагаю сначала ознакомиться с обзором,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Декомпилятор ВМ</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=19.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=17.html">18</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=18.html">19</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=19.html">20</a> . <b>21</b> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=21.html">22</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=22.html">23</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=23.html">24</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=21.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 12:33 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#1');return false;">#1</a> </span><div align=left><br>
Вашему вниманию предлагаются наработки по декомпиляции ВМ.<br>Проект на сегодняшний день для меня завершен, но жаль если результат &quot;ляжет на полку&quot;, может кому-нибудь и пригодится. Предлагаю сначала ознакомиться с обзором, и если будет интерес то могу выложить и сам плагин, или здесь или в личку заинтересованным лицам, каким образом, пока ещё не решил...<br>Но если кто-либо ожидает увидеть &quot;автоматическое чудо&quot;, то сразу скажу - его нет. Для того чтобы получить результат нужна ручная предварительная работа:<br>- с исследуемой программы должна быть снята упаковка<br>- точки входа в ВМ находятся вручную<br>- возможно неоднократное &quot;жамкание&quot; клавиш в OllyDbg, а возможно и модификация кода, чтобы попасть в нужное место, в зависимости от защищенной функции<br>- необходимо вручную прицепить к программе требуемый секцию<br>- запись результатов в файл это тоже ручная работа, но уже более приятная<br><br>Не всё гладко обстоит с определением реализаций ВМ, на сегодняшний день примерно каждая третья реализация автоматом не определяется, приходится под неё модернизировать плагин, т.к. не могу сразу предусмотреть все случаи &quot;издевательств&quot; ВМ с кодом примитивов. Лучше дела с восстановлением &quot;исходного&quot; кода защищенных функций - 70% нормально восстанавливается, хотя во многом это зависит от самой структуры функции. Таким образом, если будет заинтересованность и помощь в нахождении подобных ситуаций, то проект может быть доведен до релизной стадии.<br><br>ЗЫ: Речь идет об <i class=x>Ореановских</i> машинах. Нигде специально не упоминал.<br><br><img src="img/attach.gif" alt=""> <a href="./files/9c41_03.03.2010_CRACKLAB.rU.tgz">9c41_03.03.2010_CRACKLAB.rU.tgz</a> - VMSweeperLst.rar
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253056&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=1" class="addthx" data-post="253056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 февраля 2017 21:51 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#2');return false;">#2</a> </span><div align=left><br>
<b>Bronco</b><br><br>Да нет, вы не понимаете. Этот визор юзермод. Это локальный стековый супервизор(это не гипервизор, это софтверная реализация). Там есть эвенты на вызов сервисов, в свою очередь импорт сюда полноценных фильтров для антидебага(которые в известном ранее проекте никто заюзать из за гуя не смог) потребовало некоторого времени, так как визор в разработке, почему собственно и взят этот семпл(вручную обойти дебаг - это говно вопрос) <img src="img/smilies/s1.gif" alt=""><br><br>Гипервизоры не могут решать такие задачи, из за изоляции среды(см атомы) и сложности реализации.<br><br>Что бы получить результ по сабжу нужно снять статистику, это я сделаю в ближайшее время. Идея проста. Нужно получить стату по выборке данных и исполнению. Это поведение потока. Визор трекает выборки из памяти, соответственно вся память должна быть гранулирована и для соотвествующего в логе входа сохраняться событие выборки данных и исполнения и так же счётчики. Это позволит далее отобразить стату в виде графика. Этот функционал давно реализован <noindex><a href="https://yadi.sk/i/cAAE4aX236nRik" rel="nofollow" target="_blank">https://yadi.sk/i/cAAE4aX236nRik</a></noindex><br>Но не откатан, пока я пилю само ядро мотора. Для быстрого получения результа я просто создам базу данных, в которую буду сохранять всю стату. Проблема будет только в анализе данной инфы - придётся запилить простой гуй для визуального отображения результа.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372070&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=2" class="addthx" data-post="372070"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 февраля 2017 22:13 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#3');return false;">#3</a> </span><div align=left><br>
Вот что вызывает прот из АПИ на начальной стадии<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0015105F</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C809A2D</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>LocalAlloc<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l1"><span class="hl_number">00151573</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C80DE95</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>GetCurrentProcess<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_number">00152F34</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C80998B</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>GetCurrentThread<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">001564A5</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C80B475</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>GetModuleFileNameW<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">3</span></li><li class="hl_l0"><span class="hl_number">001540DB</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C809A2D</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>LocalAlloc<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l1"><span class="hl_number">00161403</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C8099CF</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>LocalFree<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">00166A16</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C80B475</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>GetModuleFileNameW<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">3</span></li><li class="hl_l1"><span class="hl_number">0016C759</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C80AC7E</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>FreeLibrary<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">00168867</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">77DE6F55</span>&nbsp;<span class="hl_char">[</span>ADVAPI32<span class="hl_char">.</span>OpenSCManagerW<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">3</span></li><li class="hl_l1"><span class="hl_number">00168C28</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">77E369B8</span>&nbsp;<span class="hl_char">[</span>ADVAPI32<span class="hl_char">.</span>EnumServicesStatusExW<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">10</span></li><li class="hl_l0"><span class="hl_number">0016D8F6</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C80AC7E</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>FreeLibrary<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">00168E35</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C90FE21</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>RtlGetLastWin32Error<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0"><span class="hl_number">001690DC</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C809A2D</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>LocalAlloc<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l1"><span class="hl_number">001693AE</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">77E369B8</span>&nbsp;<span class="hl_char">[</span>ADVAPI32<span class="hl_char">.</span>EnumServicesStatusExW<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">10</span></li><li class="hl_l0"><span class="hl_number">0016BAB6</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C8099CF</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>LocalFree<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">0016BC11</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">77DE6CE5</span>&nbsp;<span class="hl_char">[</span>ADVAPI32<span class="hl_char">.</span>CloseServiceHandle<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">00169CEF</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">77DE6FFD</span>&nbsp;<span class="hl_char">[</span>ADVAPI32<span class="hl_char">.</span>OpenServiceW<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">3</span></li><li class="hl_l1"><span class="hl_number">00169F51</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">77DF6F92</span>&nbsp;<span class="hl_char">[</span>ADVAPI32<span class="hl_char">.</span>QueryServiceConfigW<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">4</span></li><li class="hl_l0"><span class="hl_number">0016A15E</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C90FE21</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>RtlGetLastWin32Error<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">0016A405</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C809A2D</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>LocalAlloc<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l0"><span class="hl_number">0016A689</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">77DF6F92</span>&nbsp;<span class="hl_char">[</span>ADVAPI32<span class="hl_char">.</span>QueryServiceConfigW<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">4</span></li><li class="hl_l1"><span class="hl_number">0016B591</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C8099CF</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>LocalFree<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">0016B6CC</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">77DE6CE5</span>&nbsp;<span class="hl_char">[</span>ADVAPI32<span class="hl_char">.</span>CloseServiceHandle<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">00170106</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C8207BD</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>GetProcessAffinityMask<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">3</span></li><li class="hl_l0"><span class="hl_number">00170835</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C80998B</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>GetCurrentThread<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1"><span class="hl_number">00170B89</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C82EAC2</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>SetThreadAffinityMask<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l0"><span class="hl_number">00170C61</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C802446</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>Sleep<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l1"><span class="hl_number">0017054B</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C862E24</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>SetProcessAffinityMask<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l0"><span class="hl_number">00171F29</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C82EAC2</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>SetThreadAffinityMask<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span></li><li class="hl_l1"><span class="hl_number">0017259F</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">Call</span><span class="hl_char">:</span>&nbsp;<span class="hl_number">7C862E24</span>&nbsp;<span class="hl_char">[</span>kernel32<span class="hl_char">.</span>SetProcessAffinityMask<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;Args<span class="hl_char">:</span>&nbsp;<span class="hl_number">2</span></li>        </ol>
    </div>
</div></div>
<br>плюс многое сюда не попало, т.к. сидит во вложенных функах.<br>Всё таки декомпильнул я его загрузчик до конца, с регистрами разобрался, но остались несколько недевиртуализованных инструкций.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372071&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=3" class="addthx" data-post="372071"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 февраля 2017 22:20 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#4');return false;">#4</a> </span><div align=left><br>
<b>Vamit</b><br><br>Могу вам выложить подробный лог по нтапи, но нужно время на импорт логгера.<br><br>Вчера кстате вспомнил была забавная ситуация. Семпл первым делом детектит отладчик через винь апи IsDebuggerPresent(). Детект сей основан на проверке флага в PEB. Фишка в том что если его сбросить, то отладочный юзер лог переключится на ядерный и начнётся генерация CC. Конечно нет проблемы пропатчить кодес, но решилось интересно. Просто задана условная конструкция на выборку данных с этого адреса и соответствующее обнуление регистра-ридера. Но далее из не профайла был тупо поставлен евент на возврат из этой апи и фикс результа. забавно да <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372072&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=4" class="addthx" data-post="372072"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 06:32 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#5');return false;">#5</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Да нет, вы не понимаете. Этот визор юзермод. </I><br>ну мне прямо полегчало..<img src="img/smilies/s3.gif" alt=""><br>ну а на самом деле, конечно интересно практическая сторона мотора.
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372089&amp;user=3230&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=5" class="addthx" data-post="372089"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 07:39 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#6');return false;">#6</a> </span><div align=left><br>
<I>Bronco пишет:<br>конечно интересно практическая сторона мотора </I><br><br>Гражданин навечно застрял в 32-битах, и отвлекает товарища Vamita от работы на 64-битным вмпротом своими <br>&quot;моторами&quot;, работать с которыми может он один, &quot;ввиду их невероятной сложности&quot; <img src="img/smilies/s5.gif" alt=""><br><br><I>difexacaw пишет:<br>Если к примеру rdtsc можно забанить настройкой железа(мср), то cpuid так не получится трекнуть. </I><br><br>Давай ты мне тут не будешь рассказывать, а? Засылай любой &quot;сэмпл&quot;, я тебе и cpuid, и rdtsc &quot;трекну&quot; <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372090&amp;user=41088&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=6" class="addthx" data-post="372090"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35168" title="16-02-2017 07:10, ранг:55.7" target="_blank">v00doo</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 07:55 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#7');return false;">#7</a> </span><div align=left><br>
<b>oldman</b><br><br>Семпл выше, найдите как детектит варю.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372091&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=7" class="addthx" data-post="372091"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 09:02 &middot; Поправил: oldman <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#8');return false;">#8</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Семпл выше, найдите как детектит варю.  </I><br><br>Оба &quot;семпла&quot;  запущены под варей. Детектит варю оно элементарно - вызывает cpuid с eax=1, и смотрит в ответе, <br>включен ли бит 31 в ECX - &quot;Hypervisor present&quot; - бит я выключил. Далее идут вызовы cpuid с eax=0, в надежде <br>найти вендора &quot;VmwareVmware&quot;, но там я заботливо оставил &quot;fuck&quot; <img src="img/smilies/s5.gif" alt=""> Ну там еще с eax=7 вызовы идут,<br>не вникал зачем оно ему.<br><br>Rdtsc юзает активно, но толи криво реализован детект разницы таймеров между прямыми вызовами, и через <br>форсированый vmexit, толи не для этого вообще используется - вообщем через rdtsc вмпрот варю задетектить не <br>смог, в отличие от pafish-a, и ему подобных.<br><br>ЗЫ. полируем сверху Сциллой и &quot;cэмплы&quot; запускаются под варей и из под x32dbg <img src="img/smilies/s6.gif" alt=""><br><br>ЗЗЫ. На варе установлена win10 anniversary
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372092&amp;user=41088&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=8" class="addthx" data-post="372092"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 09:35 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#9');return false;">#9</a> </span><div align=left><br>
<b>oldman</b><br><br>Не правда, я заменял результ cpuid на тот, который на реал тачке, оно всё равно детектит. И никаких вызовов с 7 нет.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372093&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=9" class="addthx" data-post="372093"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 09:45 &middot; Поправил: oldman <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#10');return false;">#10</a> </span><div align=left><br>
<I>difexacaw пишет:<br> оно всё равно детектит. </I><br><br>моторчик видать твой хреновато работает, пропускает вызовы <img src="img/smilies/s6.gif" alt=""><br><br>15 раз выполняет cpuid с eax=0, 24 раз с eax=1, и 11 с eax=7 - это который usermode.exe<br><br>С ....kernelmode.exe, тот в сумме 56 раз вызвал.<br><br><b>Добавлено спустя -57 минут</b><br><I>difexacaw пишет:<br>И никаких вызовов с 7 нет.  </I><br><br>Просто мой  &quot;мотор&quot; всё палит, и .dll которые процесс подгрузил - тоже <img src="img/smilies/s3.gif" alt=""><br><br>Это, судя по rip - bcryptprimitives.dll вызывает с eax=7<br><br>ЗЫ.<br><br>cpuid rip = 0000000000895AD6 eax = 0000000000000001<br>cpuid rip = 000000000068A61E eax = 0000000000000001<br>cpuid rip = 000000000069BE6E eax = 0000000000000001<br>cpuid rip = 000000000069BE6E eax = 0000000000000001<br>cpuid rip = 000000000069BE6E eax = 0000000000000001<br>cpuid rip = 000000000069BE6E eax = 0000000000000001<br>cpuid rip = 000000000046F50C eax = 0000000000000000<br>cpuid rip = 000000000046F51F eax = 0000000000000001<br>cpuid rip = 0000000000524B67 eax = 0000000000000001<br><br>Последние 3 - динамические, при запуске ехе там пусто, но потом :<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0046F50C</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>cpuid</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">0046F50E</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;C<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">0046F511</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">18</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ebx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_number">0046F514</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">14</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">0046F517</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">10</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_number">0046F51A</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">0046F51F</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>cpuid</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">0046F521</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">0046F524</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_number">0046F527</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ebx</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">0046F528</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4000000</span>&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_number">0046F52F</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>je</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;akvu<span class="hl_char">.</span><span class="hl_number">46F53F</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">0046F531</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;akvu<span class="hl_char">.</span><span class="hl_number">46F492</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">0046F536</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>eax</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">0046F538</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>je</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;akvu<span class="hl_char">.</span><span class="hl_number">46F53F</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">0046F53A</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>eax</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">0046F53C</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">0046F53D</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;akvu<span class="hl_char">.</span><span class="hl_number">46F541</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li>        </ol>
    </div>
</div></div>
<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00524B67</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>cpuid</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00524B69</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>esi</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">00524B6B</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">dh</span><span class="hl_char">,</span><span style="word-break: break-all">&nbsp;E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00524B6E</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>cmc</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">00524B6F</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>sub</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebp</span><span class="hl_char">,</span><span style="word-break: break-all">&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00524B75</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;C<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">00524B79</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ebx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_number">00524B7D</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>adc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ebp</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">00524B7F</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>sbb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>esi</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00524B81</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>ebp</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">00524B85</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>sbb</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>di</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00524B88</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ss</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">00524B8C</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ebx</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00524B8D</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ah</span><span class="hl_char">,</span><span style="word-break: break-all">&nbsp;FB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">00524B90</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>btc</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span>&nbsp;FFFFFFE4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_number">00524B95</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">00524B97</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">sp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">7C16</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00524B9C</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr"><b>esi</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">4</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">00524BA2</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ebx</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00524BA4</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">bp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">4446</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">00524BA9</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">sp</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr"><b>ax</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00524BAC</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>bswap</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>eax</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span class="hl_number">00524BAE</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">bp</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">509C</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00524BB3</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">79954FB4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_number">00524BB8</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>clc</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span class="hl_number">00524BB9</span>&nbsp;<span class="hl_char">|</span>&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;akvu<span class="hl_char">.</span><span class="hl_number">5F0471</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372094&amp;user=41088&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=10" class="addthx" data-post="372094"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 09:56 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#11');return false;">#11</a> </span><div align=left><br>
<b>oldman</b><br><br>Может оно от версии оси зависит. У меня нет столько вызовов.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372095&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=11" class="addthx" data-post="372095"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]v00doo[/b]','')">v00doo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 80.6 (постоянный), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.07'>Активность: 0.1<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=35168">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 11:13 &middot; Поправил: v00doo <br><script type="text/javascript">QU('v00doo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=v00doo" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#12');return false;">#12</a> </span><div align=left><br>
<b>difexacaw</b>, вот честно, сделай отдельную тему со своим &quot;мотором&quot;, везде им все засрал, я понимаю, что ты тут всех переплюнешь, но пользы в теме &quot;Декомпилятор ВМ&quot; точно никакой, просто нулевая.<br><I>Vamit пишет:<br>Я уже устал говорить, что прот не детектит дебагер со Сциллой. Если код проги не поломан, то все эти rdtsc, cupid пошли нафиг, на них организована проверка целостности кода и антидампинг.  </I><br><br>API же <b>Vamit</b> и сам выдернул все.<br>Ps Я тоже сейчас особо не несу никакой пользы, но хоть не спамлю, а молча сел ковыряться сам, у <b>difexacaw</b> же совсем другие интересы : рассказать какой клевый &quot;мотор&quot; и как все легко, а вы все устарели, тошнит уже, в каждой теме одно и тоже.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372099&amp;user=35168&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=12" class="addthx" data-post="372099"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=31325" title="16-02-2017 07:25, ранг:9.5" target="_blank">zNob</a>, <a href="action=userinfo&user=41088" title="16-02-2017 18:35, ранг:26.9" target="_blank">oldman</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 11:32 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#13');return false;">#13</a> </span><div align=left><br>
<b>v00doo</b><br><br>Не в моторе же суть. Очевидно что отладчика не достаточно, нужны есчо методы. И полезность не нулевая, вот в данный момент снимается статистика по каждой инструкции семпла, выложу как закончит обработку и если получится ужать дамп в разумный размер. Весьма полезная инфа.<br><br><b>Добавлено спустя -22 минут</b><br><noindex><a href="https://yadi.sk/d/nVUhPv7j3E9PdJ" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>В архиве два дампа, секция с семпла и статистика(ужалось в 400k <img src="img/smilies/s1.gif" alt=""> ). Снята для длительного цикла от аллокации памяти до DEADC0DE. Содержит для каждой инструкции счётчик исполнений и счётчик выборок данных из памяти(для каждого адреса). Осталось только как то вывести это на экран, гуй пильнуть.<br><br><b>Добавлено спустя -8 минут</b><br>Забыл сказать, можно взять инструкции с макс значением счётчика и выделить так основной цикл в коде и далее можно выделить сам код через граф. То что в 19.#12
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372101&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=13" class="addthx" data-post="372101"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=3230" title="16-02-2017 12:38, ранг:152.7" target="_blank">Bronco</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]r99[/b]','')">r99</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/314.gif" alt=""><br><span class=txtSm>Ранг: 328.7 (мудрец), 73thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=314">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 13:01 <br><script type="text/javascript">QU('r99','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r99" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#14');return false;">#14</a> </span><div align=left><br>
<I>oldman пишет:<br> запущены под варей </I><br><br>вари ведь тоже разные бывают-пропатченные или нет.<br>так что сравнивать реакцию на cpuid и только - не совсем корректно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372102&amp;user=314&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=14" class="addthx" data-post="372102"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 13:38 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#15');return false;">#15</a> </span><div align=left><br>
<b>difexacaw</b><br>Ты думашь что эти 60Мб сырого кода будет кто-то смотреть? У меня после Свипера почти 100Мб получается, ну и что, нужен не полуфабрикат, а конечный результат - исходный код стартап секции прота.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372103&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=15" class="addthx" data-post="372103"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 14:00 &middot; Поправил: oldman <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#16');return false;">#16</a> </span><div align=left><br>
<I>r99 пишет:<br>вари ведь тоже разные </I><br><br>не патченая, вмтулз запущен. В конфиге возможно слегка что-то накручивал, но там вроде не про детект, а про<br>оптимизацию больше, сейчас уже не помню точно - но учитывая полученные результаты (т.е. успешный запуск <br>защищенного приложения) - вмпорт не использует стандартные  методы детекта, типа чтения ключей реестра, <br>названий хардов, и т.д. и т.п.<br><br>Если прямо так интересно, могу с нуля вообще без твиков виртуалку слепить.<br><br>---<br>ЗЫ.  Во время запуска происходит ещё такой вызов апи:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">GetModuleHandleA&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_quote">&quot;sbiedll.dll&quot;</span>&nbsp;<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>Это оно походу Sandboxie так детектит <img src="img/smilies/s6.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372105&amp;user=41088&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=16" class="addthx" data-post="372105"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Gideon Vi[/b]','')">Gideon Vi</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/2585.jpg" alt=""><br><span class=txtSm>Ранг: 1131.7 <b><u>(!!!!)</u></b>, 447thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.83'>Активность: 0.67<span style='color:red'>&searr;</span>0.2</span><br>Статус: <a href="action=userinfo&amp;user=2585">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 14:29 <br><script type="text/javascript">QU('Gideon Vi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Gideon Vi" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#17');return false;">#17</a> </span><div align=left><br>
<I>oldman пишет:<br>Это оно походу Sandboxie так детектит </I><br><br>да, причем детект песочниц объединен в одной опции вместе с детектом виртуалок, что, прямо скажем, рукажопство.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372106&amp;user=2585&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=17" class="addthx" data-post="372106"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]v00doo[/b]','')">v00doo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 80.6 (постоянный), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.07'>Активность: 0.1<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=35168">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 15:00 <br><script type="text/javascript">QU('v00doo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=v00doo" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#18');return false;">#18</a> </span><div align=left><br>
<b>Gideon Vi</b>, возможно это для хомяков, для которых что песочница, что ВМ одно и тоже.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372107&amp;user=35168&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=18" class="addthx" data-post="372107"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 16:46 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#19');return false;">#19</a> </span><div align=left><br>
<I>oldman пишет:<br>Гражданин навечно застрял в 32-битах </I><br>архитектура не принципиальна для обкатки, а без материала это всё теория.<br>сам по себе метод интересный.<br><I>oldman пишет:<br>и отвлекает товарища Vamita от работы на 64-битным вмпротом </I><br>не в упрёк Vamit, но как я понял, мотивация зависима от интереса к приложению, сам прот чисто как препятствие.<br>будет апп под х64, возможно будет и декомпиль.
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372110&amp;user=3230&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=19" class="addthx" data-post="372110"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 22:25 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#20');return false;">#20</a> </span><div align=left><br>
Вот что юзается при запуске(без подмены результа cupid):<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">NtQueryInformationProcess<span class="hl_char">,</span>&nbsp;ProcessDebugPort</li><li class="hl_l1">NtQueryInformationProcess<span class="hl_char">,</span>&nbsp;ProcessDebugObjectHandle</li><li class="hl_l0">NtSetInformationThread<span class="hl_char">,</span>&nbsp;ThreadHideFromDebugger</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>RDTSC</b></span>&nbsp;Ip<span class="hl_char">:</span>&nbsp;0x684647</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">NtCreateFile<span class="hl_char">,</span>&nbsp;akelpad<span class="hl_char">.</span>vmp<span class="hl_char">.</span>usermode<span class="hl_char">.</span>exe</li><li class="hl_l1">NtQueryInformationFile</li><li class="hl_l0">NtMapViewOfSection</li><li class="hl_l1">NtUnmapViewOfSection</li><li class="hl_l0">NtClose</li><li class="hl_l1">NtProtectVirtualMemory</li><li class="hl_l0">NtAllocateVirtualMemory</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">(</span>wait<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">.</span>05G&nbsp;Ip's</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">NtClose<span class="hl_char">,</span>&nbsp;DEADC0DE</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_number">008A273B</span>&nbsp;<span class="hl_function">popfd</span></li><li class="hl_l1"><span class="hl_number">008A273C</span>&nbsp;<span class="hl_function">rdtsc</span></li><li class="hl_l0"><span class="hl_number">008A273E</span>&nbsp;<span class="hl_function"><b>nop</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">-</span>&nbsp;#DB</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">KiUED<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">NtQueryInformationProcess<span class="hl_char">,</span>&nbsp;ProcessExecuteFlags</li><li class="hl_l1">NtQueryVirtualMemory<span class="hl_char">,</span>&nbsp;Ip<span class="hl_char">:</span>&nbsp;0x69B868</li><li class="hl_l0">NtContinue&nbsp;Ip&nbsp;<span class="hl_char">-</span><span class="hl_char">&gt;</span>&nbsp;0x0046FE08</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>CPUID</b></span>&nbsp;<span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;Ip<span class="hl_char">:</span>&nbsp;0x895AD6</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">OpenSCM<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l1">EnumServiceStatusEx<span class="hl_char">(</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">-</span><span class="hl_char">-</span>&nbsp;shadow<span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br><b>Добавлено спустя -39 минут</b><br><b>Vamit</b><br><br>&gt; У меня после Свипера почти 100Мб получается<br><br>Так ведь нужен общий метод что бы как то ориентироваться в таких огромных логах. Вот к примеру овер 1G инструкций, с чего начать подходить к этому. Учитывая что я даже не знаю что есть свипер&quot;.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372116&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=20" class="addthx" data-post="372116"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]oldman[/b]','')">oldman</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 30.2 (посетитель), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 3.96'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=41088">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 23:04 <br><script type="text/javascript">QU('oldman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=oldman" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#21');return false;">#21</a> </span><div align=left><br>
<I>difexacaw пишет:<br> Учитывая что я даже не знаю что есть свипер&quot;.  </I><br><br>имхо гражданин упорот, ибо так тролить.. ну нельзя просто <img src="img/smilies/s6.gif" alt=""><br><br>лицо вверх экрана подними, название темы прочитай, и там прилепленное сообщение сверху.. &quot;в логах <br>ориентироваться надо&quot;..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=372121&amp;user=41088&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=21" class="addthx" data-post="372121"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 февраля 2017 23:16 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#22');return false;">#22</a> </span><div align=left><br>
<b>oldman</b><br><br>Я не смотрел, так как мне не понравился пункт:<br><br>- точки входа в ВМ находятся вручную<br><br>Можно ради интереса подсчитать общее число инструкций(без повторений).
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372122&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=22" class="addthx" data-post="372122"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 00:13 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#23');return false;">#23</a> </span><div align=left><br>
<I>difexacaw пишет:<br>Вот что юзается при запуске(без подмены результа cupid): </I><br>по результу прикольно, только гипервизор больше сигнатур детектит<br><I>difexacaw пишет:<br>- точки входа в ВМ находятся вручную </I><br>да это некорректность вышла, входы в вм автоматом детектят, просто де_компиляция методов на выбор, и действительно вручную надо указать или бряк тыкнуть.
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372128&amp;user=3230&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=23" class="addthx" data-post="372128"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 00:27 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#24');return false;">#24</a> </span><div align=left><br>
<b>Bronco</b><br><br>&gt; по результу прикольно, только гипервизор больше сигнатур детектит<br><br>Возможно далее если скорректировать результ cpuid. Я это есчо не сделал. В данном случае больше cpuid нет.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372130&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=24" class="addthx" data-post="372130"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 00:56 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#25');return false;">#25</a> </span><div align=left><br>
<I>difexacaw пишет:<br>точки входа в ВМ находятся вручную </I><br>они вообще-то легко сигнатурно детектятся.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372133&amp;user=24257&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=25" class="addthx" data-post="372133"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 февраля 2017 02:01 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#26');return false;">#26</a> </span><div align=left><br>
<b>Vamit</b><br><br>&gt;  У меня после Свипера почти 100Мб получается<br><br>Я тут подсчитал число повторений, не уверен что я ровно дамп сохранил, но пока получается следующее. При числе исполненных инструкций 780М, с учётом повторений число инструкций 5K.<br><br>Проверил, всё верно. 1.266G общее число инструкций., 1.05G это без учёта ветвлений. Всего инструкций без повторений ~11.6K <img src="img/smilies/s3.gif" alt=""><br><br>О каких стопицот мегабайтах шла речь хз, видимо сабж кривой, почените.<br><br>По данным стата(это делают те 11k инструкций):<br>Выборок из памяти(R/W) - 230.7M<br>Без повторений - 4М, но без учёта размера выбираемых данных.<br><br><b>Добавлено спустя 1 час 32 минуты</b><br>Пильнул парсер, что бы выделить адреса из дампа. Вот результ в аттаче.<br><br>В логе список адресов инструкций, которые выполняют сабжевый гигабайтный цикл. Это 8K кода, остальной(из 11к, удалил из лога) - вызов апи видимо в конце работы цикла.<br><br>Интересно было бы снять стату по записи в код. Так же можно конструктором выделить весь код и сдампить, ну что бы было наглядно, а то разбросан по всему модулю.<br><br>Следует заметить что данное решение выполнено автоматикой на основе статы, я даже в код поделки не смотрел <img src="img/smilies/s12.gif" alt=""><br><br><img src="img/attach.gif" alt=""> <a href="./files/5625_17.02.2017_EXELAB.rU.tgz">5625_17.02.2017_EXELAB.rU.tgz</a> - vmdparse.rar
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372136&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=26" class="addthx" data-post="372136"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24257" title="17-02-2017 11:53, ранг:251.5" target="_blank">DenCoder</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2017 11:25 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#27');return false;">#27</a> </span><div align=left><br>
Интересно было посмотреть что за код, захватил конструктором часть из дампа. Может кому интересно <noindex><a href="https://yadi.sk/d/JFpQdfrD3EE6x3" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex>
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372215&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=27" class="addthx" data-post="372215"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2017 11:46 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#28');return false;">#28</a> </span><div align=left><br>
<b>difexacaw</b><br>Может хватит уже в эту тему всякую хрень выкладывать. Тема для декомпиляции вм в общем, и по вмпроту в частности. От тебя же практически ни одного дельного поста по этой теме не было. Если обкатываешь свой хххвизор, то создай отдельную тему и пиши туда что захочешь. Зачем же здесь мусорить.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372217&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=28" class="addthx" data-post="372217"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35168" title="18-02-2017 23:13, ранг:56.9" target="_blank">v00doo</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2017 11:50 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#29');return false;">#29</a> </span><div align=left><br>
<b>Vamit</b><br><br>От вас для меня тоже в данной теме вообще ничего годного <img src="img/smilies/s2.gif" alt=""><br><br>Вот к примеру там код поморфлен и нужно как то его собрать в нормальный вид, ну что бы начать эту вашу декомпиляцию/деморф. Вы про это ничего не говорили, что весьма странно.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372218&amp;user=40990&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=29" class="addthx" data-post="372218"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 февраля 2017 13:34 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#30');return false;">#30</a> </span><div align=left><br>
Всё что описано ниже относится к VmProtect v3<br>Нормальной декомпиляции функций ядра протектора мешают модифицированные пакетные вызовы виртуализованных функций.<br><br><b>Схема обычного пакетного вызова в основном идентична ранним версиям протектора:</b><br>Вызывающая функция (виртализованный код)<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">-</span>&nbsp;тело&nbsp;вызывающей&nbsp;функции</li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;адрес&nbsp;возврата&nbsp;в&nbsp;стек&nbsp;<span class="hl_char">(</span>адрес&nbsp;реальной&nbsp;точки&nbsp;входа&nbsp;в&nbsp;вм<span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_char">-</span>&nbsp;контекст&nbsp;вм&nbsp;в&nbsp;стек</li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;смена&nbsp;адреса&nbsp;пикода&nbsp;и&nbsp;переход&nbsp;на&nbsp;него&nbsp;<span class="hl_char">(</span>пакетный&nbsp;вызов<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;восстановление&nbsp;контекста&nbsp;из&nbsp;стека&nbsp;<span class="hl_char">(</span>точка&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;тело&nbsp;вызываемой&nbsp;функции</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;выход&nbsp;из&nbsp;вм</li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;вход&nbsp;в&nbsp;вм&nbsp;с&nbsp;адреса&nbsp;возврата</li><li class="hl_l0"><span class="hl_char">-</span>&nbsp;продолжение&nbsp;тела&nbsp;вызывающей&nbsp;функции</li>        </ol>
    </div>
</div></div>
<br>Реальная вызываемая функция<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">-</span>&nbsp;вход&nbsp;в&nbsp;вм&nbsp;с&nbsp;сохранением&nbsp;контекста&nbsp;<span class="hl_char">(</span>открытый&nbsp;код<span class="hl_char">)</span></li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;загрузка&nbsp;контекста&nbsp;в&nbsp;вм&nbsp;<span class="hl_char">(</span>здесь&nbsp;и&nbsp;далее&nbsp;виртуализованный&nbsp;код<span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_char">-</span>&nbsp;антидампинг</li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;контекст&nbsp;вм&nbsp;в&nbsp;стек</li><li class="hl_l0">Точка&nbsp;<span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;сюда&nbsp;идет&nbsp;пакетный&nbsp;вызов</li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;восстановление&nbsp;контекста&nbsp;из&nbsp;стека</li><li class="hl_l0"><span class="hl_char">-</span>&nbsp;тело&nbsp;функции</li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;выход&nbsp;из&nbsp;вм</li>        </ol>
    </div>
</div></div>
<br>В данном случае найти реальную функцию, соответствующую пакетной не просто, но возможно. Для этого нужно девиртуализовать все реальные функции и сравнить адреса пикода в точке 1, совпадение адресов даст совпадение функций.<br><br><b>Схема модифицированного пакетного вызова:</b><br>Вызывающая функция (виртализованный код)<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">-</span>&nbsp;тело&nbsp;вызывающей&nbsp;функции</li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;адрес&nbsp;возврата&nbsp;в&nbsp;стек&nbsp;<span class="hl_char">(</span>адрес&nbsp;пикода<span class="hl_char">)</span></li><li class="hl_l0"><span class="hl_char">-</span>&nbsp;контекст&nbsp;вм&nbsp;в&nbsp;стек</li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;смена&nbsp;адреса&nbsp;пикода&nbsp;и&nbsp;переход&nbsp;на&nbsp;него&nbsp;<span class="hl_char">(</span>пакетный&nbsp;вызов<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;восстановление&nbsp;контекста&nbsp;из&nbsp;стека&nbsp;<span class="hl_char">(</span>точка&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;тело&nbsp;вызываемой&nbsp;функции</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">-</span>&nbsp;простой&nbsp;переход&nbsp;со&nbsp;сменой&nbsp;адреса&nbsp;пикода&nbsp;на&nbsp;адрес&nbsp;возврата</li><li class="hl_l1"><span class="hl_char">-</span>&nbsp;продолжение&nbsp;тела&nbsp;вызывающей&nbsp;функции</li>        </ol>
    </div>
</div></div>
<br>А вот реальных вызываемых функций соответствующих такому пакетному вызову в коде протектора я не нашел. Похоже он обрезает начало своих пакетных функций, т.к. они не предназначены для вызовов из открытого кода.<br>----------------------------------------------------------<br>Напомню, что восстановление контекста вм из стека производится в регистры вм отличные от сохраненных.<br><br>А вот как девиртуализовать модифицированную пакетную функцию отдельно от вызывающей для меня пока загадка. Конечно есть одна мысль, сохранять состояние декомпилятора на точке 1 пакетного вызова, затем выходим из режима декомпиляции, загружаем в декомпилятор сохраненное состояние, чистим его на предмет данных, не относящихся к пакетной функции и стартуем декомпиляцию с точки 1, но тут большая трудоемкость реализации сохранений/восстановлений состояний декомпилятора. Намного проще другой путь - на точке 1 пакетного вызова производим выбор, что же декомпилить дальше, продолжать декомпиляцию вызывающей функции, оформив пакетный вызов как call xxx или декомпилить только пакетную функцию, предварительно почистив в декомпиляторе все данные не относящиеся к ней. Но эта реализация тоже не проста, как кажется...
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372220&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=30" class="addthx" data-post="372220"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]Bronco[/b]','')">Bronco</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/3230.gif" alt=""><br><span class=txtSm>Ранг: 312.0 (мудрец), 349thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.46<span style='color:green'>&nearr;</span>0.65</span><br>Статус: <a href="action=userinfo&amp;user=3230">Участник</a><br><font color=blue>Advisor</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 19 февраля 2017 01:47 <br><script type="text/javascript">QU('Bronco','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Bronco" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=20#31');return false;">#31</a> </span><div align=left><br>
Что значит &quot;пакетный вызов&quot; ?<br>это передача управления на другой метод под виртой, с восстановлением контекста цпу, или другое?<br>адрес возрата уникален или меняется? <br>вопросов много, оссобено по терминам. требую новый словарь.<img src="img/smilies/s3.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы юзер в нэте не делал,его всё равно жалко..</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=372261&amp;user=3230&amp;forum_n=13&amp;topic=15906&amp;page=20&amp;anchor=31" class="addthx" data-post="372261"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=19.html">&lt;&lt;</a> <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=0.html">1</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=17.html">18</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=18.html">19</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=19.html">20</a> . <b>21</b> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=21.html">22</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=22.html">23</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=23.html">24</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=21.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Декомпилятор ВМ</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="15906">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15906" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
