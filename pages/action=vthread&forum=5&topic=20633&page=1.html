<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как скрыть от программы запуск в среде VMware? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="всех приветствую! поискал решение на форуме, явного ответа не нашел. Вопрос: как спрятать от программы то, что она запускается в виртуальной среде VMware. Прошу Вас делиться положительным или отрицательным опытом. Итак, что мною">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как скрыть от программы запуск в среде VMware?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=5&amp;topic=20633&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=5&amp;topic=20633&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]stepsid[/b]','')">stepsid</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33574">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 декабря 2012 23:39 &middot; Поправил: stepsid <br><script type="text/javascript">QU('stepsid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=stepsid" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#1');return false;">#1</a> </span><div align=left><br>
всех приветствую!<br><br>поискал решение на форуме, явного ответа не нашел.<br>Вопрос: как спрятать от программы то, что она запускается в виртуальной среде VMware.<br>Прошу Вас делиться положительным или отрицательным опытом.<br><br>Итак, что мною было сделано в процессе поиска решения.<br>1. Нашел два документа, объясняющих как обнаружить запуск программы под виртуальной машиной <br>а. <noindex><a href="http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1009458&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=571232032&amp;stateId=1%200%20571230541" rel="nofollow" target="_blank">Mechanisms to determine if software is running in a VMware virtual machine</a></noindex><br>б. <noindex><a href="http://handlers.sans.org/tliston/ThwartingVMDetection_Liston_Skoudis.pdf" rel="nofollow" target="_blank">VMDetection</a></noindex><br><br>2. Добавил параметры в конфигурационный файл .vmx<br>смотри ниже.<br><br>После перезагрузки VM, использовал утилиты<br><noindex><a href="http://www.codeproject.com/Articles/9823/Detect-if-your-program-is-running-inside-a-Virtual" rel="nofollow" target="_blank">утилита 1</a></noindex>, <noindex><a href="http://www.trapkit.de/research/vmm/scoopyng/index.html" rel="nofollow" target="_blank">утилита 2</a></noindex> для обнаружения запуска в виртуальной среде. Обе утилиты показали отсутсвие виртуальной среды.<br>2. Модифицировал serial number vmware SMBIOS, убрав упоминание о Vmware (Vmware-, VMW)<br>3. Удалял VMTools.<br>4. Мониторил с помощью <noindex><a href="http://technet.microsoft.com/ru-ru/sysinternals/bb896645" rel="nofollow" target="_blank">Procmon</a></noindex> активность программы на предмет поиска строки vmware в запросах к файловой системе и реестру. Не нашел явных запросов.<br>5. Отключал у процессора поддержку виртуализации, что бы исключить проверку по <noindex><a href="http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1009458&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=571232032&amp;stateId=1%200%20571230541" rel="nofollow" target="_blank">CPUID hypervisor present bit</a></noindex><br><br>Следующий этап решения проблеммы - запуск программы в среде отладчика, поиск и блокировка проверяющего кода.<br>Судя по всему, задачка не совсем тривиальная. Разработчик программы снабдил свое творение не только защитой от запуска в виртуальной среде,<br>но и защитой от запуска в среде отладчика + частично зашифровал исполняемый код.<br>Честно говоря, последный раз отладчиком пользовался лет 18 назад.<br>Но сейчас посмотрю что и как, почитаю статьи на тему - думаю разберусь.<br>И если у кого-то есть опробированное решение разворачивания комплекса отладки дебагера+дизассемблера, работающего в стелс режиме, на виртуальное машине -<br>буду рад услышать совет. Желательно с сылками на установочные дистрибутивы и на &quot;покурить мануалы&quot; <img src="img/smilies/s1.gif" alt=""><br>Спасибо.<br><br>Да поможет нам 0xCD03h и 0x90h.<br><br>PS:<br>привожу список настроек vmware ws9, с которыми гостевая система проходит большинство проверок на наличие виртуальной среды. <br>Ссылка на <noindex><a href="http://sanbarrow.com/vmx.html" rel="nofollow" target="_blank">неплохое описание параметров в .vmx файла</a></noindex><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">#основные&nbsp;параметры</li><li class="hl_l1">monitor_control<span class="hl_char">.</span>virtual_rdtsc&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span>&nbsp;&nbsp;</li><li class="hl_l0">monitor_control<span class="hl_char">.</span>restrict_backdoor&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>getPtrLocation<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>setPtrLocation<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>setVersion<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>getVersion<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">monitor_control<span class="hl_char">.</span>disable_directexec&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span>&nbsp;</li><li class="hl_l0">monitor_control<span class="hl_char">.</span>disable_btinout&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">monitor_control<span class="hl_char">.</span>disable_btmemspace&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">monitor_control<span class="hl_char">.</span>disable_btpriv&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">monitor_control<span class="hl_char">.</span>disable_btseg&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">##&nbsp;неактуальны&nbsp;для&nbsp;WS9<span class="hl_char">,</span>&nbsp;можно&nbsp;удалить</li><li class="hl_l1">#monitor_control<span class="hl_char">.</span>disable_chksimd&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span>&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">#monitor_control<span class="hl_char">.</span>disable_ntreloc&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span>&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">#monitor_control<span class="hl_char">.</span>disable_selfmod&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span>&nbsp;</li><li class="hl_l0">#monitor_control<span class="hl_char">.</span>disable_reloc&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span>&nbsp;&nbsp;</li><li class="hl_l1">#оборудование</li><li class="hl_l0">#CPU<span class="hl_char">/</span>маскирование&nbsp;<span class="hl_function">CPUID</span></li><li class="hl_l1">featMask<span class="hl_char">.</span>vm<span class="hl_char">.</span><span class="hl_function">cpuid</span><span class="hl_char">.</span>family<span class="hl_char">=</span><span class="hl_quote">&quot;val:15&quot;</span></li><li class="hl_l0">featMask<span class="hl_char">.</span>vm<span class="hl_char">.</span><span class="hl_function">cpuid</span><span class="hl_char">.</span><span class="hl_function">model</span><span class="hl_char">=</span><span class="hl_quote">&quot;val:3&quot;</span></li><li class="hl_l1">featMask<span class="hl_char">.</span>vm<span class="hl_char">.</span><span class="hl_function">cpuid</span><span class="hl_char">.</span>stepping<span class="hl_char">=</span><span class="hl_quote">&quot;val:4&quot;</span></li><li class="hl_l0">#отключение&nbsp;Hypervisor_bit&nbsp;и&nbsp;настройка&nbsp;вложенной&nbsp;<span class="hl_char">(</span>nested<span class="hl_char">)</span>&nbsp;виртуализации&nbsp;для&nbsp;установки&nbsp;Hyper<span class="hl_char">-</span>V</li><li class="hl_l1">hypervisor<span class="hl_char">.</span><span class="hl_function">cpuid</span><span class="hl_char">.</span>v0&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l0">hypervisor<span class="hl_char">.</span><span class="hl_function">cpuid</span><span class="hl_char">.</span>v1&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l1">mce<span class="hl_char">.</span>enable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">##настройка&nbsp;nested&nbsp;виртуализации<span class="hl_char">.</span>&nbsp;можно&nbsp;отключить<span class="hl_char">.</span></li><li class="hl_l1">vhv<span class="hl_char">.</span>enable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">featMask<span class="hl_char">.</span>vm<span class="hl_char">.</span>hv<span class="hl_char">.</span>capable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;Min:1&quot;</span></li><li class="hl_l1">vmGenCounter<span class="hl_char">.</span>enable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l0">#сетевой&nbsp;адаптер</li><li class="hl_l1">ethernet0<span class="hl_char">.</span>addressType&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;static&quot;</span></li><li class="hl_l0">##указать&nbsp;свой&nbsp;MAC</li><li class="hl_l1">ethernet0<span class="hl_char">.</span>Address&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;ХХ:ХХ:ХХ:ХХ:ХХ:ХХ&quot;</span>&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">#отключение&nbsp;VMCI&nbsp;из&nbsp;списка&nbsp;оборудования&nbsp;гостевой&nbsp;системы<span class="hl_char">.</span></li><li class="hl_l1">vmci<span class="hl_char">.</span>available&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l0">vmci0<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l1">#дополнительная&nbsp;изоляция&nbsp;гостевой&nbsp;системы</li><li class="hl_l0">guest<span class="hl_char">.</span>commands<span class="hl_char">.</span>enabled&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l1">RemoteDisplay<span class="hl_char">.</span>maxConnections&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;1&quot;</span></li><li class="hl_l0">tools<span class="hl_char">.</span>setInfo<span class="hl_char">.</span>sizeLimit&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;1048576&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>device<span class="hl_char">.</span>connectable<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>device<span class="hl_char">.</span>edit<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>copy<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>dnd<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>setGUIOptions<span class="hl_char">.</span>enable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>paste<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>hgfs<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>hgfsServerSet<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span><span class="hl_function">monitor</span><span class="hl_char">.</span>control<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>ghi<span class="hl_char">.</span>autologon<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>bios<span class="hl_char">.</span>bbs<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>getCreds<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>ghi<span class="hl_char">.</span>launchmenu<span class="hl_char">.</span>change&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>memSchedFakeSampleStats<span class="hl_char">.</span>disable&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>ghi<span class="hl_char">.</span>protocolhandler<span class="hl_char">.</span>info<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>ghi<span class="hl_char">.</span>host<span class="hl_char">.</span>shellAction<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>dispTopoRequest<span class="hl_char">.</span>disable&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>trashFolderState<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>ghi<span class="hl_char">.</span>trayicon<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>unity<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>unityInterlockOperation<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>unity<span class="hl_char">.</span>taskbar<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>unityActive<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>unity<span class="hl_char">.</span>windowContents<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>unity<span class="hl_char">.</span><span class="hl_function">push</span><span class="hl_char">.</span>update<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>vmxDnDVersionGet<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>guestDnDVersionSet<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>diskShrink<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>diskWiper<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>autoInstall<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">vmsafe<span class="hl_char">.</span>enable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l0">isolation<span class="hl_char">.</span>tools<span class="hl_char">.</span>vixMessage<span class="hl_char">.</span>disable&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">tools<span class="hl_char">.</span>guestlib<span class="hl_char">.</span>enableHostInfo&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l0">sharedFolder0<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l1">sharedFolder1<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l0">#отключение&nbsp;неиспользуемого&nbsp;оборудования</li><li class="hl_l1">usb<span class="hl_char">.</span>generic<span class="hl_char">.</span>autoconnect&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l0">serial0<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l1">serialX<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l0">floppy0<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l1">floppyX<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l0">parallel0<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l1">parallelX<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;FALSE&quot;</span></li>        </ol>
    </div>
</div></div>
<br><br>Совет: Не должны быть установлено VMware Tools. Все неиспользуемое оборудование - отключайте.<br>Пример:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">pciBridge0<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">pciBridge4<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">pciBridge4<span class="hl_char">.</span>virtualDev&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;pcieRootPort&quot;</span></li><li class="hl_l1">pciBridge4<span class="hl_char">.</span>functions&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;8&quot;</span></li><li class="hl_l0">#pciBridge5<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">#pciBridge5<span class="hl_char">.</span>virtualDev&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;pcieRootPort&quot;</span></li><li class="hl_l0">#pciBridge5<span class="hl_char">.</span>functions&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;8&quot;</span></li><li class="hl_l1">#pciBridge6<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l0">#pciBridge6<span class="hl_char">.</span>virtualDev&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;pcieRootPort&quot;</span></li><li class="hl_l1">#pciBridge6<span class="hl_char">.</span>functions&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;8&quot;</span></li><li class="hl_l0">#pciBridge7<span class="hl_char">.</span>present&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;TRUE&quot;</span></li><li class="hl_l1">#pciBridge7<span class="hl_char">.</span>virtualDev&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;pcieRootPort&quot;</span></li><li class="hl_l0">#pciBridge7<span class="hl_char">.</span>functions&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;8&quot;</span></li><li class="hl_l1">pciBridge0<span class="hl_char">.</span>pciSlotNumber&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;17&quot;</span></li><li class="hl_l0">pciBridge4<span class="hl_char">.</span>pciSlotNumber&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;21&quot;</span></li><li class="hl_l1">#pciBridge5<span class="hl_char">.</span>pciSlotNumber&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;22&quot;</span></li><li class="hl_l0">#pciBridge6<span class="hl_char">.</span>pciSlotNumber&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;23&quot;</span></li><li class="hl_l1">#pciBridge7<span class="hl_char">.</span>pciSlotNumber&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;24&quot;</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=315943&amp;user=33574&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=1" class="addthx" data-post="315943"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]stepsid[/b]','')">stepsid</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33574">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июля 2013 22:15 &middot; Поправил: stepsid <br><script type="text/javascript">QU('stepsid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=stepsid" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#2');return false;">#2</a> </span><div align=left><br>
<I>ntldr пишет:<br>cpuid с eax = 1 и проверка 31 бита в ecx, оно?  </I><br><br><noindex><a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff538624%28v=vs.85%29.aspx" rel="nofollow" target="_blank">вот что тут есть по этому поводу у микропрограмм.</a></noindex><br>однако, если не ошибаюсь, то vmware может маскировать<br>GPUID по EAX 0,1,5,80000000h,80000001h,80000008h,8000000Ah (блокировка svm/vmx)<br>по поводу GPUID eax=80000000Ah <noindex><a href="http://pastebin.com/wJ5eAr" rel="nofollow" target="_blank">сюда</a></noindex><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">cpuid</span><span class="hl_char">.</span><span class="hl_registr">eax</span><span class="hl_char">.</span><span class="hl_number">0</span><span class="hl_char">=</span><span class="hl_quote">&quot;----:----:----:----:----:----:----:----&quot;</span></li><li class="hl_l1">skip</li><li class="hl_l0"><span class="hl_function">cpuid</span><span class="hl_char">.</span><span class="hl_registr">eax</span><span class="hl_char">.</span><span class="hl_number">8000000A</span><span class="hl_char">=</span><span class="hl_quote">&quot;----:----:----:----:----:----:----:----&quot;</span></li>        </ol>
    </div>
</div></div>
<br><noindex><a href="http://communities.vmware.com/thread/263019?start=0&amp;tstart=0" rel="nofollow" target="_blank">есть особенности, связанные с уровнями и методами реализации виртуализации</a></noindex><br><br>Однако, при установленных параметрах:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">hypervisor<span class="hl_char">.</span><span class="hl_function">cpuid</span><span class="hl_char">.</span>v0<span class="hl_char">=</span><span class="hl_quote">&quot;FALSE&quot;</span></li><li class="hl_l1">hypervisor<span class="hl_char">.</span><span class="hl_function">cpuid</span><span class="hl_char">.</span>v1<span class="hl_char">=</span><span class="hl_quote">&quot;FALSE&quot;</span></li>        </ol>
    </div>
</div></div>
<br>AIDA64 и pcwizard2012 не видят &quot;поднятый&quot; бит Hypervisor в свойствах процессора.<br>есть другой метод тестирования установленного Hypervisor bit , кроме как самому написать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327444&amp;user=33574&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=2" class="addthx" data-post="327444"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июля 2013 07:28 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#3');return false;">#3</a> </span><div align=left><br>
Интересная темка. Твоя софтина детектит только варю или любую вм?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327578&amp;user=22831&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=3" class="addthx" data-post="327578"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]stepsid[/b]','')">stepsid</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33574">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июля 2013 11:03 <br><script type="text/javascript">QU('stepsid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=stepsid" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#4');return false;">#4</a> </span><div align=left><br>
<b>spinz</b><br>а вчитаться в тему?<br>я ставлю задачу скрыть присутствие виртуальной среды, а не обнаружить ее.<br>и я не пишу инструментарий, я пытаюсь настроить\модифицировать саму виртуальную машину конкретного разработчика.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327580&amp;user=33574&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=4" class="addthx" data-post="327580"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июля 2013 11:26 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#5');return false;">#5</a> </span><div align=left><br>
весьма  вчитался, не увидел. там только р3 или все же дрова?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327581&amp;user=22831&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=5" class="addthx" data-post="327581"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]stepsid[/b]','')">stepsid</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33574">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июля 2013 13:30 &middot; Поправил: stepsid <br><script type="text/javascript">QU('stepsid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=stepsid" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#6');return false;">#6</a> </span><div align=left><br>
<b>spinz</b><br>р3 это в каком смысле? если ring3, то все изменения требуется делать до загрузки гостевой системы.<br>я же написал все на предыдущей странице.<br>и bios-ы (системный, контроллеров), и &quot;движок&quot; виртуальной машины, и драйвера устройств.<br>везде убираются известные строки, меняется, по необходимости,  VendorID.<br>подобное уже делалось, в том или ином виде, для прежних версий (ws 4, ws 6).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327588&amp;user=33574&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=6" class="addthx" data-post="327588"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]stepsid[/b]','')">stepsid</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33574">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июля 2013 13:37 <br><script type="text/javascript">QU('stepsid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=stepsid" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#7');return false;">#7</a> </span><div align=left><br>
<b>stepsid</b><br>опс. извини, я сам не понял о чем ты спрашивал.<br>ты говорил о той программе, которую я исследую, которая определяет наличие виртуальной среды - tnt d3 bot. <br>думаю, что она определяет любую виртуальную среду, так как при работе программа сообщает о наличии виртуальной машины вообще, без конкретики.<br>можешь попробовать сам. спроси в пм - брошу линк на архив.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327589&amp;user=33574&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=7" class="addthx" data-post="327589"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]numan[/b]','')">numan</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.32'>Активность: 0.01=0.01</span><br>Статус: <a href="action=userinfo&amp;user=28405">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 13:02 <br><script type="text/javascript">QU('numan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=numan" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#8');return false;">#8</a> </span><div align=left><br>
<b>stepsid</b> залей куда нить  свой wmware-vmx.exe с которого убрал следы от вари и сылку на бота
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327618&amp;user=28405&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=8" class="addthx" data-post="327618"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 15:12 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#9');return false;">#9</a> </span><div align=left><br>
<I>stepsid пишет:<br>при работе программа сообщает о наличии виртуальной машины вообще </I><br>в этом и вопрос. ты тестил бота только под варей?другие виртуалки он детектит?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327623&amp;user=22831&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=9" class="addthx" data-post="327623"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 15:15 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#10');return false;">#10</a> </span><div align=left><br>
Если он детектит только варю, это одно. Если он умеет из р3 концептуально отличать натив и виртуалку - даже интересно
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327624&amp;user=22831&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=10" class="addthx" data-post="327624"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]stepsid[/b]','')">stepsid</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33574">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 15:54 <br><script type="text/javascript">QU('stepsid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=stepsid" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#11');return false;">#11</a> </span><div align=left><br>
<b>spinz</b><br>другие не пробовал, только варю.<br><I>spinz пишет:<br>Если он умеет из р3 концептуально отличать натив и виртуалку - даже интересно<br> </I><br>в варе вполне может. в верхнем посте ссылка есть на тему.<br>&quot;...<br>If you run your guest with binary translation, we can&#039;t intercept CPUID executed at CPL3, because that code runs in direct execution.  Under binary translation, we can only intercept the CPL0 CPUID instructions that we translate.  Under hardware-assisted virtualization, we intercept all CPUID instructions, regardless of privilege level.  I assume you are issuing CPUID from user code at CPL3.  You should be able to play with the preferred execution mode and see the effects of binary translation vs. VT-x.<br>Under binary translation, if you &quot;disable acceleration,&quot; we can intercept all CPUID instructions, since then everything is translated...&quot;<br><br>этот бот может иметь базу эталонных (реальных) ответов CPUID и сравнивать текущие ответы по CPUID с теми что должны быть.<br>пример: если посмотришь, по умолчанию, все биты о термодетекторах в виртуальной машине выставлены в 0.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327627&amp;user=33574&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=11" class="addthx" data-post="327627"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 16:36 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#12');return false;">#12</a> </span><div align=left><br>
детект по CPUID это фейк по сути, кривые руки девелоперов ВМ
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327635&amp;user=22831&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=12" class="addthx" data-post="327635"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]stepsid[/b]','')">stepsid</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33574">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 17:14 &middot; Поправил: stepsid <br><script type="text/javascript">QU('stepsid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=stepsid" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#13');return false;">#13</a> </span><div align=left><br>
<I>spinz пишет:<br>детект по CPUID это фейк по сути, кривые руки девелоперов ВМ  </I><br>в смысле определения уровня виртуализации?<br>а тут либо скорость (трансляция бинарного кода),  либо совместимость, по-моему.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327648&amp;user=33574&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=13" class="addthx" data-post="327648"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 17:30 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#14');return false;">#14</a> </span><div align=left><br>
Логично. Сваять быструю недектируемую ВМ нереально
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327649&amp;user=22831&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=14" class="addthx" data-post="327649"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]stepsid[/b]','')">stepsid</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33574">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 17:52 &middot; Поправил: stepsid <br><script type="text/javascript">QU('stepsid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=stepsid" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#15');return false;">#15</a> </span><div align=left><br>
<I>spinz пишет:<br>Логично. Сваять быструю недектируемую ВМ нереально  </I><br>не детектируемую - это вполне реально, буде у разработчиков такая задача.<br>замечу, что всего-то и надо:<br>- предоставить пользователям самим выбирать VendorID оборудования (контроллеры, CPU итд);<br>- убрать определенные сигнатуры из биоса и драйверов;<br>А вот с временными задержками исполнения виртуальной машины - проверка по RDTSC - вот тут, согласен, сложнее. Определение виртуальной среды, как правило, происходит по четко выверенным временным отпечаткам - ибо все остальные рудименты можно убрать. Что, собственно, я и попытался сделать - убрал &quot;рудименты&quot; - но это не скрывает виртуальную среду.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327652&amp;user=33574&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=15" class="addthx" data-post="327652"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 18:21 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#16');return false;">#16</a> </span><div align=left><br>
Убирать ничего не надо, пусть вертится на реальном железе, с небольшими ограничениями. VT-d для этого и придумали. Параметры временнЫх задержек легко эмулятся. Пусть софт антидетекта будет уверен, что работает на одноядерном пне-1.8ГГц. Тогда все становится легко ))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327661&amp;user=22831&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=16" class="addthx" data-post="327661"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]stepsid[/b]','')">stepsid</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33574">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 18:39 &middot; Поправил: stepsid <br><script type="text/javascript">QU('stepsid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=stepsid" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#17');return false;">#17</a> </span><div align=left><br>
так с одноядерным пнем на варе не вопрос. маскИруешь CPUID по F:M:S - будет тебе все что захочешь.<br>работать на реальном железе не получится, так как pci pass-through <noindex><a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1010789" rel="nofollow" target="_blank">совсем не однозначен</a></noindex> (касается только контроллеров), кроме того, нет возможности использовать реальную мат.плату, со всеми вытекающими. так что, убирать &quot;рудименты&quot; - надо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327663&amp;user=33574&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=17" class="addthx" data-post="327663"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]spinz[/b]','')">spinz</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.0 (постоянный), 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.09<span style='color:green'>&nearr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=22831">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июля 2013 18:56 <br><script type="text/javascript">QU('spinz','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=spinz" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#18');return false;">#18</a> </span><div align=left><br>
глянь в сторону мелкомягкого гипервизора, там гость работает на вполне реальном железе
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=327666&amp;user=22831&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=18" class="addthx" data-post="327666"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]NRiche[/b]','')">NRiche</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.9'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=35581">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 августа 2013 10:52 <br><script type="text/javascript">QU('NRiche','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=NRiche" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#19');return false;">#19</a> </span><div align=left><br>
А как вам удалось вырезать/изменить OEMStringArray из vmware-vmx.exe? Вот эти 2 строчки:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">[</span>MS_VM_CERT<span class="hl_char">/</span>SHA1<span class="hl_char">/</span><span class="hl_number">27d66596a61c48dd3dc7216fd715126e33f59ae7</span><span class="hl_char">]</span></li><li class="hl_l1">Welcome&nbsp;to&nbsp;the&nbsp;Virtual&nbsp;Machine</li>        </ol>
    </div>
</div></div>
<br>При любой попытке их изменить виртуалка просто не загружается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=329123&amp;user=35581&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=19" class="addthx" data-post="329123"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]stepsid[/b]','')">stepsid</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.9 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.55'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33574">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 августа 2013 21:58 <br><script type="text/javascript">QU('stepsid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=stepsid" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#20');return false;">#20</a> </span><div align=left><br>
<b>NRiche</b><br>подробнее опишу немного позже.<br>Вкратце: весь файл vmware-vmx.exe по сути архив из нескольких файлов.<br>Исполняемый модуль, несколько биосов для разных контроллеров, SMIBIOS и EFIBIOS. Загружать будем SMIBIOS.<br>Первым делом извлекаем ВСЕ необходимые файлы и указываем в конфигурации гостевой системы параметры загрузки интересующий нас биосов.<br>Затем производим изменения в бинарниках файлов биосов с изменением необходимых контрольных сумм.<br>Тоже с драйвером виртуального видеоадаптера. Основная задача - убрать известные нам сигратуры.<br>Важно! <u>В самом vmware-vmx.exe меняем сигратуры только там, где это требуется.</u> Это определяется по смещению, полученному опытным путем, причем это смещенеие не должно быть в пределах относительного файлового адресного пространства используемых нами биосов.<br>Тогда проблем с запуском не будет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=329230&amp;user=33574&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=20" class="addthx" data-post="329230"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]mexxo[/b]','')">mexxo</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.4 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.87'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=35687">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 сентября 2013 18:58 <br><script type="text/javascript">QU('mexxo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mexxo" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20633&amp;page=1#21');return false;">#21</a> </span><div align=left><br>
<b>stepsid</b>Привет, можешь контакт какойнить свой кинуть, тоже с такой проблемой столкнулся как ты, вообще не выходит vmx.exe отредактировать... может ты поможешь...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330284&amp;user=35687&amp;forum_n=5&amp;topic=20633&amp;page=1&amp;anchor=21" class="addthx" data-post="330284"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=5&amp;topic=20633&amp;page=0.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=5&amp;topic=20633&amp;page=0.html">1</a> . <b>2</b> .</b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как скрыть от программы запуск в среде VMware?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#22" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="20633">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=20633" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
