<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Пауза в Delphi - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Невероятно странный вопрос, но всё же: Каким образом организовать в Delphi паузу, чтобы при ожидании не грузила дико процесс и обрабатывались события (особенно на закрытие программы!)? В сети куча советов, которые на деле не">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Пауза в Delphi</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 00:47 &middot; Поправил: Isaev <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Невероятно странный вопрос, но всё же:<br>Каким образом организовать в Delphi паузу, чтобы при ожидании не грузила дико процесс и обрабатывались события (особенно на закрытие программы!)?<br>В сети куча советов, которые на деле не пашут.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Procedure&nbsp;Delay<span class="hl_char">(</span>mSec<span class="hl_char">:</span>Cardinal<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">Var</li><li class="hl_l0">&nbsp;&nbsp;TargetTime<span class="hl_char">:</span>Cardinal<span class="hl_comment">;</span></li><li class="hl_l1">Begin</li><li class="hl_l0">&nbsp;&nbsp;TargetTime<span class="hl_char">:</span><span class="hl_char">=</span>GetTickCount<span class="hl_char">+</span>mSec<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>While</b></span>&nbsp;TargetTime<span class="hl_char">&gt;</span>GetTickCount&nbsp;Do</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Application<span class="hl_char">.</span>ProcessMessages<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>End</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Вот это полная противоположность тому, что надо!
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266134&amp;user=6946&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=1" class="addthx" data-post="266134"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Error13Tracer[/b]','')">Error13Tracer</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.8 (новичок), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.52'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19328">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 01:03 <br><script type="text/javascript">QU('Error13Tracer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error13Tracer" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Юзай в цикле<br>procedure ProcessMessages;<br>var<br>  Msg: TMsg;<br>function ProcessMsg(var Msg: TMsg): Boolean;<br>begin<br>  Result := False;<br>  if PeekMessage(Msg, 0, 0, 0, PM_REMOVE) then<br>  begin<br>    Result := True;<br>    if Msg.Message &lt;&gt; WM_QUIT then<br>    begin<br>      TranslateMessage(Msg);<br>      DispatchMessage(Msg);<br>    end<br>    else<br>      DispatchMessage(Msg);<br>  end;<br>end;  <br>begin<br>  while ProcessMsg(Msg) do;<br>end;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266135&amp;user=19328&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=2" class="addthx" data-post="266135"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Error13Tracer[/b]','')">Error13Tracer</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.8 (новичок), 21thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.52'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19328">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 01:12 <br><script type="text/javascript">QU('Error13Tracer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Error13Tracer" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Само собой, что прога виснуть будет. Лучше создай отдельное окно, принимающее только данное сообщение и вышеуказаный код внеси в него, так менше ошибок будет
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266136&amp;user=19328&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=3" class="addthx" data-post="266136"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 01:29 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
т.е. так?<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_function"><b>While</b></span>&nbsp;TargetTime<span class="hl_char">&gt;</span>GetTickCount&nbsp;Do</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>While</b></span>&nbsp;ProcessMsg<span class="hl_char">(</span>Msg<span class="hl_char">)</span>&nbsp;Do<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br><br>В общем то же самое, на закрытие формы не реагирует, пока не кончится пауза и загрузка проца 90%
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266138&amp;user=6946&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=4" class="addthx" data-post="266138"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Lumen[/b]','')">Lumen</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/2305.gif" alt=""><br><span class=txtSm>Ранг: 111.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.94'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 01:57 <br><script type="text/javascript">QU('Lumen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Lumen" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">procedure&nbsp;Delay<span class="hl_char">(</span>ATimeout<span class="hl_char">:</span>&nbsp;Integer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">var</li><li class="hl_l0">&nbsp;&nbsp;t<span class="hl_char">:</span>&nbsp;Cardinal<span class="hl_comment">;</span></li><li class="hl_l1">begin</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>while</b></span>&nbsp;ATimeout&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">0</span>&nbsp;do</li><li class="hl_l1">&nbsp;&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;GetTickCount<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;MsgWaitForMultipleObjects<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;nil^<span class="hl_char">,</span>&nbsp;<span class="hl_function">False</span><span class="hl_char">,</span>&nbsp;ATimeOut<span class="hl_char">,</span>&nbsp;QS_ALLINPUT<span class="hl_char">)</span>&nbsp;of</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WAIT_TIMEOUT<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>Break</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WAIT_FAILED<span class="hl_char">:</span>&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application<span class="hl_char">.</span>ProcessMessages<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;Application<span class="hl_char">.</span>Terminated&nbsp;then&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">dec</span><span class="hl_char">(</span>ATimeout<span class="hl_char">,</span>&nbsp;GetTickCount&nbsp;<span class="hl_char">-</span>&nbsp;t<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Попробуй так. На Delphi 7 пашет.
<br><br><font size="1"><i>-----<br>The truth is out of there...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266140&amp;user=2305&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=5" class="addthx" data-post="266140"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 02:02 &middot; Поправил: Isaev <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Lumen</b> Зашибись! <img src="img/smilies/s1.gif" alt=""><br><br><b>[added]</b><br>Рано обрадовался <img src="img/smilies/s1.gif" alt=""><br>ещё раз суть проблемы... на простейшем примере<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;For&nbsp;N<span class="hl_char">:</span><span class="hl_char">=</span><span class="hl_number">1</span>&nbsp;To&nbsp;<span class="hl_number">100</span>&nbsp;Do</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Memo1<span class="hl_char">.</span>Lines<span class="hl_char">.</span>Append<span class="hl_char">(</span>IntToStr<span class="hl_char">(</span>N<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Delay<span class="hl_char">(</span><span class="hl_number">5000</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>End</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Вот хотелось бы, чтобы в процессе выполнения цикла:<br>1. можно было закрыть форму<br>2. процессор не грузился<br><br><I>Error13Tracer пишет:<br>Само собой, что прога виснуть будет. </I><br>А с чего она должна виснуть?<br>она должна отдыхать... Как таймер работает не грузя систему?
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266141&amp;user=6946&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=6" class="addthx" data-post="266141"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Lumen[/b]','')">Lumen</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/2305.gif" alt=""><br><span class=txtSm>Ранг: 111.1 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.94'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 02:49 &middot; Поправил: Lumen <br><script type="text/javascript">QU('Lumen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Lumen" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Sleep(1)  к примеру можно добавить. Тогда виснуть по идее не должно.<br>А чтобы можно было закрыть форму - добавить проверку на Application.Terminated.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Procedure&nbsp;Delay<span class="hl_char">(</span>mSec<span class="hl_char">:</span>Cardinal<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">Var</li><li class="hl_l0">&nbsp;&nbsp;TargetTime<span class="hl_char">:</span>Cardinal<span class="hl_comment">;</span></li><li class="hl_l1">Begin</li><li class="hl_l0">&nbsp;&nbsp;TargetTime<span class="hl_char">:</span><span class="hl_char">=</span>GetTickCount<span class="hl_char">+</span>mSec<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>While</b></span>&nbsp;TargetTime<span class="hl_char">&gt;</span>GetTickCount&nbsp;Do</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Application<span class="hl_char">.</span>ProcessMessages<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sleep<span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>If</b></span>&nbsp;Application<span class="hl_char">.</span>Terminated&nbsp;then&nbsp;Exit<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>End</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>The truth is out of there...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266142&amp;user=2305&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=7" class="addthx" data-post="266142"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 02:58 &middot; Поправил: Isaev <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
В общем, удовлетворяет, спасибо!<br><br>только хотелось бы в подключаемый модуль сунуть, а Application.* не даёт<br><br>Если кто знает способ лучше, с удовольствием потестю <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266144&amp;user=6946&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=8" class="addthx" data-post="266144"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 03:32 &middot; Поправил: Isaev <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Что-то на основе WaitableTimer хотелось бы сделать, но никак до конца не разберусь...<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">Procedure&nbsp;Delay<span class="hl_char">(</span>mSec<span class="hl_char">:</span>Cardinal<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">Var</li><li class="hl_l0">&nbsp;&nbsp;P<span class="hl_char">:</span>Int64<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;Timer<span class="hl_char">:</span>Cardinal<span class="hl_comment">;</span></li><li class="hl_l0">Begin</li><li class="hl_l1">&nbsp;&nbsp;Timer<span class="hl_char">:</span><span class="hl_char">=</span>CreateWaitableTimer<span class="hl_char">(</span>Nil<span class="hl_char">,</span><span class="hl_function">False</span><span class="hl_char">,</span>Nil<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;P<span class="hl_char">:</span><span class="hl_char">=</span><span class="hl_char">-</span><span class="hl_number">10</span><span class="hl_char">*</span>mSec<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;SetWaitableTimer<span class="hl_char">(</span>Timer<span class="hl_char">,</span>P<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span>Nil<span class="hl_char">,</span>Nil<span class="hl_char">,</span><span class="hl_function">False</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;WaitForSingleObjectEx<span class="hl_char">(</span>Timer<span class="hl_char">,</span>INFINITE<span class="hl_char">,</span><span class="hl_function">True</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>Timer<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>End</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>что тут не так?
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266146&amp;user=6946&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=9" class="addthx" data-post="266146"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]tomac[/b]','')">tomac</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 65.3 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.82'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6470">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 04:09 <br><script type="text/javascript">QU('tomac','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tomac" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Может, стоит делать GetMessage(), после установки себе же таймера, потом перепосылать себе это сообщение (PostMessage), спать немного и делать Application.ProcessMessages?<br>А если не использовать Application.*... Не проще ли таймер сделать? <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=266148&amp;user=6470&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=10" class="addthx" data-post="266148"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 04:12 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>tomac пишет:<br>Не проще ли таймер сделать? </I><br>к нему и пришёл, см выше, но пока не разобрался до конца
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266149&amp;user=6946&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=11" class="addthx" data-post="266149"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 06:53 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">BOOL&nbsp;WINAPI&nbsp;SetWaitableTimer<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;__in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;hTimer<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;__in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>const</b></span>&nbsp;LARGE_INTEGER<span class="hl_char">*</span>&nbsp;pDueTime<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;__in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LONG&nbsp;lPeriod<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;__in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PTIMERAPCROUTINE&nbsp;pfnCompletionRoutine<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;__in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPVOID&nbsp;lpArgToCompletionRoutine<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;__in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BOOL&nbsp;fResume</li><li class="hl_l1"><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>1) P должен быть указателем на Int64;<br>2) lPeriod = 0, таймер сигнализирует однажды.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266156&amp;user=24257&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=12" class="addthx" data-post="266156"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 08:44 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Application.ProcessMessages был создан программистами борланда как временное решление проблемы мультипоточности в Delphi а потом оставлен для совместимости. Если вы его используете, значит код написан в корне неправильно. В GUI приложении на Delphi паузы не может быть в принципе, т.к. в основной нити идет выборка и обработка оконнных сообщений, останавливать которую нельзя. Для таких дел есть класс TThread, создающий отдельную нить. В примере с заполнением цикла можно сделать так:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;TForm1&nbsp;<span class="hl_char">=</span>&nbsp;class<span class="hl_char">(</span>TForm<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Memo1<span class="hl_char">:</span>&nbsp;TMemo<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Button1<span class="hl_char">:</span>&nbsp;TButton<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;procedure&nbsp;Button1Click<span class="hl_char">(</span>Sender<span class="hl_char">:</span>&nbsp;TObject<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;private</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;Private&nbsp;declarations&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function">public</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<span class="hl_function"><b>Public</b></span>&nbsp;declarations&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;TThreadListFill&nbsp;<span class="hl_char">=</span>&nbsp;class<span class="hl_char">(</span>TThread<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;procedure&nbsp;Execute<span class="hl_comment">; override;</span></li><li class="hl_l0">&nbsp;&nbsp;private</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;FValue&nbsp;<span class="hl_char">:</span>&nbsp;String<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;procedure&nbsp;AddValue<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">var</li><li class="hl_l0">&nbsp;&nbsp;Form1<span class="hl_char">:</span>&nbsp;TForm1<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">implementation</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">{<span class="hl_char">$</span>R&nbsp;<span class="hl_char">*</span><span class="hl_char">.</span>dfm}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">{&nbsp;TThreadListFill&nbsp;}</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">procedure&nbsp;TThreadListFill<span class="hl_char">.</span>AddValue<span class="hl_comment">;</span></li><li class="hl_l1">begin</li><li class="hl_l0">&nbsp;&nbsp;Form1<span class="hl_char">.</span>Memo1<span class="hl_char">.</span>Lines<span class="hl_char">.</span>Append<span class="hl_char">(</span>FValue<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">procedure&nbsp;TThreadListFill<span class="hl_char">.</span>Execute<span class="hl_comment">;</span></li><li class="hl_l0">var</li><li class="hl_l1">&nbsp;&nbsp;i&nbsp;<span class="hl_char">:</span>&nbsp;Integer<span class="hl_comment">;</span></li><li class="hl_l0">begin</li><li class="hl_l1">&nbsp;&nbsp;for&nbsp;i&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span>&nbsp;to&nbsp;<span class="hl_number">100</span>&nbsp;do</li><li class="hl_l0">&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;FValue&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;IntToStr<span class="hl_char">(</span>i<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;Synchronize<span class="hl_char">(</span>AddValue<span class="hl_char">)</span><span class="hl_comment">; // VCL hack by Borland</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;Sleep<span class="hl_char">(</span><span class="hl_number">5000</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;Terminated&nbsp;then&nbsp;<span class="hl_function"><b>Break</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">procedure&nbsp;TForm1<span class="hl_char">.</span>Button1Click<span class="hl_char">(</span>Sender<span class="hl_char">:</span>&nbsp;TObject<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">var</li><li class="hl_l0">&nbsp;&nbsp;FillList&nbsp;<span class="hl_char">:</span>&nbsp;TThreadListFill<span class="hl_comment">;</span></li><li class="hl_l1">begin</li><li class="hl_l0">&nbsp;&nbsp;FillList&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;TThreadListFill<span class="hl_char">.</span>Create<span class="hl_char">(</span><span class="hl_function">True</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;FillList<span class="hl_char">.</span>FreeOnTerminate&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>True</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;FillList<span class="hl_char">.</span>Resume<span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Абсолютно не грузит систему, стоит задержка, т.к. отдельная нить, то работа не мешает обработчику сообщений.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266157&amp;user=3232&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=13" class="addthx" data-post="266157"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 222thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 10:09 <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>PE_Kill</b><br>+ 100 <img src="img/smilies/s1.gif" alt=""><br><br>Добавлю, что увеличить производительность может буферизованное добавление. Я делал так: <br><br>В другом потоке расширял и заполнял буфер (за концом строки указатель на следующую), при накапливании текста осуществлялась проверка, не истекло ли 20 мс (GetTickCount). <br>Если истекло, считал длину накопленного текста, упаковывал в буфер и оттуда уже в текстовый контрол. Такой алгоритм избавляет от избыточной очереди сообщений.
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266161&amp;user=24257&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=14" class="addthx" data-post="266161"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 17:04 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>PE_Kill</b> нить это конечно хорошо, но что же в неё всю программу вешать, а основной оставить только обработку сообщений?
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266192&amp;user=6946&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=15" class="addthx" data-post="266192"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 19:04 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>Isaev</b> почитай основы Win32 программирования. Именно так и советуют поступать. Если действия по времени продолжительные и мешают нормальному функционированию менеджеру сообщений, то да, пихай всё это в отдельный Thread.<br><br>У меня есть проект, насчитывающий более 10 000 строк кода и всё это запихано в отдельную нить, а основная как раз и отвечает только за обработку оконных сообщений.<br><br>Просто есть задачи, которые ты хоть как извратись, не сделаешь в основной нити, т.к. не можешь управлять очередью сообщений: блокирующие сокеты, Debug API, Events и многое многое другое. Поэтому стоит изначально правильно строить код, чтобы в последствие не переписывать всё с нуля.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266201&amp;user=3232&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=16" class="addthx" data-post="266201"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 29 сентября 2010 20:35 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=16777.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Ясненько, спасибо всем
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=266205&amp;user=6946&amp;forum_n=6&amp;topic=16777.html&amp;page=0&amp;anchor=17" class="addthx" data-post="266205"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Пауза в Delphi</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=16777" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
