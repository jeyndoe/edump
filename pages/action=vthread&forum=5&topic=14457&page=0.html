<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите разобраться с защитой :: UPX, Markus &amp; Laszlo [Overlay] и ещё много-много страшных слов - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго вам времени суток, уважаемые! Программа генерирует COFF файл для Proteus. (Тем кто не знает - это из области электроники) Ограничения: максимум генерация файла в два кб. Смотрим: PEID: UPX 0.89.6 - 1.02 / 1.05 - 1.24">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите разобраться с защитой :: UPX, Markus &amp; Laszlo [Overlay] и ещё много-много страшных слов</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=14457&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=14457&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]EST2000[/b]','')">EST2000</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3638">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2009 14:50 &middot; Поправил: EST2000 <br><script type="text/javascript">QU('EST2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=EST2000" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго вам времени суток, уважаемые!<br><br>Программа генерирует COFF файл для Proteus. (Тем кто не знает - это из области электроники)<br>Ограничения: максимум генерация файла в два кб.<br><br>Смотрим:<br><b>PEID</b>: UPX 0.89.6 - 1.02 / 1.05 - 1.24 -&gt; Markus &amp; Laszlo [Overlay] - Снимаем...<br><b>UPX -d</b> сотрудничать отказался (закриптован/модифицирован)<br>Ручная распаковка, QUnpack, PEiD Generic Unpacker дают одинаковый результат - дамп запускается.<br>Смотрим дальше:<br><b>PEID</b>: Borland Delphi 6.0 - 7.0<br><b>Olly</b> упорно твердит, что OEP вне кода, анализ кода тоже помощи не дает. Криптор ?<br>Смотрим Strings - такому письму позавидуют даже китайцы. Смотрим саму программу - вроде бы всё в порядке, за исключением нескольких мелочей. Во первых программа запускается без автоматического выбора вкладки (не работает OnFormActivate ?), несколько строк - буквы мешаются с русскими (прога на англ.), вобщем - что-то с ресурсами. <b>PE Explorer</b> - в принципе всё в порядке, видим компонент IceLicense с защитой от отладки, монитора и криптованием кода. Ну и ещё заметил: секция ресурсов вроде как отдельно и существует, но фактически ресурсы начинаются в предыдущей секции. От Res.Binder тоже толку мало, всё остается по старому. А вот теперь, то, чего я никак не могу понять, не спрашивайте как я на это вышел, не помню. Открываем файл в WinHex, допишем 1 нулевой байт в конец файла, смотрим: строчки которые шли в перемешку с русскими буквами оправились, но не все. Допишем ещё 1 байт: все строчки читабельны, за исключением всё того-же выбора первой вкладки при запуске программы. <b>PEiD</b> уже показывает Borland Delphi 6.0 - 7.0 [Overlay]. Некоторые строчки уже появляются в Olly, но всё равно недостаточно для работы. Дописываем ещё 1 байт, и сразу же всё приходит в такойже искореженный вид как и сразу после распаковки.<br><br>Объясните мне, новичку, почему так происходит, кто в этом виноват и как это убрать.<br>Чувствуется, что &quot;истина где-то рядом&quot; но что-то не пойму куда копать, ICELicense по идее не так и страшен как его малюют, и кажется что здесь ещё что-то сидит. Хотя я могу и очень ошибаться.<br>Тема не есть запрос на кряк, интересно понять и убрать защиту с вашей помощью.<br><br>Прога + 2 образца для теста (из компл. и второй более 2 кб) rapidshare.com/files/236296481/CM4.32.rar.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232285&amp;user=3638&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=1" class="addthx" data-post="232285"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2009 15:28 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>EST2000</b>Надо в файле правильно выставить <b>Size of Code</b>и <b>Base of Code</b> тогда олька небудет ругаться при загрузке файла<img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=232291&amp;user=17432&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=2" class="addthx" data-post="232291"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]EST2000[/b]','')">EST2000</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3638">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2009 16:02 &middot; Поправил: EST2000 <br><script type="text/javascript">QU('EST2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=EST2000" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>ClockMan пишет:<br>Надо в файле правильно выставить Size of Codeи Base of Code </I><br><br>Знать бы ещё что выставить <img src="img/smilies/s1.gif" alt=""> Там две секции без имени, которая из них код, какая дата. Поставил Base от первой и Size обоих, и.. да, олька ругаться перестала, добавилось немного читабельных стрингов (в ольке) - остальное по прежнему. А вот ещё, уважаемые, скажите, а возможно как-то раскопать границы секций и разделить их, и как их опознать (имена/типы). Такое впечатление что секции идут примерно так (образно) первая с 0 до 1.5, вторая с 1.5 до 2.5, третья с 2.5 до 4.0<br>Такое ведь возможно, каким-то модификатором или даже вручную сделать, чтобы запутать анализаторы и таких как я <img src="img/smilies/s1.gif" alt="">))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232294&amp;user=3638&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=3" class="addthx" data-post="232294"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]LIZARD[/b]','')">LIZARD</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 48.2 (посетитель), 49thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.19'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16489">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2009 17:36 <br><script type="text/javascript">QU('LIZARD','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=LIZARD" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>EST2000 пишет:<br>Olly упорно твердит, что OEP вне кода, анализ кода тоже помощи не дает </I><br>распаковал в ручную и олька не ругается ни разу, да и со строками вроде все нормально<br>вот посмотри sderni.ru/34007
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232298&amp;user=16489&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=4" class="addthx" data-post="232298"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2009 18:10 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
В общем случае границы, как и имена секций, не распознаешь. Хотя это и не нужно обычно, работает и ладно. А что за фиговина с дописыванием 1-хз, смотреть надо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232300&amp;user=1556&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=5" class="addthx" data-post="232300"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2009 20:06 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>EST2000</b><br>А почему PE Explorer&#039;ом не распаковывал. Ему пофиг обфускация UPX, и секции нормальные будут.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232314&amp;user=4026&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=6" class="addthx" data-post="232314"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]EST2000[/b]','')">EST2000</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3638">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2009 20:53 <br><script type="text/javascript">QU('EST2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=EST2000" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>LIZARD пишет:<br>распаковал в ручную и олька не ругается ни разу, да и со строками вроде все нормально <br>вот посмотри sderni.ru/34007  </I><br>У меня не запускается, и олька тоже самое твердит<br><br><I>SVLab пишет:<br>А почему PE Explorer&#039;ом не распаковывал. Ему пофиг обфускация UPX, и секции нормальные будут.  </I><br><br>А вот я как-то и не знал даже <img src="img/smilies/s1.gif" alt="">)) Я знаю что он может их просматривать, но мне и в голову не пришло, что сохраняется файл уже распакованный <img src="img/smilies/s1.gif" alt=""> Спасибо!<br><br>Распакованный PE Explorer-ом файл действительно не покореженный, секции красиво смотрятся, дописывать ничего не надо, видимо уже всё дописанно. PEiD говорит: Borland Delphi 6.0 - 7.0 [Overlay]<br>Такой вариант был после &quot;дописывания&quot; байтов. Как-то вот непонятно мне это. Может действительно всё дело в искареженных секциях, не знаю, на ум ничего не приходит. И опять же, куда пропадает стартовая вкладка ? (OnFormActivate)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232316&amp;user=3638&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=7" class="addthx" data-post="232316"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2009 22:08 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Возможно, все дело в этом overlay, в смысле, на него завязана какая-нибудь проверка, потому и вкладка не активируется (ну и последующие глюки возможны). Это два байта в конце нераспакованного файла, которые как-бы отсутствуют, вернее в заголовке файла сказано, что файл заканчивается до этих байт, они не входят в последнюю секцию. Pe Explorer их тоже дописывает, а при ручной распаковке они, естественно, теряются.<br>Но у меня, что вручную распакованный (без этих байт), что експлорером, работают одинаково, без твоих &quot;страшных&quot; глюков <img src="img/smilies/s1.gif" alt=""> , но без активной вкладки. Дописывание также ничего не меняет. Возможно, имеет значение не только их наличие, но и значение и расположение. Попробуй удали их у запакованного файла - получишь еще один вариант работы программы. <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232318&amp;user=4026&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=8" class="addthx" data-post="232318"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]EST2000[/b]','')">EST2000</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3638">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 мая 2009 23:31 &middot; Поправил: EST2000 <br><script type="text/javascript">QU('EST2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=EST2000" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>SVLab пишет:<br>Но у меня, что вручную распакованный (без этих байт), что експлорером, работают одинаково </I><br><br>Получается - что у меня фигня какая-то получается <img src="img/smilies/s1.gif" alt="">)) Первое где заметно - на вкладке &quot;About&quot; посередине вместо &quot;No license&quot; пишет &quot;Пи license&quot;, и на вкладке &quot;License&quot; в окошках, что открываются по ссылкам - тоже крякозябы. Эти глюки исчезают после дописывания этих байт. Распаковываю стандартным способом, Нахожу OEP (005116A4), дамп через PETools, затем ImpRec и в заключении ResBinder. Может я чего пропустил, но уже не первый раз так распаковываю, вроде нормально получалось.<br><br><I>SVLab пишет:<br>получишь еще один вариант работы программы </I><br><br>Вот я чего и боюсь, программа генерирует отладочный код, если она его будет генерить так же, как я: &quot;а не дописать ли мне ещё 2 байта ?&quot; - то дело плохо <img src="img/smilies/s1.gif" alt="">)))<br><br>Хотя, по идее, если дамп запускается и не вылетает спустя время - проверки целостности кода нет, т.е. подменив прыжок на OEP (прога уже будет висеть в памяти распакованная) я могу прыгнуть на свободный участок, где пропатчу нужное место, а затем как и задумывалось прыгну на OEP, то вобщем больше ничего и не надо. Но всё же интересно остается про 2 байта <img src="img/smilies/s1.gif" alt="">))) И почему именно 2 <img src="img/smilies/s1.gif" alt="">)))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232325&amp;user=3638&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=9" class="addthx" data-post="232325"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 мая 2009 04:13 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>EST2000 пишет:<br>UPX 0.89.6 - 1.02 / 1.05 - 1.24 -&gt; Markus &amp; Laszlo [Overlay]  </I><br><I>EST2000 пишет:<br>Открываем файл в WinHex, допишем 1 нулевой байт в конец файла </I><br>В конец фало надо дописать в бинарном виде <b>99A0</b> это оверлей по которому скорей всего идёт расшифровка ресурсов файла<img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=232337&amp;user=17432&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=10" class="addthx" data-post="232337"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]EST2000[/b]','')">EST2000</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3638">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 01:13 &middot; Поправил: EST2000 <br><script type="text/javascript">QU('EST2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=EST2000" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>ClockMan пишет:<br>В конец фало надо дописать в бинарном виде 99A0 </I><br><br>А &quot;ткните пальцем&quot; пожалуйста, куда смотреть. Очень уж интересно именно разобраться в подробностях.<br><br><I>SVLab пишет:<br>Но у меня, что вручную распакованный </I><br>Коротко опишите процесс распаковки, если не сложно. Я распаковывал как по статье  <a href="http://exelab.ru/art/?action=view&amp;id=366" target="_blank">Распаковка UPX-Scrambler - нет ничего проще</a>. И получил далеко не лучший вариант. По такому же принципу работают и Generic Unpacker и QUnpak (и на выходе файл один-в-один)<br><br>Вобщем-то я уже сломал её, но онтересны именно мелочи.<br>Слом такой (ориг. файл, не распакованный):<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"></li><li class="hl_l1"><span class="hl_comment">; меняем стандартный прыжок пакера на OEP</span></li><li class="hl_l0"><span class="hl_number">00595E2B</span>&nbsp;&nbsp;&nbsp;&nbsp;E9&nbsp;<span class="hl_number">74B8F7FF</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;<span class="hl_number">005116A4</span></li>        </ol>
    </div>
</div></div>
<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"></li><li class="hl_l1"><span class="hl_comment">; на прыжок в пустое место...</span></li><li class="hl_l0"><span class="hl_number">00595E2B</span>&nbsp;&nbsp;&nbsp;&nbsp;E9&nbsp;BE000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;00595EEE</li><li class="hl_l1"></li><li class="hl_l0"><span class="hl_comment">; а там уже не пустое место, а вот что:</span></li><li class="hl_l1"><span class="hl_number">00595EEE</span>&nbsp;&nbsp;&nbsp;&nbsp;C705&nbsp;<span class="hl_number">23715000</span>&nbsp;<span class="hl_number">00A00F00</span>&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_number">507123</span><span class="hl_char">]</span><span class="hl_char">,</span>0FA000</li><li class="hl_l0"><span class="hl_number">00595EF8</span>&nbsp;&nbsp;&nbsp;&nbsp;E9&nbsp;A7B7F7FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;005116A4</li>        </ol>
    </div>
</div></div>
<br>Первая строка - меняем байты в распакованном коде с 2 на 0FA000, и получаем вместо 2кб - 64мб (куда уж больше <img src="img/smilies/s1.gif" alt=""> ). в процессе последующего умножения получим не 0х800 (2048), а 0x3E80000 (65536) это число и будет занесено как ограничение на размер файла<br><br>Вторая строка - прыжок на OEP.<br><br><br>Все комментарии, замечания и критика приветствуются, ибо новичек, до советов - голодный. <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232396&amp;user=3638&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=11" class="addthx" data-post="232396"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 02:53 <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Ну, вообще-то, я соврал немного, оказывается. После твоего поста посмотрел в About, - также без оверлея &quot;Пи license&quot;. С оверлеем нормальное &quot;No license&quot;. А распаковать UPX как-то не так надо еще умудриться, не думаю, что файлы у нас получились разные. Посмотри, если хочешь<br>rapidshare.com/files/236871780/Dumped1.rar.html<br>Процесс для UPX (неважно, скрэмблированный или нет): В Оле идем в конец секции кода (по Олиной интерпретации) и ставим брейкпойнт на последний JMP. Запускаем. После прерывания еще один шаг и мы на OEP. Дамп, импорт, правка заголовка дабы Оля не ругалась, прикручивание оверлея (если есть). Вроде всё.<br>По поводу &quot;ткните пальцем&quot;, уже ведь тыкали - в конце нераспакованного файла.<br>По твоему инлайну, а зачем такой длинный прыжок аж на 595еее?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232398&amp;user=4026&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=12" class="addthx" data-post="232398"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 04:27 &middot; Поправил: ClockMan <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>EST2000</b>WinHex и PeTools тебе в руки<img src="img/smilies/s1.gif" alt=""><br>Открываешь упакованный файл в ре редакторе на вкладке секций смотришь последнию секцию а именно значение <b>RawOffset</b> и <b>Raw Size</b> складываешь их вместе и запоменаешь это число,открываешь этот фаый в WinHex и идёшь по этому адресу точто начинается с этого адреса это оверлей в твоём случае это <b>99A0</b> <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=232401&amp;user=17432&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=13" class="addthx" data-post="232401"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 10:37 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Сходу вопрос: поставить галку в QuickUnpack для обработки оверлея не пробовал? Если дело в нём, должно прокатить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232415&amp;user=1556&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=14" class="addthx" data-post="232415"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]EST2000[/b]','')">EST2000</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3638">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 11:06 <br><script type="text/javascript">QU('EST2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=EST2000" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>SVLab пишет:<br>По твоему инлайну, а зачем такой длинный прыжок аж на 595еее? </I><br><br>Пробовал недалеко от прыжка делать - перестал запускаться, может проверка пакера какая-то, а может нужно это место для чего, пробовал отследить на запись, результатов не получил, не стал дальше копать - спустился почти под конец файла и всё заработало.<br><br><I>ClockMan пишет:<br>начинается с этого адреса это оверлей в твоём случае это 99A0 </I><br>Точно! <img src="img/smilies/s1.gif" alt="">) Соответственно оверлей надо положить так-же как и был ? Т.е. на распакованном файле также делаем как и на запакованном (RawOffset + Raw Size) - положить туда то же что и в запакованном ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232420&amp;user=3638&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=15" class="addthx" data-post="232420"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]EST2000[/b]','')">EST2000</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3638">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 11:36 <br><script type="text/javascript">QU('EST2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=EST2000" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Archer пишет:<br>Сходу вопрос: поставить галку в QuickUnpack для обработки оверлея не пробовал? Если дело в нём, должно прокатить. </I><br><br>прокатило, а почему раньше не сделал - QUnpack ещё 1.5 без галочки этой был (ступил <img src="img/smilies/s1.gif" alt=""> сильно не ругайте). Да, дописал оверлей, вроде всё на месте. Единственный вопрос остался непонятным - про стартовую вкладку. Казалось-бы всё есть, программа работает, ограничение сняты. Но интересно же <img src="img/smilies/s1.gif" alt="">))<br>Неужели придется трейсить и сравнивать потом киллометры трейс-лога ?! <img src="img/smilies/s15.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232421&amp;user=3638&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=16" class="addthx" data-post="232421"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 12:20 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>EST2000 пишет:<br>Соответственно оверлей надо положить так-же как и был </I><br>Ты сам ответил на свой вопрос <img src="img/smilies/s1.gif" alt="">))
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=232424&amp;user=17432&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=17" class="addthx" data-post="232424"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 16:29 &middot; Поправил: Jupiter <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
файл можно распаковать при помощи upx -d<br>для этого нужно исправить имена секций (на UPX0 и UPX1) и подкорректировать данные для распаковки UPX<br><br>по шагам:<br><br>1. Имя первой секции: <b>UPX0</b><br>2. Имя второй секции: <b>UPX1</b><br>3. На позиции файла <b>3E0</b>h вписать данные значения:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"></li><li class="hl_l1">555058210D09080798E48BD396852C534F35190079BC070000A0180026140087</li>        </ol>
    </div>
</div></div>
<br><br>после чего файл будет распакован по команде<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">upx&nbsp;<span class="hl_char">-</span>d&nbsp;CofMaker<span class="hl_char">.</span>exe</li>        </ol>
    </div>
</div></div>
<br><br><noindex><a href="http://rapidshare.com/files/237049513/CofMaker.v4.32.Unpacked.exe.only.rar" rel="nofollow" target="_blank">CofMaker.v4.32.Unpacked.exe.only.rar</a></noindex>
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=232451&amp;user=1379&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=18" class="addthx" data-post="232451"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]EST2000[/b]','')">EST2000</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3638">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 19:12 <br><script type="text/javascript">QU('EST2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=EST2000" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>Jupiter пишет:<br>1. Имя первой секции: UPX0 <br>2. Имя второй секции: UPX1 <br>3. На позиции файла 3E0h вписать данные значения: </I><br><br>Какой оригинальный способ <img src="img/smilies/s1.gif" alt="">)<br>Восстановить заголовок UPX и распаковать тем же, чем и запакованно <img src="img/smilies/s1.gif" alt="">)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232464&amp;user=3638&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=19" class="addthx" data-post="232464"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 21:06 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>EST2000</b><br>это не оригинальный способ <img src="img/smilies/s1.gif" alt=""> это правильный способ
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232472&amp;user=10534&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=20" class="addthx" data-post="232472"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 22:44 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<I>EST2000 пишет:<br>Какой оригинальный способ </I><br><br>это способ, который я пробую первым: он экономит время, не нужно запускать отладчик, всё происходит в статике - так безопаснее.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=232476&amp;user=1379&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=21" class="addthx" data-post="232476"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]EST2000[/b]','')">EST2000</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3638">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 мая 2009 23:07 <br><script type="text/javascript">QU('EST2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=EST2000" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>tihiy_grom пишет:<br>это не оригинальный способ  это правильный способ </I><br>Век живи, век учись <img src="img/smilies/s1.gif" alt="">)) Я слышу первый раз <img src="img/smilies/s1.gif" alt="">))<br><br><I>Jupiter пишет:<br>это способ, который я пробую первым: он экономит время </I><br>За описание данного способа - спасибо <img src="img/smilies/s1.gif" alt="">)))<br><br>Также выражаю огромную благодарность всем, за помощь, комментарии и потраченное (надеюсь не совсем зря) время. Спасибо!<br><br>Тему пока не закрываю, всё интересно всё же про панельки узнать, в принципе мелочь-мелочью, любопытно отчего так происходит (получается из-за распаковки). по идее это есть часть кода, которая перестала работать, интересно почему, а главное - нет ли где ещё таких участков &quot;кривых&quot;. Наверное надо всё же трейсить и сравнивать. Но если есть у кого какие мысли или догадки - пишите <img src="img/smilies/s1.gif" alt="">) Принимается любая информация.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232477&amp;user=3638&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=22" class="addthx" data-post="232477"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2009 00:26 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>EST2000</b><br>рекомендую порыться тут ;)<br><br>0050FC5D  |.  E8 4E57F8FF   CALL CofMaker.004953B0<br><br>и сразу станет всё понятно
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232481&amp;user=10534&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=23" class="addthx" data-post="232481"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]EST2000[/b]','')">EST2000</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3638">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2009 18:47 &middot; Поправил: EST2000 <br><script type="text/javascript">QU('EST2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=EST2000" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>tihiy_grom пишет:<br>рекомендую порыться тут ;)<br>0050FC5D |. E8 4E57F8FF CALL CofMaker.004953B0<br>и сразу станет всё понятно</I><br><br>Точно!!! Проверка на размер файла! tihiy_grom - ты молодец!<br><br>Образец размера файла франится в самом же файле:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00513478</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">02</span>&nbsp;E4&nbsp;<span class="hl_number">07</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; 0x07E402 = 517122 byte (запакованный файл)</span></li>        </ol>
    </div>
</div></div>
<br><br><br>При запуске - текущий размер записывается сюда:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">0051A2EC</span>&nbsp;&nbsp;&nbsp;<span class="hl_number">02</span>&nbsp;A0&nbsp;<span class="hl_number">18</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; 0x18A002 = 1613826 byte (расп. UPX -d файл)</span></li>        </ol>
    </div>
</div></div>
<br><br><br>В следствии дальнейших матем. манипуляций по адресу <b>0051A2F0</b> будет запись <b>00 00</b> (размер совпадает), либо значения не равные <b>00 00</b> (не совпадает). Насколько правильно я понял - в функции по дресу <b>004933C4</b> происходит загрузка компонентов формы, где и &quot;всплывает&quot; это значение. В зависимости от значения <b>0051A2F0</b> процес будет происходить по разному.<br><br>Открываем WinHex, идем на смещение <b>122078</b>h и меняем <b>02 E4 07 00</b> на <b>02 A0 18 00</b>.<br>Теперь вроде бы всё в порядке. С запакованным файлом таких проблем нет, т.к. хоть он и пропатченный, но размер от этого не изменился.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232508&amp;user=3638&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=24" class="addthx" data-post="232508"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Valemox[/b]','')">Valemox</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 116.5 (ветеран), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.8'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18198">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2009 20:09 &middot; Поправил: Valemox <br><script type="text/javascript">QU('Valemox','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Valemox" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>EST2000</b>, перезалей таргет плиз (ссыль ужо сдохла) хотца глянуть ее.<br><b>ADD: SVLab</b> спс
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232514&amp;user=18198&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=25" class="addthx" data-post="232514"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 мая 2009 21:25 &middot; Поправил: SVLab <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>EST2000 пишет:<br>по адресу 0051A2F0 будет запись 00 00 (размер совпадает) </I><br>Вроде там должно оставаться 01 00, а нули должны оставаться в 51а2е8<br><br><b>Valemox</b><br>rapidshare.com/files/237524903/CM4.32.rar.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232521&amp;user=4026&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=26" class="addthx" data-post="232521"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Valemox[/b]','')">Valemox</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 116.5 (ветеран), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.8'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18198">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2009 02:01 &middot; Поправил: Valemox <br><script type="text/javascript">QU('Valemox','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Valemox" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<I>EST2000 пишет:<br>Открываем WinHex, идем на смещение 122078h и меняем 02 E4 07 00 на 02 A0 18 00 </I><br>Слишком много телодвижений, так проще - лечится правкой 1-го байта<br>0050FC6F      668B<b>02</b>       MOV AX,WORD PTR DS:<b>[EDX] &lt;-- етого (был EAX)</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232531&amp;user=18198&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=27" class="addthx" data-post="232531"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]SVLab[/b]','')">SVLab</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 133.4 (ветеран), 57thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.34'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4026">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2009 07:10 &middot; Поправил: SVLab <br><script type="text/javascript">QU('SVLab','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SVLab" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>Valemox</b><br>Вариант <b>EST2000</b>&#039;а более надежный и правильный, т.к. проверяется не только здесь. Вызовов  функции, которая возвращает размер, - 3, возможно, есть и скрытые.<br>Единственно, что править можно в самой Оле.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232534&amp;user=4026&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=28" class="addthx" data-post="232534"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Valemox[/b]','')">Valemox</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 116.5 (ветеран), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.8'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18198">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2009 10:57 &middot; Поправил: Valemox <br><script type="text/javascript">QU('Valemox','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Valemox" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>SVLab пишет:<br>Вариант EST2000&#039;а более надежный и правильный, т.к. проверяется не только здесь.</I><br>Спорить не буду, но на мой вариант, покупается эта проверка. А где ты нашел еще проверку, которая не прокатывает?<br>Если быть до конца точным, то вариант предложенный <b>EST2000</b>&#039;ом можно упростить до замены 1-го байта по адресу 00513479 с E4 на A0, но он привязан к размеру файла (что не есть камильфо).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232541&amp;user=18198&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=29" class="addthx" data-post="232541"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]EST2000[/b]','')">EST2000</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 11.7 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.44'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=3638">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 мая 2009 11:57 &middot; Поправил: EST2000 <br><script type="text/javascript">QU('EST2000','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=EST2000" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=14457&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>SVLab пишет:<br>Вроде там должно оставаться 01 00, а нули должны оставаться в 51а2е8 </I><br>Очень может быть, я другие функции не проверял, ограничился тем, что функции сравнивают размер, и все берут его из одного места. Следовательно дав им понять, что размер действительно правильный - остальное должно идти правильно (теоретически) <img src="img/smilies/s1.gif" alt=""><br><br><I>Valemox пишет:<br>А где ты нашел еще проверку, которая не прокатывает? </I><br>Я например нашел два места:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"></li><li class="hl_l1"><span class="hl_comment">; размер файла лежит тут: 00513478  (02 E4 07 00)</span></li><li class="hl_l0"></li><li class="hl_l1"><span class="hl_number">0050FC6A</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;A1&nbsp;<span class="hl_number">98A65100</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_number">51A698</span><span class="hl_char">]</span>&nbsp;&nbsp;<span class="hl_comment">; [ds:0051A698]=00513478</span></li><li class="hl_l0"><span class="hl_number">0050FC6F</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">66</span><span class="hl_char">:</span><span class="hl_number">8B00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_registr">eax</span><span class="hl_char">]</span>&nbsp;<span class="hl_comment">; Место, где ты предложил исправить.</span></li><li class="hl_l1"><span class="hl_comment">;</span></li><li class="hl_l0"><span class="hl_comment">; ...а вот смотри, точно такое же место, но по другому адресу</span></li><li class="hl_l1"><span class="hl_number">00510ADF</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;A1&nbsp;<span class="hl_number">98A65100</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_number">51A698</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;<span class="hl_comment">; [ds:0051A698]=00513478</span></li><li class="hl_l0"><span class="hl_number">00510AE4</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">66</span><span class="hl_char">:</span><span class="hl_number">8B00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ax</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span><span class="hl_registr">eax</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>Поэтому и решил исправить сам размер, чтобы не отлавливать все запросы на сравнение.<br><br>А вот ещё вопрос:<br>Если бы не эта самая вкладка, которая не открывалась, и не подсказка <b>tihiy_grom</b> может никогда и не узнал бы, что есть проверка на размер файла. Может быть там и проверка CRC есть ? Если пропатчивание файла не идет в разрез с его размером, то уж точно идет поперек CRC. Может такая проверка тоже есть, и тоже не видна &quot;глазом&quot; ? Как вообще можно определить такую проверку ?<br>Как писал <I>Jupiter</I> &quot;это способ, который я пробую первым&quot;, кто какой способ пробует первым для определение таких проверок ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=232543&amp;user=3638&amp;forum_n=5&amp;topic=14457&amp;page=0&amp;anchor=30" class="addthx" data-post="232543"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=14457&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=14457&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите разобраться с защитой :: UPX, Markus &amp; Laszlo [Overlay] и ещё много-много страшных слов</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="14457">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=14457" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
