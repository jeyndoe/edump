<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Определение буквы диска подключеного USB флеша - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="В общем проблема такова... Нужно как-то получить битовую маску буквы диска подключенного флеша... WM_DEVICECHANGE не предлогать... ибо букву диска надо получить при запуске проги и когда флешка уже была воткнута до запуска">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=55802'>JustLife</a>, <a target='_blank' href='?action=userinfo&amp;user=2094'>2nd</a>, <a target='_blank' href='?action=userinfo&amp;user=33192'>morgot</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=27081'>CDK123</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Определение буквы диска подключеного USB флеша</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]DaRKSiDE[/b]','')">DaRKSiDE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2009 21:36 <br><script type="text/javascript">QU('DaRKSiDE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DaRKSiDE" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
В общем проблема такова...<br>Нужно как-то получить битовую маску буквы диска подключенного флеша...<br>WM_DEVICECHANGE не предлогать... ибо букву диска надо получить при запуске проги и когда флешка уже была воткнута до запуска программы..<br>Если программа работает и флешка втыкается - здесь проблем нет...<br>Но если флешка была уже воткнута.. и прога запуженна после того как...<br>Как в этом случае получить эту битовую маску?<br>Поделитесь инфой плиз... очень надо ..<br>Заранее большое спасибо! <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240517&amp;user=1989&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=1" class="addthx" data-post="240517"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]DaRKSiDE[/b]','')">DaRKSiDE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2009 21:43 <br><script type="text/javascript">QU('DaRKSiDE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DaRKSiDE" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Собственно привожу код который ищет флешь...<br>Получает ID и название...<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">SearchUSBDevice&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>local</b></span>&nbsp;BufLen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">:</span><span class="hl_function">dword</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>local</b></span>&nbsp;hDevInfoSet&nbsp;<span class="hl_char">:</span><span class="hl_function">dword</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>local</b></span>&nbsp;dwTmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">:</span><span class="hl_function">dword</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>local</b></span>&nbsp;BufStr&nbsp;<span class="hl_char">[</span><span class="hl_number">260</span><span class="hl_char">]</span><span class="hl_char">:</span><span class="hl_function">byte</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;SetupDiGetClassDevs<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;DISK_GUID<span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span>DIGCF_PRESENT</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>mov</b></span>&nbsp;hDevInfoSet<span class="hl_char">,</span><span class="hl_registr">eax</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>mov</b></span>&nbsp;DevInfoData<span class="hl_char">.</span>cbSize<span class="hl_char">,</span><span class="hl_function"><b>sizeof</b></span>&nbsp;DevInfoData</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_registr">ecx</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@<span class="hl_char">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;SetupDiEnumDeviceInfo<span class="hl_char">,</span>hDevInfoSet<span class="hl_char">,</span><span class="hl_registr">ecx</span><span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;DevInfoData</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>jmp</b></span>&nbsp;@exit</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function">endif</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;SetupDiGetDeviceRegistryProperty<span class="hl_char">,</span>hDevInfoSet<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;DevInfoData<span class="hl_char">,</span>SPDRP_COMPATIBLEIDS<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;dwTmp<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;BufStr<span class="hl_char">,</span><span class="hl_function"><b>sizeof</b></span>&nbsp;BufStr<span class="hl_char">,</span><span class="hl_function">NULL</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;lstrcmp<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;BufStr<span class="hl_char">,</span>chr<span class="hl_char">$</span><span class="hl_char">(</span><span class="hl_quote">&quot;USBSTOR\Disk&quot;</span><span class="hl_char">)</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;CM_Get_DevNode_Status<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;Status<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;ProblemNumber<span class="hl_char">,</span>DevInfoData<span class="hl_char">.</span>DevInst<span class="hl_char">,</span><span class="hl_function">NULL</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;CM_Get_Device_ID_Size<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;Dev_Len<span class="hl_char">,</span>DevInfoData<span class="hl_char">.</span>DevInst<span class="hl_char">,</span><span class="hl_function">NULL</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>inc</b></span>&nbsp;Dev_Len</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;CM_Get_Device_ID<span class="hl_char">,</span>DevInfoData<span class="hl_char">.</span>DevInst<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;aDeviceId<span class="hl_char">,</span>Dev_Len<span class="hl_char">,</span><span class="hl_function">NULL</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>mov</b></span>&nbsp;BufLen<span class="hl_char">,</span><span class="hl_function"><b>sizeof</b></span>&nbsp;aBufNameDevice</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;CM_Get_DevNode_Registry_Property<span class="hl_char">,</span>DevInfoData<span class="hl_char">.</span>DevInst<span class="hl_char">,</span>CM_DRP_FRIENDLYNA&nbsp;ME<span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;&nbsp;aBufNameDevice<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;BufLen<span class="hl_char">,</span><span class="hl_function">NULL</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>invoke</b></span>&nbsp;CM_Get_DevNode_Registry_Property<span class="hl_char">,</span>DevInfoData<span class="hl_char">.</span>DevInst<span class="hl_char">,</span>CM_DRP_DEVICEDESC&nbsp;<span class="hl_char">,</span><span class="hl_function">NULL</span><span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;&nbsp;aBufNameDevice<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;BufLen<span class="hl_char">,</span><span class="hl_function">NULL</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function">endif</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_function"><b>byte</b></span>&nbsp;<span class="hl_function">ptr</span><span class="hl_char">[</span>aBufNameDevice<span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_number">0</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function">endif</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вот&nbsp;здесь&nbsp;нужен&nbsp;код&nbsp;который&nbsp;получает&nbsp;букву&nbsp;флеш&nbsp;диска</span><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hl_function">TRUE</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">.</span><span class="hl_function">endif</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>inc</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>jmp</b></span>&nbsp;@B&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@exit<span class="hl_char">:</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span class="hl_function"><b>FALSE</b></span>&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">SearchUSBDevice&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240519&amp;user=1989&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=2" class="addthx" data-post="240519"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]GMax[/b]','')">GMax</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.2 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6843">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2009 22:01 <br><script type="text/javascript">QU('GMax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GMax" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
юзай SetupDiGetDeviceInterfaceDetail<br>по SP_DEVICE_INTERFACE_DETAIL_DATA.DevicePath найдешь Native-имя диска
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=240522&amp;user=6843&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=3" class="addthx" data-post="240522"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 сентября 2009 22:31 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_comment">; «««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««« ««««««</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_char">\</span>masm32<span class="hl_char">\</span>include<span class="hl_char">\</span>masm32rt<span class="hl_char">.</span><span class="hl_function">inc</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>include</b></span>&nbsp;<span class="hl_char">\</span>masm32<span class="hl_char">\</span>include<span class="hl_char">\</span>setupapi<span class="hl_char">.</span><span class="hl_function">inc</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>includelib</b></span>&nbsp;<span class="hl_char">\</span>masm32<span class="hl_char">\</span>lib<span class="hl_char">\</span>setupapi<span class="hl_char">.</span>lib</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;DIGCF_PRESENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_number">00000002h</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;DIGCF_ALLCLASSES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_number">00000004h</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;DIGCF_PROFILE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_number">00000008h</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;DIGCF_DEVICEINTERFACE&nbsp;<span class="hl_function"><b>equ</b></span>&nbsp;<span class="hl_number">00000010h</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;HDEVINFO&nbsp;typedef&nbsp;<span class="hl_function">DWORD</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;SP_DEVICE_INTERFACE_DATA&nbsp;STRUCT</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cbSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InterfaceClassGuid&nbsp;&nbsp;GUID&nbsp;&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reserved&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;SP_DEVICE_INTERFACE_DATA&nbsp;<span class="hl_function">ENDS</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;-------------------------</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; #define ANYSIZE_ARRAY 1</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;-------------------------</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;SP_DEVICE_INTERFACE_DETAIL_DATA&nbsp;STRUCT</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cbSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_char">?</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DevicePath&nbsp;&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;&nbsp;ANYSIZE_ARRAY&nbsp;<span class="hl_function">dup</span><span class="hl_char">(</span><span class="hl_char">?</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;SP_DEVICE_INTERFACE_DETAIL_DATA&nbsp;<span class="hl_function">ENDS</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;-------------------------------------------------------</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; For this I used the w2k version of the import library</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; from the Microsoft Windows Server 2003 SP1 DDK.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">;-------------------------------------------------------</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>includelib</b></span>&nbsp;hid<span class="hl_char">.</span>lib</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;LPGUID&nbsp;typedef&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;GUID</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;HidD_GetHidGuid&nbsp;<span class="hl_function"><b>PROTO</b></span>&nbsp;HidGuid<span class="hl_char">:</span>LPGUID</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_comment">; «««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««« ««««««</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function">data</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guid&nbsp;&nbsp;&nbsp;&nbsp;GUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lpsz&nbsp;&nbsp;&nbsp;&nbsp;LPOLESTR&nbsp;&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HDEVINFO&nbsp;&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spdid&nbsp;&nbsp;&nbsp;SP_DEVICE_INTERFACE_DATA&nbsp;<span class="hl_char">&lt;</span><span class="hl_function"><b>SIZEOF</b></span>&nbsp;SP_DEVICE_INTERFACE_DATA<span class="hl_char">&gt;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIZEOFSPDIDD&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>SIZEOF</b></span>&nbsp;SP_DEVICE_INTERFACE_DETAIL_DATA</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spdidd&nbsp;&nbsp;SP_DEVICE_INTERFACE_DETAIL_DATA&nbsp;<span class="hl_char">&lt;</span>SIZEOFSPDIDD<span class="hl_char">&gt;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">1024</span>&nbsp;<span class="hl_function">dup</span><span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function">code</span></li><li class="hl_l0"><span class="hl_comment">; «««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««« ««««««</span></li><li class="hl_l1">start<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_comment">; «««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««« ««««««</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<span class="hl_function">str</span><span class="hl_char">$</span><span class="hl_char">(</span>SIZEOFSPDIDD<span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;HidD_GetHidGuid<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;guid</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<span class="hl_function">str</span><span class="hl_char">$</span><span class="hl_char">(</span><span class="hl_registr">eax</span><span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;StringFromIID<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;guid<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;lpsz</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<span class="hl_function">str</span><span class="hl_char">$</span><span class="hl_char">(</span><span class="hl_registr">eax</span><span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span><span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;crt_printf<span class="hl_char">,</span>&nbsp;chr<span class="hl_char">$</span><span class="hl_char">(</span><span class="hl_quote">&quot;%S%c%c&quot;</span><span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;lpsz<span class="hl_char">,</span>&nbsp;<span class="hl_number">10</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">10</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;SetupDiGetClassDevs<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;guid<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;DIGCF_DEVICEINTERFACE</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;hdi<span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<span class="hl_function">str</span><span class="hl_char">$</span><span class="hl_char">(</span>hdi<span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span><span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;@@<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;SetupDiEnumDeviceInterfaces<span class="hl_char">,</span>&nbsp;hdi<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;guid<span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;spdid</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function"><b>IF</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;GetLastError</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function"><b>IF</b></span>&nbsp;<span class="hl_registr"><b>eax</b></span>&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;ERROR_NO_MORE_ITEMS</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<span class="hl_quote">&quot;SetupDiEnumDeviceInterfaces unexpected error&quot;</span><span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function">ENDIF</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;@F</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function">ENDIF</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;SetupDiGetDeviceInterfaceDetail<span class="hl_char">,</span>&nbsp;hdi<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;spdid<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;spdidd<span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_number">1024</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<span class="hl_function">str</span><span class="hl_char">$</span><span class="hl_char">(</span><span class="hl_registr">eax</span><span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span><span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<span class="hl_function"><b>ADDR</b></span>&nbsp;spdidd<span class="hl_char">.</span>DevicePath<span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;@B</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;@@<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>invoke</b></span>&nbsp;SetupDiDestroyDeviceInfoList<span class="hl_char">,</span>&nbsp;hdi</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<span class="hl_function">str</span><span class="hl_char">$</span><span class="hl_char">(</span><span class="hl_registr">eax</span><span class="hl_char">)</span><span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span><span class="hl_char">,</span><span class="hl_number">13</span><span class="hl_char">,</span><span class="hl_number">10</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;inkey&nbsp;<span class="hl_quote">&quot;Press any key to exit...&quot;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;exit</li><li class="hl_l1"><span class="hl_comment">; «««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««««« ««««««</span></li><li class="hl_l0"><span class="hl_function"><b>end</b></span>&nbsp;start</li>        </ol>
    </div>
</div></div><br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240528&amp;user=3520&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=4" class="addthx" data-post="240528"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]DaRKSiDE[/b]','')">DaRKSiDE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2009 08:50 <br><script type="text/javascript">QU('DaRKSiDE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DaRKSiDE" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Нифига не выходит... <img src="img/smilies/s4.gif" alt=""><br>SetupDiEnumDeviceInterfaces постоянно возвращает ERROR_NO_MORE_ITEMS<br>Может я не тот GUID использую?<br>Для получения ID устройства я использую - GUID_DEVCLASS_DISKDRIVE {4D36E967-E325-11CE-BFC1-08002BE10318}<br>Для получения имя диска нужен этот же GUID или нет?<br>Подскажите плиз ктонить.... <img src="img/smilies/s14.gif" alt="">
<br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240560&amp;user=1989&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=5" class="addthx" data-post="240560"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]GMax[/b]','')">GMax</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.2 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6843">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2009 09:57 <br><script type="text/javascript">QU('GMax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GMax" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Для SetupDiEnumDeviceInterfaces я использовал<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GUID_REMOVEABLE&nbsp;&nbsp;<span class="hl_function"><b>dd</b></span>&nbsp;<span class="hl_number">53F56307h</span>&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>dw</b></span>&nbsp;<span class="hl_number">0B6BFh</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>dw</b></span>&nbsp;<span class="hl_number">11D0h</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function"><b>db</b></span>&nbsp;<span class="hl_number">94h</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0F2h</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0A0h</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0C9h</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1Eh</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0FBh</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">8Bh</span></li>        </ol>
    </div>
</div></div>
<br>p.s. посмотри исходник на wasm
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=240566&amp;user=6843&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=6" class="addthx" data-post="240566"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]sendersu[/b]','')">sendersu</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 512.7 (<b>!</b>), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.56'>Активность: 0.27<span style='color:red'>&searr;</span>0.03</span><br>Статус: <a href="action=userinfo&amp;user=14629">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2009 12:29 <br><script type="text/javascript">QU('sendersu','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=sendersu" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
пример отсюда нумерует оК (но код там индуский <img src="img/smilies/s1.gif" alt="">)<br><br>www.codeguru.com/forum/showthread.php?t=331907<br>см. пост от March 11th, 2005, 12:43 PM
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=240580&amp;user=14629&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=7" class="addthx" data-post="240580"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]DaRKSiDE[/b]','')">DaRKSiDE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2009 14:10 <br><script type="text/javascript">QU('DaRKSiDE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DaRKSiDE" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>GMax</b><br><br>Ну вроде заработало <img src="img/smilies/s1.gif" alt=""><br><br>Подскажи теперь как из дос имени девайса  <span style="word-break: break-all">&#92;?\USBSTOR#Disk&amp;Ven_Kingston&amp;Prod_DataTraveler_2.0&amp;Rev_PMAP#5B6B06809113&amp;0#{53f56307-b6bf-11d0-94f2-00a0c91efb8b}</span>  получить имя логического диска?<br>Пожалста...
<br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240586&amp;user=1989&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=8" class="addthx" data-post="240586"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]GMax[/b]','')">GMax</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.2 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6843">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2009 14:26 <br><script type="text/javascript">QU('GMax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GMax" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Думаю есть несколько способов<br>я юзал довольно корявый:<br>открывал диск CreateFile<br>функцией DeviceIoControl и кодом IOCTL_STORAGE_GET_DEVICE_NUMBER получал номер диска<br>затем открывал каждый диск системы и делал то же самое<br>как только номера совпадали значит диск найден<br>если найдешь лучший путь дай знать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=240588&amp;user=6843&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=9" class="addthx" data-post="240588"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]DaRKSiDE[/b]','')">DaRKSiDE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2009 08:41 <br><script type="text/javascript">QU('DaRKSiDE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DaRKSiDE" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>GMax пишет:<br>Думаю есть несколько способов </I><br><br>Буду искать... найду поделюсь обязательно...<br><br>У меня такой еще вопрос - как надо преобразовать полученное дос имя, чтобы CreateFile скушал его?<br>А не матерился что файл не найден...<br><br><b>\?\USBSTOR#Disk&amp;Ven_Kingston&amp;Prod_DataTraveler_2.0&amp;Rev_PMAP#5B6B068091 13&amp;0#{53f56307-b6bf-11d0-94f2-00a0c91efb8b}</b><br>Что здесь надо изменить?
<br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240658&amp;user=1989&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=10" class="addthx" data-post="240658"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Hexxx[/b]','')">Hexxx</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 481.4 (мудрец), 109thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.37'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=10168">Участник</a><br><font color=blue>Тот самый :)</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2009 09:58 &middot; Поправил: Hexxx <br><script type="text/javascript">QU('Hexxx','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hexxx" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
В сорцах винды 2к есть мега функция которая букву для флэшки из имени USB находит. Через функции работы с volume. Естественно как называется я не помню <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Реверсивная инженерия - написание кода идентичного натуральному</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240662&amp;user=10168&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=11" class="addthx" data-post="240662"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]DaRKSiDE[/b]','')">DaRKSiDE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2009 12:09 &middot; Поправил: DaRKSiDE <br><script type="text/javascript">QU('DaRKSiDE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DaRKSiDE" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Hexxx пишет:<br>Естественно как называется я не помню  </I><br><br>Ну вот... опять облом <img src="img/smilies/s13.gif" alt="">
<br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240676&amp;user=1989&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=12" class="addthx" data-post="240676"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]GMax[/b]','')">GMax</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 23.2 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.77'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6843">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2009 18:46 <br><script type="text/javascript">QU('GMax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=GMax" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>DaRKSiDE пишет:<br>У меня такой еще вопрос - как надо преобразовать полученное дос имя, чтобы CreateFile скушал его? </I><br> у меня два обратных слеша вначале имени, кушает и не давится<br><br>а что мешает посмотреть отладчиком, например в Dr.USB?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=240710&amp;user=6843&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=13" class="addthx" data-post="240710"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]DaRKSiDE[/b]','')">DaRKSiDE</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1989.png" alt=""><br><span class=txtSm>Ранг: 462.8 (мудрец), 468thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.08'>Активность: 0.28<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1989">Участник</a><br><font color=blue>Only One!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 сентября 2009 18:53 <br><script type="text/javascript">QU('DaRKSiDE','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DaRKSiDE" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=15062.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>GMax пишет:<br>а что мешает посмотреть отладчиком, например в Dr.USB?  </I><br><br>Посмотрел <img src="img/smilies/s6.gif" alt=""><br>Пипец... старею....старею.... сделать такую опечатку...<br>Короче в параметрах CreateFile вместо FILE_ATTRIBUTE_NORMAL = 80h, я воткнул NORMAL = 0...<br>И поэтому не открывался диск... <img src="img/smilies/s14.gif" alt="">
<br><br><font size="1"><i>-----<br>aLL rIGHTS rEVERSED!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=240712&amp;user=1989&amp;forum_n=6&amp;topic=15062.html&amp;page=0&amp;anchor=14" class="addthx" data-post="240712"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Определение буквы диска подключеного USB флеша</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#15" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="15062">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15062" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
