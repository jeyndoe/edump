<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Подмена API функции - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Доброго времени суток! Немного занимаюсь крякингом, и тут попалась программа IconLover v4.12. Программа триальная и работает только 30 дней. Загоняю в SoftIce и натыкаюсь на следующее: 001B:0040B228 CALL KERNEL32!GetLocalTime">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=55991'>kris_sexy</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Подмена API функции</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=2&amp;topic=6505&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=2&amp;topic=6505&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Sparrow[/b]','')">Sparrow</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=7073">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 05:03 <br><script type="text/javascript">QU('Sparrow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sparrow" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Доброго  времени суток!<br><br>Немного занимаюсь крякингом, и тут попалась программа IconLover v4.12.<br>Программа триальная и работает только 30 дней.<br>Загоняю в SoftIce и натыкаюсь на следующее:<br><br>001B:0040B228  CALL  KERNEL32!GetLocalTime<br>001B:0040B22D  MOV   CX,[ESP+0E]<br>001B:0040B232  MOV   DX,[ESP+0A]<br>001B:0040B237  MOV   AX,[ESP+08]<br><br>Т.е.  запрашивается время(точнее число, месяц и год). Достаточно поменять например смещение на 0B(001B:0040B22D  MOV   CX,[ESP+0B]). В таком режиме программа будет бесконечно работать(только если ее крякнуть до первого запуска, т.к. она запоминает последнюю дату), считая, что у нас дата 0.0.0000. Лезем в exe файл hex редактором по адресу 0040B22D и .... ничего! Программа запакованна. Проверяем ее PEID-выдает asprotect. Распаковщик stripper 213b9 ее не берет - я так думаю одна из последних версий asprotect(2.22 или какая еще).<br><br>Теперь вопрос: <br>появились следующие мысли:<br>Вариант 1. Возможно ли подменить/перехватить API функцию GetLocalTime, не влезая в атакуемую программу?<br>Вариант 2. Возможно ли другой программой(допустим &quot;виртуальным&quot; кряком) изменить программу(точнее ее данные) прямо в памяти, после ее запуска. Но тут возникает следующая проблема, как сделать точку останова(остановить процесс) после распаковки, но до первого запуска функции GetLocalTime.<br><br>Саму прогу можно взять тут: www.aha-soft.com/iconlover/iconlove.zip<br>Особо строго не судите - я пока новичёк в этом деле <img src="img/smilies/s1.gif" alt=""><br>Всем заранее спасибо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=98842&amp;user=7073&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=1" class="addthx" data-post="98842"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Rascal[/b]','')">Rascal</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/60.jpg" alt=""><br><span class=txtSm>Ранг: 260.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=60">Участник</a><br><font color=blue>John Smith</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 05:10 &middot; Поправил: Rascal <br><script type="text/javascript">QU('Rascal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rascal" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Подменять ни к чему. Пишется laoder/ Он в памяти меняет данные програмпмы (когда она уже распаковалась) и всё. А остановка - октрываешь процесс и с интервалом читаешь по нужному адресу байты. Когда они те, что нужны, сюспендишь главный поток и меняешь байты.<br><br>[ADDED]<br>Точнее сюспендишь постоянно при проверке. Например слип 20, сюспендтрид, ридпроцессмемори, проверяешь, если распакованно, то райтпроцессмемори, резюмтрид. иначе просто резюмтрид. И это в цикле
<br><br><font size="1"><i>-----<br>Недостаточно только получить знания:надо найти им приложение</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=98844&amp;user=60&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=2" class="addthx" data-post="98844"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]HoBleen[/b]','')">HoBleen</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5110.jpg" alt=""><br><span class=txtSm>Ранг: 240.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.09'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5110">Участник</a><br><font color=blue>Author of ACKiller </font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 05:11 <br><script type="text/javascript">QU('HoBleen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HoBleen" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Sparrow пишет:<br>Возможно ли другой программой(допустим &quot;виртуальным&quot; кряком) изменить программу(точнее ее данные) прямо в памяти, после ее запуска </I><br>Называется лоадер. Запускается прога в остановленном состоянии (CREATE_SUSPENDED).<br>Далее в твоем случае лучше подгрузить библиотеку, которая пропатчивает ф-ю - либо пишет код прямо на место функции, либо подменяет адрес в таблице экспорта.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=98845&amp;user=5110&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=3" class="addthx" data-post="98845"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 05:15 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>Sparrow пишет:<br>Вариант 1. Возможно ли подменить/перехватить API функцию GetLocalTime, не влезая в атакуемую программу?  </I><br>Можно, напиши драйвер перехватчик<img src="img/smilies/s6.gif" alt=""><br>Литература по сабжу www.books.ru/shop/books/448604<br><br>Ссылки по сабжу<br>rootkit.com/<br>www.wasm.ru/article.php?article=apihook_1<br>www.wasm.ru/article.php?article=apihook_2<br>www.wasm.ru/article.php?article=apihook_3<br>www.wasm.ru/article.php?article=1021007
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=98846&amp;user=2981&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=4" class="addthx" data-post="98846"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 05:42 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
И еще в догонку. У себя на компе все подобные триалы убил очень просто: батник в Автозагрузку &quot;date 21-08-2005&quot; и все<img src="img/smilies/s6.gif" alt=""><br>З.Ы<br>В организациях такая хрень не прокатит, в сети аптек продлевал таким макаром триал Dr.Weba, через несколько дней позвонили и сказали какого хера я у них наделал - все накладные выбивались одним числом<img src="img/smilies/s6.gif" alt=""><br>Такая же ху#ня была и с местным отделом милиции<img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=98857&amp;user=2981&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=5" class="addthx" data-post="98857"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]HoBleen[/b]','')">HoBleen</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5110.jpg" alt=""><br><span class=txtSm>Ранг: 240.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.09'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5110">Участник</a><br><font color=blue>Author of ACKiller </font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 05:47 <br><script type="text/javascript">QU('HoBleen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HoBleen" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>Flint пишет:<br>&quot;date 21-08-2005&quot; </I><br>Еще один минус - сертификаты для безопасного соединения связаны с датой, в результате постоянные pop-upы с подтверждением бесят.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=98858&amp;user=5110&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=6" class="addthx" data-post="98858"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Flint[/b]','')">Flint</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/2981.jpg" alt=""><br><span class=txtSm>Ранг: 238.8 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.67'>Активность: 0.2<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2981">Участник</a><br><font color=blue>CyberHunter</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 05:56 <br><script type="text/javascript">QU('Flint','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Flint" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>HoBleen пишет:<br>Еще один минус - сертификаты для безопасного соединения связаны с датой, в результате постоянные pop-upы с подтверждением бесят. </I><br><br>А я то думаю, какого хера они у меня постоянно вылазиют
<br><br><font size="1"><i>-----<br>Nulla aetas ad discendum sera</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=98861&amp;user=2981&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=7" class="addthx" data-post="98861"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Sparrow[/b]','')">Sparrow</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=7073">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 06:38 <br><script type="text/javascript">QU('Sparrow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sparrow" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
Всем спасибо за быстрый ответ. Думаю тема исчерпана.<br><br>P.S.: Если у кого есть исходник какого-нибудь лоадера, то пожалуйста киньте на sparrow_ppc@mail.ru
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=98866&amp;user=7073&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=8" class="addthx" data-post="98866"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Rascal[/b]','')">Rascal</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/60.jpg" alt=""><br><span class=txtSm>Ранг: 260.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=60">Участник</a><br><font color=blue>John Smith</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 06:59 &middot; Поправил: Rascal <br><script type="text/javascript">QU('Rascal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rascal" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Вот лоадер для солдата. Слать влом. Да и мож кому пригодится<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/507e_14.10.2006_CRACKLAB.rU.tgz">507e_14.10.2006_CRACKLAB.rU.tgz</a> - Soldat1.3.1Loader.rar<br><br>[ADDED]<br>Размер будет у ехе 4 килобайта. Проект на с++. Это сторонникам асма <img src="img/smilies/s3.gif" alt="">
<br><br><font size="1"><i>-----<br>Недостаточно только получить знания:надо найти им приложение</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=98868&amp;user=60&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=9" class="addthx" data-post="98868"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Sparrow[/b]','')">Sparrow</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=7073">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 11:26 <br><script type="text/javascript">QU('Sparrow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sparrow" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Отлично, лоадер написан, НО! .... Возникла проблема:<br><br>Принцип работы лоадера не расказываю, но хочу остановиться на небольшом ньюансе:<br>После того как мы запустили программу-жертву мы ждем ее распаковки, но надо учесть, что asprotect после распаковки пробегает по коду и если что-то найдет-выдаст ошибку(что-то там про защиту)!Следовательно, после того, как лоадер обнаружил, что код распакован, надо еще выждать sleep(x)... Но что ставить вместо x? Как подобрать задержку в зависимости от скорости компа? На виртуально машине хватает(как ни странно) 1000, а вот на реальном компе лоадер работает только после 2000 :-/<br>Как одаптировать кряк под любой комп, точнее как узнать, что asprotect закончил проверку?<br><br>Ниже приведу консольный код на делфе(он не оптимизирован, а набран по-быстрому для проверки. Исходник был взят с каого-та сайта, да простит меня автор той статьи <img src="img/smilies/s2.gif" alt=""> ):<br><br><br>program Loader;<br><br>uses<br>  Windows;<br><br>const buf:array[0..14] of byte=(&#036;66,&#036;8B ,&#036;48 ,&#036;02 ,&#036;90 ,&#036;66 ,&#036;8B ,&#036;50 ,&#036;02 ,&#036;90 ,&#036;66 ,&#036;8B ,&#036;40 ,&#036;02 ,&#036;90); // <br>filename=&#039;iconlover.exe&#039;; // &#200;&#236;&#255; &#244;&#224;&#233;&#235;&#224;<br>appname=&#039;Loader for ReGetDelux&#039;;<br>var<br>i:cardinal;<br>sti:tstartupinfo;<br>lpPi:tprocessinformation;<br><br>begin<br>if not CreateProcess(nil,filename,nil,nil,false,CREATE_NEW_CONSOLE or NORMAL_PRIORITY_CLASS,nil,nil,StI,lpPI) then<br>begin<br>messageboxa(0,&#039;&#192; &#227;&#228;&#229; &#039;+filename+&#039; ?&#039;,&#039;Loader for ReGetDelux&#039;,MB_ICONQUESTION);<br>halt;<br>end<br>else<br>while true do<br>if readprocessmemory(lppi.hProcess,pointer(&#036;40B22D),@buf[0],1,i) // &#215;&#232;&#242;&#224;&#229;&#236; &#238;&#228;&#232;&#237; &#225;&#224;&#233;&#242; &#239;&#238; &#224;&#228;&#240;&#229;&#241;&#243; 00441785<br>then<br>if buf[0]&lt;&gt;&#036;66 then <br>begin<br><br>sleep(2000);<br><br>suspendthread(lppi.hThread);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B22E),@buf[1],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B22F),@buf[2],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B230),@buf[3],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B231),@buf[4],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B232),@buf[5],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B233),@buf[6],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B234),@buf[7],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B235),@buf[8],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B236),@buf[9],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B237),@buf[10],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B238),@buf[11],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B239),@buf[12],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B23A),@buf[13],1,i);<br>writeprocessmemory(lppi.hProcess,pointer(&#036;40B23B),@buf[14],1,i);<br>resumethread(lppi.hThread);<br>closehandle(lppi.hprocess);<br>halt;<br>end;<br>end.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=98925&amp;user=7073&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=10" class="addthx" data-post="98925"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]r99[/b]','')">r99</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/314.gif" alt=""><br><span class=txtSm>Ранг: 328.7 (мудрец), 73thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=314">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 11:55 <br><script type="text/javascript">QU('r99','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r99" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
это для любителей C++ <br><br><br><img src="img/attach.gif" alt=""> <a href="./files/8c59_14.10.2006_CRACKLAB.rU.tgz">8c59_14.10.2006_CRACKLAB.rU.tgz</a> - loader-asm.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=98932&amp;user=314&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=11" class="addthx" data-post="98932"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Rascal[/b]','')">Rascal</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/60.jpg" alt=""><br><span class=txtSm>Ранг: 260.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=60">Участник</a><br><font color=blue>John Smith</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 12:10 &middot; Поправил: Rascal <br><script type="text/javascript">QU('Rascal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rascal" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>r99</b><br>Это я так понимаю в мою сторону. Опять развязывание священных войн? Я показал что размер ехе будет 4 кило, это тем кто говорит что С++ большие ехе компилит. К чему твой наезд? Поясни.<br><br><b>Sparrow</b><br>Для кого придумали подсветку кода???<br>Как вариант запускать лоадер, искать окно сообщения, если есть килять процесс, увеличивать интервал и запускать снова. Когда интервал найдёшь записать в реестр и всё
<br><br><font size="1"><i>-----<br>Недостаточно только получить знания:надо найти им приложение</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=98940&amp;user=60&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=12" class="addthx" data-post="98940"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]r99[/b]','')">r99</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/314.gif" alt=""><br><span class=txtSm>Ранг: 328.7 (мудрец), 73thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=314">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 13:06 <br><script type="text/javascript">QU('r99','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r99" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>Rascal</b><br>не преувеличивай того чего нет - против C++ я ничего не говорил<br>и вообще это пустой топик - без отладчика  к аспру лоадер не сделаешь
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=98952&amp;user=314&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=13" class="addthx" data-post="98952"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]asd[/b]','')">asd</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 162.2 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.58'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3241">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 13:11 &middot; Поправил: asd <br><script type="text/javascript">QU('asd','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=asd" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
К чему такие извраты со слипами. Не проще-ли действительно перехватить функцию. Если всё только в неё упирается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=98953&amp;user=3241&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=14" class="addthx" data-post="98953"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Rascal[/b]','')">Rascal</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/60.jpg" alt=""><br><span class=txtSm>Ранг: 260.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=60">Участник</a><br><font color=blue>John Smith</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 13:43 <br><script type="text/javascript">QU('Rascal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rascal" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>asd</b><br>Просто писать хук библу отнюдь не проще.
<br><br><font size="1"><i>-----<br>Недостаточно только получить знания:надо найти им приложение</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=98957&amp;user=60&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=15" class="addthx" data-post="98957"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]S_T_A_S_[/b]','')">S_T_A_S_</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 163.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=251">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 20:29 &middot; Поправил: S_T_A_S_ <br><script type="text/javascript">QU('S_T_A_S_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=S_T_A_S_" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Rascal пишет:<br>Размер будет у ехе 4 килобайта. Проект на с++. Это сторонникам асма</I><br>Раз выкинул CRT, не забудь исправить сигнатуру для точки входа.<br><code><br>int APIENTRY New_WinMain(HINSTANCE hInstance,<br>                     HINSTANCE hPrevInstance,<br>                     LPTSTR    lpCmdLine,<br>                     int       nCmdShow)<br>{<br>    DialogBox ( hInstance, MAKEINTRESOURCE(IDD_MAIN), 0, (DLGPROC)DLG_Main );<br><br>    return (int) 0;<br>}</code> <br>код упадёт на return (int) 0;. В реале это не происходит, т.к. выход делается в другом месте через ExitProcess. Хотя как для DialogBox заместо hInstance подходит левый адрес из kernel32 хз.<br><br><br><I>Sparrow пишет:<br>Следовательно, после того, как лоадер обнаружил, что код распакован, надо еще выждать sleep(x)... Но что ставить вместо x? </I><br><br>Sleep не гарантирует что код пробудится черех время X. Возможно подойдет WaitForInputIdle, хотя это тоже криво.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=98985&amp;user=251&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=16" class="addthx" data-post="98985"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]HoBleen[/b]','')">HoBleen</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5110.jpg" alt=""><br><span class=txtSm>Ранг: 240.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.09'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5110">Участник</a><br><font color=blue>Author of ACKiller </font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 октября 2006 23:52 <br><script type="text/javascript">QU('HoBleen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HoBleen" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>S_T_A_S_ пишет:<br>Sleep не гарантирует что код пробудится черех время X. </I><br>Поэтому я рекомендую погружать библиотеку.<br><br><I>Rascal пишет:<br>Просто писать хук библу отнюдь не проще. </I><br>Чем же сложнее?<br>Ставишь thunk на одну из первых API проги. Подменная ф-я изменяет что надо и  возвращает код перехваченной ф-и на место. И никаких проблем с синхронизацией!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=98998&amp;user=5110&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=17" class="addthx" data-post="98998"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]slip[/b]','')">slip</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.3 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.71'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2897">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 октября 2006 00:10 <br><script type="text/javascript">QU('slip','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=slip" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Сорс моего триал фризера я думаю будед в тему.<br><br>slippage.narod.ru/files/tfsrc.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99000&amp;user=2897&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=18" class="addthx" data-post="99000"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Sparrow[/b]','')">Sparrow</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=7073">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 октября 2006 04:23 <br><script type="text/javascript">QU('Sparrow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sparrow" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
Не один из методов нормально не работает, т.к.:<br>Программа Сразу после распаковки только однажды запрашивает GetLocalTime, поэтому, что касается лоадера, то надо попасть в момент после распаковки и проверки... Задержкой(к примеру слипом) нормально интевал подобрать не выйдет, т.к. все зависит от загруженности проца и т.п. факторов. Пробовал делать в алгоритме кряка следующее: инзначально ставить задержу по минимуму, а потом отлавливать окно предупреждения о защите, далее, если оно появилось, то увеличиваем задержу(скажем на 50) и все заново... Но при разных условиях задержка в диапазоне от 100 до 2000, т.е наращивать ее нет смысла, т.к. окошко защиты появляется только через 2-5 сек после старта процесса. Получаем, если мы начинаем перебирать задержку от 100 до 2000 с шагом 50 и на каждый шаг уходит от 2 до 5 сек....сами считайте... В таких темпах программа будет грузиться достаточно долго и не факт, что вообще правильно загрузится, т.к. возможно нагрузка на проц уменьшится и мы пролетим GetLocalTime.<br><br>Что касается загрузки специальной ДЛЛ в программу-жертву, то тоже не прокатит, т.к. ее так же надо сразу же записать после распаковки и проверки - иначе мы либо проскочим GetLocalTime, либо нарвемся на защиту протектора, который скорее всего проверяет CRC(ведь нам все-равно надо изменять данные в атакуемой программе, чтобы сделать &quot;переадресацию&quot; на нашу длл).<br><br>Я вижу только два пути:<br>1. самому распаковать asprotect, чего я делать не хочу, т.к. это займет уйму времени и не факт,что получится;<br>2. найти куда прога записывает дату-я этим сейчас и вожусь, но пока безуспешно <img src="img/smilies/s9.gif" alt=""><br><br>Может я в чем-то и ошибся - не судите строго новичка...<br><br>У кого-нибуть есть еще какие-нибудь мысли?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99111&amp;user=7073&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=19" class="addthx" data-post="99111"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 октября 2006 04:27 &middot; Поправил: Archer <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>Sparrow</b><br>Вообще то длл можно писать сразу же после старта, длл ставит хук на любую функцию, которая вызывается поле распаковки. Если она вызывается раньше, поставь счётчик. Хук ставь сразу в кернел.длл, КРК обломается. В общем обдумай и делай. <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99112&amp;user=1556&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=20" class="addthx" data-post="99112"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]r99[/b]','')">r99</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/314.gif" alt=""><br><span class=txtSm>Ранг: 328.7 (мудрец), 73thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=314">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 октября 2006 05:07 <br><script type="text/javascript">QU('r99','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r99" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>Sparrow</b><br>во 1-х стриппер хоть и не берет эту прогу но выдает лог полезный (например адреса всякие)<br>во 2-х там есть unrar.dll и если в ней на EP  прописать eb fe то тоже кое-что можно узнать<br>в 3-х &quot;Знания без размышлений вредны, а размышления без знаний опасны&quot;
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99122&amp;user=314&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=21" class="addthx" data-post="99122"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]HoBleen[/b]','')">HoBleen</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5110.jpg" alt=""><br><span class=txtSm>Ранг: 240.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.09'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5110">Участник</a><br><font color=blue>Author of ACKiller </font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 октября 2006 05:15 <br><script type="text/javascript">QU('HoBleen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HoBleen" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>Sparrow пишет:<br>тоже не прокатит, т.к. ее так же надо сразу же записать после распаковки и проверки - иначе мы либо проскочим GetLocalTime, либо нарвемся на защиту протектора, который скорее всего проверяет CRC </I><br><br>Видимо ты не понял. Запускаем процесс в замороженном состоянии (флаг CREATE_SUSPENDED), при этом код проги НЕ ВЫПОЛНЯЕТСЯ. Далее подгружаем библу, кот. изменяет ВИНДОВУЮ API GetLocalTime, не трогая код проги. Т.е. CRC проги остается тем же. И после запускаем основной поток проги с помощью SuspendThread. Только после этого начинает выполняться код проги с распаковкой, проверкой CRC и т.д.<br><br>Очевидный способ противостоять этому - проверка CRC библиотеки, что также легко перехватывается на всяческих CreateFile и т.д.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99125&amp;user=5110&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=22" class="addthx" data-post="99125"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Sparrow[/b]','')">Sparrow</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=7073">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 октября 2006 10:38 <br><script type="text/javascript">QU('Sparrow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sparrow" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Прочитал достоточно много документации по внедрению длл в процесс и подмене таким способом апи.<br>Если я все правильно понял, то механизм примерно такой: загружаем длл в адресное пространство потока и в таблице импорта заменяем адрес нужной функции на свою. Но как быть, если паковщик работает так, что в таблице иморта запакованной программы нет ссылки на нужную функцию(GetLocalTime)?<br><br>Может я что-то не так понял?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99182&amp;user=7073&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=23" class="addthx" data-post="99182"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Rascal[/b]','')">Rascal</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/60.jpg" alt=""><br><span class=txtSm>Ранг: 260.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=60">Участник</a><br><font color=blue>John Smith</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 октября 2006 10:55 <br><script type="text/javascript">QU('Rascal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rascal" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>S_T_A_S_</b><br>да, есть такая тема. в этой проге не пофиксил. а в другой долго пытался понять, что же с созданием диалога. <br><br><I>HoBleen пишет:<br>Ставишь thunk на одну из первых API проги. Подменная ф-я изменяет что надо и возвращает код перехваченной ф-и на место. И никаких проблем с синхронизацией! </I><br>Ты сам понял, что написал?<br><br>Синхронизация нужна не такая. В любом случае если код с апи забирается и не выполняется в другом месте а пишется на место, то тормозить потоки надо.<br><br><b>Sparrow</b><br>Если всё именно так, то действительно самый логичный вариант это инжектить хук библу.
<br><br><font size="1"><i>-----<br>Недостаточно только получить знания:надо найти им приложение</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=99186&amp;user=60&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=24" class="addthx" data-post="99186"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]DrGolova[/b]','')">DrGolova</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/301.jpg" alt=""><br><span class=txtSm>Ранг: 199.6 (ветеран), 12thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=301">Участник</a><br><font color=blue>www.uinc.ru</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 октября 2006 13:56 <br><script type="text/javascript">QU('DrGolova','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DrGolova" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
Щас полно развелось новых двухядерных процов. Интересно, никто случаем не пробовал использовать один их них для запуска подопытной проги? Виртуализация и все такое, наверняка это как-то можно заюзать в своих меркантильных целях. Заодно может научим ms-rem&#039;а использовать спинлоки вместо cli/sti - а то так много его вкусностей не работает на многоголовых тачках <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99225&amp;user=301&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=25" class="addthx" data-post="99225"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Ms-Rem[/b]','')">Ms-Rem</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1798.gif" alt=""><br><span class=txtSm>Ранг: 120.6 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.17'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1798">Участник</a><br><font color=blue>rootkit developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 октября 2006 15:52 <br><script type="text/javascript">QU('Ms-Rem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ms-Rem" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<I>DrGolova пишет:<br>Заодно может научим ms-rem&#039;а использовать спинлоки вместо cli/sti - а то так много его вкусностей не работает на многоголовых тачках  </I><br>Что именно не работает? Глючные примеры из статей чтоли? Дык мне на них наплевать.  <br>Развиваться дальше будут только extreme dumper и hidetoolz. Они вроде работают везде нормально.<br><br>З.Ы. у меня самого 2х ядерный процессор.
<br><br><font size="1"><i>-----<br>Скажем дружно - нафиг нужно.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=99231&amp;user=1798&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=26" class="addthx" data-post="99231"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]HoBleen[/b]','')">HoBleen</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5110.jpg" alt=""><br><span class=txtSm>Ранг: 240.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.09'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5110">Участник</a><br><font color=blue>Author of ACKiller </font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 октября 2006 02:11 <br><script type="text/javascript">QU('HoBleen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HoBleen" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<I>Rascal пишет:<br> любом случае если код с апи забирается и не выполняется в другом месте а пишется на место, то тормозить потоки надо. </I><br>В случае GetLocalTime оригинальная функция не выполняется.<br>Я имел ввиду то, что если в функции-перехватчике выполнять только патчинг кода проги, то после возвращаем управление оригинальной API.<br><br>Если перехватывать одну из начальных API проги, поток будет ОДИН, который и будет делать патч после проверки CRC.<br><br><b>Sparrow</b><br>Почитай про сплайсинг:<br>wasm.ru/article.php?article=apihook_1
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99296&amp;user=5110&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=27" class="addthx" data-post="99296"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Rascal[/b]','')">Rascal</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/60.jpg" alt=""><br><span class=txtSm>Ранг: 260.9 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=60">Участник</a><br><font color=blue>John Smith</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 октября 2006 03:40 <br><script type="text/javascript">QU('Rascal','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Rascal" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>HoBleen</b><br>Кажись понял. Хук лишь для патчинга кода программы. Так вот аспр вызывает проверки времению. Так же библиотеки могут проверять время. то ИМХО плохой вариант. Апи должна работать. А ты её убиваешь. Не факт что вызовется первый то что надо.
<br><br><font size="1"><i>-----<br>Недостаточно только получить знания:надо найти им приложение</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=99306&amp;user=60&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=28" class="addthx" data-post="99306"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]HoBleen[/b]','')">HoBleen</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5110.jpg" alt=""><br><span class=txtSm>Ранг: 240.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.09'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5110">Участник</a><br><font color=blue>Author of ACKiller </font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 октября 2006 03:54 <br><script type="text/javascript">QU('HoBleen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HoBleen" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>Rascal пишет:<br>Так же библиотеки могут проверять время. </I><br>Тогда пишешь переходник, подменяющий результат, при этом на оригинальную ф-ю можно полностью забить.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99308&amp;user=5110&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=29" class="addthx" data-post="99308"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Sparrow[/b]','')">Sparrow</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.3 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.75'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=7073">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 октября 2006 11:31 <br><script type="text/javascript">QU('Sparrow','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sparrow" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=2&amp;topic=6505&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
Всем спасибо, все вышло. Написал кряк-лоадер, который загружает длл в процесс и эта длл подменяет все вызовы GetLocalTime. Все работает на Ура <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=99364&amp;user=7073&amp;forum_n=2&amp;topic=6505&amp;page=0&amp;anchor=30" class="addthx" data-post="99364"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=2&amp;topic=6505&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=2&amp;topic=6505&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/red.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=2&sortBy=0&page=0.html"><b>Крэки, обсуждения</b></a> <b class=bulletHead>&#8212;&#8250;</b> Подмена API функции</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="2">
<input type="hidden" name="topic" value="6505">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=6505" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
