<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Sphinx iQ - - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Hello everyone, I try to reverse engineer the demo version of a English/French survey software called S*phinx iQ (http://www.s*phinxsurvey.com/) [remove stars]. This software costs EUR 2,000... The software is developed with .NET">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/e.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=10&sortBy=0&page=0.html"><b>WorldWide</b></a> <b class=bulletHead>&#8212;&#8250;</b> Sphinx iQ -</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]binaryreporter[/b]','')">binaryreporter</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31201">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 21 января 2012 22:23 <br><script type="text/javascript">QU('binaryreporter','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=binaryreporter" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=19499.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Hello everyone,<br><br>I try to reverse engineer the demo version of a English/French survey software called S*phinx iQ (http://www.s*phinxsurvey.com/) [remove stars]. This software costs EUR 2,000...<br><br>The software is developed with .NET and I successfully opened the main executable in .NET Reflector. Most of the content (namespaces, classes, methods) is readable but an important part is also obfuscated. Indeed, all the functions/methods calls from inside these readable functions/methods refer to &quot;internal delegates&quot; in a namespace labeled &quot;A&quot;. All these delegates have random 32-characters name (ex: c62c2a6bc720de02e0a392a51102c40b9) and always contains a &quot;friend function/method&quot; only containing a function/method call to a &quot;friend field/variable&quot; in the same delegate.<br><br>Example:<br><br>In the readable part of the code, you can find something like this:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>c62c2a6bc720de02e0a392a51102c40b9<span class="hl_char">.</span>ce656513e27ae33feda0f91f8761bcc94<span class="hl_char">(</span>list<span class="hl_char">,</span>&nbsp;num<span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>which refers to &quot;A.c62c2a6bc720de02e0a392a51102c40b9.ce656513e27ae33feda0f91f8761bcc94()&quot;.<br><br>In &quot;A&quot;, we can find:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">internal&nbsp;delegate&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;c62c2a6bc720de02e0a392a51102c40b9<span class="hl_char">(</span>object<span class="hl_char">,</span>&nbsp;<span class="hl_function">int</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>which contains:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>public</b></span>&nbsp;static&nbsp;<span class="hl_function"><b>void</b></span>&nbsp;ce656513e27ae33feda0f91f8761bcc94<span class="hl_char">(</span>object&nbsp;obj1<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;num1<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;c7fe89751fb8f8db9dad70aa322d12984<span class="hl_char">(</span>obj1<span class="hl_char">,</span>&nbsp;num1<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br><br>which calls:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">protected&nbsp;internal&nbsp;static&nbsp;c62c2a6bc720de02e0a392a51102c40b9&nbsp;c7fe89751fb8f8db9dad70aa322d12984<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>I am looking for a clue on how to deobfuscate this mess. I tried SAE and a lot of different dissasembler but they all see the same mess.<br><br>Full demo version can be downloaded here (remove stars):<br>http://info.les*phinx.eu/telechargement/SetupS*phinxIQ.exe<br>Main executable here [remove stars]:<br>http://www.mediafire*.com/?kpx9ygigqqed565<br><br>Thanks a lot,<br><br>BinaryReporter
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299483&amp;user=31201&amp;forum_n=10&amp;topic=19499.html&amp;page=0&amp;anchor=1" class="addthx" data-post="299483"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]uncleua[/b]','')">uncleua</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 81.0 (постоянный), 88thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.72'>Активность: 0.07<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=7358">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 января 2012 00:42 &middot; Поправил: uncleua <br><script type="text/javascript">QU('uncleua','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=uncleua" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=19499.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>binaryreporter</b><br><br>Try this - <noindex><a href="http://depositfiles.com/files/uuorm2khj" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Copy all files on to the work folder and run exe...<br><br><I>I am looking for a clue on how to deobfuscate this mess.</I><br><br><noindex><a href="https://github.com/0xd4d/de4dot" rel="nofollow" target="_blank">https://github.com/0xd4d/de4dot</a></noindex>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299493&amp;user=7358&amp;forum_n=10&amp;topic=19499.html&amp;page=0&amp;anchor=2" class="addthx" data-post="299493"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]binaryreporter[/b]','')">binaryreporter</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.6 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31201">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 января 2012 04:02 <br><script type="text/javascript">QU('binaryreporter','Цитата','writes');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=binaryreporter" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=10&amp;topic=19499.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Thanks a lot, uncleua. I managed to get most of the assemblies out of the main executable by myself then I saw your post. So, I switched to de4dot and I got what I was searching for.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299515&amp;user=31201&amp;forum_n=10&amp;topic=19499.html&amp;page=0&amp;anchor=3" class="addthx" data-post="299515"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/e.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=10&sortBy=0&page=0.html"><b>WorldWide</b></a> <b class=bulletHead>&#8212;&#8250;</b> Sphinx iQ -</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19499" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
