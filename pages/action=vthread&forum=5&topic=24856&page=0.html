<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Проблема с добавлением секции - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте, я хочу добавить CODE секцию в программу вручную, ну в общем, я добавляю в Section Header описание своей секции lol, затем меняю в заголовке число секций с 3 на 4, ну вот, потом добавляю байт-код (он не рабочий,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=6859'>cppasm</a>, <a target='_blank' href='?action=userinfo&amp;user=55996'>dutyfree</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Проблема с добавлением секции</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=24856&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=24856&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]alex-rudenkiy[/b]','')">alex-rudenkiy</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.3 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.96'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=35469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2017 16:14 &middot; Поправил: alex-rudenkiy <br><script type="text/javascript">QU('alex-rudenkiy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=alex-rudenkiy" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте, я хочу добавить CODE секцию в программу вручную, ну в общем, я добавляю в Section Header описание своей секции lol, затем меняю в заголовке число секций с 3 на 4, ну вот, потом добавляю байт-код (он не рабочий, чиста для примера) и потом пытаюсь его запустить в ollydbg, вроде-бы схема должна быть рабочей, но он даже не открывается, error вылетает, что делать, подскажите пожалуйста <img src="img/smilies/s4.gif" alt=""> <img src="img/smilies/s4.gif" alt=""> <img src="img/smilies/s4.gif" alt=""> :<br><br>Name      VirtSize        VirtAddr        SizeRaw    PtrRaw          Flags        Pointing Directories<br>-------------------------------------------------------------------------------------------<br> .text     00003A56h  01001000h  00003C00h  00000400h  60000020h  Import Table<br> .lol        00000050h  0100A200h  00000050h  0001D430h  E0000020h  <br> .data     00000B98h  01005000h  00000200h  00004000h  C0000040h  <br> .rsrc     00019160h  01006000h  00019200h  00004200h  40000040h  Resource Table<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/54c7_31.08.2017_EXELAB.rU.tgz">54c7_31.08.2017_EXELAB.rU.tgz</a> - Winmine__XP - с секцией.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378416&amp;user=35469&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=1" class="addthx" data-post="378416"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2017 16:44 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Почему бы не использовать инструментарий и не мучаться, если PE формат не ваша сильная сторона?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378420&amp;user=5846&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=2" class="addthx" data-post="378420"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]alex-rudenkiy[/b]','')">alex-rudenkiy</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.3 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.96'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=35469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2017 16:48 &middot; Поправил: alex-rudenkiy <br><script type="text/javascript">QU('alex-rudenkiy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=alex-rudenkiy" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>VOLKOFF пишет:<br>Почему бы не использовать инструментарий и не мучаться, если PE формат не ваша сильная сторона? <br> </I><br>Потому-что хотелось как раз поближе и познакомится с PE, я вкурсе что есть такая возможность в ida, не всю же жизнь пользоваться крэкерскими приблудами
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378422&amp;user=35469&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=3" class="addthx" data-post="378422"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2017 17:32 &middot; Поправил: hors <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>alex-rudenkiy пишет:<br>Здравствуйте, я хочу добавить CODE секцию в программу вручную, ну в общем, я добавляю в Section Header описание своей секции lol, затем меняю в заголовке число секций с 3 на 4, ну вот, потом добавляю байт-код (он не рабочий, чиста для примера) и потом пытаюсь его запустить в ollydbg, вроде-бы схема должна быть рабочей, но он даже не открывается, error вылетает, что делать, подскажите пожалуйста : </I><br><br>Описание новой  секции нужно добавлять в конец таблицы секций, а не вставлять в середину, как у Вас.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378424&amp;user=31056&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=4" class="addthx" data-post="378424"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]alex-rudenkiy[/b]','')">alex-rudenkiy</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.3 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.96'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=35469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2017 17:47 &middot; Поправил: alex-rudenkiy <br><script type="text/javascript">QU('alex-rudenkiy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=alex-rudenkiy" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I>hors пишет:<br>Описание новой секции нужно добавлять в конец таблицы секций, а не вставлять в середину, как у Вас. <br> </I><br>Не помогает <img src="img/smilies/s4.gif" alt=""><br><br><img src="https://s8.hostingkartinok.com/uploads./images/2017/08/343859fdf4c0cf3a9a605cea32857e13.png" border="0" align="" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378425&amp;user=35469&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=5" class="addthx" data-post="378425"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]dezmand07[/b]','')">dezmand07</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 19.5 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 2.98'>Активность: 0.05<span style='color:green'>&nearr;</span>0.08</span><br>Статус: <a href="action=userinfo&amp;user=42822">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 31 августа 2017 23:56 &middot; Поправил: dezmand07 <br><script type="text/javascript">QU('dezmand07','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dezmand07" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
можно кодом добавить<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function">align</span><span class="hl_char">(</span><span class="hl_function"><b>DWORD</b></span>&nbsp;size<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function">align</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function">addr</span><span class="hl_char">)</span>{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span><span class="hl_char">(</span>size&nbsp;<span class="hl_char">%</span>&nbsp;<span class="hl_function">align</span><span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;return&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;size<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>addr</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_char">(</span>size&nbsp;<span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>align</b></span>&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">*</span>&nbsp;<span class="hl_function"><b>align</b></span><span class="hl_comment">;</span></li><li class="hl_l1">}</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">bool&nbsp;AddSection<span class="hl_char">(</span><span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>filepath<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>char</b></span>&nbsp;<span class="hl_char">*</span>sectionName<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;sizeOfSection<span class="hl_char">)</span>{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;HANDLE&nbsp;file&nbsp;<span class="hl_char">=</span>&nbsp;CreateFile<span class="hl_char">(</span>filepath<span class="hl_char">,</span>&nbsp;GENERIC_READ&nbsp;<span class="hl_char">|</span>&nbsp;GENERIC_WRITE<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;OPEN_EXISTING<span class="hl_char">,</span>&nbsp;FILE_ATTRIBUTE_NORMAL<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>file&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;INVALID_HANDLE_VALUE<span class="hl_char">)</span>&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>false</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;fileSize&nbsp;<span class="hl_char">=</span>&nbsp;GetFileSize<span class="hl_char">(</span>file<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>BYTE</b></span>&nbsp;<span class="hl_char">*</span>pByte&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;<span class="hl_function">BYTE</span><span class="hl_char">[</span>fileSize<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>dw</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;ReadFile<span class="hl_char">(</span>file<span class="hl_char">,</span>&nbsp;pByte<span class="hl_char">,</span>&nbsp;fileSize<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_function">dw</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;PIMAGE_DOS_HEADER&nbsp;dos&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>PIMAGE_DOS_HEADER<span class="hl_char">)</span>pByte<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>dos<span class="hl_char">-</span><span class="hl_char">&gt;</span>e_magic&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;IMAGE_DOS_SIGNATURE<span class="hl_char">)</span>&nbsp;return&nbsp;<span class="hl_function"><b>false</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;PIMAGE_FILE_HEADER&nbsp;FH&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>PIMAGE_FILE_HEADER<span class="hl_char">)</span><span class="hl_char">(</span>pByte&nbsp;<span class="hl_char">+</span>&nbsp;dos<span class="hl_char">-</span><span class="hl_char">&gt;</span>e_lfanew&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;PIMAGE_OPTIONAL_HEADER&nbsp;OH&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>PIMAGE_OPTIONAL_HEADER<span class="hl_char">)</span><span class="hl_char">(</span>pByte&nbsp;<span class="hl_char">+</span>&nbsp;dos<span class="hl_char">-</span><span class="hl_char">&gt;</span>e_lfanew&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span><span class="hl_function">DWORD</span><span class="hl_char">)</span><span class="hl_char">+</span><span class="hl_function">sizeof</span><span class="hl_char">(</span>IMAGE_FILE_HEADER<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;PIMAGE_SECTION_HEADER&nbsp;SH&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>PIMAGE_SECTION_HEADER<span class="hl_char">)</span><span class="hl_char">(</span>pByte&nbsp;<span class="hl_char">+</span>&nbsp;dos<span class="hl_char">-</span><span class="hl_char">&gt;</span>e_lfanew&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>IMAGE_NT_HEADERS<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;ZeroMemory<span class="hl_char">(</span><span class="hl_char">&amp;</span>SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>IMAGE_SECTION_HEADER<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;CopyMemory<span class="hl_char">(</span><span class="hl_char">&amp;</span>SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections<span class="hl_char">]</span><span class="hl_char">.</span>Name<span class="hl_char">,</span>&nbsp;sectionName<span class="hl_char">,</span>&nbsp;IMAGE_SIZEOF_SHORT_NAME<span class="hl_char">)</span><span class="hl_comment">; </span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections<span class="hl_char">]</span><span class="hl_char">.</span>Misc<span class="hl_char">.</span>VirtualSize&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">align</span><span class="hl_char">(</span>sizeOfSection<span class="hl_char">,</span>&nbsp;OH<span class="hl_char">-</span><span class="hl_char">&gt;</span>SectionAlignment<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections<span class="hl_char">]</span><span class="hl_char">.</span>VirtualAddress&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">align</span><span class="hl_char">(</span>SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>Misc<span class="hl_char">.</span>VirtualSize<span class="hl_char">,</span>&nbsp;OH<span class="hl_char">-</span><span class="hl_char">&gt;</span>SectionAlignment<span class="hl_char">,</span>&nbsp;SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>VirtualAddress<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections<span class="hl_char">]</span><span class="hl_char">.</span>SizeOfRawData&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">align</span><span class="hl_char">(</span>sizeOfSection<span class="hl_char">,</span>&nbsp;OH<span class="hl_char">-</span><span class="hl_char">&gt;</span>FileAlignment<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections<span class="hl_char">]</span><span class="hl_char">.</span>PointerToRawData&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function">align</span><span class="hl_char">(</span>SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>SizeOfRawData<span class="hl_char">,</span>&nbsp;OH<span class="hl_char">-</span><span class="hl_char">&gt;</span>FileAlignment<span class="hl_char">,</span>&nbsp;SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_char">.</span>PointerToRawData<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections<span class="hl_char">]</span><span class="hl_char">.</span>Characteristics&nbsp;<span class="hl_char">=</span>&nbsp;IMAGE_SCN_MEM_READ&nbsp;<span class="hl_char">|</span>&nbsp;IMAGE_SCN_MEM_WRITE<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;SetFilePointer<span class="hl_char">(</span>file<span class="hl_char">,</span>&nbsp;SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections<span class="hl_char">]</span><span class="hl_char">.</span>PointerToRawData&nbsp;<span class="hl_char">+</span>&nbsp;SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections<span class="hl_char">]</span><span class="hl_char">.</span>SizeOfRawData<span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;FILE_BEGIN<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;SetEndOfFile<span class="hl_char">(</span>file<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;OH<span class="hl_char">-</span><span class="hl_char">&gt;</span>SizeOfImage&nbsp;<span class="hl_char">=</span>&nbsp;SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections<span class="hl_char">]</span><span class="hl_char">.</span>VirtualAddress&nbsp;<span class="hl_char">+</span>&nbsp;SH<span class="hl_char">[</span>FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections<span class="hl_char">]</span><span class="hl_char">.</span>Misc<span class="hl_char">.</span>VirtualSize<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;FH<span class="hl_char">-</span><span class="hl_char">&gt;</span>NumberOfSections&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;SetFilePointer<span class="hl_char">(</span>file<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">,</span>&nbsp;FILE_BEGIN<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;WriteFile<span class="hl_char">(</span>file<span class="hl_char">,</span>&nbsp;pByte<span class="hl_char">,</span>&nbsp;fileSize<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_function">dw</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">NULL</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;CloseHandle<span class="hl_char">(</span>file<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>true</b></span><span class="hl_comment">;</span></li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378434&amp;user=42822&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=6" class="addthx" data-post="378434"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35469" title="01-09-2017 12:51, ранг:1.1" target="_blank">alex-rudenkiy</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 01:08 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>alex-rudenkiy пишет:<br>Не помогает </I><br>1 Берём калькулятор программиста<img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt=""><br>2. Высчитываем начало виртуальной секции и RAW данные, берём начало предыдущей секции и прибавляем её размер 01006000 + 1А000(округляем) = 1020000      и  4200 + 19200 = 1D400 а у вас другие значения<br>3. прежде чем писать секцию надо убедится что у файла нет оверлея<br>4. после внесённых изменения правим кол во секций и меняем Image size<img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378435&amp;user=17432&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=7" class="addthx" data-post="378435"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35469" title="01-09-2017 12:51, ранг:1.1" target="_blank">alex-rudenkiy</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 01:23 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>alex-rudenkiy</b><br><br>&gt; error вылетает, что делать, подскажите пожалуйста    :<br><br>Правильный ход мыслей - разобрать непосредственно что за ошибка и в чём её причина, те отладить загрузчик. Иначе можно рандомом изменять биты в хидере пе и вновь и вновь просить помощи.<br><br>FLG_SHOW_LDR_SNAPS и смотрим суть поломки.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378437&amp;user=40990&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=8" class="addthx" data-post="378437"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 02:28 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>difexacaw пишет:<br>FLG_SHOW_LDR_SNAPS и смотрим суть поломки.  </I><br>Посоветовал хирург сантехнику как операцию на сердце сделать
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378439&amp;user=17432&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=9" class="addthx" data-post="378439"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=8830" title="01-09-2017 08:05, ранг:279.0" target="_blank">ajax</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 02:45 &middot; Поправил: VOLKOFF <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Это же его &quot;фишка&quot; - дать вполне корректный &quot;умный&quot; ответ который хотя бы частично попадает в зону тематики, но абсолютно никак не решающий изначальную проблему, или решающий но сопровождающийся обязательным наличием боли и мучений спросившего смертного <img src="img/smilies/s6.gif" alt=""> Так и живем.<br><br> <I>alex-rudenkiy пишет:<br>Не помогает </I><br>Возьми же наконец CFFE кликни 2 раза мышкой чтобы добавить твою многострадальную секцию правильно и сравни с тем, что делаешь ты. Плюс сразу увидишь много подсвеченных ошибок PE полей (понимая что ошибки не в них непосредственно а из-за поломки структуры хидера твоими изящными вставками)<br><br><b>P.S.</b><br>Professional PE Explorer (для большей иронии название полное <img src="img/smilies/s1.gif" alt=""> ) на вашем сэмпле просто крашится в нирвану. Черканул аффтару про этот и еще старый баг, в прошлый раз он быстро пофиксил.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378440&amp;user=5846&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=10" class="addthx" data-post="378440"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=8830" title="01-09-2017 08:05, ранг:279.0" target="_blank">ajax</a>, <a href="action=userinfo&user=35469" title="01-09-2017 12:51, ранг:1.1" target="_blank">alex-rudenkiy</a>, <a href="action=userinfo&user=40990" title="01-09-2017 23:01, ранг:126.8" target="_blank">difexacaw</a>, <a href="action=userinfo&user=39556" title="04-09-2017 14:15, ранг:26.2" target="_blank">sefkrd</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 11:11 &middot; Поправил: ajax <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
тему об улучшениях форума снесли, так понимаю?  в пи хомячка, посты после нескольких дней. clerk, это для того, чтоб народ гуглил и т.п. каждый 2 ньюб регается для хелпа &quot;прям щас&quot;, не втыкая в мануалы<br><b>hors</b><br>вау, ты еще тут появляешься <img src="img/smilies/s1.gif" alt=""> где апдейды die? <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378448&amp;user=8830&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=11" class="addthx" data-post="378448"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]alex-rudenkiy[/b]','')">alex-rudenkiy</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.3 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.96'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=35469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 14:50 <br><script type="text/javascript">QU('alex-rudenkiy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=alex-rudenkiy" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>VOLKOFF пишет:<br>CFFE  </I><br>А что это за инструмент такой, полное название можно? <img src="img/smilies/s1.gif" alt=""><br><br><b>Добавлено спустя 18 минут</b><br><I>ClockMan пишет:<br>прежде чем писать секцию надо убедится что у файла нет оверлея </I><br><strike>Наверное не стоило бы мне это спрашивать, но </strike> а причём здесь оверлей, если он в память не грузится и нам по идее всё-равно должно быть на overlay?<br><br>Overlay - это всё то, что находится за последней секцией как я помню.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378480&amp;user=35469&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=12" class="addthx" data-post="378480"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Lambda[/b]','')">Lambda</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.3 (новичок), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.56'>Активность: 0.03<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=39981">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 15:11 <br><script type="text/javascript">QU('Lambda','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Lambda" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>alex-rudenkiy пишет:<br>А что это за инструмент такой, полное название можно?  </I><br><br><b>CFF Explorer</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378481&amp;user=39981&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=13" class="addthx" data-post="378481"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]alex-rudenkiy[/b]','')">alex-rudenkiy</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.3 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.96'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=35469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 15:48 &middot; Поправил: alex-rudenkiy <br><script type="text/javascript">QU('alex-rudenkiy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=alex-rudenkiy" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>VOLKOFF пишет:<br>Возьми же наконец CFFE кликни 2 раза мышкой чтобы добавить твою многострадальную секцию правильно </I><br>Ну всё, секция добавлена, думал всё, славу богу, но не тут то было, при запуске программа сразу же крашится <img src="img/smilies/s14.gif" alt=""> ...<br><br><img src="https://s8.hostingkartinok.com/uploads./images/2017/09/3ec6acaed3c1b043629c70991fa4fab3.png" border="0" align="" alt=""><br><br>Пишет &quot;Ошибка при запуске приложения (0xc000007b)...&quot;, может он что-то забывает на автомате делать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378483&amp;user=35469&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=14" class="addthx" data-post="378483"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 15:51 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>alex-rudenkiy пишет:<br>а причём здесь оверлей, если он в память не грузится </I><br>Всё  с вами понятно свободы<img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378484&amp;user=17432&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=15" class="addthx" data-post="378484"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]alex-rudenkiy[/b]','')">alex-rudenkiy</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.3 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.96'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=35469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 15:54 <br><script type="text/javascript">QU('alex-rudenkiy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=alex-rudenkiy" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>ClockMan пишет:<br>Всё с вами понятно свободы   <br> </I><br>Ну а что, я <noindex><a href="https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=20739" rel="nofollow" target="_blank">--&gt; здесь &lt;--</a></noindex> прочитал
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378485&amp;user=35469&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=16" class="addthx" data-post="378485"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]VOLKOFF[/b]','')">VOLKOFF</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 173.8 (ветеран), 208thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.95'>Активность: 0.12<span style='color:green'>&nearr;</span>0.36</span><br>Статус: <a href="action=userinfo&amp;user=5846">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 15:59 <br><script type="text/javascript">QU('VOLKOFF','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VOLKOFF" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>ClockMan пишет:<br>Всё с вами понятно </I><br>Практика показывает, что не стоит ждать чего-то выдающегося от человека называющего секции lol, kek и fuck <img src="img/smilies/s1.gif" alt=""><br><br><I>alex-rudenkiy пишет:<br>но не тут то было </I><br>ну уж с такой тулзой зафакапить создание секции это надо постараться <img src="img/smilies/s1.gif" alt=""> Искренний респект
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378486&amp;user=5846&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=17" class="addthx" data-post="378486"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 16:01 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>alex-rudenkiy пишет:<br>c000007b </I><br>STATUS_INVALID_IMAGE_FORMAT <img src="img/smilies/s3.gif" alt=""><br><br><b>Добавлено спустя 1 минуту</b><br><I>VOLKOFF пишет:<br>lol, kek и fuck </I><br>Я заметил какойто юных недовирусописатель<img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt=""> <img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378487&amp;user=17432&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=18" class="addthx" data-post="378487"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]alex-rudenkiy[/b]','')">alex-rudenkiy</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.3 (гость), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.96'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=35469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 18:58 &middot; Поправил: alex-rudenkiy <br><script type="text/javascript">QU('alex-rudenkiy','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=alex-rudenkiy" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>VOLKOFF пишет:<br>fuck  </I><br>ну блин, я смотрю data (4 буквы), text (4 буквы), rsrc (4 буквы), так ещё у меня нечего и не получается, злой и написал первое что в голову пришло <img src="img/smilies/s5.gif" alt=""><br><br><b>Добавлено спустя 4 минуты</b><br>Так вы не вкурсе, в чём косяк? Ох, опять всё самому разбираться )<br><br><b>Добавлено спустя 15 минут</b><br>Я помню в последний раз меня так сильно выбесила модель MVVM в C#.net, особенно после того как ты всю жизнь делал линейный (скорее всего не правильно называю) программы, а там сплошные binding&#039;и и ещё эта структура только чего стоит Model, ViewModel, View, я тогда помню вообще поник, нужно же так придумать названия, ну вроде-бы потом разобрался и программы норм стали получаться <img src="img/smilies/s8.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378493&amp;user=35469&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=19" class="addthx" data-post="378493"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]mysterio[/b]','')">mysterio</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1803.gif" alt=""><br><span class=txtSm>Ранг: 307.9 (мудрец), 196thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.17'>Активность: 0.18<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1803">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 сентября 2017 19:55 <br><script type="text/javascript">QU('mysterio','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mysterio" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
вариант для winmine.exe: после добавления секции с &quot;начинкой&quot;, запусти - сразу как файл получится нерабочим - пожми его ASPackом. Запусти. Magic ?
<br><br><font size="1"><i>-----<br>Don_t hate the cracker - hate the code.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378494&amp;user=1803&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=20" class="addthx" data-post="378494"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 сентября 2017 02:15 <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>VOLKOFF</b><br><br>&gt; Это же его &quot;фишка&quot; - дать вполне корректный &quot;умный&quot; ответ который хотя бы частично попадает в зону тематики<br><br>Да, согласен; это моя ошибка. Я не вдовался в тех детали, так как небыло времени, а описал общее решение классической задачи - любое действие юзер загрузчика логгируется.<br><br>В данном случае это не годится, как не странно <img src="img/smilies/s1.gif" alt=""><br><br>Процесс создаётся из секции(обьект), они бывают трёх типов. Создание процесса это создание конвеера на основе образа который создатся ранее как image-секция. Именно на этом этапе ядро выполняет валидации.<br><br>Я после ответа быстро прогнал отладчиком, суть в том что создание образа в ядре это очень важный механизм с точки зрения безопасности, так как образ пе фактически есть структура, которая использует изменяющиеся указатели, к такому обьекту выполняются особые проверки безопасности.<br><br>Если углубиться в детали, то фейл создания секции можно узнать только отладив в км, место около MiCreateImageFileMap() -&gt; MiVerifyImageHeader().<br><br>Следует заметить что так как этим механизмам уделяется особое внимание по выше описанной причине, то они активно допиливаются. И в более новой версии системы валидации изменены до не узнаваемости(2k:creasect.c).<br><br>Я не стал писать сразу это всё, так как думал что проблема с юзер загрузчиком.<br><br><b>Добавлено спустя 12 минут</b><br><b>ajax</b><br><br>&gt; это для того, чтоб народ гуглил<br><br>Да, достаточно для поиска. Давайте посмотрим:<br><br>Первая ссылка в гугле на мс <noindex><a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/gflags-flag-table" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Находим нашу опцию <noindex><a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/show-loader-snaps" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Смотрим на код загрузчика, какой больше нравится - дасм или старый исходный, не важно и видим что логгируется всё.<br><br>Если же отладчик какой то фейл выдаёт - нет проблем, открываем им же самого себя, ставим останов на NtCreateSection и получаем статус - bad image.
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378503&amp;user=40990&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=21" class="addthx" data-post="378503"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 сентября 2017 22:48 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>alex-rudenkiy</b><br>Для <noindex><a href="http://hiew.ru" rel="nofollow" target="_blank">Hiew</a></noindex> есть плагин <noindex><a href="http://hiew.ru/files/PeVerify043.zip" rel="nofollow" target="_blank">PeVerify ver 0.43</a></noindex>, он показывает, какие конкретные ошибки в файле.<br><br>А на счёт твоей конкретной ошибки (STATUS_INVALID_IMAGE_FORMAT), то полагаю, что ты не подумал о размере образа в памяти.<br>Считай <b>SizeOfImage</b>, когда увеличиваешь размер образа.<br><br>Тебе пригодится, изучай:<br><noindex><a href="https://github.com/corkami/pics/raw/master/binary/pe101/pe101.pdf" rel="nofollow" target="_blank">PE Format Poster (pe101.pdf)</a></noindex><br><noindex><a href="https://github.com/corkami/pics/raw/master/binary/pe102/pe102.pdf" rel="nofollow" target="_blank">PE Format Poster Detailed (pe1012.pdf)</a></noindex><br><noindex><a href="https://github.com/corkami/pics/raw/master/binary/PE.png" rel="nofollow" target="_blank">Portable executable (Картинка)</a></noindex>
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378540&amp;user=1379&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=22" class="addthx" data-post="378540"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 сентября 2017 09:40 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
К сожалению, тот плагин PEVerify чаще выдаёт информацию, которую понимает только его автор,<br>- пользу от того плагина можно оценить только в 10-20%, имхо.<br><br><I>Jupiter пишет:<br>Кривой SizeOfImage, полагаю, покажет.  </I><br><br>Покажет..<br><br>К тому плагину был бы уместен объёмный документейшен, которого нету.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378549&amp;user=35473&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=23" class="addthx" data-post="378549"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 сентября 2017 14:57 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>dosprog</b><br>Кривой SizeOfImage, полагаю, покажет.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378552&amp;user=1379&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=24" class="addthx" data-post="378552"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 сентября 2017 15:17 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>Jupiter</b><br>CFF корректит сайз
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378553&amp;user=8830&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=25" class="addthx" data-post="378553"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 сентября 2017 11:26 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
<b>ajax</b><br>Ну так ТС то код пишет, ему ж надо вроде как разбираться (я надеюсь)
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378567&amp;user=1379&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=26" class="addthx" data-post="378567"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]ajax[/b]','')">ajax</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/8830.gif" alt=""><br><span class=txtSm>Ранг: 337.6 (мудрец), 224thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.53'>Активность: 0.21<span style='color:red'>&searr;</span>0.1</span><br>Статус: <a href="action=userinfo&amp;user=8830">Участник</a><br><font color=blue>born to be evil</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 сентября 2017 16:39 <br><script type="text/javascript">QU('ajax','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ajax" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>Jupiter</b><br>сырков уйма. нюанс, что ТС не хочет гуглить. о чем мой первый пост в этой ветке
<br><br><font size="1"><i>-----<br>От многой мудрости много скорби, и умножающий знание умножает печаль</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378575&amp;user=8830&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=27" class="addthx" data-post="378575"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Jupiter[/b]','')">Jupiter</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1379.png" alt=""><br><span class=txtSm>Ранг: 605.2 (<b>!</b>), 341thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.38'>Активность: 0.47<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1379">Модератор</a><br><font color=blue>Research &amp; Development</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 сентября 2017 17:04 <br><script type="text/javascript">QU('Jupiter','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Jupiter" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>ajax</b><br>Я дал ссылки как на краткие (для ленивых) так и на очень подробные схемы-описания от Ange Albertini (corkami), так что даже если ТС предпочитает обучаться, не слизывая с чужих сорсов, то и в этом случае ему должно помочь.<br>Так то всяких библиотек для работы с PE предостаточно. От небольших до фреймворков.
<br><br><font size="1"><i>-----<br>EnJoy!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378581&amp;user=1379&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=28" class="addthx" data-post="378581"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]difexacaw[/b]','')">difexacaw</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/40990.png" alt=""><br><span class=txtSm>Ранг: 337.5 (мудрец), 348thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.02'>Активность: 2.11<span style='color:green'>&nearr;</span>2.42</span><br>Статус: <a href="action=userinfo&amp;user=40990">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 сентября 2017 17:35 &middot; Поправил: difexacaw <br><script type="text/javascript">QU('difexacaw','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=difexacaw" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<b>Jupiter</b><br><br>&gt; ему ж надо вроде как разбираться <br><br>Давайте взглянем.<br><br>Трассируем MiCreateImageFileMap(), причём делаем это на XP, так как для неё имеются сурки. Находим место с фейлом:<br><br>-&gt; STATUS_INVALID_IMAGE_FORMAT<br><br><noindex><a href="http://www.picshare.ru/view/8266082/" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>[ECX-8]: 0xA200<br>EAX: 0x100A200<br>VAR: 0x1005000<br><br>Дизасмим ядро:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">PAGE<span class="hl_char">:</span><span class="hl_number">004D3E90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_8<span class="hl_char">]</span></li><li class="hl_l1">PAGE<span class="hl_char">:</span><span class="hl_number">004D3E93</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_number">1Ch</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l0">PAGE<span class="hl_char">:</span><span class="hl_number">004D3E97</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">+</span><span class="hl_number">14h</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span></li><li class="hl_l1">PAGE<span class="hl_char">:</span><span class="hl_number">004D3E9B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esi</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0">PAGE<span class="hl_char">:</span><span class="hl_number">004D3E9D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ecx</span><span class="hl_char">-</span><span class="hl_number">8</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; IMAGE_SECTION_HEADER.VirtualAddress</span></li><li class="hl_l1">PAGE<span class="hl_char">:</span><span class="hl_number">004D3EA0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_5C<span class="hl_char">]</span></li><li class="hl_l0">PAGE<span class="hl_char">:</span><span class="hl_number">004D3EA3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">ebp</span><span class="hl_char">+</span>var_40<span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">PAGE<span class="hl_char">:</span><span class="hl_number">004D3EA6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jnz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_4D40A1</li><li class="hl_l0">PAGE<span class="hl_char">:</span><span class="hl_number">004D3EAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edi</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">edi</span></li><li class="hl_l1">PAGE<span class="hl_char">:</span><span class="hl_number">004D3EAE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loc_4D40A1</li>        </ol>
    </div>
</div></div>
<br><br>Открываем сурец из w2k/wrk и находим наше место:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subsection&nbsp;<span class="hl_char">+</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subsection<span class="hl_char">-</span><span class="hl_char">&gt;</span>ControlArea&nbsp;<span class="hl_char">=</span>&nbsp;ControlArea<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subsection<span class="hl_char">-</span><span class="hl_char">&gt;</span>NextSubsection&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subsection<span class="hl_char">-</span><span class="hl_char">&gt;</span>UnusedPtes&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_char">(</span>NextVa&nbsp;<span class="hl_char">!</span><span class="hl_char">=</span>&nbsp;<span class="hl_char">(</span>PreferredImageBase&nbsp;<span class="hl_char">+</span>&nbsp;SectionTableEntry<span class="hl_char">-</span><span class="hl_char">&gt;</span>VirtualAddress<span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span><span class="hl_char">&amp;</span>&nbsp;<span class="hl_char">(</span>InvalidAlignmentAllowed&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">FALSE</span><span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">|</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">(</span>SectionVirtualSize&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;The&nbsp;specified&nbsp;virtual&nbsp;address&nbsp;does&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;<span class="hl_function">align</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;with&nbsp;the&nbsp;next&nbsp;prototype&nbsp;PTE<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MI_BAD_IMAGE&nbsp;<span class="hl_char">(</span>0x1A<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Status&nbsp;<span class="hl_char">=</span>&nbsp;STATUS_INVALID_IMAGE_FORMAT<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;BadPeImageSegment<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li>        </ol>
    </div>
</div></div>
<br><br>Видим что IMAGE_SECTION_HEADER.VirtualAddress невалид(0xA200).<br><br><img src="img/attach.gif" alt=""> <a href="./files/2afa_04.09.2017_EXELAB.rU.tgz">2afa_04.09.2017_EXELAB.rU.tgz</a> - mi.png
<br><br><font size="1"><i>-----<br>vx</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=378585&amp;user=40990&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=29" class="addthx" data-post="378585"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]rmn[/b]','')">rmn</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 158.4 (ветеран), 123thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.28'>Активность: 0.14<span style='color:green'>&nearr;</span>0.49</span><br>Статус: <a href="action=userinfo&amp;user=1533">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 сентября 2017 18:52 <br><script type="text/javascript">QU('rmn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rmn" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24856&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>difexacaw</b><br>Тебе лишь бы ядро потрассировать... Там же и так видно, что он единицу забыл в адресе дописать? <img src="img/smilies/s1.gif" alt=""><br><br>Выравненные по section alignment секции должны идти одна за другой без наложений друг на друга и пропусков между секциями.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=378586&amp;user=1533&amp;forum_n=5&amp;topic=24856&amp;page=0&amp;anchor=30" class="addthx" data-post="378586"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=24856&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=24856&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Проблема с добавлением секции</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="24856">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24856" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
