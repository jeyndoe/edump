<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Всё очень просто или мне это только кажется? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте, уважаемые! Решил вот попробовать свои силы в крэкерском искусстве. Конечно, можно крэкми скачивать с сайта и с ними бороться, но это все-таки немножечко не то. Во-первых, там наверняка какие-нибудь серьезные">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Всё очень просто или мне это только кажется?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=22544&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=22544&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]VBA[/b]','')">VBA</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.8 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.44'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2014 02:12 &middot; Поправил: VBA <br><script type="text/javascript">QU('VBA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VBA" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте, уважаемые!<br><br>Решил вот попробовать свои силы в крэкерском искусстве. Конечно, можно крэкми скачивать с сайта и с ними бороться, но это все-таки немножечко не то. Во-первых, там наверняка какие-нибудь серьезные навороты имеются (все-таки их профи писали), которые для новичка не по зубам. А если крэкми совсем уж легкий попадется, без наворотов, то и вообще не интересно как-то <img src="img/smilies/s1.gif" alt=""><br>А во-вторых, реальный бой это все-таки реальный бой, а учебная схватка это учебная схватка.<br><br>Одним словом, решил найти в интернете какую-нибудь старую несломанную программульку и попытаться превозмочь ее защиту. Почему старую? Ну думал, что там защита должна быть попроще. Прогресс ведь не стоит на месте <img src="img/smilies/s1.gif" alt=""><br><br>Начал искать, но очень быстро понял, что взялся за безнадежное дело. Все уже давным давно сломано-переломано, позади выжженная земля <img src="img/smilies/s1.gif" alt="">  Все старые программы, которые удалось найти для скачивания, оказались с кейгенами, патчами, серийниками и т.п.<br><br>Тогда решил, ну ладно, не получилось найти старую прогу, возьмусь за какую-нибудь современную. Конечно, защита там будет сильная, современная, но все равно это хоть будет настоящий бой, а не учебный.<br>Стал искать &quot;жертву&quot;. Оказалось, что это тоже не самое легкое занятие. Гуглил примерно так: &quot;платные программы&quot;, &quot;shareware&quot;, &quot;trial&quot;, но на все мои запросы находилось только всё бесплатное. Наконец, мне посчастливилось <img src="img/smilies/s1.gif" alt=""> и я нашел программу своей мечты <img src="img/smilies/s1.gif" alt="">  С ее помощью можно снимать скриншоты с экрана и видео записывать. Триал 30 дней. Регистрация около 40&#036;.<br>Автор - американец с бородой и с юмором <img src="img/smilies/s1.gif" alt=""> Я на его сайт зашел, он там на фотке на бульдозере катается <img src="img/smilies/s1.gif" alt=""><br><br><br>Засунул, значит, я прогу этого бульдозериста в Peid. Мне там сказали, что не знают, на каком языке она написана и вообще она Overlay. Сначала я был уверен, что она должна быть упакована. Запустил ее под отладчиком. Вроде бы не упакована. Начал в ней ковыряться. Чувствую, не хватает мастерства. Установил ее 6 дней назад. Тогда было написано, что осталось 30 дней. Сейчас написано, что осталось 24 дня. Сначала думал, что эта прога хранит инфу в реестре или в файле каком-нибудь своем. С помощью Trial Reset удалил все подозрительные ключи. Всё равно дядька на бульдозере пишет мне, что осталось 24 дня. Ну думаю, большой коммунистический тупик <img src="img/smilies/s1.gif" alt=""><br>Ан нет. Решил попробовать общеизвестный приемчик. Отвел системное время на 6 дней назад. Дядька мне пишет, у вас осталось 30 дней. Ага, капиталист проклятый, нашел я твою ахиллесову пяту! <img src="img/smilies/s1.gif" alt=""> <br>Ради прикола отвожу системное время на 2000-ой год. Дядька мне пишет, что у меня в запасе еще 5000 дней!!! <img src="img/smilies/s1.gif" alt=""><br><br>Одним словом, как я понял, программа просто считывает системное время с помощью GetSystemTime, а потом сопотавляет его с тем временем, когда она была установлена. Разность этих двух дат как раз и дает нам остаток времени, отпущенный бесплатному юзеру.<br>Эта функция (GetSystemTime) вызывается из 3-х разных мест кода. <br><br>Теперь у меня вопрос к клубу знатоков <img src="img/smilies/s1.gif" alt=""><br>Вот если я прослежу в дебаггере, какое значение возвращается в регистр eax после выхода из этой функции и пропатчу прогу так, чтобы она эту функцию вообще не вызывала, а просто ноп, ноп, ноп и пихаем в регистр eax то значение, которое она возвращает сегодня. Тогда получится, что для этой проги время как бы застопорится на сегодняшней дате, и она всегда будет мне показывать, что осталось 24 бесплатных дня и таким образом получится вечный trial. Правильно я рассуждаю или нет? Разумеется, если я буду переустанавливать операционку и/или эту программу, то придется перепатчивать оригинальный вариант на то время, которое будет актуально.<br><br>P.S. И еще такой вопрос, не связанный с предыдущим.<br>А может запущенная программа менять свой собственный EXE-шник, ну в смысле, патчить саму себя или Windows не разрешит ей это сделать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337411&amp;user=36752&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=1" class="addthx" data-post="337411"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2014 02:27 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Да, и правда, &quot;КРАТКОСТЬ - СЕСТРА ТАЛАНТА&quot; (А.П. Чехов)<br>А если серьезно, то начните с туториалов Нарвахи и куча вопросов отпадет.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=337412&amp;user=4773&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=2" class="addthx" data-post="337412"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]tihiy_grom[/b]','')">tihiy_grom</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 441.3 (мудрец), 297thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.33'>Активность: 0.41<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=10534">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2014 02:45 <br><script type="text/javascript">QU('tihiy_grom','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tihiy_grom" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>VBA пишет:<br>P.S. И еще такой вопрос, не связанный с предыдущим.А может запущенная программа менять свой собственный EXE-шник, ну в смысле, патчить саму себя или Windows не разрешит ей это сделать? </I><br>может. в памяти со своим процессом можно делать всё что угодно. тут зависит от фантазии автора<br><br>по поводу первого очень краткого вопроса - читайте статьи &quot;введение в крэкинг с нуля&quot; (есть в разделе для новичков) - и, как сказал plutos - куча вопросов отпадут сами собой
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337413&amp;user=10534&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=3" class="addthx" data-post="337413"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]VBA[/b]','')">VBA</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.8 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.44'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2014 03:04 &middot; Поправил: VBA <br><script type="text/javascript">QU('VBA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VBA" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Спасибо за ответы!<br><br><I>tihiy_grom пишет:<br>может. в памяти со своим процессом можно делать всё что угодно. тут зависит от фантазии автора </I><br>Да нет, то что в памяти может делать все что угодно, это понятно. Я имел в виду, патчить свой собственный EXE-шник на диске.<br><br><I>plutos пишет:<br>...начните с туториалов Нарвахи и куча вопросов отпадет. </I><br><br><I>tihiy_grom пишет:<br>...читайте статьи &quot;введение в крэкинг с нуля&quot; (есть в разделе для новичков) - и, как сказал plutos - куча вопросов отпадут сами собой </I><br>Ну так читаю же! <img src="img/smilies/s1.gif" alt=""> Как раз сейчас занимаюсь изучением взлома BlueFace <img src="img/smilies/s1.gif" alt=""><br>Ну вот по ходу изучения и пришла эта мысль про патч, заменяющий вызов функции GetSystemTime нопами и жестким возвратом в eax того значения, которое она возвращает сегодня. Прокатит такой вариант или могут быть какие-то подводные камни?<br><br>P.S.<br><I>plutos пишет:<br>Да, и правда, &quot;КРАТКОСТЬ - СЕСТРА ТАЛАНТА&quot; (А.П. Чехов) </I><br>Я долго молчал, ну вот оно и накопилось <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337414&amp;user=36752&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=4" class="addthx" data-post="337414"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2014 04:36 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>VBA</b>:<br><b>Прокатит такой вариант или могут быть какие-то подводные камни?</b><br><br>Может уже набраться смелости и самому попробовать?! Чем рискуем-то?<br>Ну наткнетесь на &quot;камень&quot; - будет опыт,  чему-то да научитесь.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=337415&amp;user=4773&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=5" class="addthx" data-post="337415"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2014 06:23 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>VBA</b>,<br>))) бульдозерист оказался вполне гуманным. <br><br>А если вас так уж интересует ковыряние &quot;защит&quot;, придумайте собственную на языке высокого уровня, типа &quot;if(!registered)exit();&quot; - и ковыряйте её на здоровье.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337416&amp;user=35473&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=6" class="addthx" data-post="337416"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]DenCoder[/b]','')">DenCoder</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/24257.jpg" alt=""><br><span class=txtSm>Ранг: 324.3 (мудрец), 221thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.42'>Активность: 0.48<span style='color:red'>&searr;</span>0.37</span><br>Статус: <a href="action=userinfo&amp;user=24257">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2014 08:49 &middot; Поправил: DenCoder <br><script type="text/javascript">QU('DenCoder','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DenCoder" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
GetSystemTime не возвращает никаких значений! <noindex><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms724390(v=vs.85).aspx" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>И правда, и пока это писали, и пока думали, что написать - могли бы уже что-то попробовать
<br><br><font size="1"><i>-----<br>IZ.RU</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=337417&amp;user=24257&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=7" class="addthx" data-post="337417"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2014 10:05 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
&gt; Всё очень просто или мне это только кажется?<br><br>Вам это только кажется, из за низкого уровня знаний.<br><br>Увидели вы что поведение софтины зависит от времени, поэтому посмотрели на импорт и нашли соответствующую апи. После этого сделали вывод что всё такое простое.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337419&amp;user=33727&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=8" class="addthx" data-post="337419"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=34778" title="01-02-2014 11:20, ранг:10.2" target="_blank">dfnsff</a>, <a href="action=userinfo&user=36752" title="03-02-2014 14:18, ранг:0.4" target="_blank">VBA</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]ELF_7719116[/b]','')">ELF_7719116</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 419.0 (мудрец), 647thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.73'>Активность: 0.46<span style='color:green'>&nearr;</span>0.51</span><br>Статус: <a href="action=userinfo&amp;user=26651">Участник</a><br><font color=blue>&quotТибериумный реверсинг&quot</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2014 10:34 <br><script type="text/javascript">QU('ELF_7719116','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ELF_7719116" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>VBA пишет:<br>Я имел в виду, патчить свой собственный EXE-шник на диске. </I><br>Если процессу доступно повышение привелегий(из под админа был запущен), то, в принципе, ничего не мешает получить <i class=x>SE_BACKUP_PRIVILEGE</i> и подменить целевой файл. Правда, это действие, чем-то напоминает &quot;пилить сук, на котором сидиш&quot;.<br><br>И вообще, Вам правильно сказали: начните там, где уже все обкатано, расписано и обработано напильником - туториалы, кракми, WinRAR с его триалом и тд<br>К тому же, ник VBA намекает на чем Вы сейчас &quot;программируете&quot; и почему, в итоге, все так плохо. (<i class=x>Хотя это может просто совпадение</i>)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337420&amp;user=26651&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=9" class="addthx" data-post="337420"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2014 11:22 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
А чем поможет SE_BACKUP_PRIVILEGE? Она даёт право на чтение, а не запись. +право на запись в залоченый открытый кем-то файл просто привилегиями не решается. В итоге проще не корячиться и не пытаться записать в свой же файл.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337421&amp;user=1556&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=10" class="addthx" data-post="337421"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Isaev[/b]','')">Isaev</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6946.jpg" alt=""><br><span class=txtSm>Ранг: 756.3 <font color=magenta>(<b>! !</b>)</font>, 113thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.76'>Активность: 0.61<span style='color:red'>&searr;</span>0.05</span><br>Статус: <a href="action=userinfo&amp;user=6946">Участник</a><br><font color=blue>Student</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2014 18:40 <br><script type="text/javascript">QU('Isaev','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Isaev" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
а что мешает проге сделать другой exe, запустить его?<br>который убьёт её процесс и пропатчит файл... и права админа никому не нужны
<br><br><font size="1"><i>-----<br>z+Dw7uLu5+jqLCDq7vLu8PvpIPHs7uMh</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=337458&amp;user=6946&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=11" class="addthx" data-post="337458"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=36752" title="03-02-2014 14:16, ранг:0.4" target="_blank">VBA</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2014 01:10 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Isaev пишет:<br>а что мешает проге сделать другой exe, запустить его?<br>который убьёт её процесс и пропатчит файл... и права админа никому не нужны<br></I><br>-- Видел пару программ, ещё из 90-х, которые таким образом осуществляют запись в свой же екзек введённых регистрационных данных и привязку к компьютеру. <br>Но это не то, - патчится не тот файл, из которого запущен процесс. Хотя, как выход...<br><I>Убивать процесс</I> не нужно. Он записывает &quot;дочерний&quot; файл, запускает его, а сам завершается, давая пропатчить собственный екзек. При следующем запуске - удаляет тот &quot;дочерний&quot; екзек на диске, если он не запущен.<br><br>--ADD--<br>К следующему посту:<br><b>Dr0p</b>, да, плохой метод. Поэтому производители софта и не пользуются им для своих регистрационных штучек.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337469&amp;user=35473&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=12" class="addthx" data-post="337469"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 02 февраля 2014 10:55 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>dosprog</b><br><br>Модификация модуля - инфект тоже патч и задача аверов отличать такие модификации, что обычно они не делают и ось тоже блокирует.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337476&amp;user=33727&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=13" class="addthx" data-post="337476"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]VBA[/b]','')">VBA</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.8 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.44'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 17:43 &middot; Поправил: VBA <br><script type="text/javascript">QU('VBA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VBA" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Всем спасибо за такое насыщенное обсуждение. Честно говоря, даже не ожидал. <br><br>Одним словом, не справился я с этой прогой, не по зубам мне этот бульдозерист оказался <img src="img/smilies/s1.gif" alt=""><br><br>А то что это совсем не так просто, в этом я и не сомневался. Но мысль пропатчить вызовы функции GetLocalTime (а там именно эта функция фигурирует, а не GetSystemTime, как я ошибочно написал выше) ну очень сильно напрашивалась, поэтому я и спросил об этом. <br><br>Любопытная деталь, все 3 вызова этой апишной функции, которые фигурируют в данной проге, расположены очень близко друг от друга. Хотя, я разумеется, прекрасно понимаю, что редкие программы выбирают прямые пути для выполнения своего кода <img src="img/smilies/s1.gif" alt="">  Но для цитирования на форуме очень удобно <img src="img/smilies/s1.gif" alt=""><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">CPU&nbsp;Disasm</li><li class="hl_l1"><span style="word-break: break-all">Address&nbsp;&nbsp;&nbsp;Hex&nbsp;dump&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Command&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comments</span></li><li class="hl_l0"><span class="hl_number">00418A40</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">$</span>&nbsp;&nbsp;<span class="hl_number">83C4</span>&nbsp;E8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">18</span></li><li class="hl_l1"><span class="hl_number">00418A43</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8D4424</span>&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00418A47</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EAX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; /pSystemtime =&gt; OFFSET LOCAL.3</span></li><li class="hl_l1"><span class="hl_number">00418A48</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;<span class="hl_number">473EFFFF</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_function">JMP</span><span class="hl_char">.</span><span class="hl_char">&amp;</span>kernel32<span class="hl_char">.</span>GetLocalTime<span class="hl_char">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; \KERNEL32.GetLocalTime</span></li><li class="hl_l0"><span class="hl_number">00418A4D</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB74C24</span>&nbsp;<span class="hl_number">0E</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">2</span><span class="hl_char">+</span><span class="hl_number">2</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418A52</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB75424</span>&nbsp;<span class="hl_number">0A</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">+</span><span class="hl_number">2</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00418A57</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB74424</span>&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418A5C</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;DBFDFFFF&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">0041883C</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; [CaptureWiz.0041883C</span></li><li class="hl_l0"><span class="hl_number">00418A61</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;DD1C24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>FSTP</b></span>&nbsp;QWORD&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">5</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418A64</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">9B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WAIT</li><li class="hl_l0"><span class="hl_number">00418A65</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;DD0424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>FLD</b></span>&nbsp;QWORD&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">5</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418A68</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">83C4</span>&nbsp;<span class="hl_number">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">18</span></li><li class="hl_l0"><span class="hl_number">00418A6B</span>&nbsp;&nbsp;<span class="hl_char">\</span><span class="hl_char">.</span>&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">RETN</span></li><li class="hl_l1"><span class="hl_number">00418A6C</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">$</span>&nbsp;&nbsp;<span class="hl_number">83C4</span>&nbsp;E0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">20</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CaptureWiz.00418A6C(guessed void)</span></li><li class="hl_l0"><span class="hl_number">00418A6F</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8D4424</span>&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">5</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418A73</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EAX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; /pSystemtime =&gt; OFFSET LOCAL.5</span></li><li class="hl_l0"><span class="hl_number">00418A74</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;<span class="hl_number">1B3EFFFF</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_function">JMP</span><span class="hl_char">.</span><span class="hl_char">&amp;</span>kernel32<span class="hl_char">.</span>GetLocalTime<span class="hl_char">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; \KERNEL32.GetLocalTime</span></li><li class="hl_l1"><span class="hl_number">00418A79</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB74C24</span>&nbsp;<span class="hl_number">0E</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">4</span><span class="hl_char">+</span><span class="hl_number">2</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00418A7E</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB75424</span>&nbsp;<span class="hl_number">0A</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">5</span><span class="hl_char">+</span><span class="hl_number">2</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418A83</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB74424</span>&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">5</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00418A88</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;AFFDFFFF&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">0041883C</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; [CaptureWiz.0041883C</span></li><li class="hl_l1"><span class="hl_number">00418A8D</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;DD5C24&nbsp;<span class="hl_number">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>FSTP</b></span>&nbsp;QWORD&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00418A91</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">9B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WAIT</li><li class="hl_l1"><span class="hl_number">00418A92</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB74424</span>&nbsp;<span class="hl_number">16</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">2</span><span class="hl_char">+</span><span class="hl_number">2</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00418A97</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EAX</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; /Arg1</span></li><li class="hl_l1"><span class="hl_number">00418A98</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB74C24</span>&nbsp;<span class="hl_number">18</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |</span></li><li class="hl_l0"><span class="hl_number">00418A9D</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB75424</span>&nbsp;<span class="hl_number">16</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">+</span><span class="hl_number">2</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |</span></li><li class="hl_l1"><span class="hl_number">00418AA2</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB74424</span>&nbsp;<span class="hl_number">14</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; |</span></li><li class="hl_l0"><span class="hl_number">00418AA7</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;ECFBFFFF&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_number">00418698</span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; \CaptureWiz.00418698</span></li><li class="hl_l1"><span class="hl_number">00418AAC</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;DC4424&nbsp;<span class="hl_number">18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>FADD</b></span>&nbsp;QWORD&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00418AB0</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;DD1C24&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>FSTP</b></span>&nbsp;QWORD&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">7</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418AB3</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">9B</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WAIT</li><li class="hl_l0"><span class="hl_number">00418AB4</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;DD0424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>FLD</b></span>&nbsp;QWORD&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">7</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418AB7</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">83C4</span>&nbsp;<span class="hl_number">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">20</span></li><li class="hl_l0"><span class="hl_number">00418ABA</span>&nbsp;&nbsp;<span class="hl_char">\</span><span class="hl_char">.</span>&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">RETN</span></li><li class="hl_l1"><span class="hl_number">00418ABB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">NOP</span></li><li class="hl_l0"><span class="hl_number">00418ABC</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">$</span>&nbsp;&nbsp;<span class="hl_number">83C4</span>&nbsp;F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_char">-</span><span class="hl_number">10</span></li><li class="hl_l1"><span class="hl_number">00418ABF</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">54</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>ESP</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; /pSystemtime =&gt; OFFSET LOCAL.3</span></li><li class="hl_l0"><span class="hl_number">00418AC0</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;CF3DFFFF&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_function">JMP</span><span class="hl_char">.</span><span class="hl_char">&amp;</span>kernel32<span class="hl_char">.</span>GetLocalTime<span class="hl_char">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; \KERNEL32.GetLocalTime</span></li><li class="hl_l1"><span class="hl_number">00418AC5</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB70424</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00418AC9</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">83C4</span>&nbsp;<span class="hl_number">10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">10</span></li><li class="hl_l1"><span class="hl_number">00418ACC</span>&nbsp;&nbsp;<span class="hl_char">\</span><span class="hl_char">.</span>&nbsp;&nbsp;C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">RETN</span></li><li class="hl_l0"><span class="hl_number">00418ACD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">8D40</span>&nbsp;<span class="hl_number">00</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>LEA</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">EAX</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418AD0</span>&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">$</span>&nbsp;&nbsp;<span class="hl_number">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>EBP</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; CaptureWiz.00418AD0(guessed Arg1)</span></li><li class="hl_l0"><span class="hl_number">00418AD1</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8BEC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EBP</span><span class="hl_char">,</span><span class="hl_registr">ESP</span></li><li class="hl_l1"><span class="hl_number">00418AD3</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr">EBX</span></li><li class="hl_l0"><span class="hl_number">00418AD4</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">8B4D</span>&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span>ARG<span class="hl_char">.</span><span class="hl_number">1</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418AD7</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;BB&nbsp;<span class="hl_number">00010000</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">EBX</span><span class="hl_char">,</span><span class="hl_number">100</span></li><li class="hl_l0"><span class="hl_number">00418ADC</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">2B99</span>&nbsp;FCFDFFFF&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;<span class="hl_registr">EBX</span><span class="hl_char">,</span><span class="hl_function"><b>DWORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">DS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_registr">ECX</span><span class="hl_char">-</span><span class="hl_number">204</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br><br>Ну вот, как видите, все 3 вызова здесь как на ладони. Я, конечно же, поставил брейкпойнты на все 3 вызова. Сначала прога тормознулась на самом первом. Дальше я пошел пошагово. <br><br>После прохождения вот этого участка <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">CPU&nbsp;Disasm</li><li class="hl_l1"><span style="word-break: break-all">Address&nbsp;&nbsp;&nbsp;Hex&nbsp;dump&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Command&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comments</span></li><li class="hl_l0"><span class="hl_number">00418A48</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;<span class="hl_number">473EFFFF</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_function">JMP</span><span class="hl_char">.</span><span class="hl_char">&amp;</span>kernel32<span class="hl_char">.</span>GetLocalTime<span class="hl_char">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; \KERNEL32.GetLocalTime</span></li><li class="hl_l1"><span class="hl_number">00418A4D</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB74C24</span>&nbsp;<span class="hl_number">0E</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">2</span><span class="hl_char">+</span><span class="hl_number">2</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00418A52</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB75424</span>&nbsp;<span class="hl_number">0A</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">+</span><span class="hl_number">2</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418A57</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB74424</span>&nbsp;<span class="hl_number">08</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br>в затронутых регистрах лежало:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_registr"><b>EAX</b></span>&nbsp;<span class="hl_number">000007DE</span></li><li class="hl_l1"><span class="hl_registr"><b>ECX</b></span>&nbsp;<span class="hl_number">00000003</span></li><li class="hl_l0"><span class="hl_registr"><b>EDX</b></span>&nbsp;<span class="hl_number">00000002</span></li>        </ol>
    </div>
</div></div>
<br><br>То есть, как не трудно заметить, это сегодняшнее число, а именно 3 февраля 2014 года.<br>Ну это сегодня там это лежит, когда я этот пост пишу и по этому случаю снова запустил прогу под отладчиком.<br>А в другие дни высвечиваемая этими регистрами дата была другой, но всегда соответствовала именно текущей дате.<br>Вот потому-то и возникло желание жестко вставить туда эти значения безо всяких вызовов апишных функций <img src="img/smilies/s1.gif" alt=""><br>Но еще раз повторюсь, я прекрасно понимал, что это не может быть так просто. Со дня написания статьи о взломе Blue Face прошла уже уйма времени. А прогресс не стоит на месте <img src="img/smilies/s1.gif" alt=""><br><br><br>Извините, отвлекся. <br>После дальнейшей трассировки выяснилось, что программа как-то странно петляя, уходит куда-то, но потом снова несколько раз проходит через это же самое место, в смысле, снова вызывает эту же самую функцию на тех же самых строках кода. Потом, наконец, она отвязывается от этого места и идет дальше, а именно, ко второму вызову этой функции. Там снова после вызова в вышеперечисленных регистрах оказываются значения, соответствующие сегодняшней дате. Но здесь программа не циркулирует несколько раз, как в первом случае, а проходит только один раз, после чего появляется окно программы, и она ждет дальнейших действий пользователя. Ну и дебаггер тоже, разумеется, останавливает трассировку.<br><br>Иными словами, пропатчить первые 2 вызова не составило проблем, и я это сделал <img src="img/smilies/s1.gif" alt=""><br>А вот как быть с третьим вызовом? Как я ни пытался, программа упорно не желала заходить на этот брекпойнт. Теперь я думаю, что туда запрограммированы заходы только в довольно редкие моменты, например, в 12:00 каждого дня, и именно там происходит самая важная проверка.<br><br>Но я решил не сдаваться, и заодно уж (до кучи <img src="img/smilies/s1.gif" alt="">  ) пропатчил и там тоже.<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00418ABF</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">54</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>PUSH</b></span>&nbsp;<span class="hl_registr"><b>ESP</b></span><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_comment">; /pSystemtime =&gt; OFFSET LOCAL.3</span></li><li class="hl_l1"><span class="hl_number">00418AC0</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;E8&nbsp;CF3DFFFF&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_function">JMP</span><span class="hl_char">.</span><span class="hl_char">&amp;</span>kernel32<span class="hl_char">.</span>GetLocalTime<span class="hl_char">&gt;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; \KERNEL32.GetLocalTime</span></li><li class="hl_l0"><span class="hl_number">00418AC5</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">0FB70424</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418AC9</span>&nbsp;&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_number">83C4</span>&nbsp;<span class="hl_number">10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;<span class="hl_registr">ESP</span><span class="hl_char">,</span><span class="hl_number">10</span></li>        </ol>
    </div>
</div></div>
<br><br>Но ведь трассировкой зайти туда не удалось, поэтому осталось загадкой, что там попадает в регистр eax. Но я все-таки рискнул предположить, что там в этот ригистр пихают значение года, т.е. 2014. Ну вот именно это значение я туда и &quot;зашил&quot; <img src="img/smilies/s1.gif" alt=""><br><br>Самое интересное, что программа очень долго вела себя именно так, как мне этого хотелось. Как бы я ни играл системным временем, она мне стабильно говорила, что у меня в запасе еще 23 дня триального времени. И, не скрою, все это время я чувствовал себя в роли крутого крэкера, который с такой легкостью устранил защиту первой же попавшейся СОВРЕМЕННОЙ программы <img src="img/smilies/s1.gif" alt=""><br><br>Но, увы, рано или поздно всё кончается <img src="img/smilies/s1.gif" alt=""> Прога работала, работала, но потом вдруг выдала мне приблизительно вот такое сообщение: &quot;Дорогой друг! Поскольку вы там играете системным временем, срок вашего триального периода истекает не через 30 дней, а немедленно.  И даже если вы попытаетесь переустановить программу, то это тоже не поможет&quot;.<br>Но я все-таки попытался несколько раз переустановить программу, ну интересно было, что из этого получится. В какой-то момент установки прога неизменно выдавала мне сообщение: &quot;Нам очень приятно, что вам так понравилась наша программа, что вы пытаетесь установить ее снова, но увы, у вас это не получится. Купить прогу можно там-то и там-то&quot;.<br><br>А я за эти дни уже как-то привык к этой проге, и мне уже было очень даже неприятно, что у меня ее досрочно отняли <img src="img/smilies/s1.gif" alt=""><br><br>Ну и тогда я решил позвать на помощь старшего брата, чтобы не в одиночку бороться с этим бульдозеристом <img src="img/smilies/s1.gif" alt=""><br>Погуглил &quot;Название проги + скачать бесплатно&quot;. В результате нашлось очень много крэков предыдущей версии, но мне уже хотелось именно эту. И вот, наконец, после нескольких осечек нужный крэк нашелся, и прога сразу поумнела <img src="img/smilies/s1.gif" alt=""><br><br>Одним словом, конечно же я еще только новичок в этом деле, и я прекрасно понимаю, что дело это очень и очень трудное. Ну что ж, как говорится, буду учить матчасть <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337572&amp;user=36752&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=14" class="addthx" data-post="337572"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 18:08 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>VBA пишет:<br>трассировкой зайти туда не удалось, поэтому осталось загадкой, что там попадает в регистр eax</I><br>Почитал бы ты основы про соглашения о вызовах, что ли. И заодно МСДН о параметрах каждой функции и используемых структурах.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337573&amp;user=1556&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=15" class="addthx" data-post="337573"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=36752" title="03-02-2014 14:33, ранг:0.4" target="_blank">VBA</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]VBA[/b]','')">VBA</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.8 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.44'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 18:28 <br><script type="text/javascript">QU('VBA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VBA" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>Archer пишет:<br>Почитал бы ты основы про соглашения о вызовах, что ли. И заодно МСДН о параметрах каждой функции и используемых структурах </I><br>Да вроде, читал немного.<br>Эта функция значения, как такового, не возвращает, но зато возвращает структуру: год, месяц, день, час, минута и секунда. Эта структура запихивается в память по указанному перед вызовом адресу. Ну а потом оттуда эти данные считываются в регистры, это я уже процитированный код имею в виду.<br>Если я что-то неправильно понял, пусть старшие товарищи меня поправят <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337575&amp;user=36752&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=16" class="addthx" data-post="337575"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 19:15 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Как совершенно справедливо тебе рекомендует Archer, &quot;Почитал бы ты основы про соглашения о вызовах, что ли.&quot;<br><br>Скажем здесь:<br><br><noindex><a href="--&gt;http://msdn.microsoft.com/en-us/library/k2b2ssfy.aspx&lt;--" rel="nofollow" target="_blank">--&gt;http://msdn.microsoft.com/en-us/library/k2b2ssfy.aspx&lt;--</a></noindex><br><br>типа __cdecl, __stdcall, __fastcall и т.д.<br><br>Обе функции GetSystemTime and GetLocalTime в качестве единственного параметра получают: <br>A pointer to a SYSTEMTIME structure to receive the current local date and time.<br>В эту структуру и поступает информация и потом оттуда считывается.<br>&quot;Эта функция значения, как такового, не возвращает, но зато возвращает структуру&quot;<br>Return value:<br>This function does not return a value or provide extended error information.<br>Что тут еще может быть не ясно?<br><br>И вообще - поменьше воды и эмоциональных описаний своих переживаний. Вся эта образность хороша в школьном сочинении, а тут это просто неуместно. Ни у кого нет времени читать все ваши излияния.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=337578&amp;user=4773&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=17" class="addthx" data-post="337578"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 19:33 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>plutos</b><br><br>Действительно, слишком много букв.<br><br><b>VBA</b><br><br>Подменяете функцию и своё время возвращаете.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337579&amp;user=33727&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=18" class="addthx" data-post="337579"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]VBA[/b]','')">VBA</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.8 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.44'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 19:44 &middot; Поправил: VBA <br><script type="text/javascript">QU('VBA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VBA" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>plutos пишет:<br>И вообще - поменьше воды и эмоциональных описаний своих переживаний. Вся эта образность хороша в школьном сочинении, а тут это просто неуместно. Ни у кого нет времени читать все ваши излияния. </I><br><br>Хорошо, я больше не буду <img src="img/smilies/s1.gif" alt=""><br><br><br><I>plutos пишет:<br>Как совершенно справедливо тебе рекомендует Archer, &quot;Почитал бы ты основы про соглашения о вызовах, что ли.&quot;Скажем здесь:--&gt;http://msdn.microsoft.com/en-us/library/k2b2ssfy.aspx&lt;--типа __cdecl, __stdcall, __fastcall и т.д.</I><br><br>Эта ссылка у меня не открывается, мне пишут:<br><br><b>Forbidden<br>You don&#039;t have permission to access /f/--&gt;http://msdn.microsoft.com/en-us/library/k2b2ssfy.aspx&lt;-- on this server.</b><br><br><br><I>plutos пишет:<br>Обе функции GetSystemTime and GetLocalTime в качестве единственного параметра получают: A pointer to a SYSTEMTIME structure to receive the current local date and time.В эту структуру и поступает информация и потом оттуда считывается.&quot;Эта функция значения, как такового, не возвращает, но зато возвращает структуру&quot;Return value:This function does not return a value or provide extended error information.Что тут еще может быть не ясно? </I><br><br>Не ясно, в чем наши разногласия. И я говорю ровно то же самое. <br>Вот функция вернула структуру, программист использует возвращенную структуру для определения текущей даты и времени, и запихивает эти значения в 3 регистра. А мы вместо этих значений зашиваем туда удобные для нас константы. Таков был замысел, и я его осуществил. Но там &quot;подводные камни&quot;, которые мне пока еще неподвластны.<br>Во-первых, мне так и не удалось добраться до третьего вызова этой функции и посмотреть, что же там окажется в регистре eax после<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00418AC0</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;E8&nbsp;CF3DFFFF&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_function">JMP</span><span class="hl_char">.</span><span class="hl_char">&amp;</span>kernel32<span class="hl_char">.</span>GetLocalTime<span class="hl_char">&gt;</span>&nbsp;<span class="hl_comment">; \KERNEL32.GetLocalTime</span></li><li class="hl_l1"><span class="hl_number">00418AC5</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;<span class="hl_number">0FB70424</span>&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br><br>А во-вторых эта прога, наверняка, пихает нужную инфу в реестр и в какие-нибудь файлы в системной папке. По-хорошему, надо было бы промониторить систему до и после установки этой проги с помощью ФайлМона и РегМона, но мне не терпелось поковыряться внутри этой проги, и я не стал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337580&amp;user=36752&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=19" class="addthx" data-post="337580"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]VBA[/b]','')">VBA</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.8 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.44'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 19:49 &middot; Поправил: VBA <br><script type="text/javascript">QU('VBA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VBA" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>Dr0p пишет:<br>VBA<br>Подменяете функцию и своё время возвращаете. </I><br><br>Ну я же именно это и делал.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337582&amp;user=36752&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=20" class="addthx" data-post="337582"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 19:55 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>VBA</b>:<br><b>Эта ссылка у меня не открывается</b><br><br>Then do not  click on the link. Copy the link and paste it in your browser. Works just fine.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=337583&amp;user=4773&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=21" class="addthx" data-post="337583"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]VBA[/b]','')">VBA</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.8 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.44'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 20:16 <br><script type="text/javascript">QU('VBA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VBA" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>plutos пишет:<br>Then do not  click on the link. Copy the link and paste it in your browser. Works just fine. </I><br><br>Ну да, теперь работает. <br>Хорошо, сейчас почитаю. <br>Но все равно мне очень сомнительно, что я там вычитаю что-нибудь другое относительно сказанного выше, а именно того, что эта функция значения не возвращает, но возвращает структуру.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337585&amp;user=36752&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=22" class="addthx" data-post="337585"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 20:32 <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Говорить, что : &quot;функция значения не возвращает, но возвращает структуру&quot; - это бессмыслица.<br>Функция не может возвращать &quot;структуру&quot;, она может возвращать pointer to structure, адрес структуры в памяти, а коли так, то  это будет уже какое-то &quot;значение&quot;. Как оно интерпретируется - как адрес или содержимое адреса - это уже другое дело.<br>В данном случае эти функции не возвращают ничего, никаких адресов, никаких структур, а внутри себя используют переданый им в качестве параметра адрес структуры, чтобы поместить туда то, что нужно.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=337586&amp;user=4773&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=23" class="addthx" data-post="337586"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]VBA[/b]','')">VBA</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.8 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.44'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 22:19 &middot; Поправил: VBA <br><script type="text/javascript">QU('VBA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VBA" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>plutos пишет:<br>Говорить, что : &quot;функция значения не возвращает, но возвращает структуру&quot; - это бессмыслица.Функция не может возвращать &quot;структуру&quot;, она может возвращать pointer to structure, адрес структуры в памяти, а коли так, то  это будет уже какое-то &quot;значение&quot;. Как оно интерпретируется - как адрес или содержимое адреса - это уже другое дело.В данном случае эти функции не возвращают ничего, никаких адресов, никаких структур, а внутри себя используют переданный им в качестве параметра адрес структуры, чтобы поместить туда то, что нужно. </I><br><br>Большое спасибо за разъяснения!<br><br>Честно говоря, я во всей этой терминологии пока еще не особо силен, поэтому мне как-то даже и не хочется продолжать этот, на мой взгляд, чисто терминологический спор. Какое отношение это имеет к рассматриваемой задаче?<br><br>Вот оригинальный код:<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_number">00418A48</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;E8&nbsp;<span class="hl_number">473EFFFF</span>&nbsp;<span class="hl_function"><b>CALL</b></span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_function">JMP</span><span class="hl_char">.</span><span class="hl_char">&amp;</span>kernel32<span class="hl_char">.</span>GetLocalTime<span class="hl_char">&gt;</span>&nbsp;<span class="hl_comment">; \KERNEL32.GetLocalTime</span></li><li class="hl_l1"><span class="hl_number">00418A4D</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;<span class="hl_number">0FB74C24</span>&nbsp;<span class="hl_number">0E</span>&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">ECX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">2</span><span class="hl_char">+</span><span class="hl_number">2</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_number">00418A52</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;<span class="hl_number">0FB75424</span>&nbsp;<span class="hl_number">0A</span>&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EDX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">+</span><span class="hl_number">2</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_number">00418A57</span>&nbsp;<span class="hl_char">|</span><span class="hl_char">.</span>&nbsp;<span class="hl_number">0FB74424</span>&nbsp;<span class="hl_number">08</span>&nbsp;<span class="hl_function"><b>MOVZX</b></span>&nbsp;<span class="hl_registr">EAX</span><span class="hl_char">,</span><span class="hl_function"><b>WORD</b></span>&nbsp;<span class="hl_function"><b>PTR</b></span>&nbsp;<span class="hl_registr">SS</span><span class="hl_char">:</span><span class="hl_char">[</span><span class="hl_function">LOCAL</span><span class="hl_char">.</span><span class="hl_number">3</span><span class="hl_char">]</span></li>        </ol>
    </div>
</div></div>
<br>После выполнения этого участка кода в упомянутых здесь регистрах оказываются значения текущего дня, месяца и года. Я это своими глазами видел в дебаггере, а ведь до выполнения этих команд в этих регистрах были совсем другие значения. Наверно, этот самый LOCAL и есть тот самый пойнтер, о котором вы говорите. Ну а по указанным смещениям (относительно него) как раз и появляются после выполнения этой функции эти самые значения, которые затем помещаются в регистры. Я оставляю вызов этой функции, но вместо считывания значений из памяти по указанным адресам просто вставляю в эти регистры нужные мне значения. Что в этом неправильно? Или вы намекаете, что эту функцию лучше вообще занопить?<br><br>Или здесь какая-то другая тонкость, которую я никак не могу понять из ваших объяснений?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337591&amp;user=36752&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=24" class="addthx" data-post="337591"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 391thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 23:22 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>VBA пишет:<br>Или здесь какая-то другая тонкость, которую я никак не могу понять из ваших объяснений?<br></I><br>...у вас же есть готовый кряк. Посмотрите, что он делает, и сделайте правильные выводы.<br><br><I>промониторить систему до и после установки этой проги с помощью ФайлМона и РегМона, </I><br><br>-- то-есть как <I>промониторить</I> до- и после- ? Эти программы используются именно <b>во время</b> работы интересующего софта.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337596&amp;user=35473&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=25" class="addthx" data-post="337596"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]tomac[/b]','')">tomac</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 65.3 (постоянный), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.82'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6470">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 23:27 &middot; Поправил: tomac <br><script type="text/javascript">QU('tomac','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tomac" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Во-первых, после заполнения структуры и копирования значений в регистры, структура никуда не девается. Подменять нужно не значения регистров, а значения в структуре. Можно и вообще GetLocalTime похукать. <br>Во-вторых, программа может использовать другие функции считывания времени. В частности, сообщение о том, что вы играете с системным временем, означает, что у проги есть другие источники информации. Например, она пишет, сколько времени она проработала, и, когда это время переходит за сутки, проверяет, изменилось ли время на компе. <br>В-третьих, process monitor. Покажет, что программа читает, что пишет. Напрасно отказались от него.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337597&amp;user=6470&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=26" class="addthx" data-post="337597"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]DimitarSerg[/b]','')">DimitarSerg</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/24946.png" alt=""><br><span class=txtSm>Ранг: 253.5 (наставник), 684thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.26'>Активность: 0.26<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=24946">Участник</a><br><font color=blue>radical</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 февраля 2014 23:56 &middot; Поправил: DimitarSerg <br><script type="text/javascript">QU('DimitarSerg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DimitarSerg" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
У меня вопрос: почему новичку начинают объяснять не самый простой  (имхо даже немного стрёмный) вариант решения задачи, как для новичка ?!<br><br><b>VBA</b><br>А почему не пропатчить сравнение дат ? Или &quot;мы не ищем лёгких путей&quot; ?<br><br>add:<br>А для сравнения снимков до и после (чтобы находить скрытые флаги/метки в реестре/файловой системе) советую виртуалку + ThinApp/SysTracer.
<br><br><font size="1"><i>-----<br>ds</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=337601&amp;user=24946&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=27" class="addthx" data-post="337601"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=36752" title="04-02-2014 18:13, ранг:0.8" target="_blank">VBA</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Djeck[/b]','')">Djeck</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 196.0 (ветеран), 72thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.2'>Активность: 0.14<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=11304">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2014 00:32 <br><script type="text/javascript">QU('Djeck','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Djeck" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>DimitarSerg пишет:<br>почему новичку начинают объяснять не самый простой (имхо даже немного стрёмный) вариант решения задачи, как для новичка ?! </I><br> Я тоже читаю и не пойму какие перехваты структуры? Вы ему ещё длл внедрить посоветуйте.<br><b>VBA</b><br>Может ты всё-таки ссылку скинешь? А то у меня третий глаз в отпуске до конца февраля...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337608&amp;user=11304&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=28" class="addthx" data-post="337608"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=36752" title="04-02-2014 18:12, ранг:0.8" target="_blank">VBA</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Zorn[/b]','')">Zorn</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 53.9 (постоянный), 19thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.25'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4376">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2014 03:00 &middot; Поправил: Zorn <br><script type="text/javascript">QU('Zorn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Zorn" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>VBA пишет:<br>Стал искать &quot;жертву&quot;. Оказалось, что это тоже не самое легкое занятие. Гуглил примерно так: &quot;платные программы&quot;, &quot;shareware&quot;, &quot;trial&quot;, но на все мои запросы находилось только всё бесплатное. Наконец, мне посчастливилось и я нашел программу своей мечты С ее помощью можно снимать скриншоты с экрана и видео записывать. Триал 30 дней. Регистрация около 40&#036;. </I><br>Тоже так начинал. Нашел наглого быдлокодера (за 1000&#036; продавал свое поделие) и безжалостно закейгенил <img src="img/smilies/s1.gif" alt=""><br>А что за программа была, даже не вспомню )
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337613&amp;user=4376&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=29" class="addthx" data-post="337613"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]VBA[/b]','')">VBA</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 2.8 (гость), 3thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.44'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=36752">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2014 15:53 &middot; Поправил: VBA <br><script type="text/javascript">QU('VBA','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VBA" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=22544&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>Djeck пишет:<br>VBAМожет ты всё-таки ссылку скинешь? А то у меня третий глаз в отпуске до конца февраля... </I><br><br>Без проблем! И кстати, большое спасибо за эту реплику. А то бывают такие форумы, на которых вообще запрещено давать внешние ссылки, поэтому я сразу и не дал, а потом вроде никто и не просил, если не считать одного письма в личку с тем же вопросом.<br><br>Вот здесь я ее скачал, когда искал ЛЮБУЮ современную прогу пригодную для крэка и желательно не упакованную:<br><br>http://www.snapfiles.com/featured/531424-107980.html<br><br>А вот здесь я ее нашел уже с крэком, когда бульдозерист начал надо мной издеваться <img src="img/smilies/s1.gif" alt=""> <br><br>http://skachat-free.ru/11632-capturewizpro-540.html<br><br><I>dosprog пишет:<br>..у вас же есть готовый кряк. Посмотрите, что он делает, и сделайте правильные выводы. </I><br><br>Была такая мысль, была... Но это какой-то странный кряк. Первый кряк в моей жизни, который запросил для себя установки дополнительного софта <img src="img/smilies/s1.gif" alt=""> Вот такой вот привередливый кряк попался <img src="img/smilies/s1.gif" alt="">  Давай, говорит, устанавливай НетФрейм 3.5, а иначе я запускаться отказываюсь <img src="img/smilies/s1.gif" alt=""> Я, конечно, установил, проблема не большая. Кейген запустил. Интерфейс красивый, анимация салюта и все такое. Но, честно говоря, с точки зрения пользователя, в данном вопросе важен функционал, а не внешний вид. Хотя в любом случае, большое спасибо Jagged1600.<br><br>Я это говорю к тому, что кряк написан под виртуальную машину НетФрейм 3.5, а значит мне, как новичку, будет трудно с ним разобраться. По крайней мере, Bad_Guy в своем видеокурсе говорит, что для расшифровки кода виртуальных машин нужно использовать дополнительные программы, если, конечно, я ничего не путаю. Поэтому я в него и не полез.<br><br><I>dosprog пишет:<br>VBA пишет:<br>промониторить систему до и после установки этой проги с помощью ФайлМона и РегМона, <br><br>-- то-есть как промониторить до- и после- ? Эти программы используются именно во время работы интересующего софта. </I><br><br><br>На самом деле, я сейчас уже запутался со всеми этими РегМонами и ФайлМонами <img src="img/smilies/s1.gif" alt="">  Они в таком щедром количестве выложены на сайте вот здесь<br><br>http://exelab.ru/download.php?action=list&amp;n=MTU=<br><br>что у меня сейчас бушует хватательный рефлекс, и я скачиваю всё подряд, изучаю справочную систему у каждой проги, а если у какой-нибудь (не дай Бог! <img src="img/smilies/s1.gif" alt="">  ) оказывается еще и видео-тьюторил, выложенный на сайте производителя, то внимательно просматриваю еще и это видео. Если кто не в курсе, вот здесь вот очень интересные видюхи выложены:<br><br>http://jacquelin.potier.free.fr/winapioverride32/videos.php<br><br>Это я к чему говорю? Да к тому, что у меня сейчас в голове &quot;каша&quot; от всех этих программ. Одним словом, я имел в виду, что надо было бы не спешить с установкой, а сначала сделать снимок реестра, потом установить прогу, снова сделать снимок реестра и сравнить, какие ключи изменились.<br>Насколько я могу понять, вот эта вот прога позволяет всё это сделать:<br><br>&quot;RegSnap - инструмент, который может помочь Вам анализировать изменения, сделанные в реестре Windows. То есть, Вы можете сравнить снимки реестра до и после какого-то действия и узнать, какие ключи были изменены, удалены, или добавлены&quot;. <br><br>И то же самое можно с файловой системой делать с помощью той же самой проги:<br><br>&quot;Вы можете также анализировать другие чувствительные части системы, типа списка файлов в папке Windows и системной директории. RegSnap может создавать HTML отчёты&quot;.<br><br><br>На самом деле, я именно про эту прогу писал, что надо было бы ее использовать до и после установки &quot;жертвы&quot;. А ФайлМон и РегМон это, конечно, совсем другие программы, но названия уж больно подходящие под ту задачу, которую я имел в виду, потому я и запутался, и не то написал, что надо было <img src="img/smilies/s1.gif" alt=""><br><br><br><I>tomac пишет:<br>Во-первых, после заполнения структуры и копирования значений в регистры, структура никуда не девается. Подменять нужно не значения регистров, а значения в структуре. </I><br><br>Была такая мысля. Но я так и не смог добраться до этих адресов в Олли. Там написано &quot;SS:[LOCAL.2+2]&quot;, а как добраться до этого места в дампе памяти, я не знаю <img src="img/smilies/s9.gif" alt="">  Как найти этот LOCAL, от которого отсчитываются все эти смещения?<br><br><br><I>tomac пишет:<br>Можно и вообще GetLocalTime похукать. Во-вторых, программа может использовать другие функции считывания времени. В частности, сообщение о том, что вы играете с системным временем, означает, что у проги есть другие источники информации. Например, она пишет, сколько времени она проработала, и, когда это время переходит за сутки, проверяет, изменилось ли время на компе. </I><br><br>А какие API надо перехватывать, чтобы в этом разобраться?<br><br><I>tomac пишет:<br>В-третьих, process monitor. Покажет, что программа читает, что пишет. Напрасно отказались от него. </I><br><br>Да ни от чего я не отказался! Просто &quot;каша&quot; сейчас в голове от изобилия всех этих инструментов, которые все очень полезны, и глаза разбегаются, какой лучше выбрать <img src="img/smilies/s1.gif" alt=""><br><br><br><I>DimitarSerg пишет:<br>VBA<br>А почему не пропатчить сравнение дат ? Или &quot;мы не ищем лёгких путей&quot; ?</I><br><br>Совсем наоборот! Я, как новичек в этом деле, ищу сейчас именно самые легкие пути, но знать бы только где они, а вот этого я как раз и не знаю <img src="img/smilies/s1.gif" alt="">  Для того, чтобы пропатчить сравнение дат, надо знать, где это сравнение происходит, а я этого не знаю.<br><br><br><I>DimitarSerg пишет:<br>А для сравнения снимков до и после (чтобы находить скрытые флаги/метки в реестре/файловой системе) советую виртуалку + ThinApp/SysTracer. </I><br><br>Спасибо! Обязательно погуглю и установлю.<br><br><br><I>Zorn пишет:<br>Тоже так начинал. Нашел наглого быдлокодера (за 1000&#036; продавал свое поделие) и безжалостно закейгенил А что за программа была, даже не вспомню ) </I><br><br>Что же это за программа должна быть, чтобы за нее такие деньги требовать?! Не иначе как, целая операционная система новая или новый Microsoft Office <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=337634&amp;user=36752&amp;forum_n=5&amp;topic=22544&amp;page=0&amp;anchor=30" class="addthx" data-post="337634"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=5&amp;topic=22544&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=5&amp;topic=22544&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Всё очень просто или мне это только кажется?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="22544">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22544" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
