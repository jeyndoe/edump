<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>подскажите порядок команд по разбору содержимого окна класса DirectUIHWND - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="возьмем пример окна &quot;Мой компьютер&quot; в виндовс хр. левая часть окна является DirectUIHWND. как можно прочитать его содержимое? а потом еще и выбрать определенный пункт? ссылку">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> подскажите порядок команд по разбору содержимого окна класса DirectUIHWND</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=20266&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=20266&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2012 17:38 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
возьмем пример окна &quot;Мой компьютер&quot; в виндовс хр. левая часть окна является DirectUIHWND. как можно прочитать его содержимое? а потом еще и выбрать определенный пункт? ссылку http://wmsdk.com/2009/07/09/directui-iaccessible/ не предлагать, потому как китайская грамота... <br><br>нужен порядок команд, с помощью которого можно достучаться до содержимого окошка. с классом SysListView32 все получилось замечательно - читаю, выбираю. а вот в 7 виндовсе мое целевое окошко DirectUIHWND, и из-за этого затык... 4000 строчек кода и висит уже который месяц.<br><br>насколько я понял:<br>1. сначала нужно найти хэндл окошка - это есть<br>2. проверить на доступность AccessibleObjectFromWindow - это есть, возвращает S_OK<br>3. посчитать количество child - есть, но видимо работает не верно. так как возвращает 0, хотя в этом окне ясное дело есть дочерние объекты. читаю командой get_accChildCount - конечно возможно я напутал с синтаксисом get_accChildCount, и поэтому он мне хоть и пишет S_OK... но само количество child пишет 0. но я полагаю что между AccessibleObjectFromWindow и get_accChildCount должна быть еще какая-то команда... ну не может это окно иметь 0, так как внутри него есть пункты всевозможные.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=310614&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=1" class="addthx" data-post="310614"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]OKOB[/b]','')">OKOB</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6801.png" alt=""><br><span class=txtSm>Ранг: 527.7 (<b>!</b>), 381thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.78'>Активность: 0.16<span style='color:red'>&searr;</span>0.09</span><br>Статус: <a href="action=userinfo&amp;user=6801">Участник</a><br><font color=blue><font color=red>Победитель турнира 2010</font></font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 августа 2012 22:29 <br><script type="text/javascript">QU('OKOB','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=OKOB" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
что делает топик на этом форумк, да еще в основной ветке??
<br><br><font size="1"><i>-----<br>127.0.0.1, sweet 127.0.0.1</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=310617&amp;user=6801&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=2" class="addthx" data-post="310617"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4773" title="27-08-2012 00:49, ранг:47.6" target="_blank">plutos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2012 05:07 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
полезное замечание. я его обязательно применю в своем проекте. большое спасибо. осталось только мелочь... в порядке команд разобраться...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=310622&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=3" class="addthx" data-post="310622"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ZaZa[/b]','')">ZaZa</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3691.jpg" alt=""><br><span class=txtSm>Ранг: 158.5 (ветеран), 219thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.12<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3691">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2012 06:27 &middot; Поправил: ZaZa <br><script type="text/javascript">QU('ZaZa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ZaZa" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>SeregaZ</b><br>Ты скажи лучше, что тебе в той панели надо именно кликать? <br>Свойства системы? Установка, удаление программ? Панель управления?<br><br>До всего этого можно дотянуться и просто так, не используя такие хитрые приемы... Например через командную строку, используя &quot;CONTROL.EXE&quot; (читать <noindex><a href="http://winreview.ru/klyuchi-komandnoj-stroki-utility-control-exe/" rel="nofollow" target="_blank">--&gt; тут &lt;--</a></noindex>)<br>И писать 4000 строк кода нафих надо, если все можно решить проще...<br><br>Если все таки очень хочется, тогда можно тут поискать: KODERS.COM (<noindex><a href="http://koders.com/default.aspx?s=DirectUIHWND&amp;submit=Search&amp;la=*&amp;li=*" rel="nofollow" target="_blank">Поиск DirectUIHWND</a></noindex>, <noindex><a href="http://koders.com/default.aspx?s=get_accChildCount&amp;la=*&amp;li=*&amp;scope=&amp;search.x=0&amp;search.y=0" rel="nofollow" target="_blank">Поиск get_accChildCount</a></noindex>)<br><br>Или я чего то не понимаю... <img src="img/smilies/s15.gif" alt="">
<br><br><font size="1"><i>-----<br>One death is a tragedy, one million is a statistic.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=310623&amp;user=3691&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=4" class="addthx" data-post="310623"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2012 09:35 &middot; Поправил: SeregaZ <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
мое окошко в 7 и это окно выбора сертификата при входе на сайт https. а на компьютере стоит XP. на XP тот же класс окна используется в окошке Мой Компьютер, левой части. поскольку и на 7 при попытке посчитать детишек выдает 0 и на хр тоже 0, то видимо принцип достучания до данных внутри окна одинаков. вот надо просто выяснить порядок команд. <br><br>например регистрация сертификата в браузере, я тоже тут на форуме спрашивал - там порядок оказался следующий:<br>1. сначала читаем сам файл сертификата PFXImportCertStore<br>2. потом я выяснил что в каждом файле *.p12 оказывается может быть несколько сертификатов. чтобы их проиндексировать понадобится CertEnumCertificatesInStore.<br>2.1 для чтения названий сертификатов можно использовать CertGetNameString.<br>3. после этого следует открыть ту ветку-хранилище, куда мы будем записывать наш сертификат -  CertOpenStore<br>4. после открытия добавляем содержимое сертификата CertAddCertificateContextToStore<br>5. после этого следует закрыть хранилище CertCloseStore<br>6. если в  файле-контейнере *.p12 было больше 1 сертификата - повторить с пункта 2.1<br><br>4000 строчек это весь проект. там много функций. осталась одна - эта - управление окошком DirectUIHWND в виндовсе 7.<br><br>ссылки на материалы это конечно хорошо... однако хотелось бы видеть четкий план, как мой по регистрации сертификата выше, с пояснениями. между AccessibleObjectFromWindow и get_accChildCount явно что-то должно быть...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=310624&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=5" class="addthx" data-post="310624"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]ZaZa[/b]','')">ZaZa</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/3691.jpg" alt=""><br><span class=txtSm>Ранг: 158.5 (ветеран), 219thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.43'>Активность: 0.12<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3691">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2012 09:52 <br><script type="text/javascript">QU('ZaZa','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ZaZa" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Разбираться за тебя в хитросплетениях Microsoft никто не станет... Дали ссылки - читай, разбирайся сам...<br>Помощи по функциям и процедурам, указанным тобой предостаточно! Взять тот же самый MSDN: <noindex><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/cc307847.aspx" rel="nofollow" target="_blank">--&gt; Link 1 &lt;--</a></noindex>, <noindex><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd318476(v=vs.85).aspx" rel="nofollow" target="_blank">--&gt; Link 2 &lt;--</a></noindex><br>Сторонние ресурсы: <noindex><a href="http://www.scribd.com/doc/91406444/28/get-accChildCount" rel="nofollow" target="_blank">--&gt; Link &lt;--</a></noindex><br><br>Ну или проще простого: дождаться того, кто так же как и ты задался таким же вопросом, но все же решил его, вопреки своей лени!
<br><br><font size="1"><i>-----<br>One death is a tragedy, one million is a statistic.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=310625&amp;user=3691&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=6" class="addthx" data-post="310625"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4773" title="27-08-2012 05:59, ранг:47.6" target="_blank">plutos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2012 10:13 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
видимо я этим занимался, перед тем как сюда запостить. однако английский, а уж тем более технический английский штука крайне не понятная... <br><br>мсдны давно изучены. там просто команды, и поверхностные описания команд, расчитанные на довольно продвинутых пользователей... или даже программистов. про последовательность команд в мдснах что-то не указано... особенно про последовательность в моей конкретной задаче. на форуме своего языка программирования у буржуев спрашивал - не знают. на русском форуме даже спрашивать не стал, там никого нет, так как язык не популярный.<br><br>дожидатся кого-то смысла нет. тут срабатывает обычный эгоизм: вот я мегакрутой хакер разобрался, вы мне не помогали, а я сам все понял, пошли все нахер, не буду я ничего постить на форуме. вот все и ныкаются потом как слепые котята в поисках информации. даже гугл по запросу DirectUIHWND выдает на первой страничке две-три ссылки на форумы, где я сам спрашиваю про DirectUIHWND. и только одна более менее стоящая http://wmsdk.com/2009/07/09/directui-iaccessible/ но судя по ссылке написанная аж в 2009 году...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=310627&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=7" class="addthx" data-post="310627"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2012 10:54 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>однако английский, а уж тем более технический английский штука крайне не понятная...</b><br>Да, Серега, плохи твои дела... <br><br><b>мсдны давно изучены. там просто команды, и поверхностные описания команд, расчитанные на довольно продвинутых пользователей... или даже программистов. про последовательность команд в мдснах что-то не указано... </b><br>Т.е не указано, в какой последовательности нужно эти &quot;команды&quot; комбинировать? Но это уж кто как хочет, тот так и комбинирует. <img src="img/smilies/s6.gif" alt=""><br><br> <b>на форуме своего языка программирования у буржуев спрашивал - не знают. </b><br>Они, как видно, вопроса твоего не поняли (см. выше) или просто обиделись, что ты их так называешь.<br><br><b>на русском форуме даже спрашивать не стал, там никого нет, так как язык не популярный</b><br>Т.е. ты там единственный посетитель?<br><br><b>пошли все нахер, не буду я ничего постить на форуме</b><br>Да нет, нет! Продолжай пожалуйста, &quot;пость&quot;! Я твои посты всегда читаю с удовольствием... Очень освежает!
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=310630&amp;user=4773&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=8" class="addthx" data-post="310630"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 августа 2012 11:19 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>кто как хочет, тот так и комбинирует.</b><br>ну прям... есть определенные последовательности, где команды идут друг за другом, одна вытекает из другой. при изменении порядка код работать не будет. типа как сначала PFXImportCertStore а потом CertEnumCertificatesInStore. если сделать наоборот - откуда CertEnumCertificatesInStore знает что перебирать, если изначально PFXImportCertStore не загрузил данные?<br><br><b>вопроса твоего не поняли</b><br>буржуи все поняли <img src="img/smilies/s1.gif" alt=""> сам мануалы писал на буржуйском для буржуев... по другой правда теме, но жалоб не было. это задача просто крайне специфичная.<br><br><b>там единственный посетитель</b><br>хорошо перефразирую - толковых посетителей там нет. предупреждая следующий пост-возражение, перефразирую еще раз - толковых посетителей по данной теме там нет.<br><br><b>Продолжай пожалуйста</b><br>вырываешь из контекста. я писал об эгоизме, а не о себе лично.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=310632&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=9" class="addthx" data-post="310632"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 сентября 2012 19:57 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
неужели никто не сталкивался с подобной задачей для своих программ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311097&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=10" class="addthx" data-post="311097"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]MasterSoft[/b]','')">MasterSoft</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 281.8 (наставник), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.16'>Активность: 0.25<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16624">Участник</a><br><font color=blue>Destroyer of protectors</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 сентября 2012 20:30 <br><script type="text/javascript">QU('MasterSoft','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MasterSoft" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>SeregaZ пишет:<br>своего языка программирования </I><br>можно полюбопытствовать, как его имя?<br><br><I>SeregaZ пишет:<br>...или даже программистов. </I><br>забавно, ты как я понимаю программу пишешь, 4к строк накатал, так кто же ты если не программист?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311100&amp;user=16624&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=11" class="addthx" data-post="311100"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4773" title="05-09-2012 02:48, ранг:50.2" target="_blank">plutos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 сентября 2012 21:03 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>SeregaZ</b><br>Не понимаю в чем сложность, элементарно же.<br>Гугли по:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">oleacc<span class="hl_char">.</span>dll</li><li class="hl_l1"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l0">AccessibleObjectFromPoint</li><li class="hl_l1">AccessibleChildren</li><li class="hl_l0">GetStateTextW</li><li class="hl_l1">GetRoleTextW</li><li class="hl_l0"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li>        </ol>
    </div>
</div></div>
<br>Готовый код есть, не дам из принципа.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311101&amp;user=6&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=12" class="addthx" data-post="311101"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=4773" title="05-09-2012 02:48, ранг:50.2" target="_blank">plutos</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2012 09:14 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>MasterSoft пишет:<br>можно полюбопытствовать, как его имя? </I><br>PureBasic<br><br><I>MasterSoft пишет:<br>забавно, ты как я понимаю программу пишешь, 4к строк накатал, так кто же ты если не программист?  </I><br>эм... ну те строчки кода под силу и не программисту <img src="img/smilies/s1.gif" alt=""> все-таки в моем понимании это такой человек, который, помимо светлой головы, имеет еще и толковое образование.<br><br><br><I>F_a_u_s_t пишет:<br>Гугли по: <br>AccessibleObjectFromPoint</I><br>так тут проверка доступности, так сказать, из точки - то есть координат. а мне то надо окно - AccessibleObjectFromWindow. с AccessibleObjectFromPoint есть пример, даже под мой язык - выводит в тело программы текст под курсором.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311119&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=13" class="addthx" data-post="311119"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]plutos[/b]','')">plutos</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/4773.png" alt=""><br><span class=txtSm>Ранг: 622.6 (<b>!</b>), 521thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.16'>Активность: 0.33<span style='color:green'>&nearr;</span>0.89</span><br>Статус: <a href="action=userinfo&amp;user=4773">Участник</a><br><font color=blue>_Вечный_Студент_</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2012 09:37 &middot; Поправил: plutos <br><script type="text/javascript">QU('plutos','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=plutos" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
Честно говоря, тема данного топика имеет к reverse engineering и исследованию программ весьма и весьма условное отношение, как и сам язык PureBasic... <br>Пробуй, экспериментируй, учись, но этот форум тут явно ни причем.
<br><br><font size="1"><i>-----<br>Give me a HANDLE and I will move the Earth.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=311120&amp;user=4773&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=14" class="addthx" data-post="311120"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2012 10:06 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
запрос по взлому окошка DirectUIHWND в windows 7 и замене его на окошко класса SysListView32 был бы уместнее?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311121&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=15" class="addthx" data-post="311121"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2012 11:35 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>SeregaZ пишет:<br>виндовс хр. левая часть окна является DirectUIHWND. как можно прочитать его содержимое? </I><br>Один запрос в гугле и готовый код на делфи и си, в атаче пример, наведи перо на окно установка и удаление программ и нажми кнопку Получить данные.<img src="img/smilies/s1.gif" alt=""><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/3aa0_05.09.2012_EXELAB.rU.tgz">3aa0_05.09.2012_EXELAB.rU.tgz</a> - Project1.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311126&amp;user=6&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=16" class="addthx" data-post="311126"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2012 12:38 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>наведи перо</b><br>проблема в том, что в этом случае используется AccessibleObjectFromPoint. в моем случае не предполагается задействовать курсор или читать координаты каким-либо образом, то есть предполагается доступ к данным по хендлу окна - AccessibleObjectFromWindow. с AccessibleObjectFromPoint нет никаких проблем. проблема именно с AccessibleObjectFromWindow.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311131&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=17" class="addthx" data-post="311131"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2012 13:46 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>SeregaZ</b><br>Ты реально наркоман, вопрос тривиальный, а ты в место того что бы его решать сидишь на теме.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">function&nbsp;AccessibleObjectFromEvent<span class="hl_char">(</span>H&nbsp;<span class="hl_char">:</span>&nbsp;HWND<span class="hl_comment">; dwID, dwChildID : DWORD; out Acc : IAccessible; var varChild : Variant) : HRESULT; stdcall;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>stdcall</b></span><span class="hl_comment">; external 'oleacc.dll';</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">function&nbsp;AccessibleChildren<span class="hl_char">(</span>paccContainer&nbsp;<span class="hl_char">:</span>&nbsp;Pointer<span class="hl_comment">; iChildStart : LONGINT; cChildren : LONGINT; out rgvarChildren : OleVariant; out pcObtained : LONGINT) : HRESULT; stdcall;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>stdcall</b></span><span class="hl_comment">; external 'oleacc.dll';</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">procedure&nbsp;TForm1<span class="hl_char">.</span>DisplayInfo<span class="hl_char">(</span><span class="hl_function"><b>const</b></span>&nbsp;aAccessible&nbsp;<span class="hl_char">:</span>&nbsp;IAccessible<span class="hl_comment">; const aOffset : string);</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;procedure&nbsp;ProcessChild<span class="hl_char">(</span><span class="hl_function"><b>const</b></span>&nbsp;aChild&nbsp;<span class="hl_char">:</span>&nbsp;OleVariant<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;var</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;ChildAccessible&nbsp;<span class="hl_char">:</span>&nbsp;IAccessible<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;ChildDispatch&nbsp;<span class="hl_char">:</span>&nbsp;IDispatch<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;ChildDispatch&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;nil<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;VarType<span class="hl_char">(</span>aChild<span class="hl_char">)</span>&nbsp;of</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;varInteger&nbsp;<span class="hl_char">:</span>&nbsp;aAccessible<span class="hl_char">.</span>Get_accChild<span class="hl_char">(</span>aChild<span class="hl_char">,</span>&nbsp;ChildDispatch<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;varDispatch&nbsp;<span class="hl_char">:</span>&nbsp;ChildDispatch&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;aChild<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>ChildDispatch&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span>&nbsp;nil<span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_char">(</span>ChildDispatch<span class="hl_char">.</span>QueryInterface<span class="hl_char">(</span>IAccessible<span class="hl_char">,</span>&nbsp;ChildAccessible<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK<span class="hl_char">)</span>&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DisplayInfo<span class="hl_char">(</span>ChildAccessible<span class="hl_char">,</span>&nbsp;aOffset&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_quote">'   '</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">var</li><li class="hl_l1">&nbsp;&nbsp;Child<span class="hl_char">,</span>&nbsp;CurrentChild&nbsp;<span class="hl_char">:</span>&nbsp;OleVariant<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ChildArray&nbsp;<span class="hl_char">:</span>&nbsp;array&nbsp;of&nbsp;OleVariant<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;dwNum&nbsp;<span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>DWord</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;Enum&nbsp;<span class="hl_char">:</span>&nbsp;IEnumVARIANT<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;i<span class="hl_char">,</span>&nbsp;iChildCount<span class="hl_char">,</span>&nbsp;iObtained&nbsp;<span class="hl_char">:</span>&nbsp;Integer<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;wsText&nbsp;<span class="hl_char">:</span>&nbsp;WideString<span class="hl_comment">;</span></li><li class="hl_l1">begin</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;aAccessible&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span>&nbsp;nil&nbsp;then&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;aAccessible<span class="hl_char">.</span>get_AccName<span class="hl_char">(</span>CHILDID_SELF<span class="hl_char">,</span>&nbsp;wsText<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Memo1<span class="hl_char">.</span>Lines<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>aOffset&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_quote">'Name: '</span>&nbsp;<span class="hl_char">+</span>&nbsp;wsText<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Memo1<span class="hl_char">.</span>Lines<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>aOffset&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_quote">'Name: Empty'</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;aAccessible<span class="hl_char">.</span>get_AccValue<span class="hl_char">(</span>CHILDID_SELF<span class="hl_char">,</span>&nbsp;wsText<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Memo1<span class="hl_char">.</span>Lines<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>aOffset&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_quote">'  Value: '</span>&nbsp;<span class="hl_char">+</span>&nbsp;wsText<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;aAccessible<span class="hl_char">.</span>get_AccDescription<span class="hl_char">(</span>CHILDID_SELF<span class="hl_char">,</span>&nbsp;wsText<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Memo1<span class="hl_char">.</span>Lines<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>aOffset&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_quote">'  Description: '</span>&nbsp;<span class="hl_char">+</span>&nbsp;wsText<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>aAccessible<span class="hl_char">.</span>Get_accChildCount<span class="hl_char">(</span>iChildCount<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK<span class="hl_char">)</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_char">(</span>iChildCount&nbsp;<span class="hl_char">&gt;</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span>&nbsp;then&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form1<span class="hl_char">.</span>Memo1<span class="hl_char">.</span>Lines<span class="hl_char">.</span><span class="hl_function">Add</span><span class="hl_char">(</span>aOffset&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_quote">' Children: '</span>&nbsp;<span class="hl_char">+</span>&nbsp;IntToStr<span class="hl_char">(</span>iChildCount<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetLength<span class="hl_char">(</span>ChildArray<span class="hl_char">,</span>&nbsp;iChildCount<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;AccessibleChildren<span class="hl_char">(</span>Pointer<span class="hl_char">(</span>aAccessible<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;iChildCount<span class="hl_char">,</span>&nbsp;ChildArray<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;iObtained<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK&nbsp;then&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;to&nbsp;iObtained&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span>&nbsp;do</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessChild<span class="hl_char">(</span>ChildArray<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span>&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;aAccessible<span class="hl_char">.</span>QueryInterface<span class="hl_char">(</span>IEnumVARIANT<span class="hl_char">,</span>&nbsp;Enum<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK&nbsp;then&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enum&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;aAccessible&nbsp;as&nbsp;IEnumVARIANT<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;to&nbsp;iChildCount&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span>&nbsp;do</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;Enum<span class="hl_char">.</span>Next<span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;Child<span class="hl_char">,</span>&nbsp;dwNum<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessChild<span class="hl_char">(</span>Child<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span>&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;aAccessible<span class="hl_char">.</span>accNavigate<span class="hl_char">(</span>NAVDIR_FIRSTCHILD<span class="hl_char">,</span>&nbsp;CHILDID_SELF<span class="hl_char">,</span>&nbsp;CurrentChild<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK&nbsp;then&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessChild</span><span class="hl_char">(</span>CurrentChild<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;aAccessible<span class="hl_char">.</span>accNavigate<span class="hl_char">(</span>NAVDIR_NEXT<span class="hl_char">,</span>&nbsp;CurrentChild<span class="hl_char">,</span>&nbsp;CurrentChild<span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span>&nbsp;S_OK<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">end</span></li><li class="hl_l0"><span class="hl_function"><b>end</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li><li class="hl_l1">var</li><li class="hl_l0">&nbsp;&nbsp;Accessible&nbsp;<span class="hl_char">:</span>&nbsp;IAccessible<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;hWindow&nbsp;<span class="hl_char">:</span>&nbsp;HWnd<span class="hl_comment">;</span></li><li class="hl_l0">begin</li><li class="hl_l1">&nbsp;&nbsp;Memo1<span class="hl_char">.</span>Lines<span class="hl_char">.</span>Clear<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;hWindow&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;FindWindowA<span class="hl_char">(</span><span class="hl_quote">'CabinetWClass'</span><span class="hl_char">,</span>&nbsp;nil<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;AccessibleObjectFromWindow<span class="hl_char">(</span>hWindow<span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;IID_IAccessible<span class="hl_char">,</span>&nbsp;Accessible<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;DisplayInfo<span class="hl_char">(</span>Accessible<span class="hl_char">,</span>&nbsp;<span class="hl_quote">''</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">-</span></li>        </ol>
    </div>
</div></div>
<br>Если и после этого не понятно, то бросай программирование.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311136&amp;user=6&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=18" class="addthx" data-post="311136"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2012 17:53 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
о... а почему используется хэндл окошка CabinetWClass? разве не должен использоваться хэндл DirectUIHWND окошка? если использовать CabinetWClass, то количество &quot;детишек&quot; = 1. уже прогрес... однако все равно не понятно почему CabinetWClass - по сути родительское окно.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311147&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=19" class="addthx" data-post="311147"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2012 18:21 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>SeregaZ пишет:<br>а почему используется хэндл окошка CabinetWClass? разве не должен использоваться хэндл DirectUIHWND окошка? </I><br>Наверное потому что это родительский класс, а DirectUIHWND саб класс, по сути с помощью gdi рисует на CabinetWClass, в msdn это есть, читай.<br><I>SeregaZ пишет:<br>сли использовать CabinetWClass, то количество &quot;детишек&quot; = 1 </I><br>Собранный семпл в атаче, скажи еще что он не работает.<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/3f02_05.09.2012_EXELAB.rU.tgz">3f02_05.09.2012_EXELAB.rU.tgz</a> - WSpy.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311148&amp;user=6&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=20" class="addthx" data-post="311148"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 сентября 2012 19:59 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
ну тот момент что я оказывается искал не там где надо - уже большой прогресс. я то думал надо непосредственно сам DirectUIHWND разбирать. пойду у буржуев поинтересуюсь по некоторым моментам перевода в &quot;мой&quot; язык программирования...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311160&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=21" class="addthx" data-post="311160"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2012 15:04 &middot; Поправил: SeregaZ <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br>возможно ли заменить в коде Enum := aAccessible as IEnumVARIANT; этот мало понятный &quot;as&quot; на что-то более развернутое, что дельфи делает &quot;за кадром&quot;? малость застряли на этом моменте...<br><br>или с++ вариант:<br>(Delphi) <br>(Sender as TButton) := &#039;Button0&#039;; <br><br>(C++ Builder) <br>((TButton*)(Sender))-&gt;Caption = &quot;Button0&quot;;<br><br>в развернутом бы виде... что и куда записывается.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311577&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=22" class="addthx" data-post="311577"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2012 17:06 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>SeregaZ</b><br>По ключевому слову <b>AS</b> читай <noindex><a href="http://www.delphisources.ru/pages/faq/faq_delphi_basics/As.php.html" rel="nofollow" target="_blank">тут</a></noindex> там даже примеры есть.<img src="img/smilies/s1.gif" alt=""><br>С++ вариант:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">HRESULT&nbsp;WalkTreeWithAccessibleChildren<span class="hl_char">(</span>IAccessible<span class="hl_char">*</span>&nbsp;pAcc<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;depth<span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;HRESULT&nbsp;hr<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;childCount<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;long&nbsp;returnCount<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span>pAcc<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;E_INVALIDARG<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;hr&nbsp;<span class="hl_char">=</span>&nbsp;pAcc<span class="hl_char">-</span><span class="hl_char">&gt;</span>get_accChildCount<span class="hl_char">(</span><span class="hl_char">&amp;</span>childCount<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>FAILED<span class="hl_char">(</span>hr<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;hr<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>childCount&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;S_FALSE<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;VARIANT<span class="hl_char">*</span>&nbsp;pArray&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>new</b></span>&nbsp;VARIANT<span class="hl_char">[</span>childCount<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;hr&nbsp;<span class="hl_char">=</span>&nbsp;AccessibleChildren<span class="hl_char">(</span>pAcc<span class="hl_char">,</span>&nbsp;0L<span class="hl_char">,</span>&nbsp;childCount<span class="hl_char">,</span>&nbsp;pArray<span class="hl_char">,</span>&nbsp;<span class="hl_char">&amp;</span>returnCount<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>FAILED<span class="hl_char">(</span>hr<span class="hl_char">)</span><span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;hr<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;Iterate&nbsp;through&nbsp;children<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;x&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; x &lt; returnCount; x++)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VARIANT&nbsp;vtChild&nbsp;<span class="hl_char">=</span>&nbsp;pArray<span class="hl_char">[</span>x<span class="hl_char">]</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>If</b></span>&nbsp;it's an accessible object, get the IAccessible, and recurse.</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>vtChild<span class="hl_char">.</span>vt&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;VT_DISPATCH<span class="hl_char">)</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IDispatch<span class="hl_char">*</span>&nbsp;pDisp&nbsp;<span class="hl_char">=</span>&nbsp;vtChild<span class="hl_char">.</span>pdispVal<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IAccessible<span class="hl_char">*</span>&nbsp;pChild&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hr&nbsp;<span class="hl_char">=</span>&nbsp;pDisp<span class="hl_char">-</span><span class="hl_char">&gt;</span>QueryInterface<span class="hl_char">(</span>IID_IAccessible<span class="hl_char">,</span>&nbsp;<span class="hl_char">(</span><span class="hl_function">void</span><span class="hl_char">*</span><span class="hl_char">*</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">&amp;</span>pChild<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>hr&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;S_OK<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;y&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; y &lt;depth; y++)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;  &quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PrintName<span class="hl_char">(</span>pChild<span class="hl_char">,</span>&nbsp;CHILDID_SELF<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;(Object) &quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PrintRole<span class="hl_char">(</span>pChild<span class="hl_char">,</span>&nbsp;CHILDID_SELF<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WalkTreeWithAccessibleChildren<span class="hl_char">(</span>pChild<span class="hl_char">,</span>&nbsp;depth&nbsp;<span class="hl_char">+</span>&nbsp;<span class="hl_number">1</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pChild<span class="hl_char">-</span><span class="hl_char">&gt;</span>Release<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pDisp<span class="hl_char">-</span><span class="hl_char">&gt;</span>Release<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>Else</b></span>&nbsp;it's a child element so we have to call accNavigate on the parent,</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;we&nbsp;<span class="hl_quote">don't recurse since child elements can'</span>t&nbsp;have&nbsp;children<span class="hl_char">.</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">else</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;y&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">; y &lt;depth; y++)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;  &quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PrintName<span class="hl_char">(</span>pAcc<span class="hl_char">,</span>&nbsp;vtChild<span class="hl_char">.</span>lVal<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf<span class="hl_char">(</span><span class="hl_quote">&quot;(Child element) &quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PrintRole<span class="hl_char">(</span>pAcc<span class="hl_char">,</span>&nbsp;vtChild<span class="hl_char">.</span>lVal<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;delete<span class="hl_char">[</span><span class="hl_char">]</span>&nbsp;pArray<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;S_OK<span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=311578&amp;user=6&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=23" class="addthx" data-post="311578"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2012 09:36 &middot; Поправил: SeregaZ <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
все... главный мозг сдался. если уж он не смог, то я с товарищем и подавно <img src="img/smilies/s1.gif" alt=""><br><br>в ХР вываливается на этом моменте <br>if Enum.Next(1, Child, dwNum) = S_OK then<br>(этот as, который чуть выше видимо все-таки не верно определен. в нашем варианте *enum = *aAccessible )<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ElseIf</b></span>&nbsp;<span class="hl_char">*</span>aAccessible<span class="hl_char">\</span>QueryInterface<span class="hl_char">(</span>@IID_IEnumVARIANT<span class="hl_char">,</span>&nbsp;@<span class="hl_char">*</span>enum<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;#S_OK&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">*</span>enum&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">*</span>aAccessible&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;To&nbsp;count&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>If</b></span>&nbsp;<span class="hl_char">*</span>enum<span class="hl_char">\</span>Next<span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;@Child<span class="hl_char">,</span>&nbsp;@dwnum<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;#S_OK</li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessChild</span><span class="hl_char">(</span><span class="hl_char">*</span>aAccessible<span class="hl_char">,</span>&nbsp;aOffset<span class="hl_char">$</span><span class="hl_char">,</span>&nbsp;@Child<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ElseIf</b></span>&nbsp;<span class="hl_char">*</span>aAccessible<span class="hl_char">\</span>accNavigate<span class="hl_char">(</span>#NAVDIR_FIRSTCHILD<span class="hl_char">,</span>&nbsp;vt<span class="hl_char">,</span>&nbsp;@CurrentChild<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;#S_OK&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Repeat</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessChild</span><span class="hl_char">(</span><span class="hl_char">*</span>aAccessible<span class="hl_char">,</span>&nbsp;aOffset<span class="hl_char">$</span><span class="hl_char">,</span>&nbsp;@CurrentChild<span class="hl_char">)</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Until&nbsp;</span><span class="hl_char">*</span>aAccessible<span class="hl_char">\</span>accNavigate<span class="hl_char">(</span>#NAVDIR_NEXT<span class="hl_char">,</span>&nbsp;@CurrentChild<span class="hl_char">,</span>&nbsp;@CurrentChild<span class="hl_char">)</span>&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span>&nbsp;#S_OK</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>EndIf</b></span>&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">EndIf</span></li>        </ol>
    </div>
</div></div>
<br>комментарий другого программиста, на этот раз русскоязычного по этому *enum = *aAccessible:<br><i class=x>Собственно as преобразовывает один класс в другой в Делфях, правда свойства объектов при таком преобразовании не добавляются. Но Пурик не даст на лету преобразовать *aAccessible.IAccessible в *aAccessible.IEnumVARIANT, так что вы сделали по идее правильно, типа явного преобразования.<br></i><br><br><br>а в семерке работает, но не так как тот пример WSpy, некоторые значения не читает:<br><img src="http://i41.fastpic.ru/big/2012/0914/6e/2f14d3783306d82034000796ba1d6f6e.jpg" border="0" align="" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311597&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=24" class="addthx" data-post="311597"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2012 19:30 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
так. причина не вываливания в семерке выяснилась. та часть кода, которая сбоит в хп, просто не используется в семерке. если же поменять порядок проверок местами, то тогда вываливается и в семерке тоже. имею ввиду сначала поставить  if aAccessible.QueryInterface(IEnumVARIANT, Enum) = S_OK then begin, а потом if AccessibleChildren(Pointer(aAccessible), 0, iChildCount, ChildArray[0], iObtained) = S_OK then begin<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;AccessibleChildren<span class="hl_char">(</span>Pointer<span class="hl_char">(</span>aAccessible<span class="hl_char">)</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;iChildCount<span class="hl_char">,</span>&nbsp;ChildArray<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;iObtained<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK&nbsp;then&nbsp;begin</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;to&nbsp;iObtained&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span>&nbsp;do</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessChild<span class="hl_char">(</span>ChildArray<span class="hl_char">[</span>i<span class="hl_char">]</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>end</b></span>&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;aAccessible<span class="hl_char">.</span>QueryInterface<span class="hl_char">(</span>IEnumVARIANT<span class="hl_char">,</span>&nbsp;Enum<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK&nbsp;then&nbsp;begin</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Enum&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;aAccessible&nbsp;as&nbsp;IEnumVARIANT<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span>&nbsp;to&nbsp;iChildCount&nbsp;<span class="hl_char">-</span>&nbsp;<span class="hl_number">1</span>&nbsp;do</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;Enum<span class="hl_char">.</span>Next<span class="hl_char">(</span><span class="hl_number">1</span><span class="hl_char">,</span>&nbsp;Child<span class="hl_char">,</span>&nbsp;dwNum<span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span>&nbsp;S_OK&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessChild<span class="hl_char">(</span>Child<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=311607&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=25" class="addthx" data-post="311607"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2012 18:03 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
И свершилось чудо! Друг спас друга!<br><br><b>F_a_u_s_t</b><br>оказывается твой код не совсем верно работает. первый пункт не читает. меню Файл на ХП. сразу начинает - с пункта Правка, и так далее.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311635&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=26" class="addthx" data-post="311635"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2012 21:16 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>SeregaZ</b><br>То не мой, я на плюсах пишу, скопипастил пример того, чего вы всем 8 классом осилить не могли.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311645&amp;user=6&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=27" class="addthx" data-post="311645"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]SeregaZ[/b]','')">SeregaZ</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 29.3 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.39'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=19941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 сентября 2012 21:44 <br><script type="text/javascript">QU('SeregaZ','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SeregaZ" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<b>F_a_u_s_t</b><br>да какой там восьмой... меньше наверное! хотя помница я даже на УПК на информатику пошел и изучали мы там книжку &quot;IBM PC Для Пользователя, 7 издание, сокращенное, Фигурнов&quot;. чтоб туда пробится пришлось аж на 6 вопросов правильно ответить из 30. вопросы там были что-то про периодичность. а так бы от образования я б не отказался... <br><br>так, а про выбор то какого-то пункта я забыл <img src="img/smilies/s1.gif" alt=""> если не разберусь сам, а еще лучше не не подскажет тот не русский товарищ, то еще спрошу про accSelect.<br><br>и кстати про as мы тоже так и не решили. выбросили эту часть кода... хотя видимо есть какие-то элементы, которые потом не прочитаются. но пока эти элементы в Моем Компьютере ХР и семерке не встретились.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=311650&amp;user=19941&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=28" class="addthx" data-post="311650"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]le-greem[/b]','')">le-greem</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.73'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=33086">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 октября 2012 13:27 <br><script type="text/javascript">QU('le-greem','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=le-greem" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
На с++ есть неплохая библиотека демонстрирующая пример работы с этим интерфейсом. <br><br>http://www.codeproject.com/Articles/33272/XMSAALib-a-non-MFC-class-to-retrieve-accessibility<br><br>Только вот из под консольного приложения заставить ее работать у меня лично не вышло. Никто не сталкивался с подобным?<br><br><img src="img/attach.gif" alt=""> <a href="./files/e1f1_16.10.2012_EXELAB.rU.tgz">e1f1_16.10.2012_EXELAB.rU.tgz</a> - XMSAALib_demo.zip
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313130&amp;user=33086&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=29" class="addthx" data-post="313130"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]F_a_u_s_t[/b]','')">F_a_u_s_t</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 0.0 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 16.12'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 октября 2012 17:55 <br><script type="text/javascript">QU('F_a_u_s_t','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=F_a_u_s_t" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=20266&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<b>le-greem</b><br>Покажите код консольки, а еще лучше проект, видимо ошибка у вас, должно работать и в консоли, смотрите пример в MSDN.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=313144&amp;user=6&amp;forum_n=6&amp;topic=20266&amp;page=0&amp;anchor=30" class="addthx" data-post="313144"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=20266&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=20266&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> подскажите порядок команд по разбору содержимого окна класса DirectUIHWND</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#31" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="20266">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=20266" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
