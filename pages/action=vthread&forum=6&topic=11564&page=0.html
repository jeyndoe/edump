<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Информация о dll загруженный в процесс - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="В общем получаю такую инфу через RtlQueryProcessDebugInformation... Всё бы хорошо, но как однозначно определить, что либа загружена не через LoadLibrary программой, потому что флаг в структуре может &quot;врать&quot;, тоесть либа">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Информация о dll загруженный в процесс</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 18:16 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
В общем получаю такую инфу через RtlQueryProcessDebugInformation...<br>Всё бы хорошо, но как однозначно определить, что либа загружена не через LoadLibrary программой, потому что флаг в структуре может &quot;врать&quot;, тоесть либа например ntdll.dll загружена всем процесса и ясно, что не через LoadLibrary... А флаг говорит об обратном... Но у неё все свойства dll подгруженой автоматически, тоесть её нельязя никак выгрузить, у неё LoadCount равен 65535...<br>Вывод напрашиваеться сам... проверять сколько загрузок имеет либа, если 65535, значит она не подгружена через LoadLibrary... Но вот опять!<img src="img/smilies/s14.gif" alt=""> Если мы специально возьмём либу (любую) подгрузим её функцией LoadLibrary 65535 раз, то она ничем и не будет по флагам и количеству загрузок отличаться например от той же ntdll.dll...<br><code><br>procedure Log(LogString:String);<br>var<br>  f:TextFile;<br>begin<br>  AssignFile(f,&#039;log.txt&#039;);<br>  if not FileExists(&#039;log.txt&#039;) then<br>    rewrite(f)<br>  else<br>    append(f);<br>  writeln(f,LogString);<br>  CloseFile(f);<br>end;<br>...<br>type<br>mods=array of DEBUG_MODULE_INFORMATION;<br>var<br>DebugInfo:PDEBUG_BUFFER;<br>...<br>DebugInfo:=RtlCreateQueryDebugBuffer(0,true);<br>if DebugInfo=nil then<br>  exit;<br>RtlQueryProcessDebugInformation(PID,PDI_MODULES,DebugInfo);<br>if DebugInfo.ModuleInformation=nil then<br>  exit;<br>count:=Cardinal(DebugInfo.ModuleInformation^);<br>Cardinal(DebugInfo.ModuleInformation):=Cardinal(DebugInfo.ModuleInform ation)+sizeof(Cardinal);<br>for k := 0 to count-1 do<br>begin<br>//  log(&#039;Reserved[0] &#039;+inttohex(mods(DebugInfo.ModuleInformation)[k].Reserved[0],8));<br>//  log(&#039;Reserved[1] &#039;+inttohex(mods(DebugInfo.ModuleInformation)[k].Reserved[1],8));<br>//  log(&#039;Base &#039;+inttohex(mods(DebugInfo.ModuleInformation)[k].Base,8));<br>//  log(&#039;Size &#039;+inttohex(mods(DebugInfo.ModuleInformation)[k].Size,8));<br>  log(&#039;Index &#039;+inttohex(mods(DebugInfo.ModuleInformation)[k].Index,4));<br>  log(&#039;Unknown &#039;+inttohex(mods(DebugInfo.ModuleInformation)[k].Unknown,4));<br>  log(&#039;LoadCount &#039;+inttohex(mods(DebugInfo.ModuleInformation)[k].LoadCount,4));<br>  log(&#039;ModuleNameOffset &#039;+inttohex(mods(DebugInfo.ModuleInformation)[k].ModuleNameOffset,4)); <br>  log(&#039;ImageName &#039;+string(mods(DebugInfo.ModuleInformation)[k].ImageName));<br>  log(&#039; &#039;);<br>  log(&#039;Flags:&#039;);<br>  log(&#039;LDRP_STATIC_LINK &#039;+booltostr(boolean(LDRP_STATIC_LINK and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_IMAGE_DLL &#039;+booltostr(boolean(LDRP_IMAGE_DLL and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_LOAD_IN_PROGRESS &#039;+booltostr(boolean(LDRP_LOAD_IN_PROGRESS and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_UNLOAD_IN_PROGRESS &#039;+booltostr(boolean(LDRP_UNLOAD_IN_PROGRESS and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_ENTRY_PROCESSED &#039;+booltostr(boolean(LDRP_ENTRY_PROCESSED and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_ENTRY_INSERTED &#039;+booltostr(boolean(LDRP_ENTRY_INSERTED and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_CURRENT_LOAD &#039;+booltostr(boolean(LDRP_CURRENT_LOAD and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_FAILED_BUILTIN_LOAD &#039;+booltostr(boolean(LDRP_FAILED_BUILTIN_LOAD and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_DONT_CALL_FOR_THREADS &#039;+booltostr(boolean(LDRP_DONT_CALL_FOR_THREADS and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_PROCESS_ATTACH_CALLED &#039;+booltostr(boolean(LDRP_PROCESS_ATTACH_CALLED and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_DEBUG_SYMBOLS_LOADED &#039;+booltostr(boolean(LDRP_DEBUG_SYMBOLS_LOADED and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_IMAGE_NOT_AT_BASE &#039;+booltostr(boolean(LDRP_IMAGE_NOT_AT_BASE and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039;LDRP_WX86_IGNORE_MACHINETYPE &#039;+booltostr(boolean(LDRP_WX86_IGNORE_MACHINETYPE and mods(DebugInfo.ModuleInformation)[k].Flags),true));<br>  log(&#039; &#039;);<br>  log(&#039; &#039;);<br>end;  <br></code><br>LDRP_STATIC_LINK как раз и отвечает за такую инфу... (ИМХО)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184161&amp;user=12469&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=1" class="addthx" data-post="184161"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Kiev78[/b]','')">Kiev78</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 67.4 (постоянный), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.92'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 19:07 &middot; Поправил: Kiev78 <br><script type="text/javascript">QU('Kiev78','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kiev78" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
---
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184165&amp;user=12727&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=2" class="addthx" data-post="184165"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 19:57 &middot; Поправил: multiarc <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
А как же ntdll.dll? ведь её нету в таблице импорта...<br>или например msvcr.dll... и вообще таких либ много...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184168&amp;user=12469&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=3" class="addthx" data-post="184168"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Kiev78[/b]','')">Kiev78</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 67.4 (постоянный), 6thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.92'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 20:51 &middot; Поправил: Kiev78 <br><script type="text/javascript">QU('Kiev78','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kiev78" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
---
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184174&amp;user=12727&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=4" class="addthx" data-post="184174"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]drin[/b]','')">drin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 63.8 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6342">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 21:22 &middot; Поправил: drin <br><script type="text/javascript">QU('drin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=drin" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<I><br>ntdll.dll - в твоём импорте её может и нет, но если ты импортируешь kernel32.dll, то он в свою очередь импортирует именно ntdll.dll (можешь глянуть его директорию импорта).</I><br><br>импорт вообще может быть пуст, но базовые модули винды загрузчик все равно приаттачит...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184182&amp;user=6342&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=5" class="addthx" data-post="184182"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]drin[/b]','')">drin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 63.8 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6342">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 21:26 &middot; Поправил: drin <br><script type="text/javascript">QU('drin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=drin" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>multiarc</b><br>где-то в ОЕП поставь хук на LoadLibraryW и сохраняй список загружаемых через нее модулей, а потом по завершению загрузки сравнивай ...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184187&amp;user=6342&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=6" class="addthx" data-post="184187"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 21:29 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Kiev78 пишет:<br>msvcr.dll - ты хочешь сказать, что она отсутствует в импорте, не загружается при помощи ЛоадЛайбрари и при этом стабильно присутствует в адресном пространстве процесса (типа появляется из ниоткуда)??? </I><br>ну например apphelp.dll так и существует ))<br>msvcr.dll не во все процессы грузиться...<br>а на счёт kernel32.dll то флаг LDRP_STATIC_LINK вообще не установлен, как буд-то я её руками грузил...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184188&amp;user=12469&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=7" class="addthx" data-post="184188"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 21:31 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>drin пишет:<br>где-то в ОЕП поставь хук на LoadLibraryW и сохраняй список загружаемых через нее модулей, а потом по завершению загрузки сравнивай ... </I><br>А если процесс был запущен задолго до того как мне нужна такая инфа???
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184190&amp;user=12469&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=8" class="addthx" data-post="184190"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 21:35 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
на OEP загрузчик уже загрузит то что ему надо... Но вот apphelp.dll там ещё нету...<br>хотя вот она и kernel32.dll и ntdll.dll все статически подгружаються, тоесть выгружать их нельзя из под юзер мода...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184191&amp;user=12469&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=9" class="addthx" data-post="184191"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 марта 2008 23:28 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Есть идея пытаться выгрузить такие либы у которых 65535 загрузок, если значение уменьшиться, значит она динамическая...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184206&amp;user=12469&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=10" class="addthx" data-post="184206"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]S_T_A_S_[/b]','')">S_T_A_S_</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 163.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.87'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=251">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 25 марта 2008 10:24 <br><script type="text/javascript">QU('S_T_A_S_','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=S_T_A_S_" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
ntdll.dll - это отдельная тема, имидж мапится в АП процесса при его создании до всех остальных, в списки добавляется позже.<br><br>Тебе скорее всего нужно LdrpHashTable (LdrpCheckForLoadedDll).<br><br><I>Kiev78 пишет:<br>А если посмотреть в директорию импорта исполняемого файла?</I><br>То надо будет рекурсивно смотреть еще и импорты импортируемых модулей.<br><br><I>drin пишет:<br>импорт вообще может быть пуст, но базовые модули винды загрузчик все равно приаттачит.. </I><br>Размечтался.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184260&amp;user=251&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=11" class="addthx" data-post="184260"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]multiarc[/b]','')">multiarc</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/12469.jpg" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.98'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12469">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 марта 2008 21:17 <br><script type="text/javascript">QU('multiarc','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=multiarc" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11564.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
А всё таки что тогда на самом деле значят флаги LDRP_...?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=184715&amp;user=12469&amp;forum_n=6&amp;topic=11564.html&amp;page=0&amp;anchor=12" class="addthx" data-post="184715"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Информация о dll загруженный в процесс</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#13" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="11564">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=11564" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
