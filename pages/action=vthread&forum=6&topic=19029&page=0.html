<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>SenseLock -&gt;DeviceIoControl - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем добрый день. вобщем уже продолжительное время мучаю этот ключ. Докопался. Есть результат. Возникла потребность обращаться напрямую к ключу, мимо долбанной проги. Нашел кусок, вызовы DeviceIoControl 3 шт. Взял пример из">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40382'>jinoweb</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> SenseLock -&gt;DeviceIoControl</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 сентября 2011 17:59 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем добрый день. вобщем уже продолжительное время мучаю этот ключ. Докопался. Есть результат. Возникла потребность обращаться напрямую к ключу, мимо долбанной проги. Нашел кусок, вызовы DeviceIoControl 3 шт. Взял пример из SenseLock SDK под делфи. подправил на свой вкус аля....<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;dwRet&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;S4_ERROR_UNKNOWN<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;dwSize&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;pstS4Ctx&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;nil<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>enumerate&nbsp;devices</li><li class="hl_l1">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Enumerate device...'</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;S4Enum<span class="hl_char">(</span>nil<span class="hl_char">,</span>&nbsp;dwSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;pstS4Ctx&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;PSENSE4_CONTEXT<span class="hl_char">(</span>allocmem<span class="hl_char">(</span>dwSize<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;dwRet&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;S4Enum<span class="hl_char">(</span>pstS4Ctx<span class="hl_char">,</span>&nbsp;dwSize<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>S4_SUCCESS&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span>&nbsp;dwRet<span class="hl_char">)</span>&nbsp;then</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;Err<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>open&nbsp;device&nbsp;with&nbsp;exclusive&nbsp;mode</li><li class="hl_l0">&nbsp;&nbsp;OpenDir_Info<span class="hl_char">.</span>dwS4OpenInfoSize&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;<span class="hl_function">sizeof</span><span class="hl_char">(</span>S4OPENINFO<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;OpenDir_Info<span class="hl_char">.</span>dwShareMode&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;S4_EXCLUSIZE_MODE<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;dwRet&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;S4OpenEx<span class="hl_char">(</span>pstS4Ctx<span class="hl_char">,</span>&nbsp;@OpenDir_Info<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>S4_SUCCESS&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span>&nbsp;dwRet<span class="hl_char">)</span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;Err<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Open device...'</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;pp<span class="hl_char">:</span><span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ZeroMemory<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">$</span>FF<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;DeviceIoControl<span class="hl_char">(</span>&nbsp;pstS4Ctx<span class="hl_char">.</span>hLock<span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">220028</span><span class="hl_char">,</span>@data1<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">$</span>E<span class="hl_char">,</span>@OutResult<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">$</span>FF<span class="hl_char">,</span>dwReturned<span class="hl_char">,</span>pp<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'DeviceioSz.'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>dwReturned<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Deviceio...'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>pDword<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span>^<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;pp<span class="hl_char">:</span><span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;ZeroMemory<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">$</span>FF<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;DeviceIoControl<span class="hl_char">(</span>&nbsp;pstS4Ctx<span class="hl_char">.</span>hLock<span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">220028</span><span class="hl_char">,</span>@data2<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">$</span>F<span class="hl_char">,</span>@OutResult<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">$</span>FF<span class="hl_char">,</span>dwReturned<span class="hl_char">,</span>pp<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'DeviceioSz.'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>dwReturned<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Deviceio...'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>pDword<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span>^<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Deviceio...'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>pDword<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">)</span>^<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Deviceio...'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>pDword<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">)</span>^<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Deviceio...'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>pDword<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">12</span><span class="hl_char">]</span><span class="hl_char">)</span>^<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;pp<span class="hl_char">:</span><span class="hl_char">=</span><span class="hl_number">0</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;ZeroMemory<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">$</span>FF<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;DeviceIoControl<span class="hl_char">(</span>&nbsp;pstS4Ctx<span class="hl_char">.</span>hLock<span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">220028</span><span class="hl_char">,</span>@data3<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">$</span><span class="hl_number">4F</span><span class="hl_char">,</span>@OutResult<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">,</span><span class="hl_char">$</span>FF<span class="hl_char">,</span>dwReturned<span class="hl_char">,</span>pp<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'DeviceioSz.'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>dwReturned<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Deviceio...'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>pDword<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span><span class="hl_char">)</span>^<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Deviceio...'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>pDword<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">4</span><span class="hl_char">]</span><span class="hl_char">)</span>^<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Deviceio...'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>pDword<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">8</span><span class="hl_char">]</span><span class="hl_char">)</span>^<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Deviceio...'</span><span class="hl_char">+</span>IntToHex<span class="hl_char">(</span>pDword<span class="hl_char">(</span>@OutResult<span class="hl_char">[</span><span class="hl_number">12</span><span class="hl_char">]</span><span class="hl_char">)</span>^<span class="hl_char">,</span><span class="hl_number">8</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;dwRet&nbsp;<span class="hl_char">:</span><span class="hl_char">=</span>&nbsp;S4Close<span class="hl_char">(</span>pstS4Ctx<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>S4_SUCCESS&nbsp;<span class="hl_char">&lt;</span><span class="hl_char">&gt;</span>&nbsp;dwRet<span class="hl_char">)</span>&nbsp;then</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;goto&nbsp;Err<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;WriteLn<span class="hl_char">(</span><span class="hl_quote">'Close device...'</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>Есть 2 ключа. один голый купленный. Второй этот... с привязанной к нему софтой. <br>Теперь собственно вопрос. пытался я рассматривать как через свой интерфес ключ работает. По факту каждая комманда(честный сдк к ключу) получаеца набор вызовов DeviceIoControl.<br>Ктонить проводил аналогии, копал в данном направлении. Т.Е. Есть конкретные 3 вызова DeviceIoControl с параметрами, КАК задетектить че это за команад сенсилока.. фух. сори если гдето невнятно...
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291361&amp;user=17319&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=1" class="addthx" data-post="291361"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.6 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 сентября 2011 18:43 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
В смысле как задетектить? Берешь либы СЛ и разбираешь АПИ. Каждое АПИ будет набором команд к ключу. В  итоге у тебя получиться что-то типа набора команд ISO7816.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291366&amp;user=11966&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=2" class="addthx" data-post="291366"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=6947" title="09-09-2011 16:15, ранг:46.8" target="_blank">huckfuck</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 сентября 2011 19:26 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>r_e</b> собственно в этом то и проблема. По хорошему надо полностью разложить либу сенсилока для того чтобы по ссапоставлять входные параметры сенсилок комманд и то что получаеца в DeviceIoControl с целью определения фунок. Вопрос гдето так и звучал. может ктото уже этим занимался.. наработки.. сигны под иду.. или со своими коментами...  или еще варианты<br>З.Ы. я честно говоря дампы обращения снял... ток как их в читабельный юзабельный вид привести незнаю. приветствуюца наработки, экзамплы работы с сенсилоком на делфи предпочтительно
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291370&amp;user=17319&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=3" class="addthx" data-post="291370"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.6 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 сентября 2011 20:05 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Зачем что-то сопоставлять? Я тебе уже направление на ИСО дал. Работай сразу на низком уровне.<br><br><b>приветствуюца наработки, экзамплы работы с сенсилоком на делфи предпочтительно</b><br>Может сразу завернуть?
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291373&amp;user=11966&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=4" class="addthx" data-post="291373"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Den2007[/b]','')">Den2007</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.81'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=13268">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 сентября 2011 23:27 <br><script type="text/javascript">QU('Den2007','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Den2007" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Толку то...<br>После потраченного времени вы в итоге упретесь в вызов S4Execute() или S4ExecuteEx().<br>На самом низком уровне это будет выглядеть как:<br>CLA	80<br>INS	32<br>P1	[File ID] – 2 bytes, ID исполняемого VM файла	<br>P2		<br>P3	Размер поля Data<br>DATA	 [Data] – Данные, передаваемые исполняемому модулю
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=291380&amp;user=13268&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=5" class="addthx" data-post="291380"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]zeppe1in[/b]','')">zeppe1in</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/18780.png" alt=""><br><span class=txtSm>Ранг: 127.3 (ветеран), 44thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.68'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=18780">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 01:33 &middot; Поправил: zeppe1in <br><script type="text/javascript">QU('zeppe1in','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=zeppe1in" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Den2007</b><br> <img src="img/smilies/s11.gif" alt="">
<br><br><font size="1"><i>-----<br>zzz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291388&amp;user=18780&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=6" class="addthx" data-post="291388"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 10:02 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Den2007</b> ай малаца.... именно S4Execute я вызвать и пытаюсь НО перед этим надо открыть ключь пройти идентификацию сделать текущим каталог ...<br><br>ISO/IEC 7816 - стандарт относится к смарт-картам (в первую очередь контактным).<br>честно говоря недогнал к чему это<br><br>З.Ы. Собрал полный протокол обмена с ключом с момента старта проги включительно с моментом обмена данными. Осталось востановить последовательность комманд инициализации ключа.
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291397&amp;user=17319&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=7" class="addthx" data-post="291397"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.6 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 11:30 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>VodoleY</b><br>К тому что SenseLock - это смарткарта. Но для удобства пользования к ней прицепили обвес из USB интерфейса. Но в вариантах поставки есть и в виде обычной смарт-карты.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291401&amp;user=11966&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=8" class="addthx" data-post="291401"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 12:14 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>r_e</b> в таком случае я б с удовольствием почитал варианты использования сенсилока на нэйтив левеле типа тот же мануал ток в другом виде<br>З.Ы. если конкретно каким хреном и че значат запросы типа<br><br>in:190f2a8: (e) 40 0 0 0 0 0 6 0 80 ca 7 0 1 0<br>Out:190f3f8: (3) 0 90 0<br>in:190f1a4: (f) 40 0 0 0 0 0 7 0 0 a4 2 0 2 a0 0<br>Out:190f2f4: (e) 6f a a5 8 9f c 5 a0 0 8 80 0 90 0
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291405&amp;user=17319&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=9" class="addthx" data-post="291405"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]r_e[/b]','')">r_e</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 590.6 (<b>!</b>), 408thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.36<span style='color:red'>&searr;</span>0.18</span><br>Статус: <a href="action=userinfo&amp;user=11966">Модератор</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 12:59 <br><script type="text/javascript">QU('r_e','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r_e" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
На нейтив левеле попробуйте помониторить usb point вместо перехвата DIOC. +Обратите внимание что при установке с драйверами устанавливается устройсто SmartCard reader. Возможно, унутрях идет конверсия протокола. А дальше стандарт в руки и медитировать.
<br><br><font size="1"><i>-----<br>старый пень</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291409&amp;user=11966&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=10" class="addthx" data-post="291409"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Den2007[/b]','')">Den2007</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.81'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=13268">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 13:45 <br><script type="text/javascript">QU('Den2007','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Den2007" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>VodoleY пишет:<br>in:190f2a8: (e) 40 0 0 0 0 0 6 0 80 ca 7 0 1 0 </I> - получить тип ключа<br><br><I>VodoleY пишет:<br>in:190f1a4: (f) 40 0 0 0 0 0 7 0 0 a4 2 0 2 a0 0 </I> - выбрать файл FID: A000
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=291415&amp;user=13268&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=11" class="addthx" data-post="291415"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 14:49 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Den2007</b> такое есть. екзапл в студию. соотношение комманд хай левела сенси лока с нейтив кодом<br>пока все сходица
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291420&amp;user=17319&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=12" class="addthx" data-post="291420"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Den2007[/b]','')">Den2007</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.81'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=13268">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 14:58 <br><script type="text/javascript">QU('Den2007','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Den2007" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>VodoleY пишет:<br>соотношение комманд хай левела сенси лока с нейтив кодомпока все сходица </I><br><br>Я не понимаю цели исследования. <br>Ведь всеравно всё упрется в код, исполняемый сенслоком внутри. <br>Через низкий уровень код не прочитать если вы не знаете PIN разработчика. 15 попыток подбора третьей части (DD) PIN разработчика заблокируют авторизацию по команде 00 20 00 (BB CC DD) навсегда.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=291421&amp;user=13268&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=13" class="addthx" data-post="291421"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 15:13 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Den2007</b> МНЕ НЕ НАДО ПИН разраба я не хочу стырить код. я хочу использовать функу юзер мод ключа. пасс стандарнт 12345678 мне надо огранизовать обмен прога ключ крипто систему я победил могу этому файлу кормить нужные данные.
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291424&amp;user=17319&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=14" class="addthx" data-post="291424"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Den2007[/b]','')">Den2007</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.81'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=13268">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 15:20 <br><script type="text/javascript">QU('Den2007','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Den2007" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>VodoleY пишет:<br>МНЕ НЕ НАДО ПИН разраба я не хочу стырить код </I><br><br>Теперь тем более не понимаю. В чем проблема использовать стандартное API<br>S4Enum()-&gt;S4OpenEx()-&gt;S4ChangeDir()-&gt;S4VerifyPIN()-&gt;S4Execute()<br>Зачем городить огород на низком уровне то ? <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=291425&amp;user=13268&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=15" class="addthx" data-post="291425"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 15:22 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
проблема в том что большинство этого кода под ВМпротом рассмотреть не могу. могу лишь перехватить обмен. НУЖНА схеме детекта комманд <I>Den2007 пишет:<br>S4Enum()-&gt;S4OpenEx()-&gt;S4ChangeDir()-&gt;S4VerifyPIN()-&gt;S4Execute() </I><br>т.е опыта работы с СЛ нету. надо по нейтив востановить хай левел работу
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291426&amp;user=17319&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=16" class="addthx" data-post="291426"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Den2007[/b]','')">Den2007</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.81'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=13268">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 19:05 <br><script type="text/javascript">QU('Den2007','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Den2007" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Так тогда надо ловить любым USB сниффером только команду S4Execute (80 32 [File ID] [Data Size] [Data])
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=291442&amp;user=13268&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=17" class="addthx" data-post="291442"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 сентября 2011 22:43 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>Den2007</b> а можно по подробней об описателях, которые в DeviceIoControl приходят ввиде входново буфера данных<br>З.Ы снифер уже не надо. надо по факту декодер нейтив данных.<br>S4Execute  сам по себе уже не интересен. ключ отзываеца почти нормально ему надо скормить правильную последовательность комманд. лог есть еЁ расшифровать не могу (описать в хай левельном варианте) т.е чет делаю а че не понимаю
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291453&amp;user=17319&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=18" class="addthx" data-post="291453"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Den2007[/b]','')">Den2007</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 9.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.81'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=13268">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 сентября 2011 12:08 <br><script type="text/javascript">QU('Den2007','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Den2007" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<b>VodoleY</b> логи покажи.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=291469&amp;user=13268&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=19" class="addthx" data-post="291469"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 сентября 2011 13:53 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
c подачи <b>r_e</b> и тыканием носом <b>Den2007</b> набрел на http://www.ttfn.net/techno/smartcards/iso7816_4.html<br>по крайней мере коды  CLA	80  INS	32 описаны, может комуто пригодица<br>PS прошли сутки. вроде делаю все правильно. вроде почти все оттдетекил. но беда. результат другой.вопрос по прежнему задан...<br>PSS прошел еще день. Сегодня получилось наладить работу с ключом. Высше перечисленным людям спасибо. Если ктото все же надыбает сканер на нэйтив левеле с коментариями для смарт девайсов плз кинуть в личку.
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=291556&amp;user=17319&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=20" class="addthx" data-post="291556"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 июля 2015 08:03 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19029.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Спасибо модераторам за вновь открытый топик. Немного не по теме топика, но тут уж очень качественно обсуждался протокол iso7816. <br>Возникла необходимость опять порыться, вспоминал, читая этот топ. За 4 года оказывается появилось пару инструментов. Тыкнули меня немного носом, возможно и вам будет интересно. Все начилось с блога<br>http://blog.tataranovich.com/2014/09/virtual-smartcard-emulator.html<br>Оказалось на хитхабе лежит 2 утилитки итересных<br>http://sourceforge.net/projects/vsmartcard/?source=typ_redirect<br>http://sourceforge.net/projects/jsmartcard/files/<br>1ая на питоне.. 2ая на джаве<br><br><b>Добавлено спустя 8 минут</b><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>esi</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; pcbRecvLength</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>edi</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; pbRecvBuffer</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_number">0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; pioRecvPci</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; cbSendLength</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">eax</span><span class="hl_char">+</span><span class="hl_number">4</span><span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; pbSendBuffer</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span>pioSendPci<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>ecx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; pioSendPci</span></li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr"><b>edx</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_comment">; hCard</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>addr1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">ds</span><span class="hl_char">:</span>SCardTransmit</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>addr2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>test</b></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Var&nbsp;iSrc</li><li class="hl_l1">var&nbsp;iSrcSz</li><li class="hl_l0">Var&nbsp;iDest</li><li class="hl_l1">Var&nbsp;iDestSz</li><li class="hl_l0">VAR&nbsp;aAddr</li><li class="hl_l1">VAR&nbsp;aSz</li><li class="hl_l0">VAR&nbsp;al_tmp</li><li class="hl_l1">VAR&nbsp;header</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>bc</li><li class="hl_l1">BPHWS&nbsp;addr1<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;x&quot;</span></li><li class="hl_l0">BPHWS&nbsp;addr2<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;x&quot;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>RUN</li><li class="hl_l1">start<span class="hl_char">:</span></li><li class="hl_l0"><span class="hl_function"><b>CMP</b></span>&nbsp;eip<span class="hl_char">,</span>&nbsp;addr1&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>JNE</b></span>&nbsp;nextLab1</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>MOV</b></span>&nbsp;iSrc<span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">8</span><span class="hl_char">]</span>&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>MOV</b></span>&nbsp;iSrcSz<span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span>C<span class="hl_char">]</span></li><li class="hl_l1"><span class="hl_function"><b>MOV</b></span>&nbsp;iDest<span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">14</span><span class="hl_char">]</span></li><li class="hl_l0"><span class="hl_function"><b>MOV</b></span>&nbsp;iDestSz<span class="hl_char">,</span><span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">+</span><span class="hl_number">18</span><span class="hl_char">]</span></li><li class="hl_l1">ITOA&nbsp;iSrc</li><li class="hl_l0"><span class="hl_function"><b>MOV</b></span>&nbsp;aAddr<span class="hl_char">,</span>&nbsp;<span class="hl_char">$</span>RESULT&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">ITOA&nbsp;iSrcSz</li><li class="hl_l0"><span class="hl_function"><b>MOV</b></span>&nbsp;aSz<span class="hl_char">,</span>&nbsp;<span class="hl_char">$</span>RESULT&nbsp;&nbsp;</li><li class="hl_l1">WRTA&nbsp;<span class="hl_quote">&quot;c:\DevIo.log&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;in:&quot;</span><span class="hl_char">+</span>aAddr<span class="hl_char">+</span><span class="hl_quote">&quot;:(&quot;</span><span class="hl_char">+</span>aSz<span class="hl_char">+</span><span class="hl_quote">&quot;)&quot;</span>&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>MOV</b></span>&nbsp;al_tmp<span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l1">&nbsp;forIN<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span><span class="hl_char">[</span>iSrc<span class="hl_char">]</span></li><li class="hl_l1">&nbsp;ITOA&nbsp;<span class="hl_registr">al</span></li><li class="hl_l0">&nbsp;WRTA&nbsp;<span class="hl_quote">&quot;c:\DevIo.log&quot;</span><span class="hl_char">,</span><span class="hl_char">$</span>RESULT<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot; &quot;</span>&nbsp;&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;&nbsp;iSrc<span class="hl_char">,</span><span class="hl_number">1</span></li><li class="hl_l0">&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;&nbsp;iSrcSz<span class="hl_char">,</span><span class="hl_number">1</span>&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;&nbsp;iSrcSz<span class="hl_char">,</span><span class="hl_number">0</span>&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_function"><b>Ja</b></span>&nbsp;forIN&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>al_tmp</li><li class="hl_l0">nextLab1<span class="hl_char">:</span>&nbsp;</li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>CMP</b></span>&nbsp;eip<span class="hl_char">,</span>&nbsp;addr2</li><li class="hl_l1"><span class="hl_function"><b>JNE</b></span>&nbsp;nextLab2</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>mov</b></span>&nbsp;iDestSz<span class="hl_char">,</span><span class="hl_char">[</span>iDestSz<span class="hl_char">]</span></li><li class="hl_l0">ITOA&nbsp;iDest</li><li class="hl_l1"><span class="hl_function"><b>MOV</b></span>&nbsp;aAddr<span class="hl_char">,</span>&nbsp;<span class="hl_char">$</span>RESULT&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">ITOA&nbsp;iDestSz</li><li class="hl_l1"><span class="hl_function"><b>MOV</b></span>&nbsp;aSz<span class="hl_char">,</span>&nbsp;<span class="hl_char">$</span>RESULT&nbsp;&nbsp;</li><li class="hl_l0">WRTA&nbsp;<span class="hl_quote">&quot;c:\DevIo.log&quot;</span><span class="hl_char">,</span><span class="hl_quote">&quot;Out:&quot;</span><span class="hl_char">+</span>aAddr<span class="hl_char">+</span><span class="hl_quote">&quot;:(&quot;</span><span class="hl_char">+</span>aSz<span class="hl_char">+</span><span class="hl_quote">&quot;)&quot;</span>&nbsp;</li><li class="hl_l1"><span class="hl_function"><b>MOV</b></span>&nbsp;al_tmp<span class="hl_char">,</span><span class="hl_registr">al</span></li><li class="hl_l0">&nbsp;forOUT<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;<span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span><span class="hl_char">[</span>iDest<span class="hl_char">]</span></li><li class="hl_l0">&nbsp;ITOA&nbsp;<span class="hl_registr">al</span></li><li class="hl_l1">&nbsp;WRTA&nbsp;<span class="hl_quote">&quot;c:\DevIo.log&quot;</span><span class="hl_char">,</span><span class="hl_char">$</span>RESULT<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot; &quot;</span>&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_function"><b>ADD</b></span>&nbsp;&nbsp;iDest<span class="hl_char">,</span><span class="hl_number">1</span></li><li class="hl_l1">&nbsp;<span class="hl_function"><b>SUB</b></span>&nbsp;&nbsp;iDestSz<span class="hl_char">,</span><span class="hl_number">1</span>&nbsp;</li><li class="hl_l0">&nbsp;<span class="hl_function"><b>CMP</b></span>&nbsp;&nbsp;iDestSz<span class="hl_char">,</span><span class="hl_number">0</span>&nbsp;</li><li class="hl_l1">&nbsp;<span class="hl_function"><b>JA</b></span>&nbsp;&nbsp;forOUT&nbsp;&nbsp;</li><li class="hl_l0"><span class="hl_function"><b>MOV</b></span>&nbsp;<span class="hl_registr">al</span><span class="hl_char">,</span>al_tmp</li><li class="hl_l1">nextLab2<span class="hl_char">:</span></li><li class="hl_l0">run</li><li class="hl_l1"><span class="hl_function"><b>JMP</b></span>&nbsp;start</li>        </ol>
    </div>
</div></div>
<br><br><b>Добавлено спустя 10 минут</b><br>возможно будет кому то интересен скрипт. типа велосипед.. для сборки логов обмена с девайсом. он 1 в 1 подходит для DeviceIOContro ток адреса подправить. addr1 addr2 ставим по вкусу и в бой. Кстати.. 2 функи, запись в файл, тут слеплены не зря, в одбж скипте оказались ошибки, при сохранении области памяти в хекс строке, поэтому сделан залипон велосипед. Скрипт тормоз страшный, но с задачей справляется<br><br><b>Добавлено спустя 12 минут</b><br>http://www.hackersrussia.ru/Cards/ASyncro/ISO7816-3.php<br>для любителей более низкого уровня
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=357207&amp;user=17319&amp;forum_n=6&amp;topic=19029.html&amp;page=0&amp;anchor=21" class="addthx" data-post="357207"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> SenseLock -&gt;DeviceIoControl</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#22" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="19029">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19029" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
