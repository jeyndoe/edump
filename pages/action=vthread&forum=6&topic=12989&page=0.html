<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>NtSystemDebugControl - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Все доброго всремени суток. Вопрос прост и лаконичен - где найти описание вышеупомянутой функции? Гугл не предлагать - и без вас гуглил уже, но там куча ссылок, и везде неполное описание, а нужна вся доступная на сегодня инфа,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=33192'>morgot</a>, <a target='_blank' href='?action=userinfo&amp;user=8605'>Rio</a>, <a target='_blank' href='?action=userinfo&amp;user=27081'>CDK123</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=10534'>tihiy_grom</a>, <a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> NtSystemDebugControl</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2008 22:29 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Все доброго всремени суток. Вопрос прост и лаконичен - где найти описание вышеупомянутой функции? Гугл не предлагать - и без вас гуглил уже, но там куча ссылок, и везде неполное описание, а нужна вся доступная на сегодня инфа, тем не менее, буду рад любым ссылкам, может, хоть слеплю из того, что будет, то, что надо.
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206581&amp;user=6336&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=1" class="addthx" data-post="206581"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2008 23:01 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
как ни странно, но в гугле всё есть. что в твоём понимании - &quot;полное описание&quot;?
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206585&amp;user=72&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=2" class="addthx" data-post="206585"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]coderess[/b]','')">coderess</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/16383.jpg" alt=""><br><span class=txtSm>Ранг: 355.4 (мудрец), 55thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.21'>Активность: 0.32<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16383">Uploader</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2008 23:06 <br><script type="text/javascript">QU('coderess','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=coderess" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
У Неббета есть<br>NTSYSAPI<br>NTSTATUS<br>NTAPI<br>ZwSystemDebugControl(<br>IN DEBUG_CONTROL_CODE ControlCode,<br>IN PVOID InputBuffer OPTIONAL,<br>IN ULONG InputBufferLength,<br>OUT PVOID OutputBuffer OPTIONAL,<br>IN ULONG OutputBufferLength,<br>OUT PULONG ReturnLength OPTIONAL<br>);
<br><br><font size="1"><i>-----<br>Gutta cavat lapidem. Feci, quod potui. Faciant meliora potentes</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206586&amp;user=16383&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=3" class="addthx" data-post="206586"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2008 23:10 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Hellspawn пишет:</b><br><i class=x>как ни странно, но в гугле всё есть. что в твоём понимании - &quot;полное описание&quot;?</i><br>typedef enum _SYSDBG_COMMAND {<br>//Windows NT<br>    SysDbgGetTraceInformation = 1,<br>    SysDbgSetInternalBreakpoint = 2,<br>    SysDbgSetSpecialCall = 3,<br>    SysDbgClearSpecialCalls = 4,<br>    SysDbgQuerySpecialCalls = 5,<br>//NT 5.1<br>    SysDbgDbgBreakPointWithStatus = 6,<br>    SysDbgSysGetVersion = 7,<br>    SysDbgCopyMemoryChunks_0 = 8,<br>    SysDbgCopyMemoryChunks_1 = 9,<br>    SysDbgCopyMemoryChunks_2 = 10,<br>    SysDbgCopyMemoryChunks_3 = 11,<br>    SysDbgSysReadControlSpace = 12,<br>    SysDbgSysWriteControlSpace = 13,<br>    SysDbgSysReadIoSpace = 14,<br>    SysDbgSysWriteIoSpace = 15,<br>    SysDbgSysReadMsr = 16,<br>    SysDbgSysWriteMsr = 17,<br>    SysDbgSysReadBusData = 18,<br>    SysDbgSysWriteBusData = 19,<br>    SysDbgSysCheckLowMemory = 20,<br>//NT 5.2<br>    SysDbgEnableDebugger = 21,<br>    SysDbgDisableDebugger = 22,<br>    SysDbgGetAutoEnableOnEvent = 23,<br>    SysDbgSetAutoEnableOnEvent = 24,<br>    SysDbgGetPitchDebugger = 25,<br>    SysDbgSetDbgPrintBufferSize = 26,<br>    SysDbgGetIgnoreUmExceptions = 27,<br>    SysDbgSetIgnoreUmExceptions = 28<br>} SYSDBG_COMMAND, *PSYSDBG_COMMAND;<br>Вот эти все классы и что они из себя представляют - это полное описание
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206587&amp;user=6336&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=4" class="addthx" data-post="206587"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]theCollision[/b]','')">theCollision</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 271.5 (наставник), 12thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.24'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4439">Участник</a><br><font color=blue>Packer Reseacher</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2008 23:12 <br><script type="text/javascript">QU('theCollision','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=theCollision" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>скажи цель, критерий поиска лучше будет ;)
<br><br><font size="1"><i>-----<br>My love is very cool girl.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206588&amp;user=4439&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=5" class="addthx" data-post="206588"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2008 23:12 &middot; Поправил: Hellspawn <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
это не документировано, можно по названию догодаться или разбирайся сам <img src="img/smilies/s1.gif" alt=""><br><br><b>theCollision</b> +1
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206589&amp;user=72&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=6" class="addthx" data-post="206589"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2008 23:17 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>Hellspawn пишет:</b><br><i class=x>это не документировано</i><br>Ну это я понял<img src="img/smilies/s1.gif" alt=""><br><b>theCollision пишет:</b><br><i class=x>скажи цель, критерий поиска лучше будет ;)</i><br>Цель -  взять MSR-регистр MSR_DEBUGCTLA и взвести в нем бит BTF (single-step on branches)
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206590&amp;user=6336&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=7" class="addthx" data-post="206590"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]coderess[/b]','')">coderess</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/16383.jpg" alt=""><br><span class=txtSm>Ранг: 355.4 (мудрец), 55thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.21'>Активность: 0.32<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16383">Uploader</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2008 23:30 <br><script type="text/javascript">QU('coderess','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=coderess" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>www.openrce.org/blog/view/535/Branch_Tracing_with_Intel_MSR_Registers
<br><br><font size="1"><i>-----<br>Gutta cavat lapidem. Feci, quod potui. Faciant meliora potentes</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206591&amp;user=16383&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=8" class="addthx" data-post="206591"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]theCollision[/b]','')">theCollision</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 271.5 (наставник), 12thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.24'>Активность: 0.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4439">Участник</a><br><font color=blue>Packer Reseacher</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2008 23:32 <br><script type="text/javascript">QU('theCollision','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=theCollision" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>ARCHANGEL</b><br>Около этого копать ?<br>www.openrce.org/blog/view/535/Branch_Tracing_with_Intel_MSR_Registers
<br><br><font size="1"><i>-----<br>My love is very cool girl.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206592&amp;user=4439&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=9" class="addthx" data-post="206592"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2008 23:40 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>coderess</b><br>Проще говоря:<br>invoke NtSystemDebugControl,addr SysDbgWriteMsr, byref(msr), sizeof SYSDBG_MSR,0,0,0<br>а че за byref(msr)?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206593&amp;user=6336&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=10" class="addthx" data-post="206593"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]coderess[/b]','')">coderess</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/16383.jpg" alt=""><br><span class=txtSm>Ранг: 355.4 (мудрец), 55thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.21'>Активность: 0.32<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16383">Uploader</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 октября 2008 23:59 &middot; Поправил: coderess <br><script type="text/javascript">QU('coderess','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=coderess" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
byref - передает указатель на объект, типа <br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;msr</li><li class="hl_l1"><span class="hl_function"><b>invoke</b></span>&nbsp;NtSystemDebugControl<span class="hl_char">,</span><span class="hl_function"><b>addr</b></span>&nbsp;SysDbgWriteMsr<span class="hl_char">,</span>&nbsp;<span class="hl_registr">esi</span><span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>sizeof</b></span>&nbsp;SYSDBG_MSR<span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_number">0</span><span class="hl_char">,</span><span class="hl_number">0</span></li>        </ol>
    </div>
</div></div>
<br><br>Кстате, незабудь про получение привилегии на отладку SE_DEBUG_NAME для вызова NtSystemDebugControl. есть замечательная статья про привилегии может пригодится <br>www.rsdn.ru/article/baseserv/privileges.xml
<br><br><font size="1"><i>-----<br>Gutta cavat lapidem. Feci, quod potui. Faciant meliora potentes</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206594&amp;user=16383&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=11" class="addthx" data-post="206594"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2008 00:06 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
А msr - структура SYSDBG_MSR? Тогда ясно. Но надо опробовать<img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206595&amp;user=6336&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=12" class="addthx" data-post="206595"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2008 00:15 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>ZwSystemDebugControl</b><br>ZwSystemDebugControl performs a subset of the operations available to a kernel mode<br>debugger.<br>NTSYSAPI<br>NTSTATUS<br>NTAPI<br>ZwSystemDebugControl(<br>IN DEBUG_CONTROL_CODE ControlCode,<br>IN PVOID InputBuffer OPTIONAL,<br>IN ULONG InputBufferLength,<br>OUT PVOID OutputBuffer OPTIONAL,<br>IN ULONG OutputBufferLength,<br>OUT PULONG ReturnLength OPTIONAL<br>);<br><br><b>Parameters</b><br><br><b>ControlCode</b><br>The control code for operation to be performed. Permitted values are drawn from the<br>enumeration DEBUG_CONTROL_CODE.<br>typedef enum _DEBUG_CONTROL_CODE {<br>DebugGetTraceInformation = 1,<br>DebugSetInternalBreakpoint,<br>DebugSetSpecialCall,<br>DebugClearSpecialCalls,<br>DebugQuerySpecialCalls,<br>DebugDbgBreakPoint<br>} DEBUG_CONTROL_CODE;<br><br><b>InputBuffer</b><br>Points to a caller-allocated buffer or variable that contains the data required to perform<br>the operation. This parameter can be null if the ControlCode parameter specifies an<br>operation that does not require input data.<br><br><b>InputBufferLength</b><br>The size in bytes of InputBuffer.<br><br><b>OutputBuffer</b><br>Points to a caller-allocated buffer or variable that receives the operation’s output data.<br>This parameter can be null if the ControlCode parameter specifies an operation that<br>does not produce output data.<br><br><b>OutputBufferLength</b><br>The size in bytes of OutputBuffer.<br><br><b>ReturnLength</b><br>Optionally points to a variable that receives the number of bytes actually returned to<br>OutputBuffer. If this information is not needed, ReturnLength may be a null pointer.<br>1996 CH01  11/19/99  12:24 PM  System Information and Control: ZwSystemDebugControl<br><br><b>Return Value</b><br><br>Returns STATUS_SUCCESS or an error status, such as STATUS_PRIVILEGE_NOT_HELD,<br>STATUS_INVALID_INFO_CLASS or STATUS_INFO_LENGTH_MISMATCH.<br><br><b>Related Win32 Functions</b><br>None.<br><br><b>Remarks</b><br>SeDebugPrivilege is required to use ZwSystemDebugControl in Windows  2000.<br>ZwSystemDebugControl allows a process to perform a subset of the functions available to<br>a kernel mode debugger.<br>The system should be booted from a configuration that has the boot.ini “/DEBUG” (or<br>equivalent) option enabled; otherwise a kernel debugger variable needed for the cor-<br>rect operation of internal breakpoints is not initialized.<br>The data structures used by ZwSystemDebugControl are defined in windbgkd.h (includ-<br>ed with the Platform SDK).An up-to-date copy of this file is needed to compile the<br>code in Examples 1.3 and 1.4. One of the structures used by ZwSystemDebugControl<br>includes a union that has grown over time, and ZwSystemDebugControl checks that the<br>input/output buffers are large enough to hold the largest member of the union.
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206596&amp;user=3520&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=13" class="addthx" data-post="206596"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]coderess[/b]','')">coderess</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/16383.jpg" alt=""><br><span class=txtSm>Ранг: 355.4 (мудрец), 55thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.21'>Активность: 0.32<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=16383">Uploader</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2008 00:18 <br><script type="text/javascript">QU('coderess','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=coderess" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<i class=x>А msr - структура SYSDBG_MSR?</i><br><br>Да
<br><br><font size="1"><i>-----<br>Gutta cavat lapidem. Feci, quod potui. Faciant meliora potentes</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206598&amp;user=16383&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=14" class="addthx" data-post="206598"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2008 00:26 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Бонус =)<br><br><img src="img/attach.gif" alt=""> <a href="./files/e49f_08.10.2008_CRACKLAB.rU.tgz">e49f_08.10.2008_CRACKLAB.rU.tgz</a> - zwsystemdebugcontrol struct.inc
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206599&amp;user=3520&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=15" class="addthx" data-post="206599"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2008 00:29 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br><div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">KdPhysicalMemoryOperation&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;Operation<span class="hl_char">:</span>BOOLEAN<span class="hl_char">,</span>&nbsp;PhysicalAddress<span class="hl_char">:</span>PVOID<span class="hl_char">,</span>&nbsp;BufferAddress<span class="hl_char">:</span>PVOID<span class="hl_char">,</span>&nbsp;BytesToRead<span class="hl_char">:</span>ULONG</li><li class="hl_l1"><span class="hl_function"><b>Local</b></span>&nbsp;DbgBuffer<span class="hl_char">:</span>DBGKD_READ_WRITE_PHYSICAL</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>eax</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>PhysicalAddress</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>BufferAddress</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;DbgBuffer<span class="hl_char">.</span>AddressHi<span class="hl_char">,</span>eax</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;DbgBuffer<span class="hl_char">.</span>AddressLo<span class="hl_char">,</span>edx</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;DbgBuffer<span class="hl_char">.</span>Buffer<span class="hl_char">,</span>ecx</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;eax</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">edx</span><span class="hl_char">,</span>BytesToRead</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;eax</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;eax</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>lea</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>DbgBuffer</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;DbgBuffer<span class="hl_char">.</span>_Length<span class="hl_char">,</span>edx</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_function"><b>Sizeof</b></span>&nbsp;DBGKD_READ_WRITE_PHYSICAL</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;ecx</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span><span class="hl_function"><b>if</b></span>&nbsp;Operation&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;Eax</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;SysDbgReadPhysical</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>else</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;SysDbgWritePhysical</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">.</span>endif</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>Call</b></span>&nbsp;ZwSystemDebugControl</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>ret</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1">KdPhysicalMemoryOperation&nbsp;endp</li><li class="hl_l0"></li><li class="hl_l1">NTSTATUS</li><li class="hl_l0">KdPhysicalMemoryOperation<span class="hl_char">(</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;BOOLEAN&nbsp;Operation<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;ULONG&nbsp;PhysicalAddress<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;<span class="hl_function"><b>OUT</b></span>&nbsp;PVOID&nbsp;BufferAddress<span class="hl_char">,</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>IN</b></span>&nbsp;ULONG&nbsp;BytesToRead<span class="hl_char">)</span></li>        </ol>
    </div>
</div></div>
<br><br>И еще бонусный код + интересный код на Сииии<br><br><img src="img/attach.gif" alt=""> <a href="./files/2e90_08.10.2008_CRACKLAB.rU.tgz">2e90_08.10.2008_CRACKLAB.rU.tgz</a> - dbg.cpp
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206600&amp;user=3520&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=16" class="addthx" data-post="206600"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]BoOMBoX[/b]','')">BoOMBoX</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 116.1 (ветеран), 5thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4579">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 октября 2008 20:28 <br><script type="text/javascript">QU('BoOMBoX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=BoOMBoX" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>Цель - взять MSR-регистр MSR_DEBUGCTLA и взвести в нем бит BTF (single-step on branches)  </I><br><br>У Криса К. есть статья про это с примерами, правда через дровину.<br><br>Я пробовал этот трюк применять на практике в OllyDbg, но стабильного положительного эффекта добиться не удалось <img src="img/smilies/s4.gif" alt=""> . По непонятной причине иногда команды при взведенном BTF выполняются в обычном пошаговом режиме <img src="img/smilies/s14.gif" alt=""> Предполагаю, что виной тому система, т.е. какой-то (какие-то) процесс(ы) сбрасывает этот бит до выполнения следующей команды в Olly. Но это всего-лишь догадки.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=206670&amp;user=4579&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=17" class="addthx" data-post="206670"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 октября 2008 15:30 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12989.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>BoOMBoX/TSRh</b>,<b>mak</b>,<b>coderess</b><br>У меня всё вышло! Ура! В качестве примера антиотладки, если кому интересно, выкладываю вот это. Это, конечно, не всё, что можно сделать с помощью этой фичи, но хоть что-то.<img src="img/smilies/s8.gif" alt=""><br><br><img src="img/attach.gif" alt=""> <a href="./files/304e_10.10.2008_CRACKLAB.rU.tgz">304e_10.10.2008_CRACKLAB.rU.tgz</a> - Tracer.exe
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=206746&amp;user=6336&amp;forum_n=6&amp;topic=12989.html&amp;page=0&amp;anchor=18" class="addthx" data-post="206746"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> NtSystemDebugControl</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12989" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
