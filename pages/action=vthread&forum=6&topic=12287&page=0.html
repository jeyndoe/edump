<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Скрытие тяжёлых вычислений - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Есть алго, ищет строчку в куче файлов. К поиску в принципе претензий нет, всё работает, но нужно в фоне, а он кушает от процессора много %. Мне бы 1-2% и всё, да и оптимизировать это дело... Принцип: * Находим файл ---- *">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=50833'>vasilevradislav</a>, <a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a>, <a target='_blank' href='?action=userinfo&amp;user=8344'>Magister Yoda</a> (+7 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Скрытие тяжёлых вычислений</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июля 2008 08:49 &middot; Поправил: Freecod <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Есть алго, ищет строчку в куче файлов. К поиску в принципе претензий нет, всё работает, но нужно в фоне, а он кушает от процессора много %. Мне бы 1-2% и всё, да и оптимизировать это дело...<br>Принцип:<br>* Находим файл<br>----<br>* Открываем<br>* ReadFile на размер буфера<br>* Ищем в буфере<br>* Если в буфер попал весь файл - выход. Если нет - 2 шага назад<br><br>Собственно пихаю ожидание перед чтением очередной порции, WaitofSingleObject(10), но судя по всему он успевает разогнаться на % на стадии парсинга буфера.<br><br>Собственно не поделитесь примерами макс. оптимизированного открытия \ чтения файла и может есть какие-то другие &quot;фишки&quot; тихой, но быстрой работы?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=194975&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=1" class="addthx" data-post="194975"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b][wl][/b]','')">[wl]</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/2760.jpg" alt=""><br><span class=txtSm>Ранг: 196.6 (ветеран), 11thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.76'>Активность: 0.07<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2760">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июля 2008 09:43 <br><script type="text/javascript">QU('[wl]','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=[wl]" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
создавай отдельный поток, ставь ему приоритет чуть выше Idle, и он пускай делает всю работу
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=194980&amp;user=2760&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=2" class="addthx" data-post="194980"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]drin[/b]','')">drin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 63.8 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6342">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июля 2008 09:52 <br><script type="text/javascript">QU('drin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=drin" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>[wl] пишет:<br>создавай отдельный поток, ставь ему приоритет чуть выше Idle, и он пускай делает всю работу </I><br>тогда задача будет выполнятся в фоне используя все свободные ресурсы, а если я правильно понял автора то нужно что бы задача сама по себе ела мало ресурсов, не создавая нагрузки на процессор (видимо что бы не палится <img src="img/smilies/s1.gif" alt="">)<br><br><b>Freecod</b><br>если процессор разгоняется на парсинге то делай минимальный sleep внутри цикла парсинга
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=194982&amp;user=6342&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=3" class="addthx" data-post="194982"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]dermatolog[/b]','')">dermatolog</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/1404.png" alt=""><br><span class=txtSm>Ранг: 116.6 (ветеран), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.36'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1404">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июля 2008 10:01 <br><script type="text/javascript">QU('dermatolog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dermatolog" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>Freecod пишет:<br>Собственно не поделитесь примерами макс. оптимизированного открытия \ чтения файла </I><br>Смотри в сторону маппинга файла в память.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=194984&amp;user=1404&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=4" class="addthx" data-post="194984"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июля 2008 10:09 &middot; Поправил: Freecod <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Мэппинг больших файлов насилует память вплоть до размера файла. Если есть способ мэппить файл кусками или как-то иначе, чтоб не жрать память - слушаю.<br>Минимальный слип в поиске в файле размером 100 кб убивает на поиск 3 минуты... Думаю уменьшать буфер надо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=194985&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=5" class="addthx" data-post="194985"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]LazzY[/b]','')">LazzY</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 110.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.36'>Активность: 0.07<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3961">Участник</a><br><font color=blue>~ tPORt ~</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июля 2008 10:56 &middot; Поправил: LazzY <br><script type="text/javascript">QU('LazzY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=LazzY" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
ну дык <a href="http://msdn.microsoft.com/en-us/library/aa366761.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/aa366761.aspx</a> три последних параметра заюзайте и будем вам мапинг по частям.. правда можно мапить только выровненными кусками(<br><br>ps: у меня параноя, или <a href="http://www.exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11933&amp;page=0" target="_new">http://www.exelab.ru/f/action=vthread&amp;forum=6&amp;topic=11933&amp; page=0</a> дубль <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=194992&amp;user=3961&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=6" class="addthx" data-post="194992"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июля 2008 11:30 <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Что-то не пойму. <br>pMemory = MapViewOfFile(hMapFile,FILE_MAP_READ,0,0, SizeReadBuffer); // SizeReadBuffer = 1048576;<br>Сразу первый файл 10 кб - возвращает 0, код ошибки 0x05<br>И как будет двигаться окошко, если учесть что мне не нужны файлы больше гига?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=194997&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=7" class="addthx" data-post="194997"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]censor[/b]','')">censor</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 50.2 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.35'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3991">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июля 2008 17:01 <br><script type="text/javascript">QU('censor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=censor" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
http://www.google.com/codesearch?q=MapViewOfFile+lang%3Ac http://www.google.com/codesearch?q=MapViewOfFile+lang%3Ac <br>4я ссылка
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195031&amp;user=3991&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=8" class="addthx" data-post="195031"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 июля 2008 23:21 <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
LazzY: Это параноя =) Мне казалось я прошлую тему на си форуме создавал... Вообщем тогда я так ни к чему не пришёл, а доделать хочу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195083&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=9" class="addthx" data-post="195083"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]4kusNick[/b]','')">4kusNick</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1931.jpg" alt=""><br><span class=txtSm>Ранг: 748.2 <font color=magenta>(<b>! !</b>)</font>, 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.1'>Активность: 0.37<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1931">Участник</a><br><font color=blue>bytecode!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 июля 2008 00:16 <br><script type="text/javascript">QU('4kusNick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=4kusNick" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Короче что вы тут все трете-то, все же уже сказали: частичный мапинг + слипы в цикле + отд. поток с низким приоритетом - и не парься.
<br><br><font size="1"><i>-----<br>Флэш, ява, дотнет - на завтрак, обед и ужин. Unity3D на закуску.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=195092&amp;user=1931&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=10" class="addthx" data-post="195092"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 июля 2008 00:18 <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Что-то вообще никак, даж мсдн не помогает. Ладно, если файл меньше буфера - ставлю в качестве размера считываемых байт всю его длинну. Читает. Но если больше! Делаю - <br>pMemory = MapViewOfFile(hMapFile,FILE_MAP_READ,0, allpos, sizebuf); // allpos - текущая позиция по файлу, sizebuf - кол-во чит. байт.<br><br>Первый раз - allpos = 0 читает, всё ок. Второй - allpos сдвинулся - снова облом.<br>Если верить мсдн - allpos должен быть выровнен. Но я же читаю сплошной массив байт, что, если искомая строка оказалась разрезанна границей? Приходиться при близости конца при встрече символов, с которых может начинаться строка, оставлять а потом открывать с этого же места. Есть идеи?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195093&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=11" class="addthx" data-post="195093"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 июля 2008 01:02 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>drin пишет:<br>тогда задача будет выполнятся в фоне используя все свободные ресурсы </I><br>Отдельный поток сам по себе не может сожрать много ресурсов ну если это тольео не EBFE, а с низким приоритетом так вообще будет незаметно.<br><br><b>Freecod</b> есть такая прога Search&amp;Replace (залил сюда uploaded.to/?id=f10o2t), я был поражен когда задал ей искать строки в папке с игрой. Мало того что она единственная нашла эти строки (даже WinHex в указанном файле не нашел ни в одной кодировке), так еще файл размером в 14 мб она просканила за доли секунды. Посмотри как там реализовано.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=195096&amp;user=3232&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=12" class="addthx" data-post="195096"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 июля 2008 02:33 <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
PE_Kill: ок, спасибо.<br><br>Поделитесь ещё ответом на такой вопрос - какой размер ближе к половине мегабайта будет всегда выровнен?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195100&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=13" class="addthx" data-post="195100"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 июля 2008 07:18 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>PE_Kill пишет:<br>Отдельный поток сам по себе не может сожрать много ресурсов ну если это тольео не EBFE, а с низким приоритетом так вообще будет незаметно.  </I><br>Эта, если в любом потоке сделать &quot;for (;;) ;&quot; (или что-то что ест проц в мелком цикле), то CPU usage мгновенно вырастет до 100%. В случае с низким приоритетом просто OS отдаст процессорное время любому другому потоку и, следовательно, не будет видимых тормозов. (если scheduler работает правильно). <br><br>Так что, что бы не было пиков в графе CPU usage, не надо кушать сей ресурс. Sleep().
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195112&amp;user=1737&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=14" class="addthx" data-post="195112"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]drin[/b]','')">drin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 63.8 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6342">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 09 июля 2008 08:01 &middot; Поправил: drin <br><script type="text/javascript">QU('drin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=drin" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Freecod</b><br>кстати, можно попробовать упростить задачу контроля исползования цыклов CPU - всю работу делать в отдельном потоке, а в основном или другом его останавливать/запускать, вот тебе элементарный пример который ест ровно 2% CPU, правда боюсь с тяжолой работой будет не все так четко но в пределах удержится, в данном случае можно уменьшить кратность слипов (1/49) для большей &quot;гладкости&quot; но и накладных расходов будет больше и наоборот увеличив кратность, например (10/490), будут скачки маленькие но зато накладных расходов на остановку/запуск а так же сон внутри контрлирующего потока будет значительно меньше<br><br><code><br>function WorkThrd(Param: dword): dword; stdcall;<br>begin<br>  while true do begin<br>    Form1.Edit1.Text := IntToStr(Param);<br>    inc(Param);<br>  end;<br>end;<br><br>function CtrlThrd(hWorkThrd: dword): dword; stdcall;<br>begin<br>  while true do begin<br>    ResumeThread(hWorkThrd);<br>    sleep(2);<br>    SuspendThread(hWorkThrd);<br>    sleep(98);<br>  end;<br>end;<br><br>procedure TForm1.FormCreate(Sender: TObject);<br>var<br>  ThrdID, hWorkThrd: dword;<br>begin<br>  hWorkThrd := CreateThread(nil, 0, @WorkThrd, nil, CREATE_SUSPENDED, ThrdID);    <br>  CreateThread(nil, 0, @CtrlThrd, Ptr(hWorkThrd), THREAD_PRIORITY_ABOVE_NORMAL, ThrdID);<br>end;<br></code>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195114&amp;user=6342&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=15" class="addthx" data-post="195114"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июля 2008 22:25 <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Что бы далеко не отходить...<br><br>У кого есть в наличии установленный Windows SDK, залейте плз .h и .lib для следующих файлов:<br>icmpapi.h<br>ipexport.h<br>iphlpapi.h<br>и связанные с ними файлы из SDK, если требуются.<br>У меня VC6, так что борландовские не подходят, а SDK скачать не могу...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195350&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=16" class="addthx" data-post="195350"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 10 июля 2008 23:38 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Freecod</b>, в последних версиях SDK есть компилер (ессно из VS). Либы могут не подойти... Формат debug info изменился, хотя сами .obj, которые в .lib, должны быть обычными...<br><br>Вот headers. Кста, замучаешься исправлять все #includes... Какие либы нужны?<br><br><img src="img/attach.gif" alt=""> <a href="./files/0cdc_10.07.2008_CRACKLAB.rU.tgz">0cdc_10.07.2008_CRACKLAB.rU.tgz</a> - headers.tar.bz2
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195360&amp;user=1737&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=17" class="addthx" data-post="195360"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 июля 2008 00:32 <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
Блин, сколько связей всплывает...<br>Ещё нужны:<br><br>iprtrmib.h<br>iptypes.h<br><br>либы:<br><br>iprtrmib.lib<br>iptypes.lib<br>icmpapi.lib<br>ipexport.lib<br>iphlpapi.lib
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195363&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=18" class="addthx" data-post="195363"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 июля 2008 01:02 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<img src="img/smilies/s1.gif" alt=""> начинай резать headers а то понадобится весь SDK.<br><br><img src="img/attach.gif" alt=""> <a href="./files/e86d_10.07.2008_CRACKLAB.rU.tgz">e86d_10.07.2008_CRACKLAB.rU.tgz</a> - headers.tar.bz
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195367&amp;user=1737&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=19" class="addthx" data-post="195367"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 июля 2008 01:03 <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
вот lib. Остального нету в PaltformSDK...<br><br><img src="img/attach.gif" alt=""> <a href="./files/4b7b_10.07.2008_CRACKLAB.rU.tgz">4b7b_10.07.2008_CRACKLAB.rU.tgz</a> - IPHlpApi.Lib.bz2
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195368&amp;user=1737&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=20" class="addthx" data-post="195368"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 июля 2008 01:14 <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
Спасибо, очень выручил. 1гб этого SDK ради 5 файлов...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195369&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=21" class="addthx" data-post="195369"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 июля 2008 01:49 <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Недеюсь модеры не будут против, если я сюда все текущие проблемы солью =)<br><br>Хочу вызывать функцию из z.asm. У меня VC6, так что добавил файл, в настройках настроил компиляцию (С:\masm32\bin\ml.exe /c /coff /nologo &#036;(InputPath)  \  .\&#036;(InputName).obj) <br><br>В z.asm поправил - вместо start: <br>.code<br>PUBLIC	_cleanoff<br>_cleanoff PROC NEAR <br><br>Файл собирается в объектник без проблем.<br>Теперь хочу вызвать его из x.cpp<br>В шапке <br>extern &quot;C&quot; void cleanoff ();<br>вызов<br>cleanoff();<br><br>При линковке x.obj<br>x.obj : error LNK2001: unresolved external symbol _cleanoff<br>Release/x.exe : fatal error LNK1120: 1 unresolved externals<br><br>Что делаю не так?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195371&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=22" class="addthx" data-post="195371"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]droid[/b]','')">droid</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.43'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9699">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 июля 2008 03:32 <br><script type="text/javascript">QU('droid','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=droid" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Объясните мне, идиоту, почему нужно делать отдельным файлом, вместо того, чтобы в <b>__asm</b> запихать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195373&amp;user=9699&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=23" class="addthx" data-post="195373"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]s0larian[/b]','')">s0larian</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/1737.jpg" alt=""><br><span class=txtSm>Ранг: 387.4 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.19'>Активность: 0.17<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1737">Участник</a><br><font color=blue>системщик</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 11 июля 2008 07:40 &middot; Поправил: s0larian <br><script type="text/javascript">QU('s0larian','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=s0larian" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>Freecod</b>, в VS2003+ ещё надо сказать какой файл на выходе, а иначе dependencies (зависимости) говнятся. Посмотри в linker command line - есть твой файл? Ну а потом &quot;dumpbin z.obj&quot; - проверь есть ли ф-ция и её имя.<br><br>З.Ы. &quot;cleanup&quot; на аглицкой мове <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195376&amp;user=1737&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=24" class="addthx" data-post="195376"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июля 2008 00:53 &middot; Поправил: Freecod <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
droid: а разве можно запихать в __asm {} всю программу на asm целиком? Начиная с .386 и заканчивая END?<br>s0larian: у меня VS6<br>PS я отключаю отчистку - так что cleanoff =)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195473&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=25" class="addthx" data-post="195473"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Freecod[/b]','')">Freecod</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 108.7 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.04<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3539">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июля 2008 10:20 <br><script type="text/javascript">QU('Freecod','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Freecod" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
кстати, как избавиться от <br>LINK : warning LNK4089: all references to &quot;NETAPI32.dll&quot; discarded by /OPT:REF<br>то есть если я не делаю <br>#pragma comment(lib,&quot;netapi32.lib&quot;)<br>То прёт ошибки при линковке, а так даёт варнинг. Что ему не нравиться?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=195497&amp;user=3539&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=26" class="addthx" data-post="195497"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]4kusNick[/b]','')">4kusNick</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/1931.jpg" alt=""><br><span class=txtSm>Ранг: 748.2 <font color=magenta>(<b>! !</b>)</font>, 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.1'>Активность: 0.37<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1931">Участник</a><br><font color=blue>bytecode!</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 12 июля 2008 23:51 &middot; Поправил: 4kusNick <br><script type="text/javascript">QU('4kusNick','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=4kusNick" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=12287.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
ну дык опция линкера /OPT:REF  отрубает все ссылки на NETAPI32.dll, ибо<br>OPT - оптимизация<br>REF - по ссылкам<br>вкури<br>msdn.microsoft.com/en-us/library/bxwfs976(VS.80).aspx<br>на всяк случай...<br>там кста еще написано, что:<br><b>The /OPT:REF option disables incremental linking</b>
<br><br><font size="1"><i>-----<br>Флэш, ява, дотнет - на завтрак, обед и ужин. Unity3D на закуску.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=195551&amp;user=1931&amp;forum_n=6&amp;topic=12287.html&amp;page=0&amp;anchor=27" class="addthx" data-post="195551"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Скрытие тяжёлых вычислений</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#28" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="6">
<input type="hidden" name="topic" value="12287">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12287" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
