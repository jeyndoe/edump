<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Декомпилятор ВМ - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Вашему вниманию предлагаются наработки по декомпиляции ВМ. Проект на сегодняшний день для меня завершен, но жаль если результат &quot;ляжет на полку&quot;, может кому-нибудь и пригодится. Предлагаю сначала ознакомиться с обзором,">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+9 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Декомпилятор ВМ</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=7.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=7.html">8</a> . <b>9</b> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=22.html">23</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=23.html">24</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=9.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2010 12:33 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#1');return false;">#1</a> </span><div align=left><br>
Вашему вниманию предлагаются наработки по декомпиляции ВМ.<br>Проект на сегодняшний день для меня завершен, но жаль если результат &quot;ляжет на полку&quot;, может кому-нибудь и пригодится. Предлагаю сначала ознакомиться с обзором, и если будет интерес то могу выложить и сам плагин, или здесь или в личку заинтересованным лицам, каким образом, пока ещё не решил...<br>Но если кто-либо ожидает увидеть &quot;автоматическое чудо&quot;, то сразу скажу - его нет. Для того чтобы получить результат нужна ручная предварительная работа:<br>- с исследуемой программы должна быть снята упаковка<br>- точки входа в ВМ находятся вручную<br>- возможно неоднократное &quot;жамкание&quot; клавиш в OllyDbg, а возможно и модификация кода, чтобы попасть в нужное место, в зависимости от защищенной функции<br>- необходимо вручную прицепить к программе требуемый секцию<br>- запись результатов в файл это тоже ручная работа, но уже более приятная<br><br>Не всё гладко обстоит с определением реализаций ВМ, на сегодняшний день примерно каждая третья реализация автоматом не определяется, приходится под неё модернизировать плагин, т.к. не могу сразу предусмотреть все случаи &quot;издевательств&quot; ВМ с кодом примитивов. Лучше дела с восстановлением &quot;исходного&quot; кода защищенных функций - 70% нормально восстанавливается, хотя во многом это зависит от самой структуры функции. Таким образом, если будет заинтересованность и помощь в нахождении подобных ситуаций, то проект может быть доведен до релизной стадии.<br><br>ЗЫ: Речь идет об <i class=x>Ореановских</i> машинах. Нигде специально не упоминал.<br><br><img src="img/attach.gif" alt=""> <a href="./files/9c41_03.03.2010_CRACKLAB.rU.tgz">9c41_03.03.2010_CRACKLAB.rU.tgz</a> - VMSweeperLst.rar
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=253056&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=1" class="addthx" data-post="253056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 января 2011 12:11 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#2');return false;">#2</a> </span><div align=left><br>
Очередная версия <b>VMSweeper 1.4 beta 6</b>.<br>Добавлено:<br>1. <b>Полная логическая реструктуризация промкода на основе карты пикода.</b> Имеется возможность просмотра в графическом виде карты пикода. Для этого используется конвертер PMBtoGDL.exe (отдельная благодарность Ultras&#039;у за его создание), который преобразовывает файл pmb (picode map binary) в графический формат, который может быть просмотрен прогой aiSee3. Карты пикода строятся Свипером до и после реструктуризации для проверки её правильности.<br>2. <b>Обработчики FPU примитивов.</b> Обработчики добавлены не все, а только те, которые мне встретились в последних версиях вмпрота при анализе вм участвующих в распаковке/защите файла. Промкод с FPU инструкциями пока не строится, т.к. виртуализация FPU мной не была встречена.<br>3. Много мелких, но полезных изменений.<br><br>Тестируйте, по крайней мере, Свипер должен доходить до шага a12 final, но не всё в нем ещё красиво - работа продолжается...<br><br><img src="img/attach.gif" alt=""> <a href="./files/0ba5_23.01.2011_CRACKLAB.rU.tgz">0ba5_23.01.2011_CRACKLAB.rU.tgz</a> - VMSweeper14beta6.rar
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275509&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=2" class="addthx" data-post="275509"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17432" title="23-01-2011 09:23, ранг:209.9" target="_blank">ClockMan</a>, <a href="action=userinfo&user=21589" title="23-01-2011 09:41, ранг:78.6" target="_blank">_ruzmaz_</a>, <a href="action=userinfo&user=18316" title="23-01-2011 10:14, ранг:48.3" target="_blank">SReg</a>, <a href="action=userinfo&user=6947" title="23-01-2011 11:02, ранг:43.8" target="_blank">huckfuck</a>, <a href="action=userinfo&user=16120" title="23-01-2011 11:32, ранг:3.3" target="_blank">m0bscene</a>, <a href="action=userinfo&user=21485" title="23-01-2011 12:23, ранг:14.9" target="_blank">[Nomad]</a>, <a href="action=userinfo&user=8081" title="23-01-2011 13:13, ранг:21.6" target="_blank">Yotun</a>, <a href="action=userinfo&user=2777" title="24-01-2011 06:37, ранг:318.5" target="_blank">daFix</a>, <a href="action=userinfo&user=2585" title="24-01-2011 12:45, ранг:754.3" target="_blank">Gideon Vi</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 января 2011 06:36 <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#3');return false;">#3</a> </span><div align=left><br>
<b>Vamit</b>, планируется ли разбор ВМ в модулях нулевого кольца?
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275541&amp;user=6336&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=3" class="addthx" data-post="275541"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 января 2011 09:13 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#4');return false;">#4</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>планируется ли разбор ВМ в модулях нулевого кольца? </I><br>Всё что доступно из Ольки, то и можно разобрать.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275544&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=4" class="addthx" data-post="275544"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]ARCHANGEL[/b]','')">ARCHANGEL</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/6336.png" alt=""><br><span class=txtSm>Ранг: 681.5 <font color=magenta>(<b>! !</b>)</font>, 405thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.42<span style='color:red'>&searr;</span>0.21</span><br>Статус: <a href="action=userinfo&amp;user=6336">Участник</a><br><font color=blue>ALIEN Hack Team</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 января 2011 10:15 &middot; Поправил: ARCHANGEL <br><script type="text/javascript">QU('ARCHANGEL','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ARCHANGEL" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#5');return false;">#5</a> </span><div align=left><br>
Т.е. нет?<br><br><b>ADDED:</b><br><br>Жаль
<br><br><font size="1"><i>-----<br>Stuck to the plan, always think that we would stand up, never ran.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275545&amp;user=6336&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=5" class="addthx" data-post="275545"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]daFix[/b]','')">daFix</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/2777.gif" alt=""><br><span class=txtSm>Ранг: 529.0 (<b>!</b>), 110thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.29<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=2777">Участник</a><br><font color=blue>5KRT</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 января 2011 10:39 <br><script type="text/javascript">QU('daFix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=daFix" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#6');return false;">#6</a> </span><div align=left><br>
Вполне однозначно ответил - нет
<br><br><font size="1"><i>-----<br>Research For Food</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275546&amp;user=2777&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=6" class="addthx" data-post="275546"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 января 2011 14:08 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#7');return false;">#7</a> </span><div align=left><br>
<I>ARCHANGEL пишет:<br>планируется ли разбор ВМ в модулях нулевого кольца?  </I><br>Планируется. (с)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=275553&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=7" class="addthx" data-post="275553"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 января 2011 17:10 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#8');return false;">#8</a> </span><div align=left><br>
Вмпротект при виртуализации своих протекторов/распаковщиков часто использует следующую комбинацию:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">pushfd</span></li><li class="hl_l1"><span class="hl_function"><b>and</b></span>&nbsp;&nbsp;&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;0xFFFFF700</li><li class="hl_l0"><span class="hl_function">popfd</span></li>        </ol>
    </div>
</div></div>
<br>pushfd приведено схематично, для упрощения выражения, на самом деле это регистр вм содержащий флаги CPU (push rvm_xx).<br>В наборе инструкций Интела ничего подобного нет. Вопрос, что бы это могло значить, т.е. какой реальной инструкцией можно заменить результат этой виртуализации или вообще её скипать за ненадобностью?
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275638&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=8" class="addthx" data-post="275638"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2011 08:55 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#9');return false;">#9</a> </span><div align=left><br>
Раз ответа нет, приведу свой вариант объяснения, надеюсь он правильный.<br>Так как вмпрот использует два алгоритма виртуализации инструкций CPU - флаговый (флаги CPU полностью эмулируются) и безфлаговый (эмуляция флагов отсутствует), то приведенная выше конструкция устраняет побочные флаговые эффекты для безфлагового режима виртуализации. Значит её нужно скипать за ненадобностью в реальном коде.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275656&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=9" class="addthx" data-post="275656"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2011 12:02 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#10');return false;">#10</a> </span><div align=left><br>
<b>Vamit</b> единственно что меня смущает(если я не ошибся) это младший бит в 7ке. если не ошибаюсь это поднятие флага трассировки<br>ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%B3%D0%B8%D1%81%D1%82%D1%80_%D1%84%D0%BB%D0%B0%D0%B3%D0%BE%D0%B2
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275658&amp;user=17319&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=10" class="addthx" data-post="275658"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2011 12:27 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#11');return false;">#11</a> </span><div align=left><br>
<I>VodoleY пишет:<br>это поднятие флага трассировки </I><br>Там ничего не поднимается, операция же and, просто очищаются арифметические флаги, трассировка же остается неизменной.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275659&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=11" class="addthx" data-post="275659"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2011 12:47 &middot; Поправил: PE_Kill <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#12');return false;">#12</a> </span><div align=left><br>
Флаг не взводится. Он остается, если уже взведен. То же касается и DF флага.<br><br>АДД Упс, долго же я отвечал
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275660&amp;user=3232&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=12" class="addthx" data-post="275660"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2011 14:17 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#13');return false;">#13</a> </span><div align=left><br>
блин. действительно, опять тупанул...<b>Vamit</b> я на скок понял (попробовал последнюю версию) до поддержки инструкций мат. проца руки не дошли ж?
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275662&amp;user=17319&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=13" class="addthx" data-post="275662"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2011 16:20 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#14');return false;">#14</a> </span><div align=left><br>
<I>VodoleY пишет:<br>до поддержки инструкций мат. проца руки не дошли ж? </I><br>Дошли, но частично <img src="img/smilies/s1.gif" alt="">, вот список распознаваемых вм обработчиков: wait, fld, fild, fstp, fadd, fcomp, fstsw.<br>Другие пока не встретил, но созданный из них промкод декомпилироваться не будет, т.к. такие обработчики есть, а пока не используются. Дописываю по мере встречи с ними...
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275663&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=14" class="addthx" data-post="275663"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2011 17:54 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#15');return false;">#15</a> </span><div align=left><br>
<I>Vamit пишет:<br>вот список распознаваемых вм обработчиков: wait, fld, fild, fstp, fadd, fcomp, fstsw </I><br>То, что олькин дизасм криво дизасмит FPU учитывается?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=275667&amp;user=2449&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=15" class="addthx" data-post="275667"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 января 2011 18:05 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#16');return false;">#16</a> </span><div align=left><br>
<I>int пишет:<br>То, что олькин дизасм криво дизасмит FPU учитывается? </I><br>Сначала ответь, в чем наблюдается кривизна?
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275669&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=16" class="addthx" data-post="275669"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 января 2011 15:41 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#17');return false;">#17</a> </span><div align=left><br>
Очередная версия <b>VMSweeper 1.4 beta 7</b>.<br>Добавлено:<br>1. Опция AntiAntiDebug.<br>2. Опция Break on TLS.<br>3. Первоначальная обработка AntiDump.<br>4. Девиртуализация инструкции retn xx.<br>5. Девиртуализация инструкции sub без флагов.<br>6. Восстановление скрытого вызова процедуры (типа push xx; retn)<br>7. Коррекция смещений при адресации стека через esp.<br>8. Улучшено распознавание начала цикла вм в CodeVirtualizer.<br>Исправлено:<br>1. Реструктуризация промкода. Иногда прямая ветка после условного перехода шла в середину следующего блока.<br>2. Коррекция указателя esp при декомпиляции mov esp, [esp]<br>3. Восстановление косвенных вызовов процедур.<br>4. Распознавание соответствия регистров CPU и ВМ на инструкциях pop xx.<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/5652_28.01.2011_CRACKLAB.rU.tgz">5652_28.01.2011_CRACKLAB.rU.tgz</a> - VMSweeper14beta7.rar
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=275731&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=17" class="addthx" data-post="275731"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=6947" title="28-01-2011 12:54, ранг:43.8" target="_blank">huckfuck</a>, <a href="action=userinfo&user=18316" title="28-01-2011 13:07, ранг:48.5" target="_blank">SReg</a>, <a href="action=userinfo&user=17432" title="28-01-2011 13:45, ранг:210.4" target="_blank">ClockMan</a>, <a href="action=userinfo&user=2777" title="28-01-2011 13:57, ранг:319.0" target="_blank">daFix</a>, <a href="action=userinfo&user=16120" title="28-01-2011 14:32, ранг:3.3" target="_blank">m0bscene</a>, <a href="action=userinfo&user=11966" title="28-01-2011 15:13, ранг:80.6" target="_blank">r_e</a>, <a href="action=userinfo&user=21589" title="28-01-2011 15:59, ранг:78.6" target="_blank">_ruzmaz_</a>, <a href="action=userinfo&user=12557" title="28-01-2011 18:13, ранг:15.5" target="_blank">Errins</a>, <a href="action=userinfo&user=3230" title="29-01-2011 06:20, ранг:45.1" target="_blank">Bronco</a>, <a href="action=userinfo&user=8081" title="29-01-2011 20:29, ранг:21.6" target="_blank">Yotun</a>, <a href="action=userinfo&user=2585" title="29-01-2011 23:12, ранг:754.3" target="_blank">Gideon Vi</a>, <a href="action=userinfo&user=4618" title="30-01-2011 05:39, ранг:103.2" target="_blank">Nightshade</a>, <a href="action=userinfo&user=9959" title="02-02-2011 07:25, ранг:3.0" target="_blank">stas_02</a>, <a href="action=userinfo&user=18163" title="04-02-2011 17:20, ранг:4.6" target="_blank">stub</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]valot[/b]','')">valot</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.65'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2011 12:20 <br><script type="text/javascript">QU('valot','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=valot" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#18');return false;">#18</a> </span><div align=left><br>
<b>Vamit</b><br>Здравствуйте!<br><br>Пытаюсь разобраться с одной программой, накрытой, думаю последним, VMProtect. Запустил VMSweeper14beta7 на OEP - определила адреса использованных функций. Перестроить таблицу импорта не предлагала, но она уже почти вся и так была собрана. Нажал F1 на первой - сгенерировала 300 файлов. Теперь вот сижу в раздумьях, что же дальше со всем этим делать.<br><br>В соседней теме есть ссылка на инструмент <a href="http://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=17506" target="_new">http://exelab.ru/f/action=vthread&amp;forum=3&amp;topic=17506</a> . Он позволяет пошагово пройтись по командам VM и посмотреть за изменениями регистров и памяти (= дизассемблер на уровне виртуальной машины). Там же есть список всех инструкций VM, но с генерируемыми VMSweeper не смог сразу соотнести.<br><br>Подскажите, пожалуйста, как на основе полученных trc и log файлов проще всего сгенерировать asm (без VM) или максимально изолировать отдельные функции для сборки дампа?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=276006&amp;user=26941&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=18" class="addthx" data-post="276006"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2011 14:30 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#19');return false;">#19</a> </span><div align=left><br>
<I>valot пишет:<br>Нажал F1 на первой - сгенерировала 300 файлов. </I><br>Этого не может быть... Большое кол-во файлов генерится Свипером при <b>Analyze all VM references</b>, но они никакого отношения к декодировке защищенных функций не имеют, поэтому все эти файлы после анализа можно удалить, если он прошел успешно. Желательно сохранить окно найденных ссылок в файл, чтобы потом можно было бы ориентироваться в защищенных функциях, т.к. это окно &quot;одноразовое&quot;.<br>При декомпиляции защищенной функции по F1 создаются два основных файла c именем адреса декодируемой области, на котором нажали F1, и расширениями log и trc.<br><br><b>Трейс файл</b> содержит следующую последовательную информацию:<br>1. Асм код с трассировкой значений от точки старта до начала цикла вм, по этому куску распознается тип вм.<br>2. Сегменты кода и вм заданные юзером или автоматически определенные Свипером.<br>3. Асм код с трассировкой значений цикла вм до вызова обработчика.<br>4. Трассировка обработчиков вм от <b>Start Virtual Machine</b> до <b>Stop Virtual Machine</b>. В конце этой секции находится карта шагов по реструктуризации промкода - Pimap: step 1 и т.д.<br>5. Созданный промкод. Это последовательность обработчиков примитивов представленная чистым асм кодом. Далее этот код декомпилируется и если декомпиляция успешна (создается файл логов), то на точке старта создается инструкция jmp промкод. Можно осуществить переход в него и походить по нему Олькой.<br>6. Дальнейшие секции файла от <b>Adjust block 000</b> до <b>Optimized text a12 final</b> отображают шаги декомпиляции промкода и интереса для юзера не представляют.<br><br><b>Лог файл</b> содержит следующую последовательную информацию:<br>1. От <b>Section 000</b> до <b>Section 005</b> разбивка промкода на логические блоки и их группировка.<br>2. <b>Section a00</b> - представление значимых инструкций промкода<br>3. <b>Section a01 code</b> - аналогично, только адреса регистров вм заменены аббревиатурой rvm_xx, где хх - смещение регистра вм в блоке регистров.<br>4. Список зон изменения соответствий регистров вм и CPU.<br>5. Шаги декомпиляции зон промкода. От <b>Section a02 (zone х)</b> до <b>Section a07 remove rvm2 (zone x)</b>, где х - номер зоны промкода. Что производит Свипер с кодом на этих шагах можно понять из названия секции и сравнения кода в ней с кодом предыдущей секции.<br>6. <b>Section a08 svm</b> - секция объединяющая все декомпилированные зоны промкода с последующим поглощением стековых переменных вм - svm_xx<br>7. Список зон изменения соответствий регистров вм и CPU с учетом девиртуализации инструкций.<br>8. <b>Section a11 reg</b> - первоначальная замена регистров вм регистрами CPU.<br>9. Список зон изменения соответствий регистров вм и CPU с учетом выполненной замены.<br>10. <b>Section a11 resolve reg</b> - окончательная замена регистров вм регистрами CPU.<br>11. <b>Section a12 final</b> - текстовое представление декомпилированного промкода.<br>12. <b>Section asm</b> - окончательно восстановленный асм код функции.<br>Информация с блока 8 и до конца часто может быть недостоверной, т.к. пока 100% восстановить соответствие регистров вм и CPU удается далеко не всегда. До блока 8 информация достоверна, но может быть избыточной ввиду того, что некоторые инструкции кода не девиртуализовались по разным причинам.<br><br>Так же ещё создаются порядка десятка map файлов - карты ресурсов вм и промкода, содержимое их должно быть понятно из названия.<br><br><I>Он позволяет пошагово пройтись по командам VM и посмотреть за изменениями регистров и памяти  </I><br>Пробовал, не понравилось, берет только одну секцию вм до выхода из неё, а реально в кодированной функции может быть несколько десятков взаимоувязанных секций...<br><br>На более конкретные вопросы могу ответить конкретно...
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=276016&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=19" class="addthx" data-post="276016"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=26941" title="01-02-2011 16:09, ранг:2.7" target="_blank">valot</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]valot[/b]','')">valot</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 3.1 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.65'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26941">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2011 19:09 &middot; Поправил: valot <br><script type="text/javascript">QU('valot','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=valot" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#20');return false;">#20</a> </span><div align=left><br>
<I>Vamit пишет:<br>На более конкретные вопросы могу ответить конкретно...  </I><br><br>Спасибо за подробные пояснения. У меня почти во всех файлах заканчивается описание на секции 02 и лишь в некоторых 04 с перечнем VM примитивов. Буду работать над файлом дальше.<br><br>Хотел узнать, есть ли пример программы (лучше всего, конечно, с VMProtect), для которой &quot;правильно&quot; декомпилируется vm, чтобы можно было &quot;сравнить со здоровой&quot;? Или хотя бы можете выложить пример файлов с полной расшифровкой секций, чтобы представлять, куда стремиться?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=276034&amp;user=26941&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=20" class="addthx" data-post="276034"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 февраля 2011 19:34 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#21');return false;">#21</a> </span><div align=left><br>
Одну из предыдущих версий я выкладывал с тестовым примером, который 100% декомпилируется.<br>Смотри <noindex><a href="https://ssl.cracklab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=7#4" rel="nofollow" target="_blank">здесь</a></noindex>
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=276037&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=21" class="addthx" data-post="276037"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 февраля 2011 14:23 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#22');return false;">#22</a> </span><div align=left><br>
Очередная версия <b>VMSweeper 1.4 beta 8</b>.<br>Добавлено:<br>1. Улучшено распознавание транзитных меток.<br>2. Улучшено распознавание условных переходов.<br>3. Улучшено распознавание использования переменной при её частичном переприсвоении.<br>4. Удаление декодирования адреса безусловного перехода.<br>5. Второй алгоритм подсчета CRC для VMProtect версии выше 2.0<br>6. Защита DRx регистров (аппаратных точек останова) от VMProtect.<br>7. Обработка прямого вызова АПИ после кодированного выхода из ВМ.<br>Исправлено:<br>1. Реструктуризация промкода. Иногда прямая ветка после условного перехода шла не на следующий блок.<br>2. Реструктуризация промкода. Для невырожденного безусловного перехода добавляется зона метки.<br>3. Распознавание использования регистра ВМ в строке с его инициализацией.<br>4. Девиртуализация инструкции retn xx теперь не зависит от кол-ва переменных вм в стеке.<br>5. Метка вырожденного перехода не удаляется если на неё идут другие переходы.<br>6. Устранено переполнение стека и исключение при поиске соответствия регистров вм и CPU в цикле.<br>7. При автоматическом рестарте программы не активировалась опция AntiAntiDebug.<br><br>Так как на сегодняшний день Свипер практически является самодостаточным (встроены все необходимые средства защиты от ВмПротекта) и самостоятельным (анализ, восстановление и декомпиляция почти всех возможностей ВмПротекта, но в разной пока мере, а также изучение его методов защиты файлов - декомпиляция загрузчиков/протекторов и TLS кода), то приведу несколько советов в дополнение к сказанному в хелпе (всё для ВмПротекта):<br>1. Во избежании конфликтов (двойной инлайн патчинг) нужно отключить опции защиты в других плагинах, стоящих рядом со Свипером, или вообще убрать их, в первую очередь это относится к Стронгу и Фантому.<br>2. При начале работы с новой прогой делаем останов на ЕП, запускаем Analyze all VM references, на пустое окно ссылок не обращаем внимание и декомпилируем ЕП.<br>3. В секции а12 лог файла находим ОЕП, её видно практически невооруженным взглядом в версиях вмпрота выше 2.0. Если же код на ОЕП сожран протектором, то придется декомпилировать несколько последовательных вызовов вм, адрес каждой последующей вм виден в логе предыдущей. Последняя вм будет содержать сожранный кусок кода с ОЕП до первой вызываемой функции.<br>4. Если интересно содержание TLS, то можно остановиться на нем и декомпилировать, но там ничего полезного для дальнейшей работы с файлом нет.<br>5. Ставим НВР на ОЕП. Если протектор имеет защиту от дебага, то в Ольке ставим системный стоп и включаем опцию антиантидебага в Свипере. Рестартуем прогу.<br>6. Давим F9 и мы на ОЕП. Запускаем Analyze all VM references, проверив значения сегментов предложенные Свипером и, если нужно, корректируем их. Сохраняем найденный список в файл. Выбираем интересующий кусок кода накрытый вм и ставим на него обычный бряк. Делаем реанализ кода, если он не был сделан Свипером, например, при восстановлении импорта.<br>7. Выходим из Ольки. Нужно для того, чтобы вся собранная Свипером инфа сохранилась в UDD файле проги, иначе при вылете на декомпиляции будет потеряна часть нужной инфы и п.6 придется выполнять заново.<br>8. Загружаем прогу, доходим до ОЕП, активируем бряк на выбранной функе, достигаем его - а далее всё было описано ранее...<br><br><br><br><img src="img/attach.gif" alt=""> <a href="./files/f632_04.02.2011_CRACKLAB.rU.tgz">f632_04.02.2011_CRACKLAB.rU.tgz</a> - VMSweeper14beta8.rar
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=276241&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=22" class="addthx" data-post="276241"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17432" title="04-02-2011 11:44, ранг:211.0" target="_blank">ClockMan</a>, <a href="action=userinfo&user=18316" title="04-02-2011 12:08, ранг:50.2" target="_blank">SReg</a>, <a href="action=userinfo&user=4618" title="04-02-2011 12:17, ранг:104.2" target="_blank">Nightshade</a>, <a href="action=userinfo&user=6947" title="04-02-2011 12:35, ранг:43.8" target="_blank">huckfuck</a>, <a href="action=userinfo&user=16120" title="04-02-2011 13:27, ранг:3.3" target="_blank">m0bscene</a>, <a href="action=userinfo&user=8081" title="04-02-2011 13:46, ранг:21.6" target="_blank">Yotun</a>, <a href="action=userinfo&user=21589" title="04-02-2011 14:53, ранг:79.7" target="_blank">_ruzmaz_</a>, <a href="action=userinfo&user=11966" title="04-02-2011 16:37, ранг:84.1" target="_blank">r_e</a>, <a href="action=userinfo&user=2777" title="04-02-2011 20:16, ранг:320.0" target="_blank">daFix</a>, <a href="action=userinfo&user=2585" title="05-02-2011 06:55, ранг:754.3" target="_blank">Gideon Vi</a>, <a href="action=userinfo&user=35168" title="02-01-2017 02:28, ранг:49.0" target="_blank">v00doo</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 февраля 2011 10:26 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#23');return false;">#23</a> </span><div align=left><br>
<b>Vamit</b> либо я чет недопонимаю, либо в 8ой бэтке стало больше багов (проверил на 2ух компах) почемуто перестал в подопытной проге находит точки входа в ВМ, (предыдующий находил). Если его тыкать в анализ руками, после рестарта останавливается и при попытке любого действия орет, что  анализ уже запущен при этом ниче не делает.
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=276288&amp;user=17319&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=23" class="addthx" data-post="276288"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Ultras[/b]','')">Ultras</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 123.0 (ветеран), 10thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.51'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3438">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 февраля 2011 11:02 &middot; Поправил: Ultras <br><script type="text/javascript">QU('Ultras','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Ultras" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#24');return false;">#24</a> </span><div align=left><br>
<b>VodoleY</b>, проверь сначала границы диапазона ВМ: расширь на секцию с импортом. У меня вчера была похожая проблема, но в итоге все пошло нормально. Проблема отловилась по логам.
<br><br><font size="1"><i>-----<br>.[ rE! p0w4 ].</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=276289&amp;user=3438&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=24" class="addthx" data-post="276289"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 февраля 2011 11:24 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#25');return false;">#25</a> </span><div align=left><br>
<b>Ultras</b> суть в том что диапазон  мне <b>Vamit</b> лично указывал, правда несколько месяцев назад , и с прошлыми версиями свипера было все путем <img src="img/smilies/s9.gif" alt="">
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=276291&amp;user=17319&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=25" class="addthx" data-post="276291"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 февраля 2011 18:51 <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#26');return false;">#26</a> </span><div align=left><br>
<I>VodoleY пишет:<br>мне Vamit лично указывал, правда несколько месяцев назад , и с прошлыми версиями свипера было все путем </I><br>Много воды утекло с тех пор... что-то ушло, но больше добавилось...<br>Если точка в вм не определяется Свипером,то:<br>1. Если она есть в списке ссылок, но имеет не postponed статус, то это ошибка Свипера.<br>2. Если она в списке отсутствует, то смотрим куда идет переход из этой точки, если в сегмент вм с заданными границами, то это ошибка Свипера, если мимо сегмента вм, то это ваша ошибка - расширьте границы сегмента вм и повторите анализ.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=276317&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=26" class="addthx" data-post="276317"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 февраля 2011 20:57 &middot; Поправил: VodoleY <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#27');return false;">#27</a> </span><div align=left><br>
<b>Vamit</b> я руками ставлю на начало ВМ на певую инструкцию=ОЕП вобщем как надо. прошлый билд очень чудесно хавал, хоть и ругался (читайте асю) НО тут полезли баги. Причем разнообразные. с прошлым билдом с этой же прогой такого не было<br>З.Ы. по опыту общения... мы мне проще отправить ехе шник.. сами посмотрите, ОН ТоТ же . у мну просто не доходят руки до этого проэкта.Но он показательный.<br>З.Ы.Ы. Я не ругаюсь, и не привередничаю, простите мастер. Просто глюк есть. Может быть ток в моем случае. Ибо ВАШ продук я лиш на одной проге и катаю.
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=276323&amp;user=17319&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=27" class="addthx" data-post="276323"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 февраля 2011 09:23 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#28');return false;">#28</a> </span><div align=left><br>
<I>VodoleY пишет:<br>прошлый билд очень чудесно хавал, хоть и ругался (читайте асю) НО тут полезли баги.  </I><br>Нужно было ещё давно, вроде с версии 1.3 beta xx, удалить удд файл и отрезать секцию .vm от файла, а ещё лучше взять оригинальный файл, т.к. секция .vm ломает CRC файла и вмпрот это ловит... и провести анализ кода заново, он должен пройти успешно. Но, в твоем случае, декомпиляция ЕП не прошла бы, т.к. конкретно в этом файле собран почти весь набор ФПУ обработчиков, их за выходные я уже реализовал, так что увидеть это будет можно в следующей версии.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=276419&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=28" class="addthx" data-post="276419"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]VodoleY[/b]','')">VodoleY</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 488.1 (мудрец), 272thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.01'>Активность: 0.35<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=17319">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 февраля 2011 09:46 <br><script type="text/javascript">QU('VodoleY','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=VodoleY" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#29');return false;">#29</a> </span><div align=left><br>
<b>Vamit</b> Спасибо, вы как всегда на высоте.  С интересом слежу за развитием проэкта, удачи! <img src="img/smilies/s1.gif" alt="">
<br><br><font size="1"><i>-----<br>Наша работа во тьме, Мы делаем, что умеем. Мы отдаем, что имеем, Наша работа во тьме....</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=276421&amp;user=17319&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=29" class="addthx" data-post="276421"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]Vamit[/b]','')">Vamit</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/20406.jpg" alt=""><br><span class=txtSm>Ранг: 331.1 (мудрец), 561thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.3'>Активность: 0.19<span style='color:red'>&searr;</span>0.06</span><br>Статус: <a href="action=userinfo&amp;user=20406">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 февраля 2011 10:00 &middot; Поправил: Vamit <br><script type="text/javascript">QU('Vamit','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Vamit" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#30');return false;">#30</a> </span><div align=left><br>
Раскопал ещё одну защиту ВмПротекта:<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;store&nbsp;content&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;stack&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_char">[</span>0x00664B60<span class="hl_char">]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;value&nbsp;0x107BD8F4</li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;load&nbsp;content&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;VM&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l0"><span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_registr">esp</span><span class="hl_char">]</span><span class="hl_char">,</span>&nbsp;0xEF9D53C4</li><li class="hl_l1"><span class="hl_function"><b>pop</b></span>&nbsp;rvm_aux&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;auxilary&nbsp;VM&nbsp;register</li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;decompiled&nbsp;<span class="hl_function">code</span></li><li class="hl_l0"><span class="hl_number">001500C0</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">pushfd</span></li><li class="hl_l1"><span class="hl_number">001500C6</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">001500CC</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">001500D2</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_number">001500D8</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>push</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_number">001500DE</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_number">1</span></li><li class="hl_l0"><span class="hl_number">001500E9</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>cpuid</b></span>&nbsp;</li><li class="hl_l1"><span class="hl_number">0015010E</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0xFFFFFFF0</li><li class="hl_l0"><span class="hl_number">00150147</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;0x00FFFFFF</li><li class="hl_l1"><span class="hl_number">00150180</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0x35ABCC30</li><li class="hl_l0"><span class="hl_number">001502B0</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;0xE28F4C0B</li><li class="hl_l1"><span class="hl_number">00150315</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">00150332</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>xor</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;rvm_aux</li><li class="hl_l1"><span class="hl_number">001503B1</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>bswap</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">00150425</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>dec</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_number">00150441</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>bswap</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">001504B5</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">eax</span><span class="hl_char">,</span>&nbsp;0xD35C7112</li><li class="hl_l1"><span class="hl_number">001504E7</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>mov</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">[</span>rvm_aux&nbsp;<span class="hl_char">+</span>&nbsp;0x38<span class="hl_char">]</span>&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;value&nbsp;0x18202273</li><li class="hl_l0"><span class="hl_number">001504F0</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>bswap</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_number">00150564</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>dec</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">00150580</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>bswap</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_number">001505F4</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">ebx</span><span class="hl_char">,</span>&nbsp;0xD35C7112</li><li class="hl_l0"><span class="hl_number">00150608</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">pushfd</span></li><li class="hl_l1"><span class="hl_number">00150610</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_number">0015061C</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;0x00000100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;TF</li><li class="hl_l1"><span class="hl_number">00150654</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>add</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">00150671</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>cmp</b></span>&nbsp;<span class="hl_registr">ecx</span><span class="hl_char">,</span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_number">00150868</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>jz</b></span>&nbsp;0x001509E4</li><li class="hl_l0"><span class="hl_number">00150931</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l1"><span class="hl_number">00150937</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l0"><span class="hl_number">0015093D</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l1"><span class="hl_number">00150943</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l0"><span class="hl_number">00150949</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">popfd</span></li><li class="hl_l1"><span class="hl_number">001509DF</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>jmp</b></span>&nbsp;0x763986E0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_function"><b>false</b></span>&nbsp;transition</li><li class="hl_l0"><span class="hl_number">001509E4</span><span class="hl_char">:</span>&nbsp;label_1509E4<span class="hl_char">:</span></li><li class="hl_l1"><span class="hl_number">00150AA6</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ebx</span></li><li class="hl_l0"><span class="hl_number">00150AAC</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">edx</span></li><li class="hl_l1"><span class="hl_number">00150AB2</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">ecx</span></li><li class="hl_l0"><span class="hl_number">00150AB8</span><span class="hl_char">:</span>&nbsp;<span class="hl_function"><b>pop</b></span>&nbsp;<span class="hl_registr">eax</span></li><li class="hl_l1"><span class="hl_number">00150ABE</span><span class="hl_char">:</span>&nbsp;<span class="hl_function">popfd</span></li><li class="hl_l0"><span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;real&nbsp;<span class="hl_function"><b>code</b></span>&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span></li>        </ol>
    </div>
</div></div>
<br>этот код втыкается протектором в начало каждой защищенной им функции. Вопрос: что это такое может быть?<br>Реализаций такого кода может быть несколько - вместо bswap могут использоваться любые инструкции сдвига.
<br><br><font size="1"><i>-----<br>Everything is relative...</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=277055&amp;user=20406&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=30" class="addthx" data-post="277055"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="31" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 февраля 2011 10:07 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#31" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=13&amp;topic=15906&amp;page=8#31');return false;">#31</a> </span><div align=left><br>
Видимо, антидамп это на основе cpuid и антиотладка на основе TF.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=277056&amp;user=1556&amp;forum_n=13&amp;topic=15906&amp;page=8&amp;anchor=31" class="addthx" data-post="277056"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=7.html">&lt;&lt;</a> .  <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=0.html">1</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=2.html">3</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=3.html">4</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=4.html">5</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=5.html">6</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=6.html">7</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=7.html">8</a> . <b>9</b> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=9.html">10</a> ... <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=22.html">23</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=23.html">24</a> . <a href="action=vthread&amp;forum=13&amp;topic=15906&amp;page=9.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/aspro.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=13&sortBy=0&page=0.html"><b>Протекторы</b></a> <b class=bulletHead>&#8212;&#8250;</b> Декомпилятор ВМ</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#32" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="13">
<input type="hidden" name="topic" value="15906">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=15906" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
