<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Вопрос по GetProcAddress - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Здравствуйте! Дописываю PE-загрузчик. Думал уж, конец скоро, как столкнулся с непредвиденной проблемой, реализуя аналог GetProcAdress. По спецификации она принимает первым параметром адрес загрузки DLL, вторым - указатель на">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=42072'>zombi-vadim</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопрос по GetProcAddress</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]MisterSmile[/b]','')">MisterSmile</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.16'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=34848">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2013 23:34 &middot; Поправил: MisterSmile <br><script type="text/javascript">QU('MisterSmile','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MisterSmile" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Здравствуйте!<br>Дописываю PE-загрузчик. Думал уж, конец скоро, как столкнулся с непредвиденной проблемой, реализуя аналог GetProcAdress.<br><br>По спецификации она принимает первым параметром адрес загрузки DLL, вторым - указатель на строку, содержащую имя функции либо ординал.<br><br>Хочу сделать так, чтобы она могла работать, как с именами функций, так и ординалами.<br><br>И собственно вопрос: в случае, когда передается ординал, есть ли какие автоматизированные средства перевода, то бишь функции или макросы, из char* в DWORD? Например, если мне нужно преобразовать строку &quot;07Е15A2C&quot; в переменную DWORD со значением 07Е15A2C.<br>Или нужно всё собственными ручками писать?<br><br>Что-то я в интернете искал, но везде натыкался на вариант, когда строка переводится в последовательность значений, кодирующих каждый её символ.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330869&amp;user=34848&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=1" class="addthx" data-post="330869"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2013 23:40 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
в delphi StrToInt(&#039;&#036;&#039;+val) или HexToInt<br>в С можно sscanf(.., &quot;%08x&quot;..) или atoi с добавленным 0x<br>Только смысл переводить в строку чтоб потом обратно в dword?<br><br>GetProcAddress(hModule, (char *)1);
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330870&amp;user=3136&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=2" class="addthx" data-post="330870"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]MisterSmile[/b]','')">MisterSmile</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.16'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=34848">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 сентября 2013 23:55 <br><script type="text/javascript">QU('MisterSmile','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MisterSmile" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Veliant</b>, спасибо большое)<br><br>Не совсем понял последний вопрос. В одном и том же передаваемом параметре у нас может быть, как ординал, так и имя функции. Как иначе передать имя, если не строкой?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330872&amp;user=34848&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=3" class="addthx" data-post="330872"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 00:08 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>MisterSmile пишет:<br>Хочу сделать так, чтобы она могла работать, как с именами функций, так и ординалами. </I><br><br>Нужно проверить переданный в функцию параметр. Если это указатель на строку. То старший Word не равен 0. Если это ординал, то старший Word равен 0.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=330873&amp;user=31056&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=4" class="addthx" data-post="330873"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]MisterSmile[/b]','')">MisterSmile</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.16'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=34848">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 00:16 &middot; Поправил: MisterSmile <br><script type="text/javascript">QU('MisterSmile','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MisterSmile" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>hors</b>, это да. Только сначала нужно перевести в DWORD. Собственно поэтому и вопрос возник.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330874&amp;user=34848&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=5" class="addthx" data-post="330874"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]hors[/b]','')">hors</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/31056.jpg" alt=""><br><span class=txtSm>Ранг: 136.0 (ветеран), 360thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.52'>Активность: 0.27<span style='color:red'>&searr;</span>0.14</span><br>Статус: <a href="action=userinfo&amp;user=31056">Участник</a><br><font color=blue>Qt Developer</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 00:21 <br><script type="text/javascript">QU('hors','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hors" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<I>MisterSmile пишет:<br>hors, это да. Только сначала нужно перевести в DWORD. Собственно поэтому и вопрос возник.  </I><br><br>GetProcAdress принимает не строку. А <b>указатель</b> на строку. То есть адрес. Это и есть DWORD.
<br><br><font size="1"><i>-----<br>http://ntinfo.biz</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=330875&amp;user=31056&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=6" class="addthx" data-post="330875"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 00:24 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Ключевой момент здесь - сравнение параметра с числом 10000h (старшее слово 0?).<br>Если параметр меньше, чем 10000h - то GetProcAddress считает, что нужно искать функцию по ординалу,<br>если параметр больше , чем 10000h - то GetProcAddress считает, что это указатель на строку-имя функции.<br>(Указатель в WIN32 PE-EXE всегда будет больше, чем 10000h).<br><br>- - - - - - - - - &gt;8<br>mov eax, 3             ;; -it&#039;s ORDINAL &lt; 10000h<br>.....<br>mov eax,402203h  ;; -it&#039;s POINTER &gt;10000h - адрес строки-имени функции<br>.....<br>push eax<br>push module_handle<br>call GetProcAddress<br>- - - - - - - - - &gt;8
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330876&amp;user=35473&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=7" class="addthx" data-post="330876"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]drin[/b]','')">drin</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 63.8 (постоянный), 2thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.85'>Активность: 0.03<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=6342">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 00:30 &middot; Поправил: drin <br><script type="text/javascript">QU('drin','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=drin" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<b>MisterSmile</b><br>как то странно... с одной стороны вы пытаетесь реализовать совсем не тривиальную задачу, а с другой ваши познания спотыкаются на довольно простых вещах...<br>а) вы не знаете как перевести Hex строку в DWORD<br>б) переводить ничего не нужно, строка которая передается в GetProcAddress это PChar - 32битное число указатель на строку, если передается ordinal то это число и является тем порятковым номером ф-ии, а не указателем на имя... нужно просто рассматривать в таком случае этот PChar как DWORD и все, и как выше предложили если он ниже 0xFFFF это ординал,а если выше то ссылка на имя
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330877&amp;user=6342&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=8" class="addthx" data-post="330877"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=34848" title="15-09-2013 09:53, ранг:4.0" target="_blank">MisterSmile</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 00:37 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>drin</b>,<br>уточю - рассматривать будет WIN32 при выполнении GetProcAddress.<br>Если её что-то не устроит - вернёт ошибку, иначе вернёт адрес интересующей функции.<br><br>Если даётся ординал - он должен присутствовать в этом подуле,<br>если даётся указатель на строку-имя функции - то имя это должно присутствовать в числе экспортируемых имён.<br><br>В любом случае, самое страшное, что тут может произойти, - это GetProcAddress вернёт ошибку.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330878&amp;user=35473&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=9" class="addthx" data-post="330878"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Veliant[/b]','')">Veliant</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 301.4 (мудрец), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.62'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=3136">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 00:44 &middot; Поправил: Veliant <br><script type="text/javascript">QU('Veliant','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Veliant" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Кстати, есть еще сквозной экспорт у библиотек. Когда вместо указателя на функцию будет указатель на имя функции в другой библиотеке. Например HeapAlloc kernel32 &quot;сквозит&quot; на ntdll.RtlAllocateHeap
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330879&amp;user=3136&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=10" class="addthx" data-post="330879"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 00:50 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<b>MisterSmile</b>,<br>sscanf(...);<br>-- Экспортируется библиотекой msvcrt.dll.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330880&amp;user=35473&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=11" class="addthx" data-post="330880"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 00:59 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Лучше чем LWE не запилите. Так что вопрос смысла не имеет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330881&amp;user=33727&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=12" class="addthx" data-post="330881"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 01:00 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<b>Veliant</b>,<br><br>&gt;&gt;вместо указателя на функцию будет указатель на имя функции в другой библиотеке.<br><br>-- наверное, <b>будет указатель на функцию в другой библиотеке</b> ?...<br><br><b>Dr0p</b>,<br>да тут речь идёт о простой маленькой утилитке, какую все или почти все когда-то для себя поделали.<br>Десяток строчек на Си. Чуть больше на асме.<br>...хотя ... нет, видимо, я не до конца понял суть проблемы. <br>Тут задумка, вроде, взрослая. Тогда я не понимаю, откуда проблема с конвертацией string-&gt;DWORD?..
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330882&amp;user=35473&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=13" class="addthx" data-post="330882"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 01:04 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
...Post removed...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330884&amp;user=35473&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=14" class="addthx" data-post="330884"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 01:06 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>dosprog</b><br><br>Загрузчик нужен для не многих целей. Это загрузка из памяти, либо осевой для каких нить буткитов. В любых иных случаях есть системный. Да и GPA() позволяет по ординалам искать. Не пойму в чём проблема.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330885&amp;user=33727&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=15" class="addthx" data-post="330885"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=35473" title="14-09-2013 21:26, ранг:9.9" target="_blank">dosprog</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 01:30 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
&gt; Тогда я не понимаю, откуда проблема с конвертацией string-&gt;DWORD?..<br><br>Строка это не массив символов загружаемый в стек в качестве аргументов. Строка в данном случае имеет фиксированный тип - PSTR. Префикс P&quot; у типов означает Pointer&quot;. Это ссылка на строку, тоесть её адрес.<br><br>Ординал же есть число. Лень смореть как там у виньапишки, для нтлдр прото конкретное:<br><br>LdrGetProcedureAddress(<br>IN HANDLE ModuleHandle,<br>IN PANSI_STRING FunctionName OPTIONAL,<br>IN ULONG Ordinal OPTIONAL,<br>OUT PPOINTER ProcedureAddress<br>):NTSTATUS
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330886&amp;user=33727&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=16" class="addthx" data-post="330886"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 01:37 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>Dr0p</b><br>Всё. Я понял.<br>ТС просто грузит в память модуль, а потом хочет  в памяти в этом модуле  искать точки входа функций.<br>Так это проще сделать вызовом GetProcAddress, если только не замышляется дизассемблер для DLL&#039;ей.<br>Как вы и написали в посте #15...<br><br>Вопрос был - как сконвертировать строку &quot;123h&quot; в DWORD 123h, видимо, &quot;123h&quot; это будет задаваемый от-руки ординал.<br>Вспомнилось, как это всё организовано было в WIN16 - там загрузка по ординалам делалась так:<br>принимается FAR указатель на строку. Эта строка - или имя функции, или строка-ординал в виде &quot;#123&quot;,<br>где &quot;123&quot; - это WORD ординал 123dec. <br>Правда, был и третий способ - в стек запихивался ординал в двоичном виде как DWORD, но старшее слово у него должно было быть 0000 (вроде сегмента в FAR-указателе).<br>Ничего нового...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330888&amp;user=35473&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=17" class="addthx" data-post="330888"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 01:43 <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<b>dosprog</b><br><br>GPA опенсурс. Но есно она не на дельфи.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330889&amp;user=33727&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=18" class="addthx" data-post="330889"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]yagello[/b]','')">yagello</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.1 (постоянный), 30thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.56'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=23568">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 02:41 <br><script type="text/javascript">QU('yagello','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=yagello" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
У ординалов взведен старший бит адреса. т.е.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>XXX&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;<span class="hl_char">$</span><span class="hl_number">80000000</span><span class="hl_char">)</span><span class="hl_char">&lt;</span><span class="hl_char">&gt;</span><span class="hl_number">0</span></li><li class="hl_l1">then&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;ординал</li><li class="hl_l0"><span class="hl_function"><b>else</b></span>&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;имя&nbsp;функции</li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=330890&amp;user=23568&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=19" class="addthx" data-post="330890"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=17432" title="14-09-2013 22:50, ранг:367.2" target="_blank">ClockMan</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 04:42 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>yagello</b>,<br><br>&gt;&gt;У ординалов взведен старший бит адреса. т.е.<br><br>-- вы имеете в виду ординалы, находящиеся в таблице импорта PE-EXE файла.<br>Но такое  практически не встречается нигде. Так не делают.  <br>Можно, конечно, слинковать PE-EXE командой &quot;C&gt;TLINK32 /o ... ...&quot;,<br>но делать такое - это заведомо иметь проблемы с переносимостью на другую версию той же Windows.<br>ОРДИНАЛ ФУНКЦИИ НЕ ПОСТОЯНЕН В РАЗНЫХ ВЕРСИЯХ WIN32. Об этом и Микрософт предупреждала.<br>Импорт в WIN32 PE-EXE - практически всегда только по именам функций.<br>Конечно,  импорт только из собственных библиотек можно реализовать и по ординалам.<br>Для затруднения анализа кода. Но зачем это делать, я не знаю... Только злить людей.<br>Что-то такое было в IDE.  <br><br>Вот, кстати, старинная утилитка на тему загрузки DLL&#039;лей с помошью системного загрузчика:<br>(LoadLibrary + GetProcAddress):<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/d5aa_15.09.2013_EXELAB.rU.tgz">d5aa_15.09.2013_EXELAB.rU.tgz</a> - PROCADDR.RAR
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330892&amp;user=35473&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=20" class="addthx" data-post="330892"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Dr0p[/b]','')">Dr0p</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/33727.png" alt=""><br><span class=txtSm>Ранг: 72.3 (постоянный), 133thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.5'>Активность: 0.38<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=33727">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 10:42 &middot; Поправил: Dr0p <br><script type="text/javascript">QU('Dr0p','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dr0p" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>yagello</b><br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_large">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">FARPROC</li><li class="hl_l1">GetProcAddress<span class="hl_char">(</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;HMODULE&nbsp;hModule<span class="hl_char">,</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;LPCSTR&nbsp;lpProcName</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">)</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_char">+</span><span class="hl_char">+</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Routine&nbsp;Description<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>This</b></span>&nbsp;function&nbsp;retrieves&nbsp;the&nbsp;memory&nbsp;address&nbsp;of&nbsp;the&nbsp;function&nbsp;whose</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;is&nbsp;pointed&nbsp;to&nbsp;by&nbsp;the&nbsp;lpProcName&nbsp;parameter<span class="hl_char">.</span>&nbsp;&nbsp;The&nbsp;GetProcAddress</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;searches&nbsp;for&nbsp;the&nbsp;function&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;the&nbsp;module&nbsp;specified&nbsp;by&nbsp;the</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;hModule&nbsp;parameter<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;the&nbsp;module&nbsp;associated&nbsp;with&nbsp;the&nbsp;current</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;process&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;hModule&nbsp;is&nbsp;<span class="hl_function">NULL</span><span class="hl_char">.</span>&nbsp;&nbsp;The&nbsp;function&nbsp;must&nbsp;be&nbsp;an&nbsp;exported</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;function<span class="hl_comment">; the module's definition file must contain an appropriate</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;EXPORTS&nbsp;line&nbsp;for&nbsp;the&nbsp;function<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>If</b></span>&nbsp;the&nbsp;lpProcName&nbsp;parameter&nbsp;is&nbsp;an&nbsp;ordinal&nbsp;value&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;a&nbsp;function&nbsp;with</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;specified&nbsp;ordinal&nbsp;does&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;exist&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;the&nbsp;module<span class="hl_char">,</span>&nbsp;GetProcAddress</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;still&nbsp;return&nbsp;a&nbsp;non<span class="hl_char">-</span><span class="hl_function"><b>NULL</b></span>&nbsp;value<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_function"><b>In</b></span>&nbsp;cases&nbsp;where&nbsp;the&nbsp;function&nbsp;may</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>not</b></span>&nbsp;exist<span class="hl_char">,</span>&nbsp;specify&nbsp;the&nbsp;function&nbsp;by&nbsp;name&nbsp;rather&nbsp;than&nbsp;ordinal&nbsp;value<span class="hl_char">.</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;Only&nbsp;use&nbsp;GetProcAddress&nbsp;to&nbsp;retrieve&nbsp;addresses&nbsp;of&nbsp;exported&nbsp;functions</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;belong&nbsp;to&nbsp;<span class="hl_function"><b>library</b></span>&nbsp;modules<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;spelling&nbsp;of&nbsp;the&nbsp;function&nbsp;name&nbsp;<span class="hl_char">(</span>pointed&nbsp;to&nbsp;by&nbsp;lpProcName<span class="hl_char">)</span>&nbsp;must&nbsp;be</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;identical&nbsp;to&nbsp;the&nbsp;spelling&nbsp;as&nbsp;it&nbsp;appears&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;the&nbsp;source&nbsp;library's</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;definition&nbsp;<span class="hl_char">(</span><span class="hl_char">.</span>DEF<span class="hl_char">)</span>&nbsp;file<span class="hl_char">.</span>&nbsp;&nbsp;The&nbsp;function&nbsp;can&nbsp;be&nbsp;renamed&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;the</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;definition&nbsp;file<span class="hl_char">.</span>&nbsp;&nbsp;Case&nbsp;sensitive&nbsp;matching&nbsp;is&nbsp;used<span class="hl_char">?</span><span class="hl_char">?</span><span class="hl_char">?</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">Arguments<span class="hl_char">:</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;hModule&nbsp;<span class="hl_char">-</span>&nbsp;Identifies&nbsp;the&nbsp;module&nbsp;whose&nbsp;<span class="hl_function"><b>executable</b></span>&nbsp;file&nbsp;contains&nbsp;the</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function<span class="hl_char">.</span>&nbsp;&nbsp;A&nbsp;value&nbsp;of&nbsp;<span class="hl_function"><b>NULL</b></span>&nbsp;references&nbsp;the&nbsp;module&nbsp;handle</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;associated&nbsp;with&nbsp;the&nbsp;image&nbsp;file&nbsp;that&nbsp;was&nbsp;used&nbsp;to&nbsp;create&nbsp;the</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current&nbsp;process<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;lpProcName&nbsp;<span class="hl_char">-</span>&nbsp;Points&nbsp;to&nbsp;the&nbsp;function&nbsp;name<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>or</b></span>&nbsp;contains&nbsp;the&nbsp;ordinal</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;of&nbsp;the&nbsp;function<span class="hl_char">.</span>&nbsp;&nbsp;<span class="hl_function"><b>If</b></span>&nbsp;it&nbsp;is&nbsp;an&nbsp;ordinal&nbsp;value<span class="hl_char">,</span>&nbsp;the&nbsp;value</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;must&nbsp;be&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;the&nbsp;low<span class="hl_char">-</span>order&nbsp;<span class="hl_function"><b>word</b></span>&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;zero&nbsp;must&nbsp;be&nbsp;<span class="hl_function"><b>in</b></span>&nbsp;the&nbsp;high<span class="hl_char">-</span>order</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function">word</span><span class="hl_char">.</span>&nbsp;&nbsp;The&nbsp;string&nbsp;must&nbsp;be&nbsp;a&nbsp;<span class="hl_function">null</span><span class="hl_char">-</span>terminated&nbsp;character&nbsp;string<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">Return&nbsp;Value<span class="hl_char">:</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;return&nbsp;value&nbsp;points&nbsp;to&nbsp;the&nbsp;function's entry point if the</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;is&nbsp;successful<span class="hl_char">.</span>&nbsp;&nbsp;A&nbsp;return&nbsp;value&nbsp;of&nbsp;<span class="hl_function"><b>NULL</b></span>&nbsp;indicates&nbsp;an&nbsp;error</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>and</b></span>&nbsp;extended&nbsp;error&nbsp;status&nbsp;is&nbsp;available&nbsp;using&nbsp;the&nbsp;GetLastError&nbsp;function<span class="hl_char">.</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;NTSTATUS&nbsp;Status<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;PVOID&nbsp;ProcedureAddress<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;STRING&nbsp;ProcedureName<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">(</span>ULONG_PTR<span class="hl_char">)</span>lpProcName&nbsp;<span class="hl_char">&gt;</span>&nbsp;0xffff&nbsp;<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RtlInitString<span class="hl_char">(</span><span class="hl_char">&amp;</span>ProcedureName<span class="hl_char">,</span>lpProcName<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Status&nbsp;<span class="hl_char">=</span>&nbsp;LdrGetProcedureAddress<span class="hl_char">(</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BasepMapModuleHandle</span><span class="hl_char">(</span>&nbsp;hModule<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>FALSE</b></span>&nbsp;<span class="hl_char">)</span><span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">&amp;</span>ProcedureName<span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0L</span><span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">&amp;</span>ProcedureAddress</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Status&nbsp;<span class="hl_char">=</span>&nbsp;LdrGetProcedureAddress<span class="hl_char">(</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BasepMapModuleHandle</span><span class="hl_char">(</span>&nbsp;hModule<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>FALSE</b></span>&nbsp;<span class="hl_char">)</span><span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_function">NULL</span><span class="hl_char">,</span></li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PtrToUlong</span><span class="hl_char">(</span><span class="hl_char">(</span>PVOID<span class="hl_char">)</span>lpProcName<span class="hl_char">)</span><span class="hl_char">,</span></li><li class="hl_l0"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">&amp;</span>ProcedureAddress</li><li class="hl_l1"><span style="word-break: break-all">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">!</span>NT_SUCCESS<span class="hl_char">(</span>Status<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseSetLastNTError<span class="hl_char">(</span>Status<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;ProcedureAddress&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;BasepMapModuleHandle<span class="hl_char">(</span>&nbsp;hModule<span class="hl_char">,</span>&nbsp;<span class="hl_function"><b>FALSE</b></span>&nbsp;<span class="hl_char">)</span>&nbsp;<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span>&nbsp;<span class="hl_char">(</span>ULONG_PTR<span class="hl_char">)</span>lpProcName&nbsp;<span class="hl_char">&gt;</span>&nbsp;0xffff&nbsp;<span class="hl_char">)</span>&nbsp;{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Status&nbsp;<span class="hl_char">=</span>&nbsp;STATUS_ENTRYPOINT_NOT_FOUND<span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Status&nbsp;<span class="hl_char">=</span>&nbsp;STATUS_ORDINAL_NOT_FOUND<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BaseSetLastNTError<span class="hl_char">(</span>Status<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_function"><b>NULL</b></span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_function"><b>else</b></span>&nbsp;{</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_char">(</span>FARPROC<span class="hl_char">)</span>ProcedureAddress<span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l0">}</li>        </ol>
    </div>
</div></div>
<br><br>- старшее слово обнулено.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330900&amp;user=33727&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=21" class="addthx" data-post="330900"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]MisterSmile[/b]','')">MisterSmile</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 5.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.16'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=34848">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 13:55 <br><script type="text/javascript">QU('MisterSmile','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=MisterSmile" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
Всех благодарю! Разобрался <img src="img/smilies/s1.gif" alt=""><br><br>Не знаю, почему своим ходом не дошёл до столь простого решения:<br><br>MyGetProcAddress (DynamicLoad(&quot;Dynamic.dll&quot;), (char*)1); //если вызов по ординалу<br><br>MyGetProcAddress (DynamicLoad(&quot;Dynamic.dll&quot;), &quot;TestFunction&quot;); //если вызов по имени функции<br><br>И всё работает)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330903&amp;user=34848&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=22" class="addthx" data-post="330903"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 сентября 2013 14:20 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=22170.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
Полагаю, можно закрыть, раз вопрос решён.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=330904&amp;user=1556&amp;forum_n=6&amp;topic=22170.html&amp;page=0&amp;anchor=23" class="addthx" data-post="330904"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Вопрос по GetProcAddress</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=22170" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
