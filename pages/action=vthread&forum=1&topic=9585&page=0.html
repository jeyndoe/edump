<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Помогите убить CRC проверки (ExeCryptor) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Прога: Anyplace-Control 4.0.7.0 Сайт: www.anyplace-control.com/ru Закачка: www.anyplace-control.com/anyplace-control/data/AnyplaceControlInstall.exe (2.7 метра) Импорт: rapidshare.com/files/47288052/ww.rar.html OEP: 001C3453 [ +">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=55853'>rtsgreg1989</a>, <a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите убить CRC проверки (ExeCryptor)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 14:27 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Прога: Anyplace-Control 4.0.7.0<br>Сайт: www.anyplace-control.com/ru<br>Закачка: www.anyplace-control.com/anyplace-control/data/AnyplaceControlInstall.exe (2.7 метра)<br>Импорт: rapidshare.com/files/47288052/ww.rar.html<br>OEP: 001C3453 [ + 400000]<br><br>Прога накрыта ExeCryptor (не упакована) с CRC проверкой.<br>Пробовал дампить+восстанавливать импорт. Прога работает, но только на моей машине.<br>Если в исходном exe поправить TLS+OEP+Import+BaseOfCode вылетает &quot;File corrupt!&quot; и закрывается.<br>Пробовал бряк на &quot;CreateThread&quot; потом C3, ebfe, exit thread... прога все равно вылетает с CRC ошибкой.<br><br>Наверняка кто то решал эту проблему, и может подсказать решение.
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150730&amp;user=2775&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=1" class="addthx" data-post="150730"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 14:50 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
_lopen _Lread _hread Лови где чекаются блоки! Решений полным полно! Можешь подменить значения, можешь убрать проверку , можешь прибить тред ! самыи простой способ снять со стека куда нить возврат со старта любого треда и вывести тред с проверкой
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150734&amp;user=293&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=2" class="addthx" data-post="150734"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Smon[/b]','')">Smon</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 500.5 (<b>!</b>), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.33'>Активность: 0.23<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 14:52 <br><script type="text/javascript">QU('Smon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Smon" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Maximus пишет:<br>ebfe </I><br>C3h , кроме того такая проверка не одна, и поток создаётся тоже не один.
<br><br><font size="1"><i>-----<br>&quotПусть видят, что мы не шутим. Стволы для понта, ножи для дела&quot Lock, Stock &amp Two Smoking Barrels</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150735&amp;user=1449&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=3" class="addthx" data-post="150735"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 15:01 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<b>Smon</b><br>вроде одна, но тред запускается всегда разное количество раз, и на последок всегда вылетает с кодом 131h<br><br><b>можешь прибить тред !</b><br>Пробовал jmp ExitThread, но прога проваливается в WaitForSingleObject и там и остается.<br><br>lopen _Lread _hread<br>пробовал, бряки не срабатывают (ставил хардварные и обычные)... прога не брякается ни разу ((...
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150738&amp;user=2775&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=4" class="addthx" data-post="150738"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 15:18 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
К примеру <br>Бряк на CreateThread<br>0012F5E8   0060176B  /CALL to CreateThread from FileEncr.00601766<br>0012F5EC   00000000  |pSecurity = NULL<br>0012F5F0   00000000  |StackSize = 0<br>0012F5F4   005F9E74  |ThreadFunction = FileEncr.005F9E74 &lt;--ставишь бряк на начало функции<br>0012F5F8   0012F608  |pThreadParm = 0012F608<br>0012F5FC   00000000  |CreationFlags = 0<br>0012F600   0012F604  \pThreadId = 0012F604<br><br>005F9E74     55                       push ebp &lt;--Начало функции<br>005F9E75     8BEC                     mov ebp,esp<br>005F9E77     E9 09E40300              jmp FileEncr.00638285<br><br>00E0FFB8   7C80B50B  RETURN to kernel32.7C80B50B &lt;--------Стек <br>00E0FFBC   0012F608<br>Что бы вывести тред в нужном месте тебе нужно не jmp ExitThread , а сунуть на стек 7C80B50B и ret
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150742&amp;user=293&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=5" class="addthx" data-post="150742"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]DarkWolf[/b]','')">DarkWolf</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 42.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=12385">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 15:30 <br><script type="text/javascript">QU('DarkWolf','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=DarkWolf" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
На офф. сайте уже стоит версия 4.0.8.0. А ImpRec её не любит - &quot;Can&#039;t open the process&quot;. В чём фишка?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150743&amp;user=12385&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=6" class="addthx" data-post="150743"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 15:35 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>DarkWolf</b> ща сделаю импорт на .0.8<br><br>&quot;Can&#039;t open the process&quot;. <br>Об этом писали в топах, ошибка на импрек 1.6, нужен 1.42
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150746&amp;user=2775&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=7" class="addthx" data-post="150746"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Smon[/b]','')">Smon</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 500.5 (<b>!</b>), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.33'>Активность: 0.23<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 15:36 <br><script type="text/javascript">QU('Smon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Smon" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>DarkWolf пишет:<br>На офф. сайте уже стоит версия 4.0.8.0. А ImpRec её не любит - &quot;Can&#039;t open the process&quot;. В чём фишка? </I><br>а попробуй 1.4.2 версию импрека вместо 1.6 - это раз, во вторых выставь атрибуты секций RWE в отладчике.
<br><br><font size="1"><i>-----<br>&quotПусть видят, что мы не шутим. Стволы для понта, ножи для дела&quot Lock, Stock &amp Two Smoking Barrels</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150747&amp;user=1449&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=8" class="addthx" data-post="150747"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 15:37 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>pavka</b> оки ща попробую на новой версии уже
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150748&amp;user=2775&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=9" class="addthx" data-post="150748"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Smon[/b]','')">Smon</a></b><br></div>
<img src="img/s8.gif" alt=""><br><span class=txtSm>Ранг: 500.5 (<b>!</b>), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.33'>Активность: 0.23<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=1449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 15:41 <br><script type="text/javascript">QU('Smon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Smon" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
я вообще выписывал все адреса типа 5F9E74 побрякавшись на CreateThread, а затем заменял уже в дампе на диске hiew&#039;ом первый байт по этим адресам на C3, и всё - crc идёт лесом.
<br><br><font size="1"><i>-----<br>&quotПусть видят, что мы не шутим. Стволы для понта, ножи для дела&quot Lock, Stock &amp Two Smoking Barrels</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150750&amp;user=1449&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=10" class="addthx" data-post="150750"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 15:45 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>Smon пишет:<br>я вообще выписывал все адреса типа 5F9E74 побрякавшись на CreateThread, а затем заменял уже в дампе на диске hiew&#039;ом первый байт по этим адресам на C3, и всё - crc идёт лесом. </I><br>Нафига отмниторить Камом он покажет все вызовы ;) Мне просто лениво искать начало треда  или искать проверки я просто записываю куда нить в конец секции кода верхушку стека  и в безобидом месте где нить просто вывожу тред...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150752&amp;user=293&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=11" class="addthx" data-post="150752"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]YDS[/b]','')">YDS</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/132.jpg" alt=""><br><span class=txtSm>Ранг: 199.9 (ветеран), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.12<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=132">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 16:23 <br><script type="text/javascript">QU('YDS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YDS" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<b>Maximus</b><br>Если речь идет о файле apc_Admin.exe, попробуй пропатчить так:<br>.00703718  3BC0  CMP EAX,EAX<br>.0070371A  90      NOP<br>.0070371B 90      NOP
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150772&amp;user=132&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=12" class="addthx" data-post="150772"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Amok[/b]','')">Amok</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 35.1 (посетитель)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.2'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4595">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 16:52 <br><script type="text/javascript">QU('Amok','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Amok" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Распаковал apc_Admin.exe под ХР СП1 и под ХР СП2. Удивительно, но поведение файлов разное. <br>Поведение файла распакованного под ХР СП2 уже описал <b>Maximus</b>. <br>А вот фаил распакованный под ХР СП1 запускается и работает, а окно с ошибкой выкидывает, только при выходе из программы (т.е. фаил-&gt;выход). Но конечно фаил распакованный под ХР СП1 не запускается под ХР СП2.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150777&amp;user=4595&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=13" class="addthx" data-post="150777"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 18:31 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<b>Amok</b> дык я писал что если сдампить, то работает на той тачке на которой сдамплено ((...<br><br><b>YDS</b><br>Чета не прокатило, хоть бы рассказал откуда цыферь.. ((<br><br>Ща еще буду пробовать паффкины методы борьбы...<br><br>Вот навсяк 4.0.8.0 с восстановленым импортом и восстановлеными спертыми байтами (CRC не проходит):<br>rapidshare.com/files/47329840/apc_Admin1.rar.html
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150794&amp;user=2775&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=14" class="addthx" data-post="150794"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]YDS[/b]','')">YDS</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/132.jpg" alt=""><br><span class=txtSm>Ранг: 199.9 (ветеран), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.12<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=132">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 18:35 &middot; Поправил: YDS <br><script type="text/javascript">QU('YDS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YDS" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<b>Maximus</b><br>ИМХО, но значит дело не в проверке CRC, а в распаковке <img src="img/smilies/s2.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150797&amp;user=132&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=15" class="addthx" data-post="150797"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]pavka[/b]','')">pavka</a></b><br></div>
<img src="img/s9.gif" alt=""><br><span class=txtSm>Ранг: 1045.7 <b><u>(!!!!)</u></b>, 31thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.85'>Активность: 0.57<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=293">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 18:54 <br><script type="text/javascript">QU('pavka','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=pavka" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>YDS пишет:<br>ИМХО, но значит дело не в проверке CRC, а в распаковке </I><br>Если &quot;File corrupt!&quot; месагебох то в CRC <img src="img/smilies/s1.gif" alt=""> бывает еще такая фигня когда фиксишь под разные оси  начинает орать дебагер детектед ;) при запуске и терминатится ....
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150800&amp;user=293&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=16" class="addthx" data-post="150800"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 19:24 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<b>YDS</b> файл то не упакован))<br><br><b>pavka</b> <br>вот не могу понять смысл фразы &quot;а сунуть на стек 7C80B50B и ret&quot;<br><br>то есть<br>push 7C80B50B<br>ret?<br>то есть получится как бы двойной возврат?<br><br>Рассказываю еще раз:<br>ставлю бряк на &quot;CreateThread&quot;, брякаюсь<br>0012FD58   005C9CFA  /CALL to CreateThread from apc_Admi.005C9CF5<br>0012FD5C   00000000  |pSecurity = NULL<br>0012FD60   00000000  |StackSize = 0<br>0012FD64   006A5EE4  |ThreadFunction = apc_Admi.006A5EE4<br>0012FD68   0012FD78  |pThreadParm = 0012FD78<br>0012FD6C   00000000  |CreationFlags = 0<br>0012FD70   0012FD74  \pThreadId = 0012FD74<br><br>0012FD68   0012FD78  |pThreadParm = 0012FD78 = DC<br><br>в основном потоке сразу попадаю сюда<br>0012FD6C   0068E7C9  /CALL to WaitForSingleObject<br>0012FD70   000000DC  |hObject = 000000DC (window)<br>0012FD74   FFFFFFFF  \Timeout = INFINITE<br><br>по 6A5EE4 пишу ret. И в результате так и остаюсь на WaitForSingleObject (((<br>олька в логе пишет код возврата 0 из нити
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150809&amp;user=2775&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=17" class="addthx" data-post="150809"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]Archer[/b]','')">Archer</a></b><br></div>
<img src="img/s9.gif" alt=""><br><img style="padding-top:3px;" src="av/1556.jpg" alt=""><br><span class=txtSm>Ранг: 2014.5 <b><u>(!!!!)</u></b>, 1278thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.27'>Активность: 1.34<span style='color:red'>&searr;</span>0.25</span><br>Статус: <a href="action=userinfo&amp;user=1556">Модератор</a><br><font color=blue>retired</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 19:35 <br><script type="text/javascript">QU('Archer','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Archer" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>Maximus пишет:<br>вот не могу понять смысл фразы &quot;а сунуть на стек 7C80B50B и ret&quot; </I><br>Имхо, это значит положить на стек это число и топать на ret.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150812&amp;user=1556&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=18" class="addthx" data-post="150812"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]r99[/b]','')">r99</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/314.gif" alt=""><br><span class=txtSm>Ранг: 328.7 (мудрец), 73thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=314">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 19:45 &middot; Поправил: r99 <br><script type="text/javascript">QU('r99','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r99" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
а зачем вообще распаковывать - если не упакована<br><br>ps<br>в delphi-прогах есть примерно такой кусок в самом начале<br><br>.00404331: 3BF3                         cmp         esi,ebx<br>.00404333: 7E1A                         jle        .00040434F -- 2<br>.00404335: 8B45FC                       mov         eax,[ebp][-04]<br>.00404338: 8B04D8                       mov         eax,[eax][ebx]*8    &lt;--- бряк<br>.0040433B: 8945F8                       mov         [ebp][-08],eax<br>.0040433E: 43                           inc         ebx<br>.0040433F: 895F0C                       mov         [edi][0C],ebx<br>.00404342: 837DF800                     cmp         d,[ebp][-08],0<br>.00404346: 7403                         je         .00040434B -- 3<br>.00404348: FF55F8                       call        d,[ebp][-08]<br>.0040434B: 3BF3                         cmp         esi,ebx<br>.0040434D: 7FE6                         jg         .000404335 -- 4<br>.0040434F: 33C0                         xor         eax,eax<br>.00404351: 5A                           pop         edx<br><br>на бряке нужно ловить при каком ebx прога начинает флудить и тогда соответствующий <br>call [ebx-8] пропускать<br><br>код может быть другой - но структура одинаковая
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150814&amp;user=314&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=19" class="addthx" data-post="150814"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 20:34 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<b>r99</b> я не пытаюсь распаковать прогу)) я пытаюсь найти способ пофиксить CRC проверку...<br><br>Сделал поиск по 8B04D8 (mov eax,[eax][ebx]*8) и таких байт не обнаружил, соответственно куска такого не нашел.
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150822&amp;user=2775&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=20" class="addthx" data-post="150822"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]r99[/b]','')">r99</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/314.gif" alt=""><br><span class=txtSm>Ранг: 328.7 (мудрец), 73thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=314">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 21:37 <br><script type="text/javascript">QU('r99','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r99" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>Maximus</b> ищи<br>Должон быть<br><br>я ж написал - код другой может быть<br><br>call eax или call edx ....<br>cmp         esi,ebx  - это вроде обязательно
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150833&amp;user=314&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=21" class="addthx" data-post="150833"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 21:42 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<b>r99</b> у мну есть такой код<br><br>00404A60   . 3BF3           CMP ESI,EBX<br>00404A62   . 7E 14          JLE SHORT apc_Admi.00404A78<br>00404A64   &gt; 8B04DF         MOV EAX,DWORD PTR DS:[EDI+EBX*8]<br>00404A67   . 43             INC EBX<br>00404A68   . 891D 44465B00  MOV DWORD PTR DS:[5B4644],EBX<br>00404A6E   . 85C0           TEST EAX,EAX<br>00404A70   . 74 02          JE SHORT apc_Admi.00404A74<br>00404A72   . FFD0           CALL EAX<br>00404A74   &gt; 3BF3           CMP ESI,EBX<br>00404A76   .^7F EC          JG SHORT apc_Admi.00404A64<br>00404A78   &gt; 33C0           XOR EAX,EAX<br>00404A7A   . 5A             POP EDX<br>00404A7B   . 59             POP ECX<br>00404A7C   . 59             POP ECX<br>00404A7D   . 64:8910        MOV DWORD PTR FS:[EAX],EDX<br>00404A80   . EB 14          JMP SHORT apc_Admi.00404A96<br><br>00404A72   . FFD0           CALL EAX выполняется без проблем, без всякого флуда, раз 30...<br>Я чуть выше файлик выложил<br>rapidshare.com/files/47329840/apc_Admin1.rar.html<br>можешь сам убедится посмотреть...
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150834&amp;user=2775&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=22" class="addthx" data-post="150834"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]r99[/b]','')">r99</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/314.gif" alt=""><br><span class=txtSm>Ранг: 328.7 (мудрец), 73thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=314">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 21:47 <br><script type="text/javascript">QU('r99','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r99" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<b>Maximus</b><br>у меня на 100-выполнении вылезали баги а ты 30
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150837&amp;user=314&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=23" class="addthx" data-post="150837"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 21:53 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<b>r99</b> да нет там ни каких багов до самого завершения программы <img src="img/smilies/s6.gif" alt="">
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150838&amp;user=2775&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=24" class="addthx" data-post="150838"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]YDS[/b]','')">YDS</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/132.jpg" alt=""><br><span class=txtSm>Ранг: 199.9 (ветеран), 4thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.92'>Активность: 0.12<span style='color:red'>&searr;</span>0.02</span><br>Статус: <a href="action=userinfo&amp;user=132">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 22:01 &middot; Поправил: YDS <br><script type="text/javascript">QU('YDS','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=YDS" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<b>r99</b><br>Что за способ - не знал раньше о таком. Только в этом случае не работает.<br>Единственное похожее место находится тут:<br>/*404A60*/  CMP ESI,EBX<br>/*404A62*/  JLE SHORT apc_Admi.00404A78<br>/*404A64*/  MOV EAX,DWORD PTR DS:[EDI+EBX*8]<br>/*404A67*/  INC EBX<br>/*404A68*/  MOV DWORD PTR DS:[5B4644],EBX<br>/*404A6E*/  TEST EAX,EAX<br>/*404A70*/  JE SHORT apc_Admi.00404A74<br>/*404A72*/  CALL EAX<br>/*404A74*/  CMP ESI,EBX<br>/*404A76*/  JG SHORT apc_Admi.00404A64<br>/*404A78*/  XOR EAX,EAX<br>/*404A7A*/  POP EDX<br>Последнее срабатывание происходит при EBX = 000000DD. Однако прыг через call EAX ничего не дает - триды с проверкой идут дальше.<br><br><b>Maximus</b><br>Если знаешь, что патчить - скажи, я попробую заинлайнить.<br><br><b>Add:</b> пока писал, уже опередили.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150842&amp;user=132&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=25" class="addthx" data-post="150842"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]r99[/b]','')">r99</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/314.gif" alt=""><br><span class=txtSm>Ранг: 328.7 (мудрец), 73thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=314">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 06 августа 2007 23:13 <br><script type="text/javascript">QU('r99','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r99" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
кусок лога от KAM v1.32<br>Log generated by KaKeeware Application Monitor, www.kakeeware.com <br>.......<br><br>005CA059 kernel32.dll -&gt; GetModuleFileNameA           --  file CRC check<br>mod = [00400000] F:\Program Files\Anyplace Control 4\apc_Admin.exe<br>arg = 001B4CB8, *arg = 001B0178<br>arg = 00003FFF (16383)<br>00703715 kernel32.dll -&gt; _lopen     -   <br>aStr = 001B4CB8 = F:\Program Files\Anyplace Control 4\apc_Admin.exe <br>arg = 00000000 (0)<br>7C85EA42 kernel32.dll -&gt; CreateFileA                           -- memory CRC check<br>aStr = 001B4CB8 = F:\Program Files\Anyplace Control 4\apc_Admin.exe <br>arg = 80000000 (-2147483648)<br>shareMode = [00000003] FILE_SHARE_READ | FILE_SHARE_WRITE<br>arg = 00000000 (0)<br>createDisp = [00000003] OPEN_EXISTING<br>flagsAndAttr = [00000000] <br>handle = [00000000] <br>005D0A6A kernel32.dll -&gt; CreateThread<br>arg = 00000000 (0)<br>size = 00000000 (0)<br>arg = 006852FF, *arg = U‹мйdи                                  &lt;---------стартовый адрес шреда<br>arg = 00000000 (0)<br>arg = 00000000 (0)<br>arg = 0012F960, *arg = 006B9BD4<br><br>итого:<br>1<br>  . [5ca059] &lt;--- 033  делаем возвращаемый хендл файла равным нулю - как будто нет файла и<br>    [6bae23] &lt;--89     суем 0 в название так как [ebp-4]=&quot;......\apc_Admin.exe&quot;,0<br><br>или как советовал YDS <br>  в [703718] - суем код чтобы поставить ZF=1   - то есть ошибка открытия файла<br><br><br>2<br> [6852ff]  &lt;-- 0c3
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150860&amp;user=314&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=26" class="addthx" data-post="150860"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 09:56 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
<b>r99</b> теперь понял откуда взял цыферь YDS<br>все работает, спасибо, тему пока закрывать не буду до полного отлома на случай если появятся вопросы еще
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=150910&amp;user=2775&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=27" class="addthx" data-post="150910"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]r99[/b]','')">r99</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/314.gif" alt=""><br><span class=txtSm>Ранг: 328.7 (мудрец), 73thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.84'>Активность: 0.17<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=314">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 07 августа 2007 10:54 <br><script type="text/javascript">QU('r99','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=r99" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
<I>YDS пишет:<br>Однако прыг через call EAX ничего не дает - триды с проверкой идут дальше. </I><br><br>нужно не прыг через call eax а занулять соответствующий dword.<br>необходимость в этом появляется (вспомнил) в упакованных прогах, когда начинаешь отрезать последние секции дампа и корректировать внутренний импорт криптора и появляется такая хрень:<br><br><I>pavka пишет:<br>бывает еще такая фигня когда фиксишь под разные оси начинает орать дебагер детектед ;) при запуске и терминатится .... </I>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=150923&amp;user=314&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=28" class="addthx" data-post="150923"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 августа 2007 06:16 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=1&amp;topic=9585.html&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
Прогу раздолбал (все таки апи слабое место всех протов), всем еще раз большое спасибо (без вас я бы не справился). Топег закрываю.<br><br>P.S: отдельное спасибо <b>r99</b> за то что доходчиво объяснил как, и точно показал где )))<br>P.S: Кому надо, скачать кряк можно на борде...
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=151111&amp;user=2775&amp;forum_n=1&amp;topic=9585.html&amp;page=0&amp;anchor=29" class="addthx" data-post="151111"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/green.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=1&sortBy=0&page=0.html"><b>Основной форум</b></a> <b class=bulletHead>&#8212;&#8250;</b> Помогите убить CRC проверки (ExeCryptor)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=9585" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
