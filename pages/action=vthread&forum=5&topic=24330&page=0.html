<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Смещение в DLL - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Всем привет. Хочу понять как работает смещение в длл, но пока безуспешно, возможно вопрос нубовской, но раздел все же для новичков вот на скрине в Оли Address    Hex dump           Command                          Comments">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=6859'>cppasm</a>, <a target='_blank' href='?action=userinfo&amp;user=55995'>tyns777</a>, <a target='_blank' href='?action=userinfo&amp;user=55996'>dutyfree</a>, <a target='_blank' href='?action=userinfo&amp;user=28016'>asfa</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Смещение в DLL</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]udman[/b]','')">udman</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24017">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 19:48 &middot; Поправил: udman <br><script type="text/javascript">QU('udman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=udman" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Всем привет. Хочу понять как работает смещение в длл, но пока безуспешно, возможно вопрос нубовской, но раздел все же для новичков <img src="img/smilies/s1.gif" alt=""><br>вот на скрине в Оли<br><br>Address       Hex dump                     Command                                                   Comments<br>0FAB767B    BA ACFD2111               MOV EDX,OFFSET chrome.1121FDAC             ; ASCII &quot;[BLOCKED]&quot;<br><br>вроде как понятно что по смещению 1121FDAC находится ASCII &quot;[BLOCKED]&quot; соответственно зная адрес 1121FDAC с помощью любого хекс редактора можно найти все что ссылается на этот адрес 1121FDAC что мне и надо<br><br><img src="http://s018.radikal.ru/i516/1609/62/6c2316519a58.png" border="0" align="" alt=""><br><br><br>но, когда открываешь хекс редактор и по слову [BLOCKED] находишь адрес то видишь что этот адрес не совпадает с тем который в Оли<br><img src="http://s017.radikal.ru/i417/1609/19/56a4b67b87d3.png" border="0" align="" alt=""><br><br>ну то такое, решил я посмотреть что ссылается на этот адрес, но увы ничего не нашел, потом я решил тем же хекс редактором с помощью хекс кодов в Оли найти то самое место где идет ссылка на [BLOCKED] и вот что получилось, в Оли хекс код один, а в хекс редакторе другой<br>BA ACFD2111<br>BA ACFDED11<br><br><img src="http://s019.radikal.ru/i604/1609/f0/6e3edd998286.png" border="0" align="" alt=""><br><br>ну да й ладно подумал я, начал искать это смещение которое  11 ED FD AC в хекс редакторе, но в итоге не нашел ничего, пробовал минусовать 400 000 и точку входа 0F340000 но у меня никак не получается выйти на адрес 1E DE 3A 0C который в хекс редакторе и на котором есть этот самый [BLOCKED]<br>собственно вопрос в том, как найти в хекс редакторе ссылки на этот [BLOCKED]?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367852&amp;user=24017&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=1" class="addthx" data-post="367852"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 19:54 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
вот такой инструмент вам нужно взять и потом понять почему FileOffset и Virtual Address не одно и тоже.<br><br><noindex><a href="http://hostingkartinok.com/show-image.php?id=5dcec5caccfc2d29f4845e4f66d01a1b" rel="nofollow" target="_blank"> <img src="http://s8.hostingkartinok.com/uploads/thumbs/2016/09/5dcec5caccfc2d29f4845e4f66d01a1b.png" border="0" align="" alt=""></a></noindex>
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=367853&amp;user=72&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=2" class="addthx" data-post="367853"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]udman[/b]','')">udman</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24017">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 19:56 <br><script type="text/javascript">QU('udman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=udman" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<I>Hellspawn пишет:<br>вот такой инструмент вам нужно взять и потом понять почему FileOffset и Virtual Address не одно и тоже. </I><br>а что это за инструмент если не секрет?))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367854&amp;user=24017&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=3" class="addthx" data-post="367854"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 20:08 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>udman пишет:<br>с помощью любого хекс редактора можно найти все </I><br><br>С помощью любого нельзя.<br><br>Кстати, есть такая прикольная тулза, называется <noindex><a href="http://www.manhunter.ru/releases/250_file_location_calculator_1_4.html" rel="nofollow" target="_blank">--&gt; &quot;File Location Calculator&quot; &lt;--</a></noindex>.<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367855&amp;user=35473&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=4" class="addthx" data-post="367855"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Tyrus[/b]','')">Tyrus</a></b><br></div>
<img src="img/s3.gif" alt=""><br><span class=txtSm>Ранг: 47.8 (посетитель), 16thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 12.1'>Активность: 0.02<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=16960">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 20:22 <br><script type="text/javascript">QU('Tyrus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Tyrus" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>udman</b><br>CFF Explorer
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367856&amp;user=16960&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=5" class="addthx" data-post="367856"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24017" title="22-09-2016 18:58, ранг:0.2" target="_blank">udman</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]udman[/b]','')">udman</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24017">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 20:32 <br><script type="text/javascript">QU('udman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=udman" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<img src="http://s1.radikali.ru/uploads/2016/9/22/cd45960956b0cbd9f5712899528c0587-full.png" border="0" align="" alt=""><br>ввел виртуал адрес, получил файл офсет, но все равно это никак не адрес на [BLOCKED]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367858&amp;user=24017&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=6" class="addthx" data-post="367858"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 20:50 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<b>udman</b><br>вычтете из него ImageBase, его можно в olly увидеть в memory map, и вводите в строку в RVA
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=367859&amp;user=72&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=7" class="addthx" data-post="367859"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24017" title="22-09-2016 18:57, ранг:0.2" target="_blank">udman</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 20:51 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<I>udman пишет:<br>ввел виртуал адрес, получил файл офсет, но все равно это никак не адрес на [BLOCKED]  </I><br>потому что введенный адрес основан на релоцированной базе, а калькулятор считает на основе оригинальной базы 0x10000000<br><br><I>udman пишет:<br><b>0FAB767B</b> BA ACFD2111 MOV EDX,OFFSET chrome.1121FDAC ; ASCII &quot;[BLOCKED]&quot; </I><br>выделенный адрес ЯВНО меньше 0x10000000, значит база ДЛЛ в памяти изменена.<br><br>в олли на вкладке с буквой Е (список модулей) найди свою длл и её базу.<br>потом ручками в калькуляторе рассчитай 0х1121FDAC - (та_самая_база), получишь RVA - относительный виртуальный адрес. дальше я думаю и так станет понятно
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367860&amp;user=26242&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=8" class="addthx" data-post="367860"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=24017" title="22-09-2016 18:57, ранг:0.2" target="_blank">udman</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]script_kidis[/b]','')">script_kidis</a></b><br></div>
<img src="img/s4.gif" alt=""><br><img style="padding-top:3px;" src="av/39388.jpg" alt=""><br><span class=txtSm>Ранг: 56.2 (постоянный), 14thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 5.01'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=39388">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 21:12 <br><script type="text/javascript">QU('script_kidis','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=script_kidis" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
на счёт смещения и разности хорошо,а для чего смотреть правильный адрес из олли в хексе там же опкоды<br> патч хотите создать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367861&amp;user=39388&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=9" class="addthx" data-post="367861"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]udman[/b]','')">udman</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24017">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 21:28 <br><script type="text/javascript">QU('udman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=udman" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>в олли на вкладке с буквой Е (список модулей) найди свою длл и её базу.<br>потом ручками в калькуляторе рассчитай 0х1121FDAC - (та_самая_база), получишь RVA - относительный виртуальный адрес. дальше я думаю и так станет понятно  </I><br>да, тут разобрался, теперь появился другой вопрос, возможно ли через хекс редактор узнать (та_самая_база)?<br><br>то есть цель такая, найти в хекс коде<br>[BLOCKED]<br>его текущий файл офсет 01EDE3AC, потом перевести его в РВА и потом уже с новым этим адресом посмотреть в хекс коде что на него ссылается?<br><br><b>Добавлено спустя 1 минуту</b><br><I>script_kidis пишет:<br>на счёт смещения и разности хорошо,а для чего смотреть правильный адрес из олли в хексе там же опкоды<br>патч хотите создать?  </I><br>да, хочу написать патч под хром, но проблема ровно в том что в каждой новой версии длл-ка и её адреса отличаются, конечно как вариант можно взять все версии хрома и каждую дллку обработать, но это нереальный геморой
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367862&amp;user=24017&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=10" class="addthx" data-post="367862"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 21:56 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>udman пишет:<br>возможно ли через хекс редактор узнать (та_самая_база)? </I><br>в данном случае та_самая_база - это адрес, по которому была загружена длл.<br>а загружается она туда, если её оригинальная база уже кем-то занята.<br>соответственно, статично определить это нельзя.<br>да и нет нужды, ведь есть RVA.<br><br><br><I>udman пишет:<br>то есть цель такая, найти в хекс коде [BLOCKED]<br>его текущий файл офсет 01EDE3AC, потом перевести его в РВА и потом уже с новым этим адресом посмотреть в хекс коде что на него ссылается?<br> </I><br>если это делается статично (тоесть работа с файлом а не с образом в памяти) - тогда используй ImageBase из хидера.<br>если это делается на лету (тоесть патчится память запущенного приложения) - тогда нужно сначала выяснить базовый адрес нужного модуля<br><br>между прочим, а на что конкретно нужно пропатчить? мож есть смысл строку менять, а не код?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367863&amp;user=26242&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=11" class="addthx" data-post="367863"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]udman[/b]','')">udman</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24017">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 22:07 &middot; Поправил: udman <br><script type="text/javascript">QU('udman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=udman" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>между прочим, а на что конкретно нужно пропатчить? мож есть смысл строку менять, а не код?  </I><br>надо пропатчить на возможность устанавливать расширения с ПК, с 33й версии они запретили это дело, но если перед ссылкой [BLOCKED] поменять всего лишь 1 байт и вместо JNE поставить JMP, то появляется снова возможность ставить расширения с компьютера, но для того чтобы найти этот JNE надо найти то самое место которое ссылется на [BLOCKED], отмотать пару десятков байт обратно и соответственно изменить его<br><br><br><I>-=AkaBOSS=- пишет:<br>если это делается статично (тоесть работа с файлом а не с образом в памяти) - тогда используй ImageBase из хидера. </I><br>я посмотрел через ХИЕВ ImageBase = 10000000, но увы это никак не помогает)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367864&amp;user=24017&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=12" class="addthx" data-post="367864"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 22:19 <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>udman пишет:<br>я посмотрел через ХИЕВ ImageBase = 10000000, но увы это никак не помогает)  </I><br>значит не той стороной пихаете<br>алгоритм примерно такой:<br>1. ищем строку в файле<br>2. полученное смещение пересчитываем в RVA<br>3. к нему плюсуем ImageBase - получился вполне себе искабельный виртуальный адрес<br>4. ищем этот адрес в файле (не забываем про little-endianess)<br>5. при нахождении референса, проверяем цепочку байт перед ним на наличие опкода jne<br>6. патчим, сохраняем и радуемся<br><br>а не вариант патчить ту самую функцию, результат которой проверяется перед jne?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367865&amp;user=26242&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=13" class="addthx" data-post="367865"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]udman[/b]','')">udman</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24017">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 22:51 <br><script type="text/javascript">QU('udman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=udman" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>алгоритм примерно такой:<br>1. ищем строку в файле<br>2. полученное смещение пересчитываем в RVA<br>3. к нему плюсуем ImageBase - получился вполне себе искабельный виртуальный адрес<br>4. ищем этот адрес в файле (не забываем про little-endianess)<br>5. при нахождении референса, проверяем цепочку байт перед ним на наличие опкода jne </I><br><br>такс, вроде как все понятно, но, как мне пересчитать в РВА не используя CFF Explorer?<br><br>на счет патчить функцию, то она в разных вариантах браузера разная, по этому тут только опираясь на [BLOCKED]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367866&amp;user=24017&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=14" class="addthx" data-post="367866"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 23:00 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>udman пишет:<br>как мне пересчитать в РВА </I><br><noindex><a href="http://uinc.ru/articles/41/#21" rel="nofollow" target="_blank"><u>дока на все времена</u></a></noindex><br><b><br>/к следующему посту</b><br><I>SReg пишет:<br>без дизасма никак </I><br>а зачем тут дизасм? к константам обращение идёт напрямую по вирт адресу, найти его не такая большая проблема<br>остаётся конечно вероятность словить вместо своей константы какие-то инструкции, но это вполне решаемо.<br>можно сделать проверку возможных байт перед найденной цепочкой байт.<br>можно подсчитать <u>реальное</u> количество референсов, и если патчер найдёт больше чем нужно, сообщить пользователю о необходимости что-то менять
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367867&amp;user=26242&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=15" class="addthx" data-post="367867"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 22 сентября 2016 23:37 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>udman пишет:<br>собственно вопрос в том, как найти в хекс редакторе ссылки на этот [BLOCKED]?  </I><br>в хекс редакторе? думаю без дизасма никак..<br><br><b>Добавлено спустя 37 минут</b><br><b>-=AkaBOSS=-</b><br>да я согласен что решаемо, но не по феншую <img src="img/smilies/s1.gif" alt=""><br>а в данном конкретном случае и нормального патерна для dUP&#039;a достаточно, зачем этот поиск ссылок.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367868&amp;user=18316&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=16" class="addthx" data-post="367868"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2016 00:16 <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
Зачем эти сложности?<br>Hiew религия использовать не позволяет?<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367869&amp;user=35473&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=17" class="addthx" data-post="367869"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]udman[/b]','')">udman</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24017">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2016 00:16 <br><script type="text/javascript">QU('udman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=udman" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>дока на все времена </I><br>перечитал несколько раз но так и не понял)) но все равно спасибо за многое, просветил реально во многом <img src="img/smilies/s1.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367870&amp;user=24017&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=18" class="addthx" data-post="367870"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]-=AkaBOSS=-[/b]','')">-=AkaBOSS=-</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/26242.png" alt=""><br><span class=txtSm>Ранг: 150.3 (ветеран), 175thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.88'>Активность: 0.16<span style='color:red'>&searr;</span>0.07</span><br>Статус: <a href="action=userinfo&amp;user=26242">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2016 00:50 &middot; Поправил: -=AkaBOSS=- <br><script type="text/javascript">QU('-=AkaBOSS=-','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=-=AkaBOSS=-" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>udman пишет:<br>перечитал несколько раз но так и не понял </I><br>да, за один раз всё вкурить может быть непросто.<br><br>ладно, разжую малость<br>чтобы из физического смещения получить RVA - потребуется прокурить PE-формат, хотя бы основные заголовки.<br>продравшись через него (e_lfanew+0x18+SizeOfOptionalHeader) до таблицы секций,  можно начинать работать<br>1. ищем секцию у которой PointerToRawData &lt;= нужное_нам_смещение &lt; (PointerToRawData+SizeOfRawData)<br>2. вычитаем из нужного_нам_смещения PointerToRawData найденной секции (получается смещение относительно начала секции)<br>3. и прибавляем VirtualAddress этой же секции (получается, собственно, RVA)<br>4. фсё<br><br>фактически, есть еще кой-какие тонкости, связанные с механизмом маппинга секций в память, однако я не думаю что для чистой непротекченной длл нужно их учитывать
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367871&amp;user=26242&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=19" class="addthx" data-post="367871"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]udman[/b]','')">udman</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24017">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2016 20:03 &middot; Поправил: udman <br><script type="text/javascript">QU('udman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=udman" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
<I>-=AkaBOSS=- пишет:<br>чтобы из физического смещения получить RVA - потребуется прокурить PE-формат, хотя бы основные заголовки.<br>продравшись через него (e_lfanew+0x18+SizeOfOptionalHeader) до таблицы секций, можно начинать работать<br>1. ищем секцию у которой PointerToRawData &lt;= нужное_нам_смещение &lt; (PointerToRawData+SizeOfRawData)<br>2. вычитаем из нужного_нам_смещения PointerToRawData найденной секции (получается смещение относительно начала секции)<br>3. и прибавляем VirtualAddress этой же секции (получается, собственно, RVA)<br>4. фсё<br> </I><br><br>вроде как разобрался с одной версией, решил открыть другую версию и все посчитать по новой, итого<br><img src="http://s1.radikali.ru/uploads/2016/9/23/ee2f29cfc42c9c2294f6ebe2f7ccd576-full.png" border="0" align="" alt=""><br>нашел вот файл офсет 1C2A7E0 где БЛОКЕД<br>дальше, считаю это дело в РВА и плюсую ImageBase итого получаю виртуальный адрес 03 85 B3 E0 <br><br>перевожу в little-endianess E0 B3 85 03<br><br><img src="http://s1.radikali.ru/uploads/2016/9/23/abd200d4d5ac1f389c1710048e3f9947-full.png" border="0" align="" alt=""><br><br>дальше захожу в хекс редактор, успешно нахожу значение и потом решаю перепроверить все в Оли, открываю и вижу это<br><br><img src="http://s1.radikali.ru/uploads/2016/9/23/76ce18bc1f2d828d024ea4a7c4d35cac-full.png" border="0" align="" alt=""><br><br>то есть хекс код найденный мной<br>E0 B3 85 03<br>а в Оли<br>E0 B3 02 05<br><br>почему так? что я не так сделал?<br><br>при этом всем код который в Оли, я не могу найти в хекс редакторе
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=367889&amp;user=24017&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=20" class="addthx" data-post="367889"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 23 сентября 2016 20:17 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>udman</b> ну опять 25, пчитайте про PE формат. это из-за релоков! видите, адрес в олли подчеркнут.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=367890&amp;user=72&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=21" class="addthx" data-post="367890"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 464thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 24 сентября 2016 01:35 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
всё банально просто в олли пкм&gt;view&gt;Executable file или Copy executablt&gt;selection&gt;save file
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=367897&amp;user=17432&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=22" class="addthx" data-post="367897"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]udman[/b]','')">udman</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24017">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 14:42 <br><script type="text/javascript">QU('udman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=udman" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
<I>ClockMan пишет:<br>всё банально просто в олли пкм&gt;view&gt;Executable file или Copy executablt&gt;selection&gt;save file </I><br>я знаю как в оли, в а делфи как?<img src="img/smilies/s5.gif" alt=""> <img src="img/smilies/s5.gif" alt=""> <img src="img/smilies/s5.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368092&amp;user=24017&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=23" class="addthx" data-post="368092"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]unknownproject[/b]','')">unknownproject</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 95.1 (постоянный), 247thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.52'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=27422">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 15:37 &middot; Поправил: unknownproject <br><script type="text/javascript">QU('unknownproject','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=unknownproject" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
<I>udman пишет:<br>я знаю как в оли, в а делфи как?  </I><br>Работа с бинарными файлами в любой нормальной книге описана.При желании можно допереть то, как читаются, перезаписываются и извлекаются блоки нужных данных.Этого никто разжевывать не будет.
<br><br><font size="1"><i>-----<br>TEST YOUR MIGHT</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=368094&amp;user=27422&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=24" class="addthx" data-post="368094"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]udman[/b]','')">udman</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24017">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 сентября 2016 19:57 <br><script type="text/javascript">QU('udman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=udman" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
<I>unknownproject пишет:<br>Работа с бинарными файлами в любой нормальной книге описана.При желании можно допереть то, как читаются, перезаписываются и извлекаются блоки нужных данных.Этого никто разжевывать не будет.  </I><br><br>мне выше уже разжевали и я все уже сделал, хорошо что все таки есть нормальные люди которые могут разжевать, даже если ты прочел книгу и все равно не понял
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368103&amp;user=24017&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=25" class="addthx" data-post="368103"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]udman[/b]','')">udman</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.47'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=24017">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 октября 2016 15:29 <br><script type="text/javascript">QU('udman','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=udman" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=24330.html&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
с х86 все работает как часы, с х64 просчитываю через CFF Explorer RVA перевожу его в little-endianess и не могу найти его в коде... кто-то может подсказать куда копать что читать?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=368292&amp;user=24017&amp;forum_n=5&amp;topic=24330.html&amp;page=0&amp;anchor=26" class="addthx" data-post="368292"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Смещение в DLL</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#27" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="24330">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=24330" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
