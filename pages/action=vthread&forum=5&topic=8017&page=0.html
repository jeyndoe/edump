<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>как найти в SI адрес внешнего файла? - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Помогите самому старому новичку. Вот вижу в SoftIce где прога закачала извне инфу в память и потом с ней работает. А вот как узнать путь к этому внешнему файлу (и, естессно, сам файл), с которым она(прога) общалась и откуда взяла">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a>, <a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=5602'>ut2004</a> (+6 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> как найти в SI адрес внешнего файла?</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]rask[/b]','')">rask</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.45'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9490">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 23:05 <br><script type="text/javascript">QU('rask','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rask" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Помогите самому старому новичку. Вот вижу в SoftIce где прога закачала извне инфу в память и потом с ней работает. А вот как узнать путь к этому внешнему файлу (и, естессно, сам файл),  с которым она(прога) общалась и откуда взяла инфу?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124565&amp;user=9490&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=1" class="addthx" data-post="124565"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]nice[/b]','')">nice</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 384.1 (мудрец)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.96'>Активность: 0.25<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=29">Участник</a><br><font color=blue>www.int3.net</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 26 февраля 2007 23:33 <br><script type="text/javascript">QU('nice','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=nice" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Как правило файл считывается с диска АПИ: ReadFile<br>но если ты поставишь брекпоинт на данную ф-ию, то сможешь найти только хэндл с которым она работает.<br>что бы определить название файла, тебе нужно использовать брекпоинты: CreateFileA или CreateFileW, в стеке ты увидишь путь к файлу
<br><br><font size="1"><i>-----<br>Подписи - ЗЛО! Нужно убирать!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=124567&amp;user=29&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=2" class="addthx" data-post="124567"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]rask[/b]','')">rask</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.45'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9490">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2007 00:30 <br><script type="text/javascript">QU('rask','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rask" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
Спасибо за совет! Сейчас попробую. Но Create - создание. Почему не Open? - по тем же причинам, что и Read?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124574&amp;user=9490&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=3" class="addthx" data-post="124574"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2007 01:17 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
В виндахх CreateFileA рубит в большинстве случаефф, OpenFile осталась от старой винды 3.11 или типа того. Есть также NtCreateFile и int 2Eh/sysenter. Имя файла в при срабатывании бряка удобно смотреть: d esp-&gt;4.
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=124578&amp;user=8962&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=4" class="addthx" data-post="124578"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]rask[/b]','')">rask</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.45'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9490">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2007 03:13 <br><script type="text/javascript">QU('rask','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rask" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
Что-то не получается... В буфере (памяти) появляется информация, явно считанная извне. То ли с DLL, то ли с файла, а может и из реестра? Ставлю бряк на чтение-запись в этот адрес. Вылетаю в SI. А откуда ты взялась в этом буфере? До того как - там было пусто. А бряк на Create так таки и не сработал. В этом месте (до момента появления данных).
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124602&amp;user=9490&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=5" class="addthx" data-post="124602"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2007 04:52 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
&gt; А откуда ты взялась в этом буфере?<br><br>Если сработал бряк(bpm), значит его вызвало выполнение какого-то кода в системе (DMA так не видно) - вот Sice в него и укажет (на команду/на следующую команду). В твоем случае это скорее всего код драйвера диска, копирующий данные в юзер-буфер.<br><br>&gt; А бряк на Create так таки и не сработал.<br><br>Убедицца надо шта у тебя вообще бряки на API работают. Так как при запуске приложения стопудейно читаюцца файлы, то CreateFileA тоже должен быть. Если нет, то скорее всего у тебя XP а в нем нужно сайсу сказать что работаешь с конкретным процессом (i3here? - поправьте кто знает). Короче, добейся чтобы у тебя вообще бряки на API работали. Можно, конечна, на NtCreateFile поставить, потом спустицца... но это не для coward&#039;офф ;)
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=124615&amp;user=8962&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=6" class="addthx" data-post="124615"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]rask[/b]','')">rask</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.45'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9490">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2007 09:40 <br><script type="text/javascript">QU('rask','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rask" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Бряки на API работают. При остановке по &quot;bpm (адрес памяти) w&quot; содержимое в указанном адресе становится равным определенному значению. До этого момента выхода SI по &quot;bpx CreateFile&#039; нет. Если пустить дальше, то останов, конечно, есть. Но это ведь уже другая история...  Это значение было записано откуда-то в указанный участок памяти раньше...  Причем именно в это место памяти и именно впервые, так как поиск до этого момента по всей области памяти результата не давал.  А вот откуда? Как узнать? Есть ли такая возможность в SoftIce? Можно, конечно, попробовать Filemon и Regmon, но это же кошмар - они показывают МОРЕ ключей и файлов даже при установленном фильтре. И, скорее всего, это значение сидит где-то там, вне программы, не в явном виде.<br>Извините за занудство.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124666&amp;user=9490&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=7" class="addthx" data-post="124666"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2007 11:05 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
1) Не окончательно понял - у тебя _вообще_ CreateFileA, именно &quot;A&quot; - работает?<br>2) Если не работает, попробуй NtCreateFile и вообще посмотри таблицу импорта этой проги;<br>3) Возьми кусок своего магического буфера в момент его записи в буфер и поищи на винте файло с таким содержимым;<br>4) Продолжи мониторить буфер через bpm, скорее всего тот, кто соберецца поиметь его - он же и вызвал чтение его из &quot;неизвестного источника&quot;;<br>5) Возможно этот буфер - часть самой проги или ее ресурсов, те его читает система при загрузке проги;<br>6) ...
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=124672&amp;user=8962&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=8" class="addthx" data-post="124672"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]rask[/b]','')">rask</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.45'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9490">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2007 21:10 <br><script type="text/javascript">QU('rask','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rask" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
Работает именно &quot;А&quot;, как и другие bpm &quot;SendMessageA&quot;, например. Вопрос чайника - как посмотреть таблицу импорта? С куском содержимого попробую, но мне кажется, что в файле содержимое не в явном виде. Я уже прошерстил поиском на нахождение пары &quot;слов&quot; в ASCII - ничего. Но то, что где-то сидит, однозначно, так как не может быть на установочном дистрибуте. Буду мониторить дальше, постепенно обучаясь... Меня в данном случае интересует именно технология отыскания пути/имени внешнего источника информации. И Вы мне уже много чего подсказали - спасибо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124710&amp;user=9490&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=9" class="addthx" data-post="124710"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Chingachguk[/b]','')">Chingachguk</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/8962.jpg" alt=""><br><span class=txtSm>Ранг: 113.0 (ветеран)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.51'>Активность: 0.05<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=8962">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 27 февраля 2007 23:38 <br><script type="text/javascript">QU('Chingachguk','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Chingachguk" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
&gt; Вопрос чайника - как посмотреть таблицу импорта?<br><br>Каким-нибудь редактором PE-файлофф или просто в FAR нажать F3/F4 и посмотреть конец файлика <img src="img/smilies/s2.gif" alt=""> Хотя (seldom) бывает что по ординалу.<br><br>&gt; нахождение пары &quot;слов&quot; в ASCII - ничего<br><br>Если байтики не равны 0x00 - те &quot;читаемые&quot;, то их можно поискать в файликах на всех винтах (я использую FAR).  Но если они &quot;нечитаемые&quot;, то для таких случаефф я писал свою программку.
<br><br><font size="1"><i>-----<br>The one derivative you manage is the one I abhore (c) Slipknot</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=124734&amp;user=8962&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=10" class="addthx" data-post="124734"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]HoBleen[/b]','')">HoBleen</a></b><br></div>
<img src="img/s6.gif" alt=""><br><img style="padding-top:3px;" src="av/5110.jpg" alt=""><br><span class=txtSm>Ранг: 240.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.09'>Активность: 0.19<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=5110">Участник</a><br><font color=blue>Author of ACKiller </font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2007 04:00 <br><script type="text/javascript">QU('HoBleen','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HoBleen" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Воспользуйся файлмоном - настрой фильтр на свою прогу и он тебе покажет ВСЕ обращения к файлам этой проги.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124792&amp;user=5110&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=11" class="addthx" data-post="124792"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]rask[/b]','')">rask</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.45'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9490">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 28 февраля 2007 05:27 <br><script type="text/javascript">QU('rask','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rask" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
Воспользовался и файлмоном и регмоном. Настроил фильтр на прогу и получил ВСЕ обращения - порядка 1500 строчек файлмона и много больше регмона. Поэтому и отловил Софтайсом момент появления отлавливаемой информации. А вот источник определить не могу. то ли реестр, то ли файл, то ли DLL.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=124799&amp;user=9490&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=12" class="addthx" data-post="124799"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 марта 2007 23:11 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>rask пишет:<br>А вот источник определить не могу. то ли реестр, то ли файл, то ли DLL. </I><br> Я понял, что тебя не сама работа с файлом интересует, а откуда взялось его имя ?! Это на самом деле сложный вопрос - придется ловить команды пересылки в памяти, пока не найдешь действительный источник. Т.е. после первого бряка смотришь из какой области памяти пересылают в буфер, ставишь бряк уже на эту область и перезапускаешь прогу. И так до &quot;посинения&quot;. Основная сложность в том, что можешь попасть на буфер, который используется тысячу раз для других дел.<br>  Вообщем переформулируй вопрос, тогда получишь помощь. На начальный вопрос лучше filemon ничего нет.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=125366&amp;user=4072&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=13" class="addthx" data-post="125366"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]rask[/b]','')">rask</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.45'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9490">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 04 марта 2007 10:05 <br><script type="text/javascript">QU('rask','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rask" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
И так до &quot;посинения&quot;... Да, так оно и получается... Меня интересует откуда берется некое СОДЕРЖИМОЕ - из файла, из регистра, из DLL? Если из файла, то его имя. Если из регистра - то ветка и ключ. Наставил бряков, вот, кажется уже и уши показались... Хвать - ан ничего опять и нет. То зависаю, то формируется окошко о &quot;Access violation&quot;. В общем, &quot;синею&quot; потихоньку. Да еще со временем туго... Но зато уже кое-что стал понимать, учусь потихоньку... Уже добрался до бряков на RegOpen и RegQueryValue из advapi32.dll. Спасибо за участие и советы.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=125483&amp;user=9490&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=14" class="addthx" data-post="125483"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]tundra37[/b]','')">tundra37</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 310.8 (мудрец), 29thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.32'>Активность: 0.43<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4072">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 05 марта 2007 22:06 <br><script type="text/javascript">QU('tundra37','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=tundra37" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>rask пишет:<br>Меня интересует откуда берется некое СОДЕРЖИМОЕ  </I><br> Это собственно и есть задача кракера - выяснить откуда что берется. А помочь можно только по конкретному случаю. Методы поиска две : прямая - берем подозреваемого и смотрим превратится ли он в то, что надо, или обратная - берем результат и ищем откуда он взялся. Ты напрасно выбрал вторую методу - она для новичков не годится. Точнее, я понял, что ты и результат не знаешь - так тяжело искать.<br> Но сам именно с этого в тяжелых случаях начинаю : просто смотрю откуда что берется - рано или поздно попадаешь на то, что нужно <img src="img/smilies/s7.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=125729&amp;user=4072&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=15" class="addthx" data-post="125729"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]rask[/b]','')">rask</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 1.8 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.45'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=9490">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 марта 2007 10:30 &middot; Поправил: rask <br><script type="text/javascript">QU('rask','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=rask" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=8017.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
Ну хорошо... Появилось подозрение, что прога работает с ключем реестра HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Shell Extensions\Approved\...  Попытался убрать его (естесс-но, со всеми предосторожностями), но на любые попытки (даже щелкнуть по нему мышью) идет сообшение, что ничего поделать нельзя - ошибка при открытии раздела. В то же время RegMon дает недвусчысленную инфу про обращение проги к этому ключу: на CreateKey - SUCCESS	Access: 0x1, на QueryValue - BUFFER TOO SMALL  и на это же далее - SUCCESS	66 61 66 6F 61 63 67 65 ... Ну и на CloseKey - SUCCESS. Что делать?<br>Конечно, может я залез не совсем туда, но хотелось бы проверить... <br><br>Нашел прошлогоднее обсуждение: <a href="http://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4170" target="_blank">http://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=4170</a> (Удаление защищенного ключа в реестре) - как раз мой вариант, но ответа на вопрос КАК УДАЛИТЬ там я не увидел... Видимо, ослабел мозгами...<br>Всем спасибо<br>PS. Впрос снят. Удалил ключ с помощью RTKF (Registry Trash Keys Finder). Прога черпала инфу действительно оттуда. То есть, прога защищена с помощью EXECryptor 2+<br>Еще раз ВСЕМ спасибо.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=127320&amp;user=9490&amp;forum_n=5&amp;topic=8017.html&amp;page=0&amp;anchor=16" class="addthx" data-post="127320"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> как найти в SI адрес внешнего файла?</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#17" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="8017">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=8017" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
