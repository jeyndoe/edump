<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>ASProtect 1.23 RC4 Demo почти повторение - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Была тут недавно тема, где один товарищ просил помочь распаковать ASProtect 1.23 RC4. А потом то ли распаковал и отвалил, то ли не смог и плюнул. В общем тема уползла в историю. А я чего-то увяз на этой проге и четвертый день">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=41701'>_MBK_</a>, <a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+4 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASProtect 1.23 RC4 Demo почти повторение</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Sturgeon[/b]','')">Sturgeon</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2007 13:13 <br><script type="text/javascript">QU('Sturgeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sturgeon" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Была тут недавно тема, где один товарищ просил помочь распаковать ASProtect 1.23 RC4. А потом то ли распаковал и отвалил, то ли не смог и плюнул. В общем тема уползла в историю. А я чего-то увяз на этой проге и четвертый день ковыряюсь с ней, обложившись туторами.<br>Stripper ее не берет. Распакованная прога вываливается с ошибкой (это вроде вышеупомянутый товарищ уже сообщал).<br><br>Как я понял <b>crc1</b> ковырялся с этой прогой, и не без успеха. Может подскажешь? Хотя если еще кто-нибудь поможет буду только рад. <br><br><br>[url=http://www.softnew.ru/process.phtml?action=load&amp;id=6884&amp;mirror=0&amp; PHPSESSID=639c33b50bcd1fc7453d91f1d1a0f63b]Remote Desktop Control 1.8  1.4Mb[/url<br><br><b>crc1</b> давал ссылку на тутор.<br><br>[quote]Тутор по адресу hack4joy.narod.ru/crack/arc4/arc4.htm один в один с этой прогой.[/quote] <br>Я бы так не сказал. <br>Значит, что я сам сделал. Ничего не получилось, правда, но все же опишу, может быть кто-то укажет на мои ошибки.<br><br><b><I>Ищем ОЕР.</b></I> По пути занопил magic CALL (кстати раньше не знал про такую штуку). А вот дальше не сходится, хотя это может у меня руки кривые. Ставим hr esp-4, и, по статье от ALEXa, должны брякнуться три раза. У меня получается бряк только один раз, а потом прога запускается. Ну да ладно, мы пойдем другим путем(с).<br><br>До ОЕР дошел проще. Дошел до последнего исключения. Мемори бряк на секцию кода и трассируем.<br><br><br>Попадаем на адрес <code>00406D54-FF2574224C00 JMP DWORD PTR DS:[4C2274]</code>. Поначалу тоже думал, что это ОЕР, но после прочтения туторов догнал, что это прыжок на эмуляцию GetModuleHandleA.<br><br>Выходим по РЕТ из эмуляции GetModuleHandleA. Проходим код по Ф8 по пути записывая ЕАХ (типа из спертых байтов)<br><br>еах=004BC2D4<br><br>Выходим по РЕТ на настоящую ОЕР.<br><code><br>004BC612      00            DB 00<br>004BC613   .  E8 3CA8F4FF   CALL apc_Admi.00406E54<br>004BC618   .  33C0          XOR EAX,EAX         &lt;-выходим здесь<br>004BC61A   .  55            PUSH EBP<br></code><br>Выше адреса 004BC612 расположены 23 ноля. Соответственно 23 спертых байта?<br><br>Опять же вопрос: где снимать дамп? В разных статьях советуют снимать то на ОЕП, то на джампе в GetModuleHandleA. Попробовал и там, и там.<br><br><b><I>Восстанавливаем импорт.</b></I> Запускаем ИмпРек (что характерно). ОЕР = BC618, размер ставим 1000. Восстанавливаем нераспознанные функции с помощью Trace Level1(Disasm). Все что не распозналось отрезаем нафиг.<br><br>Фиксируем импорт.<br><br><b><I>Спертые байты.</b></I> Тут засада. Следуя туторам, попадаю в код, замусоренный настолько, что с непривычки разобраться в нем не могу<img src="img/smilies/s9.gif" alt="">. Начинаются эти сперты байты с мусором с такого кода:  <br><code>00A36E71    61              POPAD<br>00A36E72   /EB 02           JMP SHORT 00A36E76<br>00A36E74   |CD20 F2EB010F   VxDJump F01EBF2<br>00A36E7A    83EC 39         SUB ESP,39<br></code><br>То ли это место, что нужно? И как выковырнуть отсюда правильные байты? Пока, для пробы, взял байты приведенные <b>crc1</b>. Попробовал вписать. Поменял Entry Point.<br><br>Итог: прога падает на обращениях к несуществующим адресам. Причем таких мест очень много, так что просто занопить их все нет возможности. <br>Я понимаю, что туторов по Аспру хоть пруд пруди, и желания разжевывать каждую отдельную прогу ни у кого нет. Но может быть кто-то уже распаковывал эту прогу и сможет помочь?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141172&amp;user=3305&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=1" class="addthx" data-post="141172"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2007 15:19 &middot; Поправил: Small_S <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
<b>Sturgeon</b> прогу не смотрел я на работе и ещё долго буду, по верхам. На <b>Восстанавливаем нераспознанные функции с помощью Trace Level1(Disasm). Все что не распозналось отрезаем нафиг. </b><br> <br> Когда восстанавливаю импорт после Аспра обязательно кроме  Trace Level1(Disasm) восстанавливаю повреждённые Аспром переходники плугом для импректа  ASProtect 1.23(так кажется зовётся). Приду домой если раньше не найдёшь приаттачу. Причём плуг ASProtect 1.22 не подходит(делает ошибки) из за этого часть функций не распознаётся.<br><br>В мусорном коде, как правило содержится, самое начало проги присущее тому или иному компилятору. Попробуй  в DIE загнать прогу прям запакованную и посмотри на чём написано, возьми несколько вариантов начал для скажем С и сверяй.<br><br>Судя по приведённому куску там в спёртой части нужно идти обратным трассированием(я надеюсь ты туда по трассировке попал?) по клавише - минус, уже подзабыл, давно 1.23 RC4 не ковырял. Ну а как в начале мусорного кода окажешся иди по шагу  вперёд и смотри переходы будут приводить к визуальному изменению кода. У тебя это место совсем другим будет:<br>00A36E74 |CD20 F2EB010F VxDJump F01EBF2 <br>00A36E7A 83EC 39 SUB ESP,39 <br><b>совершенно другим.</b><br>(видишь прыг не нормально на следующую команду, а между двумя командами JMP SHORT 00A36E76)<br>Такой дрянью вся секция выделенной памяти под VM в старших версиях аспра забита(всё плывёт при каждом шаге, модефицируется, куча байт пропускаются и по сути являются мусором и к тому же даже многие из тех команд, что выполняются ничего не делают Например SUB EAX, INC EAX).<br><br>Вот аттачу всем известный плагин. Сунь длл в папку с плагинами импректу.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141195&amp;user=9147&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=2" class="addthx" data-post="141195"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2007 16:24 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Sturgeon</b><br>В версии 1.23 RC4 мусорный код проходишь по F7, за исключением одного CALL&#039;a<br><code>00B97AAC        CALL 00B97A27           тут F8<br>00B97AB1         POPAD<br>00B97AB2         JMP SHORT 00B97AB6<br>00B97AB4         INT 20<br>00B97AB6         PREFIX REPNE:                           <br>00B97AB7         JMP SHORT 00B97ABA</code><br>Дальше идешь по F7 и внимательно смотришь и увидишь спертые команды<br><code>00B97B20      PUSH EBP<br>00B97B21       MOV EBP, ESP      <br>00B97B23       SUB ESP, 18          ; заменить на ADD ESP, -18 (три байта) </code><br>При выходе из мусорного кода на RET в EAX будет нужное значение  (004BC2D4)<br>Всего в данной проге своровано 11 (dec) байт<br><code>004BC608          PUSH EBP                                               ;OEP<br>004BC609           MOV EBP, ESP<br>004BC60B           ADD ESP, -18<br>004BC60E           MOV EAX, 004BC2D4</code><br>Импорт:  Trace Level1(Disasm), после него нужен плугин, или руками. Возможно неверно восстановится<br>ф-я LoadLibrary. Остальное допишу завтра<br>Вот распакованный       rapidshare.com/files/36949947/dump.rar.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141202&amp;user=423&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=3" class="addthx" data-post="141202"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 13 июня 2007 18:12 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Млин. На исправлении не аттачится. Вот.<br><br><img src="img/attach.gif" alt=""> <a href="./files/ad79_13.06.2007_CRACKLAB.rU.tgz">ad79_13.06.2007_CRACKLAB.rU.tgz</a> - ASPR_1.23-ImpREC_Plugin.dll
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141223&amp;user=9147&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=4" class="addthx" data-post="141223"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Sturgeon[/b]','')">Sturgeon</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2007 00:30 <br><script type="text/javascript">QU('Sturgeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sturgeon" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<b>crc1</b> Спасибо! Со спертым ОЕР разобрался. Меня сильно смущало то, что нолей на настоящем ОЕР было 23.<br><b>Small_S</b><br>Как я понял, в AsprRC4 несколько хитрее прячется ОЕР, чем в более ранних версиях. Т.е. обратной трассировкой я пробовал найти байты, но не получилось. Уж очень много мусора, да и непривычно в первый раз.<br>С импортом буду завтра с утра заморачиваться, а то уже поздно очень. Плаг к импреку у меня есть, спасибо. У меня вроде весь импорт восстановился, а отрезал я явный мусор (или это мне кажется что мусор:-\)<br>2 <b>crc1</b> А ты Magic Call нопил или нет? Насколько это вообще нужно? И дамп где снимал? На ОЕР или на джампе?<br><br>З.Ы. Долбаный Аспр! Уж сколько написано про него, а все равно с каждой отдельной прогой какие-то заморочки. Неожиданно возник вопрос. Здесь на форуме на двадцать вопросов об Аспре приходится один-два вопроса об Армадилло или Екзекрипторе. Неужели Аспр сложнее снять чем Арму или Криптор? Или просто они более стандартные? Сам я пока не берусь снимать такие проты, но в ближайше время хочу попробовать научиться снимать хотя бы ранние версии.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141275&amp;user=3305&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=5" class="addthx" data-post="141275"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2007 09:09 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
<b>Sturgeon</b><br>Приношу извинения, вчера поспешил с крадеными байтами. Их действительно 23 (dec) шт<br><code>00B97180          PUSH EBP<br>00B97181              MOV EBP, ESP<br>00B97183             SUB ESP, 18          ; заменить на ADD ESP, -18 (три байта)<br>00B97189            <b>JMP SHORT 00B9718C       ; это мусор</b><br>00B9718B            <b>NOP                         ; это мусор, я поменял на ноп  </b>             <br>00B9718C             PUSH EBX<br>00B9718D             XOR EAX, EAX<br>00B9718F             MOV DWORD PTR SS:[EBP-10], EAX<br>00B97192             MOV DWORD PTR SS:[EBP-18], EAX<br>00B97195             MOV DWORD PTR SS:[EBP-14], EAX</code><br>OEP == 004BC5FC<br>Дамп снимай как только распаковалась секция кода, (но можно на OEP)<br>Magic Call можно не нопить, плагин ASPR_1.23 нормально восстанавливает импорт, за исключением ф-ии<br>LoadLibraryA (путает с GetModuleHandleA) (может только у меня?)<br>Если прога падает на обращениях к несуществующим адресам, забей нулями третью секцию<br>Тут нормально распакованный файл<br>rapidshare.com/files/37103825/dump.rar.html
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141295&amp;user=423&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=6" class="addthx" data-post="141295"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]Sturgeon[/b]','')">Sturgeon</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2007 11:45 <br><script type="text/javascript">QU('Sturgeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sturgeon" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
Твой дамп замечательно работает. А у меня снова жопа<img src="img/smilies/s9.gif" alt=""><br>Пробовал сравнивать побайтно два файла (твой и мой). Совершенно одинаковые, за исключение небольших отличий в адресах таблицы импорта.<br>Мой файл первый раз падает по следующему адресу:<br><code><br>004021E9   &gt; \C1F8 02       SAR EAX,2<br>004021EC   .  8B15 8C144C00 MOV EDX,DWORD PTR DS:[4C148C]<br>004021F2   .  8B5482 F4     MOV EDX,DWORD PTR DS:[EDX+EAX*4-C] &lt;- Здесь Memory violation<br>004021F6   .  85D2          TEST EDX,EDX<br></code><br>Хотя твой файл выполняет этот код без проблем.<br>Может быть это связано как раз с неправильным распознаванием LoadLibraryA? Я просто не знаю как узнать правильно она определилась или нет. <br>Вот мой нерабочий (к сожалению) дамп<br><br>slil.ru/24511811
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141328&amp;user=3305&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=7" class="addthx" data-post="141328"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2007 16:21 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
<code>00405A22    MOV DWORD PTR SS:[EBP-8], EAX<br>00405A25     PUSH 00405B94                            ; ASCII &quot;kernel32.dll&quot;<br>00405A2A      CALL &lt;JMP.&amp;kernel32.GetModuleHandleA&gt;       <b> Должно быть LoadLibraryA</b><br>********************************************************************** ********<br>0040D440          PUSH EBX<br>0040D441       PUSH 0040D478                            ; ASCII &quot;kernel32.dll&quot;<br>0040D446    CALL &lt;JMP.&amp;kernel32.GetModuleHandleA&gt;       <b>Аналагична</b></code><br><br><I>Sturgeon пишет:<br>004021F2 . 8B5482 F4 MOV EDX,DWORD PTR DS:[EDX+EAX*4-C] &lt;- Здесь Memory violation </I><br><I>crc1 пишет:<br>забей нулями третью секцию </I>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141391&amp;user=423&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=8" class="addthx" data-post="141391"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]Sturgeon[/b]','')">Sturgeon</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2007 20:18 <br><script type="text/javascript">QU('Sturgeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sturgeon" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
По поводу восстановления LoadLibraryA.<br>Когда я в Импреке восстанавливаю импорт, каким образом можно определить, что функция восстановилась неправильно? Допустим, что теперь я знаю, что функция LoadLibraryA может восстановиться как GetModuleHandleA. Но как из восьми функций GetModuleHandleA опознать те, которые должны быть на самом деле LoadLibraryA?<br><br><I>crc1 пишет:<br>crc1 пишет: <br>забей нулями третью секцию </I><br>В смысле секцию .adata? Только теперь доперло. А то я по недалекости своей забивал нолями третью по счету, то  есть секцию после .code<img src="img/smilies/s1.gif" alt="">. А если ее отрезать вобще нафиг? Сейчас попробую...
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141421&amp;user=3305&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=9" class="addthx" data-post="141421"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 14 июня 2007 22:38 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
<b>Sturgeon</b> на <b>Но как из восьми функций GetModuleHandleA опознать те, которые должны быть на самом деле LoadLibraryA?<br></b> так запусти дамп в оле и когда упадёшь смотри в окно стека, там обычно такая верхняя строка:<br>адрес такой то из(from) от туда то запоминаешь откуда и перегружаешь Олю.<br>Контрал +G и переходишь по этому адресу и смотришь почему падает(это как бы общий алгоритм).<br><br>А в случае с неправильно распознанной функой <br><br>1) Смотриш в центральное окно CPU и видишь вызов АПИ на котором падает например(это первая попавшаяся прога)<br>00402442   |.  2E:FF15 BCD08000           CALL DWORD PTR CS:[&lt;&amp;gdi32.SetTextColor&gt;]        ; \SetTextColor<br>Вот этот вызов берет из секции где таблица ИАТ по адресу <b>BCD08000</b> нужный адрес АПИ функи <br>точнее это адрес 0080D0BC (знаешь наверное что адреса читаются в памяти справа налево побайтно).<br>То же самое(контрал +G) в окне дампа и туда этот адрес (0080D0BC) у тебя там так же перевернуто будет<br><br>0080D0B8 &gt;77F1B4F7  чґсw  GDI32.SetPixel<br>0080D0BC &gt;<b>77F15D97</b>  —]сw  GDI32.SetTextColor==========вот она <br>0080D0C0 &gt;77F1BAF2  тєсw  GDI32.StretchBlt<br>0080D0C4 &gt;77F17EE5  е~сw  GDI32.TextOutW<br><br>меняешь режим на HEX/UNICOD(16bytes) этот режим Long, в нём удобно смотреть, но вбивают изменения в хексе, как обычно выделил перешёл в хекс режим пробел клавиша и вбиваешь нужный адрес АПИ какая тебе нужна. И сохраняешь изменения в дампе.<br><br>Ну и всё запускаешь по новой, если упал там же то не угадал нужно вернуть на родину как было, если упал позже то повторяешь маневры.<br><br>Вот тебе прога(не помню откуда качал), она по имени функи определяет её адрес на твоёй системе. См аттач.<br><br><br><img src="img/attach.gif" alt=""> <a href="./files/1517_14.06.2007_CRACKLAB.rU.tgz">1517_14.06.2007_CRACKLAB.rU.tgz</a> - прога для определения API адрессов на этом компе у любой функции.rar
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141432&amp;user=9147&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=10" class="addthx" data-post="141432"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]Small_S[/b]','')">Small_S</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 72.7 (постоянный)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.49'>Активность: 0.08<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=9147">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 04:15 <br><script type="text/javascript">QU('Small_S','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Small_S" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
Сорри, совершил описку вчера по усталости. В предыдущем посте читай не <br>&quot;Ну и всё запускаешь по новой, если упал там же то не угадал <b>нужно вернуть на родину как было</b>, если упал позже то повторяешь маневры. &quot;<br>а значит не угадал и есть ещё какой то вариант (АПИ вообще какая то вызывается другая).<br>Пост побоялся править, иногда аттачи после правки слетают.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141454&amp;user=9147&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=11" class="addthx" data-post="141454"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 07:55 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>Sturgeon пишет:<br>Но как из восьми функций GetModuleHandleA опознать те, которые должны быть на самом деле LoadLibraryA? </I><br>При восстановлении импорта после аспра я иногда натыкался на грабли, когда Импрек вместо LoadLibraryA<br>определял GetModuleHandleA. Если библиотека отображена в адресном пространстве вызывающего процесса, то все ОК,  GetModuleHandleA вернет дискриптор библы. А если библиотека еще не загружена?<br>Тогда произойдет ошибка. Т.е. в такой конструкции<br><code>00405A25  PUSH 00405B94                            ; ASCII &quot;kernel32.dll&quot;<br>00405A2A    CALL &lt;JMP.&amp;kernel32.LoadLibraryA&gt;<br>00405A2F    MOV EBX, EAX<br>00405A31     TEST EBX, EBX<br>00405A33     JE SHORT 00405A75<br>00405A35    PUSH 00405BA4                            ; ASCII &quot;GetLongPathNameA&quot;<br>00405A3A      PUSH EBX<br>00405A3B     CALL &lt;JMP.&amp;kernel32.GetProcAddress&gt;</code><br>лучше LoadLibraryA (она загрузит dll и вернет дискриптор), потому что вместо kernel32.dll может быть имя библы, еще не загруженной в контекст проги.<br>Третья секция это не .adata, а третья сверху она без названия, начинается с адреса 004С1000 <br>Тут это обсуждалось<br><a href="http://exelab.ru/f/action=vthread&amp;topic=6624&amp;forum=1&amp;page=-1" target="_new">http://exelab.ru/f/action=vthread&amp;topic=6624&amp;forum=1&amp;page= -1</a>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141467&amp;user=423&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=12" class="addthx" data-post="141467"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]Sturgeon[/b]','')">Sturgeon</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 08:03 <br><script type="text/javascript">QU('Sturgeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sturgeon" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
Так... До функций доберусь чуть попозже.<br>Пока не могу понять почему падает дамп. Секцию забил нолями, но все равно падает по тому же адресу, что и выше. Блин, почему так?<img src="img/smilies/s9.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141469&amp;user=3305&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=13" class="addthx" data-post="141469"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Sturgeon[/b]','')">Sturgeon</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 15 июня 2007 17:52 &middot; Поправил: Sturgeon <br><script type="text/javascript">QU('Sturgeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sturgeon" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
2 [crc1] Чего то я туплю <br>Забил нолями секцию, а прога все равно падает. Только теперь на другой ошибке:<br><code>00403CD8   &gt; \F0:FF42 F8    LOCK INC DWORD PTR DS:[EDX-8]                     ;  LOCK prefix<br>00403CDC   &gt;  8710          XCHG DWORD PTR DS:[EAX],EDX  &lt;-Access violation<img src="img/smilies/s9.gif" alt=""><br>00403CDE   .  85D2          TEST EDX,EDX </code><br>Может это праблы с неправильным дампом? Если есть свободное время и если не трудно, не мог бы ты посмотреть мой дамп (приаттачен выше). Можно ли из него сделать правильно работающий?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141570&amp;user=3305&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=14" class="addthx" data-post="141570"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]crc1[/b]','')">crc1</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 138.7 (ветеран), 135thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.79'>Активность: 0.11<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=423">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 июня 2007 23:26 <br><script type="text/javascript">QU('crc1','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=crc1" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
Со slil.ru скачать не могу и че толку если я сделаю твой дамп рабочим. Ты сам разберись.<br> Кароче<br><code>Тормознись тут<br>00B332B0  MOV EAX, DWORD PTR SS:[EBP+C]<br>00B332B3  PUSH EAX<br>00B332B4  CALL 00B32F00<br>00B332B9  CALL 00B3313C                 ; как ты называешь Magic Call<br>иди до RET<br><br>00B3354D  POP EBX                       ; Выйдешь сюда<br>00B3354E  JMP SHORT 00B3351E<br>00B33550  POPAD                         ; сюда ставь бряк что бы пройти цикл  и F9<br>00B33551  CALL 00B33590                 ; тут жми F7<br>00B33556  PUSH 0B3355F<br>00B3355B  INC DWORD PTR SS:[ESP]<br>00B3355E  RETN<br><br>дойдешь до сюда<br>00B3359C  MOV DWORD PTR FS:[EAX], ESP<br>00B3359F  XOR DWORD PTR DS:[EAX], EAX  ; SEH<br>00B335A1  JMP SHORT 00B335A4           ; сюда бряк и Shift+F9  <br>чуть ниже будет код<br>00B335FC  PUSHAD<br>00B335FD  PUSH 0B363AC<br>00B33602  LEA EAX, DWORD PTR SS:[EBP-C]<br>00B33605  PUSH DWORD PTR DS:[B37AA4]       <br>00B3360B  CALL DWORD PTR DS:[EAX]<br>00B3360D  POPAD                        ; тут снимай дамп, т.к. секция кода распакована и IAT заполнена</code><br>Восстанавливай импорт, Trace Level1(Disasm) +  ASPR_1.23-ImpREC_Plugin.dll, все API восстановятся<br>На LoadLibraryA (в данной проге)не обращай внимания, прикручивай спертые байты, правь OEP <br>ВСЕ, 10 минут работы. Только что проделал все вышесказанное, дамп пашет<br>Я тебе пересказал статью Alex&#039;a. Ты наверн плохо ее читал<img src="img/smilies/s13.gif" alt="">  Найди хоть одно отличие(кроме адресов)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141739&amp;user=423&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=15" class="addthx" data-post="141739"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]Sturgeon[/b]','')">Sturgeon</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 105.9 (ветеран), 1thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.56'>Активность: 0.09<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3305">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 июня 2007 10:35 <br><script type="text/javascript">QU('Sturgeon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Sturgeon" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=9048.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>crc1</b><br>Приношу свои извинения за глупые и истеричные вопросы. Все праблы как обычно были следствием собственной невнимательности<img src="img/smilies/s9.gif" alt=""> Неправильно вписывал спертые байты.<br>Разобрался, слава Богу!<br>Огромное спасибо за помощь, советы и терпение!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=141934&amp;user=3305&amp;forum_n=5&amp;topic=9048.html&amp;page=0&amp;anchor=16" class="addthx" data-post="141934"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> ASProtect 1.23 RC4 Demo почти повторение</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#17" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="9048">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=9048" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
