<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Как дождаться загрузки Модуля для получения Адреса загрузки - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Добрый день! Мне требуется узнать адрес загрузки - сторонней библиотеки &quot;Nwindow.dll&quot; которая загружается в 1 приложение, проблема в том что то место откуда я внедряю свой код(точнее библиотека &quot;Ogg.dll&quot;))">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=40607'>vsv1</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как дождаться загрузки Модуля для получения Адреса загрузки</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]bolvai[/b]','')">bolvai</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.5'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=40090">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 14:41 &middot; Поправил: bolvai <br><script type="text/javascript">QU('bolvai','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bolvai" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Добрый день! Мне требуется узнать адрес загрузки - сторонней библиотеки &quot;Nwindow.dll&quot; которая загружается в 1 приложение, проблема в том что то место откуда я внедряю свой код(точнее библиотека &quot;Ogg.dll&quot;)) загружается намного раньше чем NWindow.dll, и по этому всякий раз когда я выполняю GetModuleHandle - подобным образом -<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">HMODULE&nbsp;<span class="hl_function"><b>inc</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;GetModuleHandle<span class="hl_char">(</span><span class="hl_quote">&quot;NWindow.dll&quot;</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>if</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">!</span><span class="hl_char">(</span><span class="hl_function"><b>inc</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;GetModuleHandle<span class="hl_char">(</span><span class="hl_quote">&quot;NWindow.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span>{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wsprintfA<span class="hl_char">(</span>buffer<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;%d&quot;</span><span class="hl_char">,</span>&nbsp;GetLastError<span class="hl_char">(</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBoxA<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;buffer<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;buffer error&quot;</span><span class="hl_char">,</span>&nbsp;MB_OK<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;else{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wsprintfA<span class="hl_char">(</span>buffer<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;inc: 0x%08X\n&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_function">inc</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBoxA<span class="hl_char">(</span><span class="hl_number">0</span><span class="hl_char">,</span>&nbsp;buffer<span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;buffer addr&quot;</span><span class="hl_char">,</span>&nbsp;MB_OK<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;}</li>        </ol>
    </div>
</div></div>
 получаю ноль - 126(не найдено) , так же пробовал сделать через LoadLibrary, но таким образом нарушалась цепочка вызова и программа попросту не запускалась, еще пробовал сделать while loop, т.е псевдо способ дождаться загрузки модуля.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>while</b></span>&nbsp;<span class="hl_char">(</span><span class="hl_char">(</span>UInterfaceBar&nbsp;<span class="hl_char">=</span>&nbsp;GetModuleHandle<span class="hl_char">(</span>TEXT<span class="hl_char">(</span><span class="hl_quote">&quot;NWindow.dll&quot;</span><span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_char">)</span>&nbsp;<span class="hl_char">=</span><span class="hl_char">=</span>&nbsp;<span class="hl_number">0</span><span class="hl_char">)</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sleep<span class="hl_char">(</span><span class="hl_number">100</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
 <br>но в результате программа попросту зависала, как правильно следует дождаться загрузки модуля через код, либо может есть другой способ ?<br>Пытаюсь решить эту проблему уже несколько дней - но не как не выходит, подскажите пжлста !
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362666&amp;user=40090&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=1" class="addthx" data-post="362666"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 14:49 <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
sleep()
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362667&amp;user=35473&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=2" class="addthx" data-post="362667"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]Kaimi[/b]','')">Kaimi</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 60.6 (постоянный), 87thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.85'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 14:50 <br><script type="text/javascript">QU('Kaimi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kaimi" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
https://msdn.microsoft.com/en-us/library/dd347461(v=vs.85).aspx
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362668&amp;user=26297&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=3" class="addthx" data-post="362668"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 14:52 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
<I>Kaimi пишет:<br>https:/ </I><br>- <br>[This function may be changed or removed from Windows without further notice.]
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362669&amp;user=35473&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=4" class="addthx" data-post="362669"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 14:53 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
ну например так: LdrLoadDll
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=362670&amp;user=72&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=5" class="addthx" data-post="362670"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 14:59 <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
Если вызывать sleep() в DllMain - то она и будет зависать. <br>Это ж очевидно - DLL не закончила инициализацию и другие библиотеки не загружаются.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362671&amp;user=35473&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=6" class="addthx" data-post="362671"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]bolvai[/b]','')">bolvai</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.5'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=40090">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 15:00 <br><script type="text/javascript">QU('bolvai','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bolvai" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>Kaimi пишет:<br>https://msdn.microsoft.com/en-us/library/dd347461(v=vs.85).aspx <br> </I><br>А примерный код можно взглянуть(в упрошенной форме)<br>То что тут нашел https://github.com/strobejb/sslhook/blob/master/sslhook/modnotify.cpp немного замудрено для разных целей.<br><I>Hellspawn пишет:<br>ну например так: LdrLoadDll <br> </I><br>Так если я загружу библиотеку раньше чем это требуется, это разве не вызовет проблем ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362672&amp;user=40090&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=7" class="addthx" data-post="362672"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Hellspawn[/b]','')">Hellspawn</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/72.gif" alt=""><br><span class=txtSm>Ранг: 990.2 <font color=red>(<b>! ! !</b>)</font>, 380thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 15.95'>Активность: 0.68<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=72">Модератор</a><br><font color=blue>Author of DiE</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 15:13 <br><script type="text/javascript">QU('Hellspawn','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Hellspawn" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
ты можешь перехватить функцию и следить за загрузкой модулей.<br>либо ждать загрузки в отдельном потоке, гоняя цикл с GetModuleHandle.
<br><br><font size="1"><i>-----<br>[nice coder and reverser]</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=362673&amp;user=72&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=8" class="addthx" data-post="362673"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]bolvai[/b]','')">bolvai</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.5'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=40090">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 15:18 &middot; Поправил: bolvai <br><script type="text/javascript">QU('bolvai','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bolvai" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<I>Hellspawn пишет:<br>либо ждать загрузки в отдельном потоке, гоняя цикл с GetModuleHandle.  </I><br>Можно чуточку по подробнее про это и про LdrRegisterDllNotification ?<br>Я просто раньше не сталкивался с подобным - но эта древняя библиотека 2006 -года, генерирует адреса динамически(и самих функций и адрес загрузки), от запуска к запуску они разные.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362674&amp;user=40090&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=9" class="addthx" data-post="362674"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]kunix[/b]','')">kunix</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 71.2 (постоянный), 33thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.53'>Активность: 0.05<span style='color:green'>&nearr;</span>0.12</span><br>Статус: <a href="action=userinfo&amp;user=19260">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 15:18 <br><script type="text/javascript">QU('kunix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kunix" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
Господа, а нельзя ли загрузить модуль NWindow.dll без запуска DllMain (а также опционально загрузки зависимостей, вызовов TLS), чтобы хендл был уже валидный, а попозже модуль загрузится полноценно в обычном порядке родной программой?<br>Вроде в LoadLibraryExW есть интересные флажки, но я туда сам не лез.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362675&amp;user=19260&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=10" class="addthx" data-post="362675"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 15:25 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
<I>kunix пишет:<br>Господа, а нельзя ли загрузить модуль NWindow.dll без запуска DllMain  </I><br><br>Потом, при реальной загрузке, уже будет другой адрес.<br><br><I>bolvai пишет:<br>Я просто раньше не сталкивался с подобным - но эта древняя библиотека 2006 -года, генерирует адреса динамически(и самих функций и адрес загрузки), от запуска к запуску они разные.<br> </I><br><br>При чём тут древность?<br>На какой системе запускаете это всё?<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362676&amp;user=35473&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=11" class="addthx" data-post="362676"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]kunix[/b]','')">kunix</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 71.2 (постоянный), 33thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.53'>Активность: 0.05<span style='color:green'>&nearr;</span>0.12</span><br>Статус: <a href="action=userinfo&amp;user=19260">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 15:29 &middot; Поправил: kunix <br><script type="text/javascript">QU('kunix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kunix" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>dosprog пишет:<br>Потом, при реальной загрузке, уже будет другой адрес. </I><br>Ну это смотря какой механизм применить. Если сначала As Data File - то при реальной загрузке будет другой адрес.<br>А если как-то еще?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362678&amp;user=19260&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=12" class="addthx" data-post="362678"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 15:31 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>kunix пишет:<br>А если как-то еще?  </I><br><br>На Vista+ говнюки ввели механизм ASLR - специально, чтобы воспрепятствовать подобным экспериментам.<br>- Специально, гады, рандомизируют адреса загрузки модулей. <br>(если модули имеют таблицу перемещений)<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362679&amp;user=35473&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=13" class="addthx" data-post="362679"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]Kaimi[/b]','')">Kaimi</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 60.6 (постоянный), 87thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.85'>Активность: 0.06<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=26297">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 15:34 <br><script type="text/javascript">QU('Kaimi','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Kaimi" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>bolvai пишет:<br>А примерный код можно взглянуть(в упрошенной форме)<br>То что тут нашел https://github.com/strobejb/sslhook/blob/master/sslhook/modnotify.cpp немного замудрено для разных целей. </I><br>Да по ссылке вроде все просто.<br>Вот еще какой-то пример<br>http://www.programmershare.com/3522318/<br>или вот<br>http://stackoverflow.com/questions/4242469/detect-when-a-module-dll-is-unloaded
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362680&amp;user=26297&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=14" class="addthx" data-post="362680"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]kunix[/b]','')">kunix</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 71.2 (постоянный), 33thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.53'>Активность: 0.05<span style='color:green'>&nearr;</span>0.12</span><br>Статус: <a href="action=userinfo&amp;user=19260">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 15:41 <br><script type="text/javascript">QU('kunix','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=kunix" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>dosprog пишет:<br>На Vista+ говнюки ввели механизм ASLR - специально, чтобы воспрепятствовать подобным экспериментам.<br>- Специально, гады, рандомизируют адреса загрузки модулей. <br>(если модули имеют таблицу перемещений) </I><br><br>Вы меня слишком примитивно поняли, я не предлагаю загружать и потом выгружать, а потом опять загружать.<br><br>Я предлагаю загрузить частично, через LoadLibraryEx (,,DONT_RESOLVE_DLL_REFERENCES)<br>или LoadLibraryEx (,, LOAD_LIBRARY_AS_IMAGE_RESOURCE).<br><br>Скорее всего не выйдет, так как, например, LoadLibraryEx (,,LOAD_LIBRARY_AS_DATAFILE) с последующим LoadLibrary() загрузит image два раза и вернет два разных хендла.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362681&amp;user=19260&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=15" class="addthx" data-post="362681"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]bolvai[/b]','')">bolvai</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.5'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=40090">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 16:06 <br><script type="text/javascript">QU('bolvai','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bolvai" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<I>dosprog пишет:<br>На какой системе запускаете это всё? </I><br>под Win8.1 приложение x86 (игра), есть более новые версии этой самой игры и та же самая библиотека имеет статичные адреса, которые генерирует IDA, и их можно напрямую инжектить, а с этой версией такое не срабатывает.<br>  <I>Kaimi пишет:<br>http://www.programmershare.com/3522318/<br>или вот<br>http://stackoverflow.com/questions/4242469/detect-when-a-module-dll-is-unloaded  </I><br>Сейчас попробую
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362683&amp;user=40090&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=16" class="addthx" data-post="362683"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]dosprog[/b]','')">dosprog</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 431.7 (мудрец), 390thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 6.95'>Активность: 0.73<span style='color:red'>&searr;</span>0.32</span><br>Статус: <a href="action=userinfo&amp;user=35473">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 19:20 &middot; Поправил: dosprog <br><script type="text/javascript">QU('dosprog','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=dosprog" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>bolvai пишет:<br>под Win8.1 приложение x86 (игра), </I><br><br>Пробуйте под WinXP. А то начинаются какие-то непонятные описания с &quot;генерированием библиотекой динамических адресов&quot;...<br><i class=x><br></i>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362696&amp;user=35473&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=17" class="addthx" data-post="362696"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]bolvai[/b]','')">bolvai</a></b><br></div>
<img src="img/s1.gif" alt=""><br><span class=txtSm>Ранг: 4.2 (гость)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 4.5'>Активность: 0.02<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=40090">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 21:49 <br><script type="text/javascript">QU('bolvai','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=bolvai" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
<I>dosprog пишет:<br>генерированием библиотекой динамических адресов&quot;... </I><br>Это я забыл вам упоминать - основную причину того - почему мне требуется адрес загрузки, в этом приложении(игре) адресное пространство функций генерируется от запуска к запуску с разными значением, было к примеру 9330000, а потом стало 9320000, по этому те функции что мне сгенирировала IDA имеют не совсем верный адрес уже в памяти, т.е была функци по адресу sub_1008F870(В иде),а в итоге она будет в памяти по адресу (sub_1008F870-ImageBase)+Тот самый адрес загрузки - который как раз не постоянный.<br><br>В общем посмотрел я на применение
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">LdrRegisterDllNotification</li>        </ol>
    </div>
</div></div>
 и это слишком муторно, много доп кода ради простого ожидания, кто то говорил про внедрение дополнительно потока и цикла внутри него - как это будет выглядеть в коде - может кто пример скинуть пжлста ?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362701&amp;user=40090&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=18" class="addthx" data-post="362701"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]v00doo[/b]','')">v00doo</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 80.6 (постоянный), 194thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 7.07'>Активность: 0.1<span style='color:red'>&searr;</span>0.04</span><br>Статус: <a href="action=userinfo&amp;user=35168">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 08 февраля 2016 23:22 &middot; Поправил: v00doo <br><script type="text/javascript">QU('v00doo','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=v00doo" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=5&amp;topic=23998.html&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>bolvai пишет:<br>дресное пространство функций генерируется от запуска к запуску с разными значением </I><br>Почитал бы уже про и примеры погуглил, уже даже сказали.<br>https://ru.wikipedia.org/wiki/ASLR<br>Кстати вариант с ожиданием в потоке, как сказал <b>Hellspawn</b>, кажется тут самым простым.<br><I>bolvai пишет:<br> по этому те функции что мне сгенирировала IDA имеют не совсем верный адрес уже в памяти </I><br>Не генерирует она ничего, они идут от базы (ImageBase) все так же, ты описываешь тот же ASLR, хотя могу ошибаться, но скорее всего все именно так, отключить да проверить.<br><I>bolvai пишет:<br> есть более новые версии этой самой игры и та же самая библиотека имеет статичные адреса </I><br>Измени тогда хидер либы, отключи ASLR
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=362708&amp;user=35168&amp;forum_n=5&amp;topic=23998.html&amp;page=0&amp;anchor=19" class="addthx" data-post="362708"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/nub.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=5&sortBy=0&page=0.html"><b>Вопросы новичков</b></a> <b class=bulletHead>&#8212;&#8250;</b> Как дождаться загрузки Модуля для получения Адреса загрузки</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#20" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="5">
<input type="hidden" name="topic" value="23998">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=23998" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
