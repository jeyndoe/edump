<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Многослойное динамическое шифрование (пример полиморфного кода на C/C++) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Везде так много говорится о крутости шифрования кода на лету и даже не просто шифрования, а ещё и многослойного, но нигде я что-то не могу найти примера, который бы на пальцах показывал что это такое. Может есть у кого самый">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b><a target='_blank' href='?action=userinfo&amp;user=31361'>zds</a>, <a target='_blank' href='?action=userinfo&amp;user=1288'>UniSoft</a>, <a target='_blank' href='?action=userinfo&amp;user=7823'>ManHunter</a>, <a target='_blank' href='?action=userinfo&amp;user=1533'>rmn</a> (+5 невидимых)</b></span>
</td>
</tr>
</table>

 

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Многослойное динамическое шифрование (пример полиморфного кода на C/C++)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=19478&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=19478&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2012 18:55 <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Везде так много говорится о крутости шифрования<br>кода на лету и даже не просто шифрования, а ещё<br>и многослойного, но нигде я что-то не могу найти<br>примера, который бы на пальцах показывал что это<br>такое.<br><br>Может есть у кого самый минимальный-минимальный<br>пример на си, который показывает суть методики<br>многослойного шифрования кода, чтобы сразу<br>стало понятно что такое многослойное, а что такое<br>однослойное шифрование?<br><br>В идеале хотелось бы пример, который можно было <br>бы скопировать в файл a.cpp и запустить <br><br>c:\&gt; g++ a.cpp &amp;&amp; a.exe<br><br>PS. я на этом форуме новенький, мне хочется попросить<br>администрацию добавить к кнопкам style=&quot;cursor:pointer&quot;<br>куда с этим вопросом обращаться?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299210&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=1" class="addthx" data-post="299210"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2012 19:32 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Многослойное шифрование есть почти в любом коммерческом протекторе (кроме пожалуй говновмпротекта). Вряд ли есть пример кода на паблике. Обходится крякерами элементарно и не оправдывает затраченного времени на программирование. Как пример могу привести обход двухслойного шифрования у темиды:<br>http://www.exelab.ru/f/action=vthread&amp;forum=13&amp;topic=19415<br>(раздел InLine Themida)<br><br>На деле никто не будет париться с вашими слоями, а просто перехватят ваш первый вызов API когда программа сама себя полностью расшифрует.
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299218&amp;user=2775&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=2" class="addthx" data-post="299218"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2012 21:58 <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
&gt; раздел InLine Themida<br><br>спасибо конечно за пример, я изучил, очень интересно,<br>но мой вопрос был продиктован не верой в возможности<br>горячего шифрования кода как защитного средства,<br>а желанием понять как именно это шифрование реализуется<br>на C/C++<br><br>я не смог найти ни одного примера который бы<br>по самому минимуму показал бы сам принцип<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>int</b></span>&nbsp;flag&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">2</span><span class="hl_comment">;</span></li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;enok<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;{&nbsp;<span class="hl_char">:</span><span class="hl_char">:</span>flag<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_comment">; }</span></li><li class="hl_l0"><span class="hl_function"><b>void</b></span>&nbsp;exam<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;{&nbsp;<span class="hl_function"><b>int</b></span>&nbsp;die<span class="hl_char">[</span><span class="hl_number">1</span><span class="hl_char">]</span><span class="hl_comment">; int p = die[::flag]; }</span></li>        </ol>
    </div>
</div></div>
<br><br>как на этом простом примере средствами си<br>можно продемонстрировать минимальное<br>двойное шифрование кода (например, ксором)<br><br>то есть хочется увидеть не как многослой<br>выглядит в дебаггере, а как он выглядит<br>на си<br><br>&gt; когда программа сама себя полностью расшифрует.<br><br>что я понял из мануалов:<br><br>1. если во время работы программы существует <br>принципиальная точка когда весь код в памяти<br>становится расшифрованным, тогда и шифровать<br>не стоило вообще<br><br>2. в любой момент времени программу важно <br>экпонировать в память лишь частично актуальной<br><br>это чем-то похоже на организацию преступных схем:<br>ни один исполнитель не должен знать всю схему,<br>а только свою часть, после выполнения которой<br>его лучше убить (как в &quot;форсаж 4&quot; <img src="img/smilies/s1.gif" alt=""><br><br>&gt; просто перехватят ваш первый вызов API<br><br>3. самое уязвимое место крякера - это<br>тоже самое, что и самое уязвимое место<br>обычного разработчика - тесты, т.е. приемка<br>изделия заказчиком<br><br>кряк по большому счету ничем не отличается<br>от обычной добработки и стало быть у крякера<br>те же самые проблемы, что и у обычного<br>доработчика - нестабильная работа после<br>внесения изменений<br><br>если создатель защиты внутри думает,<br>что есть отдельно модуль защиты, а есть<br>отдельно моя программа, тогда он напишет<br>её слишком инкапсулированно, у неё будут<br>слабые сайд-эффекты и в неё будет очень<br>комфортно вносить правки. к этому стремится<br>любой хороший архитектор<br><br>а построение защиты - это как раз наоборот -<br>чем больше спагетти и лоскутков, тем больше<br>у крекера шансов случайно создать сайд-эффект<br><br>идеальаня защита - это когда крякнутая<br>программа работает в 90% случаев<br><br>мне где-то попадалось такое сравнение:<br>вы заходите в лифт, нажимаете кнопку,<br>но лифт не едет, нажимаете ещё раз -<br>не едет, нажимаете трейтий раз, лифт<br>едет и как обычно привозит на 12-ый этаж,<br>но всю поездку вы будете на измене <br>потому что не будете знать наверняка -<br>доедете или застрянете<br><br>создание вот этого легкого безумия -<br>вот в чем цель защиты программы:<br>вроде всё нормально, вроде всё вылечили,<br>а внутри все равно какой-то легкий зуд,<br>а вдруг и многих заказчиков этот легкий<br>зуд может довести до ночных кошмаров<br>и они вернутся в легальные отношения<br>чисто чтобы это безумие закончилось<br><br>имхо, конечно
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299228&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=3" class="addthx" data-post="299228"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 16 января 2012 22:15 <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Это мог написать только человек достаточно отдаленный от крекинга. На деле все намного проще. Многослойность обходится, регистрационные схемы обходятся, любая проверка на целостность так же обходится путем перехватов соответсвующих АПИ. При должном опыте крякера лифт приезжает на 12 этаж в 100 случая из ста. Из опыта я совершенно точно вам могу сказать что день написания защитного кода сводится к нескольким минутам для крекера (а фигли, ломать то не строить ;)... Тоесть можете прикинуть сколько вам придется потратить времени что бы крякер просидел с вашей программой хотя бы день.<br><br>Статья на которую я вам дал ссылку есть универсальный способ обхода одного из самых мощных на сегоднящий день протекторов. Он обладает максимальным функционалом защиты на сегоднящний день (можете почитать описание набрав в яндексе название), однако, как видно, программам им защищенным это мало помогает. Таже участь постигнет и вашу самописную защиту при должной популярности программы (готов побиться на 1000 рублей)
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299229&amp;user=2775&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=4" class="addthx" data-post="299229"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="5" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 01:41 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#5" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#5');return false;">#5</a> </span><div align=left><br>
<i class=x>Полнейший наглый оффтоп. Пламенный привет Арчеру...</i><br><b>wowfactor</b><br>Так сойдет:<br><br>&lt;img src=&quot;./img/button_url.gif&quot; width=&quot;23&quot; height=&quot;23&quot; border=&quot;0&quot; alt=&quot;Вставить ссылку&quot; style=&quot;cursor: pointer; cursor: hand;&quot; onmouseover=&quot;window.status=&#039;Вставить ссылку&#039;; return true&quot; onmouseout=&quot;window.status=&#039;&#039;; return true&quot; onclick=&quot;JavaScript:di(&#039;[url=&#039;,&#039;]--&gt; Link &lt;--[/url]&#039;);&quot; /&gt;<br><br>?<br><br>P.S. Сдул концепт у Лебедева.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299231&amp;user=2449&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=5" class="addthx" data-post="299231"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="6" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 03:16 &middot; Поправил: wowfactor <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#6" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#6');return false;">#6</a> </span><div align=left><br>
&gt; человек достаточно отдаленный от крекинга<br><br>я не крекрер, я прикладной программист,<br>потому что имхо прикладное программирование<br>приносит в разы больше денег, чем крякание,<br>не говоря уже о законной стороне вопроса<br><br>&gt; многослойность обходится<br>&gt; регистрационные схемы обходятся<br>&gt; любая проверка на целостность так же обходится<br><br>вы как бы исходите из предположения, что типа<br>я утверждаю обратное. вы думаете, что я типа <br>не в курсе, что в принципе лечится все<br><br>так вот: я в курсе <img src="img/smilies/s1.gif" alt=""><br><br>&gt; при должном опыте крякера лифт приезжает<br>&gt; на 12 этаж в 100 случая из ста<br><br>я лишь поделился более крутой концепцией,<br>которую пока не встречал, что защита - это<br>сознательный баг<br><br><b>сознательно<br>пишешь<br>баг</b><br><br>лично мне эта концепция взрывает мозг <img src="img/smilies/s1.gif" alt=""><br> <br>&gt; день написания защитного кода сводится <br>&gt; к нескольким минутам для крекера<br><br>это высшая планка<br><br>&#036;500 за работу<br>&#036;1 - за удар молотка<br>&#036;499 - за знание куда и как ударить<br><br>в екате таких немного, а те, кто есть на них <br>клиенты фиг выйдут, потому что сами крекеры <br>на открытый контакт идти опасаются из-за УК рисков,<br>а вебманисхемы пугают заказчиков, что типа <br>их могут кинуть, проще продолжать со мной работать<br><br>&gt; самых мощных на сегодняший день протекторов<br><br>по-моему даже есть где-то статья, никогда<br>не пользуйтесь протекторами, потому что на каждый<br>протектер уже есть туториал<br><br>&gt; при должной популярности программы (готов <br>&gt; побиться на 1000 рублей) <br><br>наш софт никогда не выйдет на должную популярность,<br>он продается чисто активкой, у нас даже сайта<br>нет, потому что он тупо не нужен. есть только<br>апдейт-сервер и всё<br><br>к нам много приходят через сарафанное радио,<br>вот этот канал передачи софта и хотелось бы<br>прикрыть, чтобы друзьям не раздавали, а меня<br>рекомендовали + мы берем ежегодную плату (такая<br>ценовая модель)<br><br>2 int <br>&gt; Так сойдет?<br><br>конечно! супер!<br><br>странно, что на кнопках редактора их сделали,<br>а на самой нажимаемой кнопке &quot;Отправить сообщение&quot;<br>не сделали. даже на кнопке SSL сделали ...<br><br>я помню когда ещё 100 лет назад писал вебинтерфейс<br>к своей первой CRM меня клиенты каждый день долбали<br>чтобы я все элементы, которые можно нажимать были<br>бы с пальцем, а сегодня через много лет, вот сам<br>придираюсь <img src="img/smilies/s1.gif" alt=""><br><br>вот ещё до кучи<br>долго объяснять - проще было сразу накатать<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">function&nbsp;wikinice<span class="hl_char">(</span><span class="hl_char">$</span><span class="hl_function">out</span><span class="hl_char">)</span></li><li class="hl_l1">{</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_char">.</span>whoseQuote<span class="hl_char">,</span>&nbsp;<span class="hl_char">.</span>quote&nbsp;{&nbsp;width<span class="hl_char">:</span>&nbsp;<span class="hl_number">60</span><span class="hl_char">%</span><span class="hl_comment">; margin: 0; padding: 5px; } </span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_char">.</span>whoseQuote&nbsp;{&nbsp;&nbsp;background<span class="hl_char">:</span>#BFC3C6<span class="hl_comment">; font-weight:bold;  } </span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;<span class="hl_char">.</span>quote&nbsp;{&nbsp;background<span class="hl_char">:</span>#CFD3D6<span class="hl_comment">; font-size: small }</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">$</span><span class="hl_function"><b>out</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;preg_replace<span class="hl_char">(</span><span class="hl_quote">&quot;/^2 (.+)$/im&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;&lt;div class='whoseQuote'&gt;$1&lt;/div&gt;&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">$</span><span class="hl_function">out</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;&nbsp;&nbsp;&nbsp;<span class="hl_char">$</span><span class="hl_function"><b>out</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;preg_replace<span class="hl_char">(</span><span class="hl_quote">&quot;/^&gt; ?(.*)$/im&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;&lt;div class='quote'&gt;$1&lt;/div&gt;&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">$</span><span class="hl_function">out</span><span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;<span class="hl_char">$</span><span class="hl_function"><b>out</b></span><span class="hl_comment">;</span></li><li class="hl_l1">}</li>        </ol>
    </div>
</div></div>
<br><br><br>&gt; P.S. Сдул концепт у Лебедева. <br><br>я не знал, что это его идея<br><br>у нас в екате другую его идею обожают:<br>при наведении на ссылку она становится красной
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299233&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=6" class="addthx" data-post="299233"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="7" onfocus="this.blur()" href="JavaScript:di('[b]int[/b]','')">int</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 101.0 (ветеран), 344thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.1'>Активность: 1.15<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=2449">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 03:29 <br><script type="text/javascript">QU('int','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=int" target="_blank">Личное сообщение</a> &middot;  <a href="#7" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#7');return false;">#7</a> </span><div align=left><br>
<I>wowfactor пишет:<br>я не знал, что это его идея </I><br>Ну не то чтобы его идея, просто нашел хорошее объяснение целесообразности такого приема (вот <noindex><a href="http://www.artlebedev.ru/tools/technogrette/html/links/" rel="nofollow" target="_blank">линк</a></noindex>, кстати статья не самого Лебедева, а человека из его команды).<br><br><I>wowfactor пишет:<br>странно, что на кнопках редактора их сделали,<br>а на самой нажимаемой кнопке &quot;Отправить сообщение&quot;<br>не сделали. даже на кнопке SSL сделали ... </I><br>Форум создавался на базе miniBB допиливанием его разными людьми (в итоге от miniBB, кроме внешности, мало что осталось), у которых либо было мало времени, либо мало опыта и у них (у нас <img src="img/smilies/s2.gif" alt=""> ) разные стили HTML-верстки и методов программирования логики. Поэтому, понятное дело, применялась копи-паста, встречается разностильный код, а рефакторинг откладывается каждый раз (только время появится, и тут же как на зло, время забирает что-то другое).<br><br>P.S. Беседу по поводу движка лучше перенести в отдельный тред или Личные Сообщения, если будем дальше продолжать.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299234&amp;user=2449&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=7" class="addthx" data-post="299234"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="8" onfocus="this.blur()" href="JavaScript:di('[b]Maximus[/b]','')">Maximus</a></b><br></div>
<img src="img/s7.gif" alt=""><br><img style="padding-top:3px;" src="av/2775.jpg" alt=""><br><span class=txtSm>Ранг: 392.8 (мудрец), 108thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.75'>Активность: 0.26<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=2775">Участник</a><br><font color=blue>REVENGE сила, БеХоЦе могила</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 10:00 &middot; Поправил: Maximus <br><script type="text/javascript">QU('Maximus','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Maximus" target="_blank">Личное сообщение</a> &middot;  <a href="#8" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#8');return false;">#8</a> </span><div align=left><br>
&gt;я не крекрер, я прикладной программист<br>Не поверишь, я тоже прикладной программист с почти 20 летним стажем <img src="img/smilies/s6.gif" alt=""><br><br>&gt;сознательно пишешь баг<br>и вот этим я занимаюсь как раз все 20 лет <img src="img/smilies/s5.gif" alt=""> <img src="img/smilies/s5.gif" alt=""> <img src="img/smilies/s5.gif" alt=""><br><br>&gt;проще продолжать со мной работать<br>Это еще одна ошибка. Есть этот форум, есть рубоард, я Вас уверяю что заказаов лично мне хватает с головой, или если быть честным хватает через край. Со временем появляются к тому же еще и постоянные клиенты. Так что вероятность того что я буду ковырять ваши слои очень велика, но вы, конечно, об этом никогда не узнаете <img src="img/smilies/s6.gif" alt=""><br><br>&gt;потому что на каждый протектер уже есть туториал<br>А вот это правильный совет, все именно так и обстоит <img src="img/smilies/s1.gif" alt=""><br><br>Пойми простую вещь<br>Представь, ты первый раз в жизни написал защиту, сделав это так, как все мы делаем что то первый раз в жизни - каряво и потратив на это кучу времени. А ее будет разбирать человек, который до этого разобрал 500 таких же вот горе защит, или защит сделанных намного лучше или профессиональных защит. Сам понимаешь что перевес будет на его стороне. Кроме того ты все таки прикладной программист, и время приходится тратить на прикладную программу. И вот это драгоценное время ты будешь тратить впустую на защиту. Тоесть вместо того что бы улучшить код своей чудопрограммы ты будешь делать горезащиту, которая как потом окажется и не защита вовсе, а один сплошной глюк.<br><br>Я уже старожил этого форума, я видел тут даже профессионалов, писателей сильных защит, которые сначала тут гнали понты и которых потом тутошние ребята опускали по полной (можешь поискать тут по слову ExeCryptor). Так что совет тебе от старого программиста:<br>Брось ты это дело и займись написанием и улучшением прикладной программы, а не защиты ее.
<br><br><font size="1"><i>-----<br>StarForce и Themida ацтой!</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299235&amp;user=2775&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=8" class="addthx" data-post="299235"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=14629" title="17-01-2012 09:29, ранг:202.0" target="_blank">sendersu</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="9" onfocus="this.blur()" href="JavaScript:di('[b]SergX[/b]','')">SergX</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 226.0 (наставник), 67thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 13.08'>Активность: 0.16<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=11974">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 12:04 &middot; Поправил: SergX <br><script type="text/javascript">QU('SergX','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SergX" target="_blank">Личное сообщение</a> &middot;  <a href="#9" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#9');return false;">#9</a> </span><div align=left><br>
<b>Maximus</b> не одобряет защиты ))<br><br>В данном топе <b>Maximus</b> решил показать мастер класс и ломануть софтинку прямо в сознании разраба. Нейролингвистический реверс так сказать )))
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299236&amp;user=11974&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=9" class="addthx" data-post="299236"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=21589" title="17-01-2012 08:52, ранг:105.6" target="_blank">_ruzmaz_</a>, <a href="action=userinfo&user=3232" title="17-01-2012 09:54, ранг:788.6" target="_blank">PE_Kill</a>, <a href="action=userinfo&user=2777" title="18-01-2012 23:33, ранг:372.6" target="_blank">daFix</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="10" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 12:24 <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#10" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#10');return false;">#10</a> </span><div align=left><br>
&gt; Беседу по поводу движка лучше перенести в отдельный <br>&gt; тред или Личные Сообщения, если будем дальше продолжать.<br><br>лично мне теме оффтопика добавить нечего - двигатель<br>отличный и других серьезных пожеланий у меня нет<br><br>я правда уже неделю не могу найти, где закачивается<br>аватарка, но это непринципиально <img src="img/smilies/s1.gif" alt=""><br><br>а пожелания типа<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">$</span><span class="hl_function"><b>out</b></span>&nbsp;<span class="hl_char">=</span>&nbsp;preg_replace<span class="hl_char">(</span><span class="hl_quote">&quot;/\*\*(.*)\*\*/isU&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_quote">&quot;&lt;b&gt;$1&lt;/b&gt;&quot;</span><span class="hl_char">,</span>&nbsp;<span class="hl_char">$</span><span class="hl_function">out</span><span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br>это сликшом индивидуально, поэтому про них<br>лучше помолчать<br><br>&gt; пойми простую вещь<br><br>все, что вы написали по этому поводу<br>правда и я это отлично осознаю<br><br>&gt; сначала тут гнали понты<br><br>это опять все разновидности веры <br>в принципиальную возможность реальной<br>защиты<br><br>&gt; есть этот форум, есть рубоард<br><br>в моем случае речь скорее о другом. в природе <br>80% конфликтов завершается на уровне рыка<br>и лишь 20% доходят до реального применения<br>силы. задача моей защиты страшно рявкнуть,<br>чтобы спугнуть тех, кто крякает по туториалам<br><br>2 SergX<br>&gt; ломануть софтинку прямо в сознании разраба<br><br>я именно это и имел ввиду: написание защиты<br>в голове туториалного краякера-одногодки<br><br>просто кадры типа Maximus&#039;a за 20 лет крякания<br>забыли что такое страх и думают, что все<br>такие смелые как они <img src="img/smilies/s1.gif" alt=""><br><br>= = = = = = = = = = = = = = = = = = = = = = = = = = = =<br><br>&gt; я буду ковырять ваши слои<br><br><b>мой изначальный вопрос актуален до сих пор <img src="img/smilies/s1.gif" alt=""><br><br>если у кого-то есть самый простой пример<br>на си, демонстрирующий чем отличается двухслойное<br>шифрование от трех- или пятислойного, пожалуйста,<br>поделитесь кодом</b>
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299237&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=10" class="addthx" data-post="299237"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="11" onfocus="this.blur()" href="JavaScript:di('[b]SReg[/b]','')">SReg</a></b><br></div>
<img src="img/s7.gif" alt=""><br><span class=txtSm>Ранг: 315.1 (мудрец), 631thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.78'>Активность: 0.3<span style='color:green'>&nearr;</span>0.33</span><br>Статус: <a href="action=userinfo&amp;user=18316">Модератор</a><br><font color=blue>CrackLab</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 13:01 <br><script type="text/javascript">QU('SReg','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=SReg" target="_blank">Личное сообщение</a> &middot;  <a href="#11" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#11');return false;">#11</a> </span><div align=left><br>
раз уж тут оффтоп, то позволю высказатся. <br><I>wowfactor пишет:<br>задача моей защиты страшно рявкнуть </I><br>Не совсем верно, имхо. Т.к. это например некоторых это только лишь бы подзадорило &quot;довести дело до конца&quot;.<br>Я бывает пишу киген к какой нить никому не нужной проге неделю. т.к. &quot;зацепила&quot; защита. Написал - поклацал - удалил и забыл. Даже бывает расстроился немного, что квест заончился.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299240&amp;user=18316&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=11" class="addthx" data-post="299240"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="12" onfocus="this.blur()" href="JavaScript:di('[b]HandMill[/b]','')">HandMill</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 222.2 (наставник), 115thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4554">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 13:24 <br><script type="text/javascript">QU('HandMill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HandMill" target="_blank">Личное сообщение</a> &middot;  <a href="#12" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#12');return false;">#12</a> </span><div align=left><br>
<I>wowfactor пишет:<br>если у кого-то есть самый простой пример<br>на си, демонстрирующий чем отличается двухслойное<br>шифрование от трех- или пятислойного, пожалуйста,<br>поделитесь кодом</I><br>вообще суть вопроса не понятна. А изначально поставленный вопрос:<br><I>wowfactor пишет:<br>Везде так много говорится о крутости шифрования<br>кода на лету и даже не просто шифрования, а ещё<br>и многослойного, но нигде я что-то не могу найти<br>примера, который бы на пальцах показывал что это<br>такое.</I><br>формулировал ребёнок с отсутствием малейших понятий о машинном коде. <b>wowfactor</b>, в одном лишь си жизни нет, ещё вроде как никто не слепил компилятор си, который бы генерировал базонезависимый код, не говоря уже о с++. Как только такое появится хоть в одном компилере - можно будет подумывать о каком-то там &quot;многослойном шифровании кода&quot;, но прямиком из-под компиля такого не видать. Каждый разработчик таких защит клепает свой комбайн самостоятельно: из си и ассемблера. И для многослойной упаковки утилиты разработчиков проходятся по откомпилированному коду не один раз. Прям хлебопечку хочешь - пхай в неё си, а она тебе на выход многослойно упакованный код))) Можно смело закрывать топик, поскольку с тобой никто кодом не поделится ввиду того что кода на одном лишь си нет, и надеюсь ты понял, что быть не может. Могут быть лишь собственные инструменты, пойди на форум Themida&#039;ы или StarForce поклянчи там, может дадут.
<br><br><font size="1"><i>-----<br>все багрепорты - в личные сообщения</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299244&amp;user=4554&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=12" class="addthx" data-post="299244"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="13" onfocus="this.blur()" href="JavaScript:di('[b]PE_Kill[/b]','')">PE_Kill</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3232.gif" alt=""><br><span class=txtSm>Ранг: 793.4 <font color=magenta>(<b>! !</b>)</font>, 568thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.59'>Активность: 0.74<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=3232">Участник</a><br><font color=blue>Шаман</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 14:08 <br><script type="text/javascript">QU('PE_Kill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=PE_Kill" target="_blank">Личное сообщение</a> &middot;  <a href="#13" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#13');return false;">#13</a> </span><div align=left><br>
<I>HandMill пишет:<br>вообще суть вопроса не понятна </I><br>Просто ТС не знает основ. Он хочет написать код на Си, чтобы он был многослойно пошифрован, т.е. не прибегая к внешним утилитам, что невозможно. Нужно написать код, проставить маркеры, внешней утилитой найти маркеры и пошифровать, дописать дешифровщики или сразу воткнуть их в код через дефайны. Если линкуется с динамической базой, то еще и релоки учесть. Короче понт это всё, писать довольно трудоемко, а дешифровать в несколько минут.
<br><br><font size="1"><i>-----<br>Yann Tiersen best and do not fuck</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299250&amp;user=3232&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=13" class="addthx" data-post="299250"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="14" onfocus="this.blur()" href="JavaScript:di('[b]ClockMan[/b]','')">ClockMan</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/17432.jpg" alt=""><br><span class=txtSm>Ранг: 568.2 (<b>!</b>), 465thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.99'>Активность: 0.55<span style='color:green'>&nearr;</span>0.57</span><br>Статус: <a href="action=userinfo&amp;user=17432">Участник</a><br><font color=blue>оптимист</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 14:17 <br><script type="text/javascript">QU('ClockMan','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=ClockMan" target="_blank">Личное сообщение</a> &middot;  <a href="#14" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#14');return false;">#14</a> </span><div align=left><br>
<I>wowfactor пишет:<br>я не крекрер, я прикладной программист,потому что имхо прикладное программированиеприносит в разы больше денег, чем крякание </I><br>крякер+прикладной программист зарабатывает намного больше чем обычный программист<img src="img/smilies/s3.gif" alt=""> <br><I>wowfactor пишет:<br>по-моему даже есть где-то статья, никогдане пользуйтесь протекторами, потому что на каждыйпротектер уже есть туториал </I><br>Туториал это для чайников и новичков,программа накрывать всяким говном только неудачники,расспостранёный софт вообще ничем непакуют, там берегут свои нервы.<br><b>wowfactor</b><br>Вы лучше улучшайте код в своих программах чтоб у пользователя возникло желание купить её.
<br><br><font size="1"><i>-----<br>Чтобы правильно задать вопрос, нужно знать большую часть  ответа. Р.Шекли.</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299251&amp;user=17432&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=14" class="addthx" data-post="299251"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="15" onfocus="this.blur()" href="JavaScript:di('[b]gloomdemon[/b]','')">gloomdemon</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.2 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.11'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25555">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 15:45 &middot; Поправил: gloomdemon <br><script type="text/javascript">QU('gloomdemon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=gloomdemon" target="_blank">Личное сообщение</a> &middot;  <a href="#15" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#15');return false;">#15</a> </span><div align=left><br>
<I>HandMill пишет:<br>ещё вроде как никто не слепил компилятор си, который бы генерировал базонезависимый код, не говоря уже о с++. Как только такое появится хоть в одном компилере - можно будет подумывать о каком-то там &quot;многослойном шифровании кода&quot;, но прямиком из-под компиля такого не видать. </I><br><br>Упс, а разработчики gcc и binutils наверное с перепоя добавили -fPIC, -fPIE, -pic, -pie, а потом и забыли про него:<br><br>root[lib1]# cat exe_pie.c<br>/*<br> * exe_pie.c<br> */<br><br>#include &lt;stdio.h&gt;<br>#include &lt;stdlib.h&gt;<br><br>/*<br> *<br> */<br>int main(int argc, char** argv)<br>{<br>	printf(&quot;exe_pie\n&quot;);<br><br>	return (EXIT_SUCCESS);<br>}<br><br>компиляем: cc -g -ggdb -Wall -Wl,-rpath,. -pie -fPIE -o exe_pie.ex exe_pie.c<br>смотрим в иде:<br><br>; Attributes: bp-based frame<br><br>public main<br>main proc near<br>lea     ecx, [esp+4]<br>and     esp, 0FFFFFFF0h<br>push    dword ptr [ecx-4]<br>push    ebp<br>mov     ebp, esp<br>push    ebx<br>push    ecx<br>call    &#036;+5<br>pop     ebx<br>add     ebx, 1204h<br>sub     esp, 0Ch<br>lea     eax, (aExe_pie - 16F4h)[ebx] ; &quot;exe_pie&quot;<br>push    eax             ; s<br>call    _puts<br>add     esp, 10h<br>mov     eax, 0<br>lea     esp, [ebp-8]<br>add     esp, 0<br>pop     ecx<br>pop     ebx<br>pop     ebp<br>lea     esp, [ecx-4]<br>retn<br><br>Я этого не вставлял: call &#036;+5, pop ebx<br><br>Без -pie -fPIE:<br><br>; Attributes: bp-based frame<br><br>public main<br>main proc near<br><br>var_4= dword ptr -4<br><br>lea     ecx, [esp+4]<br>and     esp, 0FFFFFFF0h<br>push    dword ptr [ecx-4]<br>push    ebp<br>mov     ebp, esp<br>push    ecx<br>sub     esp, 4<br>sub     esp, 0Ch<br>push    offset s        ; &quot;exe_pie&quot;<br>call    _puts<br>add     esp, 10h<br>mov     eax, 0<br>mov     ecx, [ebp+var_4]<br>leave<br>lea     esp, [ecx-4]<br>retn<br><br>Это пример для x86, с x86-64 еще проще. Собственно все либы, под тот же линукс, давным давно уже компиляются обязательно с -fPIC =) и никаких релоков.
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299256&amp;user=25555&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=15" class="addthx" data-post="299256"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=10168" title="18-01-2012 21:36, ранг:443.5" target="_blank">Hexxx</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="16" onfocus="this.blur()" href="JavaScript:di('[b]HandMill[/b]','')">HandMill</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 222.2 (наставник), 115thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4554">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 15:59 <br><script type="text/javascript">QU('HandMill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HandMill" target="_blank">Личное сообщение</a> &middot;  <a href="#16" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#16');return false;">#16</a> </span><div align=left><br>
<b>gloomdemon</b> call _puts уж как-то очень просто, вам не кажется что такое необходимо предусматривать? Из второго листинга что за &quot;var_4= dword ptr -4&quot;? Теперь о _puts ещё чуток: другое дело если бы генерился код который в рантайме искал бы эту функцию и вставлял на место _puts нужный адрес. Необходимо ещё проверить доступен ли этот адрес на запись в памяти. В приведенном коде этого нет. Вывод - код не готов для переноса в другой бинарник.<br>разработчикам gcc и binutils привет!<br><I>gloomdemon пишет:<br>Собственно все либы, под тот же линукс, давным давно уже компиляются обязательно с -fPIC =) и никаких релоков.</I><br>Если всё так просто, почему же вы не помогаете ТС в решении изначально поставленной задачи?
<br><br><font size="1"><i>-----<br>все багрепорты - в личные сообщения</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299258&amp;user=4554&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=16" class="addthx" data-post="299258"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="17" onfocus="this.blur()" href="JavaScript:di('[b]gloomdemon[/b]','')">gloomdemon</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.2 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.11'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25555">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 16:12 &middot; Поправил: gloomdemon <br><script type="text/javascript">QU('gloomdemon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=gloomdemon" target="_blank">Личное сообщение</a> &middot;  <a href="#17" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#17');return false;">#17</a> </span><div align=left><br>
<I>HandMill пишет:<br>call _puts уж как-то очень просто, вам не кажется что такое необходимо предусматривать?  </I><br><br>Можно конечно потроллить такой вопрос, ведь вы очень невнимательно прочитали что я написал, ведь не просто так написал про то что все либы под линукс, компиляются с -fPIC, т.е. они базо-независимы и можно просто к опциям добавить -static, и libc + libdl будут слинкованы статически, правда в данном примере будет небольшой интересный побочный эфект.<br><br>Так же, можно взять libc, взять оттуда код dlopen, dlsym, и самому что надо ручками подгружать:<br><br>	void (*ctest1)(int *);<br><br>	lib_handle = lib_open(&quot;lib1.so&quot;, LIBS_LDEFAULT | LIBS_EPROCESS);<br><br>	if (!lib_handle)<br>		exit(1);<br>	if (!lib_symbol(lib_handle, &quot;ctest1&quot;, LIBS_EPROCESS, (void**)&amp;ctest1))<br>		exit(1);<br><br>lib_open обертка над dlopen, lib_symbol - dlsym<br><br><I>HandMill пишет:<br>другое дело если бы генерился код который в рантайме искал бы эту функцию и вставлял на место _puts нужный адрес. Необходимо ещё проверить доступен ли этот адрес на запись в памяти. В приведенном коде этого нет. Вывод - код не готов для переноса в другой бинарник. </I><br><br>не вижу смысла генерировать некий код в рантайме если он есть в libc, или тупо можно оттуда взять его сырцы, и этот код за меня все проверяет.<br><br><I>HandMill пишет:<br>Из второго листинга что за &quot;var_4= dword ptr -4&quot;? </I><br><br>второй листинг для примера, без -fPIE, т.е. без генерации базонезависимого кода, что  &quot;var_4= dword ptr -4&quot; не смотрел, как ида сгенерила по умолчанию так и скопипастил<br><br><I>HandMill пишет:<br>Если всё так просто, почему же вы не помогаете ТС в решении изначально поставленной задачи?</I><br><br>И что ему написать? Посоветовать скомпилить код, который нужно зашифровать, в объектник, потом код в объектнике пошифровать два раза ксором (желательно не одним и тем же числом) и потом прилинковать его к декриптору? Ну так это выше уже посоветовали.<br><br>ЗЫ<br><br>Решил еще добавить, что бы было понятно почему написал gcc и binutils, т.к. импорт (+секции и т.д.) разруливает линкер, то gcc туда не лезет, и просто компилит код который облегчает линкеру работу, т.е. из примера выше, код в объектнике получается следующий:<br><br>.text:08000000 ; Attributes: bp-based frame<br>.text:08000000<br>.text:08000000                 public main<br>.text:08000000 main            proc near<br>.text:08000000                 lea     ecx, [esp+4]<br>.text:08000004                 and     esp, 0FFFFFFF0h<br>.text:08000007                 push    dword ptr [ecx-4]<br>.text:0800000A                 push    ebp<br>.text:0800000B                 mov     ebp, esp<br>.text:0800000D                 push    ebx<br>.text:0800000E                 push    ecx<br>.text:0800000F                 call    &#036;+5<br>.text:08000014                 pop     ebx<br>.text:08000015                 nop                     ; PIC mode<br>.text:08000016                 mov     ebx, offset _GLOBAL_OFFSET_TABLE_<br>.text:0800001B                 sub     esp, 0Ch<br>.text:0800001E                 nop                     ; PIC mode<br>.text:0800001F                 mov     eax, offset s   ; &quot;exe_pie&quot;<br>.text:08000024                 push    eax             ; s<br>.text:08000025                 call    puts            ; PIC mode<br>.text:0800002A                 add     esp, 10h<br>.text:0800002D                 mov     eax, 0<br>.text:08000032                 lea     esp, [ebp-8]<br>.text:08000035                 add     esp, 0<br>.text:08000038                 pop     ecx<br>.text:08000039                 pop     ebx<br>.text:0800003A                 pop     ebp<br>.text:0800003B                 lea     esp, [ecx-4]<br>.text:0800003E                 retn<br><br>.rodata:08000045<br>.rodata:08000045 ; Segment type: Pure data<br>.rodata:08000045 ; Segment permissions: Read<br>.rodata:08000045 _rodata         segment byte public &#039;CONST&#039; use32<br>.rodata:08000045                 assume cs:_rodata<br>.rodata:08000045                 ;org 8000045h<br>.rodata:08000045 ; char s[]<br>.rodata:08000045 s               db &#039;exe_pie&#039;,0<br>.rodata:08000045 _rodata         ends<br>.rodata:08000045<br><br>extern:08000054<br>extern:08000054 ; Segment type: Externs<br>extern:08000054 ; extern<br>extern:08000054                 extrn _GLOBAL_OFFSET_TABLE_<br>extern:08000058 ; int puts(const char *s)<br>extern:08000058                 extrn puts:near<br>extern:08000058<br>extern:08000058<br>extern:08000058                 end<br><br>Тут, можно сказать, даже метки уже для криптора и разруливания им импорта есть =)
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299259&amp;user=25555&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=17" class="addthx" data-post="299259"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="18" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 17:59 <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#18" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#18');return false;">#18</a> </span><div align=left><br>
2 SReg<br>&gt; некоторых это только лишь бы подзадорило<br><br>я понимаю, что если во время спуска начнется<br>лавина, то некоторых фрирайдеров это подзадорит,<br>а у больщинства от этого всё таки измена случится <img src="img/smilies/s1.gif" alt=""><br><br>2 HandMill<br>&gt; вообще суть вопроса не понятна<br><br>в чем отличие трехслойного от пятислойного шифрования?<br><br>&gt; но прямиком из-под компиля такого не видать<br><br>я не ставил условие прямиком из компиля<br>меня интересует сама суть слоёв<br><br>что такое многослойное?<br><br>&gt; клепает свой комбайн самостоятельно: из си и ассемблера<br><br>&gt; для многослойной упаковки утилиты разработчиков <br>&gt; проходятся по откомпилированному коду не один раз<br><br>&gt; она тебе на выход многослойно упакованный код)))<br><br>я хотел увидеть код самого-самого простого<br>комбайна для трех- и пятислойного шифрования<br>чтобы понять суть что такое слой шифрования<br><br>&gt; ввиду того что кода на одном лишь си нет<br><br>то есть многослойное шифрование только<br>на одном на си не сделать? обязательно набор языков?<br><br>&gt; могут быть лишь собственные инструменты, <br>&gt; пойди на форум Themida&#039;ы или StarForce <br>&gt; поклянчи там, может дадут<br><br>мне может не хватить квалификации осилить<br>понимание работы комплекта утилит, используемых<br>в продакшене. я хотел увидеть именно минимальный<br>учебный пример. самый тупой, самый простой<br>на ксоре или ещё проще, если возможно<br><br>2 PE_Kill<br>&gt; он хочет написать код на cи, чтобы он <br>&gt; был многослойно пошифрован, т.е. <br>&gt; не прибегая к внешним утилитам<br><br>нет, я этого не говорил<br><br>я упоминул си лишь потому, что если бы<br>кто-то стал бы мне объяснять отличие<br>трех- от пятислойного шифрования например<br>на дельфи или на питоне, то я бы не понял,<br>ибо знаю только C/C++, пых и яваскрипт<br>я даже перл за 10 лет забыл <img src="img/smilies/s1.gif" alt=""><br><br>&gt; 1. написать код<br>&gt; 2. проставить маркеры<br>&gt; 3. воткнуть дешифровщики через дефайны<br>&gt; 4. внешней утилитой найти маркеры<br>&gt; 5. пошифровать<br><br>это один слой или на п.5. образуется<br>многослойное шифрование?<br><br>&gt; короче понт это всё, писать довольно<br>&gt; трудоемко, а дешифровать в несколько минут<br><br>товарищи, ну, хорош меня долбить<br>я уже давно понял, что ломается всё; <br>что построение защиты на порядки сложнее её поломки; <br>что защиту пишут только тупорылые дауны и т.п. <img src="img/smilies/s1.gif" alt=""><br><br>хватит крякать мой мосск <img src="img/smilies/s1.gif" alt=""><br><br>2 gloomdemon<br>&gt; скомпилить код, который нужно зашифровать,<br>&gt; в объектник, потом код в объектнике <br>&gt; пошифровать два раза ксором (желательно <br>&gt; не одним и тем же числом) и потом <br>&gt; прилинковать его к декриптору<br><br>ага!!! неужели трехслойное шифрование - <br>это тройной проход ксором, а пятислойное -<br>это пройти ксором пять раз? и из-за этого<br>столько вони про многослойность????!!!!<br>я в шоке!!!
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299270&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=18" class="addthx" data-post="299270"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="19" onfocus="this.blur()" href="JavaScript:di('[b]gloomdemon[/b]','')">gloomdemon</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 18.2 (новичок), 8thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.11'>Активность: 0.01<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=25555">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 18:12 <br><script type="text/javascript">QU('gloomdemon','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=gloomdemon" target="_blank">Личное сообщение</a> &middot;  <a href="#19" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#19');return false;">#19</a> </span><div align=left><br>
<I>wowfactor пишет:<br>ага!!! неужели трехслойное шифрование -<br>это тройной проход ксором, а пятислойное -<br>это пройти ксором пять раз? и из-за этого<br>столько вони про многослойность????!!!!<br>я в шоке!!!  </I><br><br>Эм, я даже не знаю что ответить, наверное так http://tinyurl.com/7tj95pm
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299271&amp;user=25555&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=19" class="addthx" data-post="299271"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=28841" title="17-01-2012 14:15, ранг:24.9" target="_blank">vden</a>, <a href="action=userinfo&user=31149" title="17-01-2012 16:19, ранг:6.0" target="_blank">wowfactor</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="20" onfocus="this.blur()" href="JavaScript:di('[b]HandMill[/b]','')">HandMill</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 222.2 (наставник), 115thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4554">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 18:16 <br><script type="text/javascript">QU('HandMill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HandMill" target="_blank">Личное сообщение</a> &middot;  <a href="#20" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#20');return false;">#20</a> </span><div align=left><br>
Ок, чувак, поясняю что нужно: пишем простой peloader(по запросу в гугле найдёшь массу исходников, в том числе и на с/с++), затем пихаешь в него (бинарно) целевую программу(калькулятор например), компилируешь, получаешь калькулятор внутри лоадера, при запуске должно работать, если не работает - лоадер не годный. Затем перегоняешь полученный ЕХЕ в дамп для с/с++, вставляешь его в код лоадера, компилируешь. Вот тебе уже двойное шифрование. Далее - дело итераций. Какими ключами шифровать - вопрос каждого билда.
<br><br><font size="1"><i>-----<br>все багрепорты - в личные сообщения</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299273&amp;user=4554&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=20" class="addthx" data-post="299273"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="21" onfocus="this.blur()" href="JavaScript:di('[b]vden[/b]','')">vden</a></b><br></div>
<img src="img/s5.gif" alt=""><br><span class=txtSm>Ранг: 112.9 (ветеран), 186thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 9.22'>Активность: 0.09<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=28841">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 18:26 &middot; Поправил: vden <br><script type="text/javascript">QU('vden','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=vden" target="_blank">Личное сообщение</a> &middot;  <a href="#21" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#21');return false;">#21</a> </span><div align=left><br>
<b>wowfactor</b><br>Если попробовать объяснить просто, то несколько слоев распаковки это когда:<br>один код распаковывает другой, переходит на него, распаковывает третий, переходит на него и т.д.<br>Чтобы побольше возни реверсеру.<br><br>Вот сгенерировал задачку, чтобы наглядно показать.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00510754</span>&nbsp;_TForm1_Button1Click&nbsp;<span class="hl_function"><b>proc</b></span>&nbsp;<span class="hl_function"><b>near</b></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00510754</span>&nbsp;&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;&nbsp;&nbsp;&nbsp;Layers</li><li class="hl_l0"><span class="hl_char">.</span>text<span class="hl_char">:</span><span class="hl_number">00510754</span>&nbsp;_TForm1_Button1Click&nbsp;<span class="hl_function">endp</span></li>        </ol>
    </div>
</div></div>
<br><br>Задача получить сообщение You Win.<br>Слоев 100.<br><br><img src="img/attach.gif" alt=""> <a href="./files/b99e_17.01.2012_EXELAB.rU.tgz">b99e_17.01.2012_EXELAB.rU.tgz</a> - prot1.7z
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299274&amp;user=28841&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=21" class="addthx" data-post="299274"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=30303" title="17-01-2012 14:30, ранг:7.2" target="_blank">dimka_new</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="22" onfocus="this.blur()" href="JavaScript:di('[b]hlmadip[/b]','')">hlmadip</a></b><br></div>
<img src="img/s4.gif" alt=""><br><span class=txtSm>Ранг: 58.1 (постоянный), 42thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 11.01'>Активность: 0.06<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=21572">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 19:52 <br><script type="text/javascript">QU('hlmadip','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=hlmadip" target="_blank">Личное сообщение</a> &middot;  <a href="#22" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#22');return false;">#22</a> </span><div align=left><br>
<I>vden пишет:<br>Вот сгенерировал задачку, чтобы наглядно показать. </I><br>Действительно, очень секретный код<img src="img/smilies/s3.gif" alt="">
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299283&amp;user=21572&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=22" class="addthx" data-post="299283"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:inline"> | Сообщение посчитали полезным: <span class="total_thx"><a href="action=userinfo&user=28841" title="18-01-2012 10:05, ранг:25.9" target="_blank">vden</a></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="23" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 20:22 <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#23" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#23');return false;">#23</a> </span><div align=left><br>
&gt; http://tinyurl.com/7tj95pm <br><br><img src="img/smilies/s5.gif" alt=""> <img src="img/smilies/s5.gif" alt=""> <img src="img/smilies/s5.gif" alt=""><br>ай молодца! <img src="img/smilies/s1.gif" alt=""><br><br>2 HandsMill<br>&gt; 1. пишем простой peloader<br><br>в контексте обсуждаемой темы peloader -<br>это такая разновидность дешифратора (декриптера)<br><br>верно?<br><br>&gt; 2. затем пихаешь в него (бинарно) целевую программу<br><br>в контексте темы, на си - речь идет о содержимом<br>exe файла сконвертированного в сишную строку<br>литеральным хексом<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function"><b>const</b></span>&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;strexe&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_quote">&quot;\x4D\x5A ... &quot;</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>верно?<br><br>&gt; 3. затем перегоняешь полученный ЕХЕ в дамп для с/с++<br><br>то есть содержимое полученного exe файла<br>опять в сишную строку литеральным хексом<br><br>&gt; 4. вставляешь его в код лоадера, компилируешь. <br><br>&gt; вот тебе уже двойное шифрование<br><br>может я чё-то не догоняю, но это не горячее <br>шифрование, а какая-то онанистическая конструкция<br>из вложнных самораспаковывающихся архивов <img src="img/smilies/s1.gif" alt=""><br><br>это всё равно что заархивировать бинарник<br>винраром в sfx, потом полученный архив ещё<br>раз заархивировать, потом ещё раз<br><br>если это и есть многослойное шифрование,<br>понятно, что тут все будут называть его<br>онанизмом <img src="img/smilies/s1.gif" alt=""><br><br>таких извращений можно много придумать <img src="img/smilies/s1.gif" alt=""><br>например создать ярлык, на него ярлык,<br>на него тоже ярлык, на ярлык батник, <br>на батник ярлык и т.д. пока крыша не съедет <img src="img/smilies/s5.gif" alt=""><br><br>короче, пример понятен, но по-моему он какой-то <br>не совсем аутентичный ... <img src="img/smilies/s3.gif" alt=""><br><br>2 vden<br>&gt; один код распаковывает другой, <br>&gt; переходит на него, <br>&gt; распаковывает третий, <br>&gt; переходит на него и т.д.<br><br><b>вот это уже что-то больше похоже на по теме</b><br><br>осталось только надыбать где-нибудь<br>пример, как можно например, простейшую<br>операцию инкремента глобальной переменной<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_char">:</span><span class="hl_char">:</span>flag<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>трехслойно расшифровать, а потом пятислойно<br>зашифровать, а при следующем обращении пятислойно<br>расшифровать, а потом опять однослойно зашифровать<br><br>есть у кого примерчик на си как такое можно<br>не напрягаясь делать в рантайме под винду?<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;крип</li><li class="hl_l0">count&nbsp;<span class="hl_char">=</span>&nbsp;strlen<span class="hl_char">(</span>buf<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">buf<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;0x79<span class="hl_comment">;</span></li><li class="hl_l0">for&nbsp;<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_number">1</span><span class="hl_comment">; i &lt; count; i++) buf[i] ^= buf[i-1];</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>&nbsp;декрип</li><li class="hl_l1">len&nbsp;<span class="hl_char">=</span>&nbsp;strlen<span class="hl_char">(</span>buf<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l0">for<span class="hl_char">(</span><span class="hl_function"><b>int</b></span>&nbsp;i&nbsp;<span class="hl_char">=</span>&nbsp;count<span class="hl_char">-</span><span class="hl_number">1</span><span class="hl_comment">; i &gt; 0 ; i--) buf[i] ^= buf[i-1];</span></li><li class="hl_l1">buf<span class="hl_char">[</span><span class="hl_number">0</span><span class="hl_char">]</span>&nbsp;^<span class="hl_char">=</span>&nbsp;0x79<span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br><br>&gt; Вот сгенерировал задачку, чтобы наглядно показать.<br><br><i class=x>чувак, я ни хрена не понял, что ты сказал,<br>но ты заговорил и ты тронул мое сердце</i><br><br><img src="img/smilies/s3.gif" alt=""><br><br>PS. немного не по теме, но вопрос возник и решил задать<br>если я хочу оставить сообщение крекеру, которое<br>я хочу чтобы он прочитал, когда будет крякать,<br>то где мне лучше всего это сообщение прописать?<br><br>например, если я хочу, чтобы когда он распакует <br>второй слой, то смог бы прочитать: &quot;молодец, два<br>слоя распаковано, осталось ещё три. вперед и с песней!&quot;<br><br>где лучше всего эту строку разместить?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299285&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=23" class="addthx" data-post="299285"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="24" onfocus="this.blur()" href="JavaScript:di('[b]HandMill[/b]','')">HandMill</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 222.2 (наставник), 115thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4554">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 20:35 <br><script type="text/javascript">QU('HandMill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HandMill" target="_blank">Личное сообщение</a> &middot;  <a href="#24" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#24');return false;">#24</a> </span><div align=left><br>
1. Нет, это загрузчик исполняемых файлов формата PE (portable executable)<br>2. Верно<br>3. Верно<br>4. Нет, не совсем таки уж вложенных самораспаковывающихся архивов. Так как всё происходит в контексте одного процесса. Но если рассматривать что процесс - архив, то да. Ярлык и батник - лишние файлы в системе. При работе peloader&#039;а не происходит никаких извлечений файлов на диск, всё в памяти. Только у вас видимо до сих пор ещё голова не хочет работать на то что в процессе распаковки можно как-то модифицировать &quot;распаковываемые файлы&quot;(или до упаковки ещё их модифицировать), так что бы они находясь в таком виде на диске не работали.<br><br>Код простенького(не подходящего для демонстрационного примера задачи) лоадера: <noindex><a href="http://it-talk.org/topic2161.html" rel="nofollow" target="_blank">http://it-talk.org/topic2161.html</a></noindex><br>Но вы ведь знаете с++? сможете переписать это для примера в котором происходила бы работа с памятью?<br><br>Более крутые лоадеры можно найти на этом сайте: <noindex><a href="http://indy-vx.narod.ru/log.txt" rel="nofollow" target="_blank">http://indy-vx.narod.ru/log.txt</a></noindex><br><br>Автор, сперва научись программы ломать, потом уж защиты писать берись
<br><br><font size="1"><i>-----<br>все багрепорты - в личные сообщения</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299286&amp;user=4554&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=24" class="addthx" data-post="299286"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="25" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 21:59 &middot; Поправил: wowfactor <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#25" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#25');return false;">#25</a> </span><div align=left><br>
&gt; Нет, это загрузчик исполняемых файлов формата PE (portable executable)<br>&gt; Ярлык и батник - лишние файлы в системе<br> <br>HandMill, sfx архив, ярылки и батники - <br>это всё были метафоры, а вы поняли их буквально.<br>извините, что ввел вас в заблуждение.<br> <br>я изучил что такое peloader и пришел к выводу,<br>что в контексте обсуждаемой темы - это<br>просто такой навороченный декриптер, который<br>расшифровывает строку с хексовыми литералами<br><br>. .  .  кстати, криптер для peloader&#039;a - это ни что <br>. .  .  иное как обычный компилятор. скомпилировать -<br>. .  .  это то же самое, что зашифровать<br><br>. .  .  а навороченная версия peloader&#039;а - это уже<br>. .  .  получится виртуальная машина)<br> <br>задача текущей темы не peloader&#039;ы изучать,<br>а многослойность, то есть не сложность<br>строковых декрипторов, а полифорфизм<br>исполняемого кода в рантайме средствами си<br> <br>я благодарен вам за пример, но он слишком топорный,<br>потому что peloader нафиг не нужен, ведь <br>всегда можно скинуть строку в файл <br>и вызвать system() - смысл будет тот же самый<br><br>а вот расшифровать одну инструкцию, выполнить<br>её и зашировать опять, причем в зависимости<br>от динамических параметров - вот о каком примере<br>я спрашиваю<br><br>. .  .  кстати, я в одной статье прочитал, что<br>. .  .  крякеры часто замечают криптеры и декриптеры <br>. .  .  чисто на глаз, просто по внешнему отличию <br>. .  .  от остального кода<br><br>. .  .  обычный код светлый, разряженный, криптеры<br>. .  .  всегда такие навороченные<br><br>. .  .  это правда? действительно они для опытного <br>. .  .  глаза в листинге выделяются?<br><br>&gt; сперва научись программы ломать, <br>&gt; потом уж защиты писать берись<br><br>нет у меня мотивации крякерство учить,<br>а на создание защит мотивация есть<br><br>я поэтому и тусуюсь в разделе форума<br>&quot;Программирование&quot;, а не &quot;Крякерство&quot;<br><br>&gt; сможете переписать это для примера <br>&gt; в котором происходила бы работа с памятью?<br><br>я изучил данный вами прелоадер и для<br>нашего случая нашел такую строку<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">__asm&nbsp;<span class="hl_function"><b>call</b></span>&nbsp;<span class="hl_function"><b>dword</b></span>&nbsp;<span class="hl_function"><b>ptr</b></span>&nbsp;<span class="hl_char">[</span><span class="hl_function">entry</span><span class="hl_char">]</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div>
<br><br>из которой я сделал вывод, что средствами<br>си невозможно вызвать кусок кода, который<br>был бы распакован в память, выполнен<br>и потом опять запакован в памяти и сохранен<br>в где-то в новом хранилище<br><br>что я нарыл на данный момент из вашего<br>примера<br><br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">void</span><span class="hl_char">*</span>&nbsp;pFrom<span class="hl_comment">; void* pTo;</span></li><li class="hl_l1"><span class="hl_function"><b>void</b></span>&nbsp;state<span class="hl_char">(</span><span class="hl_char">)</span>&nbsp;{&nbsp;<span class="hl_char">:</span><span class="hl_char">:</span>flag<span class="hl_char">-</span><span class="hl_char">-</span><span class="hl_comment">; }</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_char">/</span><span class="hl_char">*</span><span class="hl_char">*</span>&nbsp;some&nbsp;magic&nbsp;here&nbsp;<span class="hl_char">*</span><span class="hl_char">/</span></li><li class="hl_l0">&nbsp;</li><li class="hl_l1"><span class="hl_function">void</span><span class="hl_char">*</span>&nbsp;p&nbsp;<span class="hl_char">=</span>&nbsp;<span class="hl_char">.</span><span class="hl_char">.</span><span class="hl_char">.</span>&nbsp;<span class="hl_comment">;</span></li><li class="hl_l0">asm&nbsp;volatile&nbsp;<span class="hl_char">(</span><span class="hl_quote">&quot;call *%0&quot;</span><span class="hl_char">:</span><span class="hl_char">:</span><span class="hl_quote">&quot;r&quot;</span><span class="hl_char">(</span>p<span class="hl_char">)</span><span class="hl_char">)</span><span class="hl_comment">; // у меня mingw</span></li>        </ol>
    </div>
</div></div>
<br><br>как можно в рантайме взять содержание<br>функции state(), скопировать в кучу по новому<br>адресу в заксоренном виде, потом скопировать<br>адрес pTo = pFrom, расксорить, выполнить, потом<br>заксорить, скопировать в другое место в куче<br>и обратно отдать pFrom = pTo<br><br>тут нужно что-то с адресами меток мутить, да?<br>и как не ошибиться с размером (длиной функции)<br>или для этого тоже какие-то ассемблерные<br>вставки используются?
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299287&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=25" class="addthx" data-post="299287"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="26" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 17 января 2012 23:05 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#26" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#26');return false;">#26</a> </span><div align=left><br>
Triple Des ?! Примеры на си есть в сети.
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299293&amp;user=3520&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=26" class="addthx" data-post="299293"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="27" onfocus="this.blur()" href="JavaScript:di('[b]wowfactor[/b]','')">wowfactor</a></b><br></div>
<img src="img/s2.gif" alt=""><br><span class=txtSm>Ранг: 10.0 (новичок)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 8.49'>Активность: 0=0</span><br>Статус: <a href="action=userinfo&amp;user=31149">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 00:15 <br><script type="text/javascript">QU('wowfactor','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=wowfactor" target="_blank">Личное сообщение</a> &middot;  <a href="#27" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#27');return false;">#27</a> </span><div align=left><br>
&gt; Triple Des<br><br>не, качество шифровки меня не интересует<br>(в смысле не в этом треде)<br>в этой ветке речь только о многослойности
<br><br><span class="txtGoods"><a href="action=addthx&amp;post=299303&amp;user=31149&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=27" class="addthx" data-post="299303"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="28" onfocus="this.blur()" href="JavaScript:di('[b]Dart Sergius[/b]','')">Dart Sergius</a></b><br></div>
<img src="img/s5.gif" alt=""><br><img style="padding-top:3px;" src="av/22828.jpg" alt=""><br><span class=txtSm>Ранг: 105.6 (ветеран), 36thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 10.72'>Активность: 0.1<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=22828">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 00:20 &middot; Поправил: Dart Sergius <br><script type="text/javascript">QU('Dart Sergius','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Dart Sergius" target="_blank">Личное сообщение</a> &middot;  <a href="#28" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#28');return false;">#28</a> </span><div align=left><br>
если не объявленна переменная state, то <br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0"><span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;crypt_func<span class="hl_char">=</span><span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span>state</li>        </ol>
    </div>
</div></div>
<br>т.к. state - это переменная типа FARPROC(вроде так пишется)<br>ну или что-то типо такого мутить.<br>
<div class="hl_container">
<div class="hl_header">Code:</div>
<div class="hl_scroll_part_normal">
    <div class="hl_normal"> 
        <ol class="hl_main"><li class="hl_l0">FARPROC&nbsp;uncrypt<span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;Dest<span class="hl_char">,</span>&nbsp;<span class="hl_function">char</span><span class="hl_char">*</span>&nbsp;Key<span class="hl_char">)</span><span class="hl_comment">;</span></li><li class="hl_l1">&nbsp;</li><li class="hl_l0"><span class="hl_char">/</span><span class="hl_char">/</span>использовать&nbsp;так</li><li class="hl_l1">uncrypt<span class="hl_char">(</span><span class="hl_char">(</span><span class="hl_function">char</span><span class="hl_char">*</span><span class="hl_char">)</span>state<span class="hl_char">,</span>&nbsp;key<span class="hl_char">)</span><span class="hl_char">(</span>и&nbsp;&nbsp;тут&nbsp;параметры&nbsp;для&nbsp;вызова&nbsp;функции<span class="hl_char">)</span><span class="hl_comment">;</span></li>        </ol>
    </div>
</div></div><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299308&amp;user=22828&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=28" class="addthx" data-post="299308"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="29" onfocus="this.blur()" href="JavaScript:di('[b]HandMill[/b]','')">HandMill</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 222.2 (наставник), 115thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.14<span style='color:red'>&searr;</span>0.01</span><br>Статус: <a href="action=userinfo&amp;user=4554">Участник</a></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 00:29 <br><script type="text/javascript">QU('HandMill','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=HandMill" target="_blank">Личное сообщение</a> &middot;  <a href="#29" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#29');return false;">#29</a> </span><div align=left><br>
<I>wowfactor пишет:<br>из которой я сделал вывод, что средствами<br>си невозможно вызвать кусок кода, который<br>был бы распакован в память, выполнен<br>и потом опять запакован в памяти и сохранен<br>в где-то в новом хранилище</I><br>Конечно же это всё можно реализовать! Для этого есть специальный движок: <noindex><a href="http://indy-vx.narod.ru/Bin/GCBE.zip" rel="nofollow" target="_blank">http://indy-vx.narod.ru/Bin/GCBE.zip</a></noindex> он вам поможет построить граф и отморфить код так, как вы посчитаете нужным. Надеюсь смешать код на си и ассемблере для вас проблем не составит. Это пожалуй лучшее решение что я Вам могу порекомендовать. Данный случай (с динамической дешифровкой и шифровкой кода обратно) как раз взывает к использованию таких методик
<br><br><font size="1"><i>-----<br>все багрепорты - в личные сообщения</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299310&amp;user=4554&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=29" class="addthx" data-post="299310"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="30" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.48'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 18 января 2012 01:27 &middot; Поправил: mak <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#30" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=6&amp;topic=19478&amp;page=0#30');return false;">#30</a> </span><div align=left><br>
<I>wowfactor пишет:<br>&gt; Triple Des<br><br>не, качество шифровки меня не интересует<br>(в смысле не в этом треде)<br>в этой ветке речь только о многослойности  </I><br><br>Сам не знаешь, что тебе конкретно нужно, даже не посмотрел похоже <img src="img/smilies/s13.gif" alt=""><br><br><I>wowfactor пишет:<br>Везде так много говорится о крутости шифрования<br>кода на лету и даже не просто шифрования, а ещё<br>и многослойного, но нигде я что-то не могу найти<br>примера, который бы на пальцах показывал что это<br>такое. </I><br><br>Определись с терминами, опиши сам еще раз что тебе нужно и что это такое. В многослойном шифровании может использоваться один и тот же криптоалгоритм, а может и разные. Сюда же входит тема о комбинации криптоалгоритмов, была здесь такая тема, но развития не получила. А такие примеры скорее всего тут не увидишь. Какие примеры конкретно ты хочешь увидеть? С ксором?<br><br>Тебе таким образом сколько примеров не показывай, мало будет.<br><br>П.С. Аес и блоуфисш бери и строй многослойное шифрование, по ходу отписывайся.<br>Или можно посмотреть ru.wikipedia.org/wiki/Режим_шифрования, например глава Cipher Block Chaining (CBC) он может считаться частным случаем многослойного шифрования, пример с ксором описан. AES-CBC можно глянуть. Генетические алгоритмы тоже идут как дабл лэйеред, вариантов многослойного шифрования очень много. Обычно используют несколько подряд криптоалгоритмов и шифруют по очереди, крипто - декриптор отличный от первого - и опять крипто отличное от первых двух.<br><br>С простым ксором многослойное шифрование можно найти в крипторах, там и будет нужный полиморф по условию темы. Сорсов в сети тоже полно.
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=299318&amp;user=3520&amp;forum_n=6&amp;topic=19478&amp;page=0&amp;anchor=30" class="addthx" data-post="299318"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b> .  <b>1</b> . <a href="action=vthread&amp;forum=6&amp;topic=19478&amp;page=1.html">2</a> . <a href="action=vthread&amp;forum=6&amp;topic=19478&amp;page=1.html">&gt;&gt;</a></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/p.gif" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=6&sortBy=0&page=0.html"><b>Программирование</b></a> <b class=bulletHead>&#8212;&#8250;</b> Многослойное динамическое шифрование (пример полиморфного кода на C/C++)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<div align=center>
<table class=forums>
<tr>
<td class=caption4 width="100%"><span class=header>Эта тема закрыта. Ответы больше не принимаются.</span></td>
</tr>
</table>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=19478" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
