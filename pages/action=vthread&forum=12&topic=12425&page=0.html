<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>Demon666 blog: Native Ring API (NRAPI) - eXeL@B</title>
<meta NAME="DESCRIPTION" CONTENT="Как привык писать всемогущий Archer - всем варнинги, если вы себя без лишней скромности считаете профессионалом, то для вас здесь ничего нового не будет, но вы можете поделиться своими знаниями с другими! долго думал, что выбрать">
<meta NAME="KEYWORDS" CONTENT="x64_dbg windbg ollydbg ida скачать взлом отладчик ассемблер дизассемблер крэкер cracker реверсер keygen кейген кодер патч патчер крэкми лоадер брутфорсер протектор распаковщик пароль ключ ключфайл шпион oep key защита программа winapi faq hiew windasm softice winhex">
<META NAME="Document-state" CONTENT="Dynamic">
<META HTTP-EQUIV="Pragma" CONTENT="no-cache"> 
<link rel="SHORTCUT ICON" href="/favicon.ico">
<meta name="viewport" content="width=device-width">
<link href="./skin/s0.css" type="text/css" rel="STYLESHEET">
<link href="./skin/code.css" type="text/css" rel="STYLESHEET">
<script type="text/javascript" src="./js/jq.js"></script>
<link rel="alternate" type="application/rss+xml" title="eXeL@B" href="./rss.php">
<style type="text/css">.username div .dops{display:none;}</style>
<link href="../menu.css" type="text/css" rel="stylesheet">
</head>

<body>
<a id="to_top"></a>
<div id="wrapper">
 
<div class="mob-hamburger"><span></span></div>
 
</center></div><script type='text/javascript'>
function lst(){var i=0;var htm='';var a='';var timer=setInterval(function(){if(i<10){i=i+10;}else{clearInterval(timer);i=0;}document.getElementById('kurs_container').style.marginLeft='-'+i+'px';},100);}
document.addEventListener('DOMContentLoaded',function(event){setTimeout(lst,1500);setInterval(lst,10000);});
</script></div></div>
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery(".mob-hamburger").on("click", function() {
        jQuery(".mob-hamburger").toggleClass("active");
        jQuery("#site-navigation").slideToggle();
		if (jQuery('.mob-hamburger').hasClass('active')) {
			var i = jQuery('#site-navigation').offset().top;
		} else { 
			var i = 0;
		}
			
		jQuery("html, body").animate({ scrollTop: i }, 600);
    });
	var btn = jQuery('#to_top');
	jQuery(window).scroll(function() {
		if (jQuery(window).scrollTop() > 300) {
			btn.addClass('show');
		} else {
			btn.removeClass('show');
		}
	});
	btn.on('click', function(e) {
		e.preventDefault();
		jQuery('html, body').animate({scrollTop:0}, '300');
	});
});
</script>
 
<div id="content">
<div align=center style="margin-top:15px">

<table class=tbTransparent>
<tr><td class=tbTransparent>
<span class=txtSm>Сейчас на форуме: <b> (+3 невидимых)</b></span>
</td>
</tr>
</table>

<table class=forums>
 
</tr></table>

</div><br>
<script language="javascript" type="text/javascript" charset="windows-1251" src="templates/base.js"></script>

<div align=center><table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/blog.png" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=12&sortBy=0&page=0.html"><b>Дневники и блоги</b></a> <b class=bulletHead>&#8212;&#8250;</b> Demon666 blog: Native Ring API (NRAPI)</span></td>
</tr></table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width="15%" class=caption4><span class=txtSm><b>Посл.ответ</b></span></td>
<td width="85%" class=caption4><span class=txtSm><b>Сообщение</b></span></td></tr>
<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="1" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 30 июля 2008 09:17 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#1" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=12425.html&amp;page=0#1');return false;">#1</a> </span><div align=left><br>
Как привык писать всемогущий <b>Archer </b>- всем варнинги, если вы себя без лишней скромности считаете профессионалом, то для вас здесь ничего нового не будет, но вы можете поделиться своими знаниями с другими! <br>долго думал, что выбрать если честно. И подумал, чтобы сразу выше потолка не прыгнуть, как раз для начала самое то...<br>кто любит и умеет что-то делать, предлагаю поучаствовать в проекте, если конечно хоть немного заденет.<br>Native Ring API (NRAPI) <br>The native ring application programming interface (NRAPI) is a helper library<br>вот подумал, что красиво сабж звучит, по этому решил на таком названии и остановится <br>у Microsoft есть imagehlp.dll и psapi.dll, ну это будет наш гибрид %))<br>ссылки на исходники для более детального знакомства, если вдруг у кого нет на СИ<br>demonteam.narod.ru/download/imagehlp.rar (211kb)<br>demonteam.narod.ru/download/psapi.rar (13kb)<br>кстати у вас при этом есть возможность сравнить стиль написания кода предложенный мной с кодом от Microsoft %))<br>и вот пожалуй надо сказать пару слов о трудах Клерка, ссылка <br>demonteam.narod.ru/download/ntpatch.rar (160kb)<br>мне его стиль не очень, черточек много в названиях да и лишнего кода там много, но может кому проще в Native окунутся будет как раз по его исходникам на ASM`е<br>кстати критика по стилю кодинга библы приветствуется, но с существенными комментариями ;)<br>demonteam.narod.ru/download/nrapi.rar  (18kb)<br>как обычно предлагаю, если кто напишет свою хотя бы одну API, отпостите здесь свой кодес, я его добавлю в общую библиотеку чтобы ее могли юзать все кому интересен будет сабж, короче.. не жадничайте, плз!<br>у меня не очень много времени бывает, так что бывает смогу отписаться только через неделю, так что не обращайте особого внимания, если есть чего обсудить без меня, и еще просьба не гнобить ньюбиков жаждущих поиметь новых знаний, плз!!!<br>!!!Вопросы типа: у меня компилер не скомпилил и выдает такую-то ошибку, здесь писать не надо - идите в таком случае учите RTFM!!!<br><br>а да забыл сказать, что кодес мы в dll будем юзать C++ нам сказали что это стандарт, но asm-кодеров мы незабываем никогда.<br>Поэтому пишите на asm`е(только сами(копипаст не приветствуется, но можно)) и постите здесь, а мы его уже переведем в C++<br><br>и так хватит уже угарного треша, пора и к делу<br>что у нас есть на данный момент из макросов <br>RVATOVA(base, offset)<br>GetImageDosHeader(base)<br>GetImageNtHeaders(base)<br>GetNumberOfSections(base)<br>// Microsoft macro IMAGE_FIRST_SECTION in winnt.h<br>GetFirstImageSectionHeader(base)<br>GetImageExportDirectory(base)<br>GetImageTlsDirectory(base)<br><br>описывать для чего они нужны смысла не вижу, из имен макросов можно сразу понять для чего они...<br>макросы были выбраны для работы с PE-форматом не случайно<br>они сокращают код в исходнике, имеют более читабельный вид и при компиляции создается оптимальный бинарный код<br>далее имена экспортируемых функций (тут суть не в том чтобы уже сразу заюзать готовый код)<br>ULONG CalcHash(LPSTR name_api)<br>NTSTATUS NrGetSystemModuleInformation(LPSTR ModuleName, PSYSTEM_MODULE_INFORMATION smi)<br>NTSTATUS NrMapViewOfFile(LPSTR DosPathModuleName, HANDLE hProcess, PFILE_MAP_INFORMATION file_map_information)<br>NTSTATUS NrUnmapViewOfFile(PFILE_MAP_INFORMATION file_map_information)<br>NTSTATUS NrWriteVirtualMemoryProtect(HANDLE ProcessHandle, PVOID BaseAddress, PVOID Buffer, ULONG BufferLength, PULONG ReturnLength)<br>NTSTATUS NrReadVirtualMemoryProtect(HANDLE ProcessHandle, PVOID BaseAddress, PVOID Buffer,ULONG BufferLength, PULONG ReturnLength)<br>NTSTATUS NrGetProcAddress(PVOID hModule, PULONG pArraryProcHash, PULONG pArraryReturnVaOfFunctions)<br>бывает есть в наличии адрес и нужно узнать полный путь модуля, которому принадлежит этот адрес в его адресном пространстве или базовый адрес по которому загружен модуль, вот эта API ищет инфу о модуле <br>на входе хендл процесса и адрес – на выходе заполненная информацией о модуле структура MODULE_INFORMATION<br>NTSTATUS NrFindModule(HANDLE hProcess, PVOID Address, PMODULE_INFORMATION module_information)<br><br>да я понимаю что этого совсем мало для релиза, можно сказать совсем ничего, но ведь цель не выложить готовое, а постараться самим КОМАНДОЙ создать что-то, а это просто в качестве примера – так сказать направление.. <br>было бы не плохо, если у кого-нибудь есть хорошие ссылочки на чтиво по теме, запостите тут чтобы у новичков больше инфы было<br>P. S.<br>буду рад услышать мнение тех кто умеет/знает больше..<br>ЗЫ: у меня аттачи здесь не цепляются
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=197165&amp;user=4551&amp;forum_n=12&amp;topic=12425.html&amp;page=0&amp;anchor=1" class="addthx" data-post="197165"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr><td class=caption4 colspan=2></td></tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="2" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 августа 2008 21:02 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#2" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=12425.html&amp;page=0#2');return false;">#2</a> </span><div align=left><br>
Хех. Не знаю, почему автор приватно постенг прислал, но очень даже все и интересно написано<br><I> Хотелось бы видеть нечто вроде этого:<br><br>DWORD BinarySearch(BYTE* DATA,int SizeOfDATA,BYTE* Pattern,BYTE* SearchMask,int PatternLen)<br>{<br>///////////////////////////////////////////////////////////////////// /////<br>// Example:<br>//<br>// BYTE Pattern[]= {0x00, 0x01, 0x00, 0x03};<br>// // {0x00, 0x01, 0x00, ??};<br>// BYTE SearchMask[]= {0, 0, 0, 1};<br>// int PatternLen=sizeof Pattern;<br>// BYTE Data[]={0x01 ,0x01, 0x01, 0x00, 0x01, 0x00, 0x01, 0x01};<br>// int DataLen=sizeof Data;<br>//<br>// BinarySearch((unsigned char *)Data,DataLen,(unsigned char *)Pattern,(unsigned char *)SearchMask,PatternLen)<br>//<br>// if successfull find needed pattern, returns an offset to it<br>// in this example it will return 3<br>///////////////////////////////////////////////////////////////////// /////<br>bool Result;<br>int Count;<br><br>if (SizeOfDATA&lt;PatternLen)<br>{<br>return PE_ERROR;<br>}<br><br>for (int i=0;i&lt;SizeOfDATA;i++)<br>{<br>Count=0;<br>Result=TRUE;<br>if (DATA[i]==Pattern[0])<br>{<br>for (int j=0;j&lt;PatternLen;j++)<br>{<br>Count++;<br>if (DATA[i+j]!=Pattern[j])<br>{<br>Count--;<br>Result=FALSE;<br><br>if (SearchMask[j]==1)<br>{<br>Count++;<br>Result=TRUE;<br>}<br>}<br>}<br>if ((Result==TRUE)&amp;&amp;(Count==PatternLen))<br>{<br>return i;<br>}<br>}<br>}<br><br>return PE_ERROR;<br>}<br><br>Очень часто просто приходится искать некую последовательность байт в коде по маске. Моя функа не оптимизирована и хреновая (как о ней отозвались на форуме когда речь зашла о бинарном поиске по маске). Хотя я её применил в одном своём проекте довольно успешно =) Уверен что ты сможешь помочь в улучшении этой функи ;) <br> </I><br><br>я точно не помню, но где-то видел даже несколько топиков по этой теме<br>Вообщем тут почесав мозг, решил зарелизить приватный алго на asm`е<br>уровень сложности где-то средний, тут выложить кодес не проблема.. вот как его снабдить тех.документацией <br>по себе знаю что бывает довольно тяжко, если нет описалова для кодеса<br>вот такой паттерн мона заюзать в нем: C0 ?A ?? (11???01?) * 26 3? * 5C<br>то, что в (11???01?) - это побитный поиск(8bit) (должно быть ровно 8, в скобках  – 0 или 1 или ?)<br>* - это любой бинарный байт(ы)(тут ограничение 100 байт(я уже сейчас точно не помню)) единственное что могу еще добавить не вариант больше или вообще без лимита, просто даже по одной из причин что может найти на начале и в самом конце(короче думаю ты поймешь если нужно будет)<br>там юзается рекурсия я вот не помню скорее всего без лимитная <br>? – тут пожалуй все стандартно как и у всех, ну разве что мона и по тетраде(старшей/младшей) осуществлять поиск<br>прототип для СИ<br>extern &quot;C&quot; ULONG __stdcall BinWildcard(void *Base, unsigned long Length, char *szPattern);<br>Base – адрес с которого начинается поиск<br>Length – это длина того ГДЕ ИЩЕТСЯ<br>szPattern – указатель на строку ASCII типа C0?A??(11???01?)*263?*5C заканчивающиеся нулем<br>возвращает -1, если ничего не нашел, или адрес если нашел<br>короче не знаю есть ли в природе быстрее алгоритм, но всяких там Гуано Педрасов уделает эт точно %)))<br>там в алго парсер он сам переводит строку в нужный ему формат для поиска<br>короче ниже это уже угарный трешь asm-кодеров (вообщем приватный сленг), но если в asm`е шаришь, то там ничего сложного нет!<br>demonteam.narod.ru/download/modx86.rar <br>вот как подключать к C/C++ проекту, вариантов очень много.. каждый выбирает для себя сам, короче эт уже RTFM мну его разжевывать не очень любит
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=197535&amp;user=4551&amp;forum_n=12&amp;topic=12425.html&amp;page=0&amp;anchor=2" class="addthx" data-post="197535"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel1>
<td width="17%" class=caption1>
<div class=username><div><b><a name="3" onfocus="this.blur()" href="JavaScript:di('[b]mak[/b]','')">mak</a></b><br></div>
<img src="img/s8.gif" alt=""><br><img style="padding-top:3px;" src="av/3520.jpg" alt=""><br><span class=txtSm>Ранг: 673.3 <font color=magenta>(<b>! !</b>)</font>, 400thx<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.49'>Активность: 0.4<span style='color:red'>&searr;</span>0.31</span><br>Статус: <a href="action=userinfo&amp;user=3520">Участник</a><br><font color=blue>CyberMonk</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 01 августа 2008 22:07 <br><script type="text/javascript">QU('mak','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=mak" target="_blank">Личное сообщение</a> &middot;  <a href="#3" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=12425.html&amp;page=0#3');return false;">#3</a> </span><div align=left><br>
<b>Demon666</b> обалденно ты в тему ) , спасибо , оч пригодится ..
<br><br><font size="1"><i>-----<br>RE In Progress [!] Coding Hazard [!] Stay Clear of this Cube</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=197541&amp;user=3520&amp;forum_n=12&amp;topic=12425.html&amp;page=0&amp;anchor=3" class="addthx" data-post="197541"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>

<tr valign=top class=tbCel2>
<td width="17%" class=caption1>
<div class=username><div><b><a name="4" onfocus="this.blur()" href="JavaScript:di('[b]Demon666[/b]','')">Demon666</a></b><br></div>
<img src="img/s6.gif" alt=""><br><span class=txtSm>Ранг: 213.5 (наставник)<br><span title='Сообщений в день (с регистрации) / За последний год / Лет с регистрации: 14.21'>Активность: 0.12<span style='color:red'>&searr;</span>0</span><br>Статус: <a href="action=userinfo&amp;user=4551">Участник</a><br><font color=blue>забанен</font></span></div>
<br>
</td>
<td width="83%" class="caption1 post"><span class=txtSm>Создано: 03 августа 2008 20:07 <br><script type="text/javascript">QU('Demon666','Цитата','пишет');</script> &middot; <a href="?step=sendmsg&amp;action=pmail&amp;userto=Demon666" target="_blank">Личное сообщение</a> &middot;  <a href="#4" onClick="prompt('Ссылка на сообщение', 'https://exelab.ru/f/action=vthread&amp;forum=12&amp;topic=12425.html&amp;page=0#4');return false;">#4</a> </span><div align=left><br>
Вот ща тупо на клавиши жму и слышу такой текст из песни: (еще музыка такая, разрушающая сознание)<br>Blind me eyes, I can&#039;t see<br>What is being done to me<br>In my mind, only pain<br>All the memories are drained<br>и все таки мне его жалко...<br><br>Иногда нужно заюзать чужой код в своем проекте, но этот чужой код может быть очень большой - к примеру 10 мегабайт, а нам нужно только около 1 мегабайта.<br>Особенно это бывает актуально при рипе - когда много кода, а нужно рипнуть только нужный код<br>или есть библа 10 мегабайт и ее таскать с собой из-за одной API – это АХТУНГ! <br>Меня вообще добивают неудачники кодящие на C# - сам код, который они пишут, весит обычно не больше 100kb, но они делают инсталл и в него пихают стандартные сборки, которые уже у всех обычно установлены и в результате вместо полезного кода (100 килобайт), мы получаем проги от 1 до 10 мегабайт...<br>да и вообще тут даже все это дело под большим вопросом, а писали ли они вообще этот код или просто тупо скопипастили и теперь им барыжнечают...<br>ведь сейчас что-то писать самому это не есть гуд, можно просто банально тупо зайти на <br>Google Code Search www.google.com/codesearch <br>вбить нужный кодес и нажать на Search, гы-гы - а тут у нас как обычно проблема, че-то много нагуглило бывает даже глаза разбегаются от предоставленной халявы %))<br>вступайте и копилируйте вместе - сейчас уже это не актуально ИМХО<br>GoogleCodeSearch - вы еще так ни разу не гуглели? Тогда мы идем к вам!<br><br>все пишут и я напишу %))<br>тут пользы от этого кода ноль(но может кому и интересно будет понять что он делает), он чич-то для примера. Показывает как заюзать нужную API из чужого кода в ASM`е на примере адского MessageBox`а <br>все как обычно, но будет всего одно отличие, в скомпиленом бинарике будет только тот код, который нам нужен и ничего кроме.<br>в архиве динамик и статик скомпиленные варианты и исходники на ASM`е, короче все че надо чтобы разобраться как это работает, там есть.<br>demonteam.narod.ru/download/UsedObj.rar (18kb)<br><br>тут тоже из статика код выложу (чтобы гуглился)<br>.386<br>.model flat,stdcall<br>option casemap:none<br><br>NrGetProcAddress PROTO :DWORD,:DWORD,:DWORD<br>NrGetKernel32 PROTO<br>NrBinWildcard PROTO :DWORD,:DWORD,:DWORD<br>NrWriteVirtualMemoryProtect PROTO :DWORD,:DWORD,:DWORD,:DWORD,:DWORD<br><br>include kernel32.inc<br>includelib kernel32.lib<br>includelib user32.lib<br>includelib ntdll.lib<br>includelib nrapi_static.lib<br><br><br>cha MACRO name_api<br>    LOCAL hash<br>    hash = 0<br>	FORC char, &lt;name_api&gt;<br>		hash = (((hash SHL 7) OR (hash SHR (32-7))) XOR  &#039;&amp;char&#039;)<br>	ENDM<br>	EXITM &lt;hash&gt;<br>ENDM<br><br>API Struct <br>	LoadLibrary dd ?<br>	FreeLibrary dd ?<br>	EndKernel32 dd ?<br>	MessageBox dd ?<br>	EndUser32 dd ?<br>API EndS<br><br>.data?<br>api API &lt;?&gt;<br>hUser32 dd ?<br>	<br>.data<br>szUser32 db &quot;user32.dll&quot;,0<br>hash_api API &lt;cha(LoadLibraryA),cha(FreeLibrary),0,cha(MessageBoxA),0&gt;<br>szPattern db &quot;54686973*696E20444F&quot;,0<br><br>.code <br>UsedObj: <br>	invoke NrGetKernel32<br>	invoke NrGetProcAddress, eax, addr hash_api, addr api<br>	push offset szUser32<br>	call api.LoadLibrary<br>	mov hUser32, eax<br>	invoke NrGetProcAddress, eax, addr hash_api.MessageBox, addr api.MessageBox<br>	invoke NrBinWildcard, hUser32, 1000h, addr szPattern<br>	mov edi,eax<br>	add eax,13<br>	mov esi,eax<br>	invoke GetCurrentProcess<br>	invoke NrWriteVirtualMemoryProtect, eax, esi, addr szUser32, 11, 0<br>	push 0<br>	push offset szUser32<br>	push edi<br>	push 0<br>	call api.MessageBox<br>	push hUser32<br>	call api.FreeLibrary<br>	ret<br>end UsedObj<br><br>еще две мелочи пофиксил - может там еще че есть.. ну да ладно потом, если попадется<br>там NrBinWildcard возвращала смещение, а не адрес - забыл просто, закомментил одну строчку и все гуд работает<br>и в NrGetProcAddress дописать два плюса надо было, чтобы массив заполнялся<br>пока вроде все пашет...
<br><br><font size="1"><i>-----<br>ЗЫ: истЕна где-то рядом, Welcome@Google.com</i></font><br><br><span class="txtGoods"><a href="action=addthx&amp;post=197793&amp;user=4551&amp;forum_n=12&amp;topic=12425.html&amp;page=0&amp;anchor=4" class="addthx" data-post="197793"><img src="img/tu.png" border=0 title="Полезное сообщение"></a><span class="have_thx" style="display:none"> | Сообщение посчитали полезным: <span class="total_thx"></span></span></span><br></div></td>
</tr>


</table>
<table class=tbTransparent><tr><td class=tbTransparent><span class=txtSm><b></b></span></td></tr></table>
<table class=forums><tr>
<td width=16 valign=top class=caption3><img src="./img/forum_icons/blog.png" width=16 height=16 alt=""></td>
<td width="100%" class=caption3><span class=header>&nbsp;<a href="../index.html"><b>eXeL@B</b></a> <b class=bulletHead>&#8212;&#8250;</b> <a href="action=vtopic&amp;forum=12&sortBy=0&page=0.html"><b>Дневники и блоги</b></a> <b class=bulletHead>&#8212;&#8250;</b> Demon666 blog: Native Ring API (NRAPI)</span></td>
</tr></table>
</div>
<a name=newreply></a>
<script type="text/javascript">
function check_form(f)
{
  f.elements['b1'].value = 'Отправка...';
  f.elements['b1'].disabled = true;
  return true;
}
</script>

<div align="center">
<form name="postMsg" action="#5" method="post" class="formStyle" enctype="multipart/form-data" onsubmit="return check_form(this);" onkeydown="ctrle(event, this)">
<table class="forums">

<tr>
<td class="caption2">
<span class="txtSm"><b>:: Ваш ответ</b></span>
</td>
</tr>
<tr>
<td class="caption7">

<img class="toolButton" src="./img/button_bold.gif" width="23" height="22" border="0" title="Жирный" alt="Жирный" onmouseover="window.status='Жирный'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[b]','[/b]');">&nbsp;
<img class="toolButton" src="./img/button_italic.gif" width="23" height="22" border="0" title="Курсив" alt="Курсив" onmouseover="window.status='Курсив'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[t]','[/t]');">&nbsp;
<img class="toolButton" src="./img/button_underlined.gif" width="23" height="22" border="0" title="Подчеркнутый" alt="Подчеркнутый" onmouseover="window.status='Подчеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[u]','[/u]');">&nbsp;
<img class="toolButton" src="./img/button_strike.gif" width="23" height="22" border="0" title="Перечеркнутый" alt="Перечеркнутый" onmouseover="window.status='Перечеркнутый'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[s]','[/s]');">&nbsp;
<img class="toolButton" src="./img/button_code.gif" width="23" height="22" border="0" title="Код" alt="{mpf5}" onmouseover="window.status='Код'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[ASM]','[/ASM]');">&nbsp;
<img class="toolButton" src="./img/button_image.gif" width="23" height="22" border="0" title="Ссылка на картинку" alt="Код" onmouseover="window.status='Ссылка на картинку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[img]','[/img]');">&nbsp;
<img class="toolButton" src="./img/button_url.gif" width="23" height="22" border="0" title="Вставить ссылку" alt="Вставить ссылку" onmouseover="window.status='Вставить ссылку'; return true" onmouseout="window.status=''; return true" onclick="JavaScript:di('[url=',']--&gt; Link &lt;--[/url]');">&nbsp;

<!-- mod by arnix start 
<select style="position: relative; top: -7; width: 150px;" id="addHighlightedCode" onchange="insertHl(this);">
<option value="0">Подсветка кода...</option>
<option value="asm">Assembler</option>
<option value="c">C</option>
<option value="cpp">C++</option>
<option value="pascal">Pascal</option>
<option value="delphi">Delphi</option>
<option value="php">PHP</option>
<option value="vb">Visual Basic</option>
</select>&nbsp;
 mod by arnix end -->

<br>
<a href="JavaScript:di(':s1:','');"><img src="./img/smilies/s1.gif" border="0" alt=":s1:"></a>
<a href="JavaScript:di(':s2:','');"><img src="./img/smilies/s2.gif" border="0" alt=":s2:"></a>
<a href="JavaScript:di(':s3:','');"><img src="./img/smilies/s3.gif" border="0" alt=":s3:"></a>
<a href="JavaScript:di(':s4:','');"><img src="./img/smilies/s4.gif" border="0" alt=":s4:"></a>
<a href="JavaScript:di(':s5:','');"><img src="./img/smilies/s5.gif" border="0" alt=":s5:"></a>
<a href="JavaScript:di(':s6:','');"><img src="./img/smilies/s6.gif" border="0" alt=":s6:"></a>
<a href="JavaScript:di(':s7:','');"><img src="./img/smilies/s7.gif" border="0" alt=":s7:"></a>
<a href="JavaScript:di(':s8:','');"><img src="./img/smilies/s8.gif" border="0" alt=":s8:"></a>
<a href="JavaScript:di(':s9:','');"><img src="./img/smilies/s9.gif" border="0" alt=":s9:"></a>
<a href="JavaScript:di(':s10:','');"><img src="./img/smilies/s10.gif" border="0" alt=":s10:"></a>
<a href="JavaScript:di(':s11:','');"><img src="./img/smilies/s11.gif" border="0" alt=":s11:"></a>
<a href="JavaScript:di(':s12:','');"><img src="./img/smilies/s12.gif" border="0" alt=":s12:"></a>
<a href="JavaScript:di(':s13:','');"><img src="./img/smilies/s13.gif" border="0" alt=":s13:"></a>
<a href="JavaScript:di(':s14:','');"><img src="./img/smilies/s14.gif" border="0" alt=":s14:"></a>
<a href="JavaScript:di(':s15:','');"><img src="./img/smilies/s15.gif" border="0" alt=":s15:"></a>
<a href="JavaScript:di(':s16:','');"><img src="./img/smilies/s16.gif" border="0" alt=":s16:"></a>
</td></tr>
<tr>
<td class="caption5"><textarea name="postText" rows="10" class="textForm" tabindex="2" style="width:100%"></textarea>
<BR><INPUT class="textForm" type="file" name="fileAttach"><BR><SMALL>Максимальный размер аттача: <b>500KB</b>.</SMALL>
<br><span class="txtSm"> </span>
</td>
</tr>
<tr>
<td class="caption7">
<table class=tbTransparent>
<tr valign=middle>
<td class=tbTransparent><span class=txtSm>Ваш логин: <b><a href="https://exelab.ru/f/action=userinfo&amp;user=55973">german1505</a></b>  &raquo; <a href="mode=logout">Выход</a> &raquo; <a href="?action=pmail"><b>ЛС</b></a></span></td>
</tr>
</table>

</td>
</tr>


<tr>
<td class="caption5"><input type="submit" value="Отправить сообщение" class="inputButton" name="b1" tabindex="5"></td>
</tr>
</table>
<input type="hidden" name="action" value="pthread">
<input type="hidden" name="forum" value="12">
<input type="hidden" name="topic" value="12425">
</form>
</div>
<script type="text/javascript" src="templates/vthread_logged.js"></script>
<div align=center><table class=tbTransparent><tr>
<td class=tbTransparent><span class=txtSm>      &nbsp;&nbsp;&nbsp;<a href="/f/forprint.php?topic_id=12425" title="Версия для печати"><img src="img/forprint.gif" border="0" alt="Для печати"> Для печати</a>&nbsp;</span></td>
</tr></table></div>
<br>
 
<br><br><br></center>

</div>
<div id="footer">Вы находитесь на EXELAB.rU</div>
<div id="footer_btns">
<a href="http://www.reactos.org" rel="nofollow" target="_blank"><img src="./images/react.png" height="31" width="88" border="0" title="" alt=""></a> <script type="text/javascript"><!--
document.write("<img src='//counter.yadro.ru/hit?t44.2;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";h"+escape(document.title.substring(0,80))+";"+Math.random()+
"' "+
"border='0' width='31' height='31'>")
//--></script>
</div>
</div>

</body></html>
